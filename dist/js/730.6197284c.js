"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[730],{80730:function(a,t,e){e.r(t),e.d(t,{default:function(){return Sa}});var s=e(66252),l=e(2262),o=e(3577),c=e(87066),i=e(56296);const r={class:"layout-px-spacing"},d=(0,s.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Assets Consumption Details</span></li></ol></nav></div></li></ul>',1),n=["innerHTML"],u={key:1,class:"custom-table table3"},b=["onClick"],m=(0,s._)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),v=(0,s._)("circle",{cx:"12",cy:"12",r:"3"},null,-1),_=[m,v],g={class:"modal fade mymodal",id:"ItemConsumption","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1"},h={class:"modal-dialog modal-fullscreen modal-dialog-scrollable"},w={class:"modal-content"},p={class:"modal-header"},y=(0,s._)("h1",{class:"modal-title fs-5"},"Items Consumption Details",-1),S={class:"modal-body flex-grow-1 overflow-auto"},x={class:"row layout-top-spacing"},k={class:"col-xl-6 col-lg-12 col-sm-12 layout-spacing"},f={class:"statbox box-shadow shadow card"},N=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"JOBCARDS")],-1),C={class:"custom-table table3"},L=["onClick"],D={key:0,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-check2-circle",viewBox:"0 0 16 16"},q=(0,s._)("path",{d:"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0"},null,-1),H=(0,s._)("path",{d:"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"},null,-1),j=[q,H],W={key:1,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-circle",viewBox:"0 0 16 16"},R=(0,s._)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},null,-1),A=[R],E={class:"col-xl-6 col-lg-12 col-sm-12 layout-spacing",style:{"max-height":"95vh","overflow-y":"auto"}},U={class:"row"},I={key:0,class:"col-12 mb-4"},O={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},M=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"SPARES USED")],-1),T={class:"card-body"},B={class:"custom-table table3"},z={key:1,class:"col-12 mb-4"},K={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},P=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"BODY WORKS")],-1),F={class:"card-body"},G={class:"custom-table table3"},Y={key:2,class:"col-12 mb-4"},J={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},V=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"TYRES USED")],-1),Z={class:"card-body"},Q={class:"custom-table table3"},X={key:3,class:"col-12 mb-4"},$={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},aa=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"ADDITIONAL WORKS")],-1),ta={class:"card-body"},ea={class:"custom-table table3"},sa={key:4,class:"col-12 mb-4"},la={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},oa=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"ENGINEERING WORKS")],-1),ca={class:"card-body"},ia={class:"custom-table table3"},ra={key:5,class:"col-12 mb-4"},da={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},na=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"LABOUR COST")],-1),ua={class:"card-body"},ba={class:"custom-table table3"},ma={key:6,class:"col-12 mb-4"},va={class:"statbox widget box box-shadow widget-statistics h-100 shadow card"},_a=(0,s._)("div",{class:"card-header text-center"},[(0,s._)("h4",{class:"mb-0"},"ELECTRICAL WORKS")],-1),ga={class:"card-body"},ha={class:"custom-table table3"},wa={class:"modal-footer"};var pa={setup(a){(0,i.j)({title:"Custom Table"});const t=c.Z.create({baseURL:"https://bushman.ink/api/v1/"}),e=((0,s.f3)("loadingIndicator"),(0,s.f3)("tableShimmer")),m=(0,s.f3)("showError"),v=(0,l.iH)(!1),q=(0,l.iH)([]),H=(0,l.iH)([]),R=(0,l.iH)([]),pa=(0,l.iH)([]),ya=(0,l.iH)([]),Sa=(0,l.iH)([]),xa=(0,l.iH)([]),ka=(0,l.iH)([]),fa=(0,l.iH)([]),Na=(0,l.iH)(["SNo","name","type","fuel_type","complete_jobcards","active_jobcards","total_jobcards","total_cost","actions"]),Ca=(0,l.iH)(["SNo","tyre_no","rate","date_changed"]),La=(0,l.iH)(["jobcard_id","service_type","status","date_created","cost","actions"]),Da=(0,s.Fl)((()=>["SNo","spare","quantity","rate","cost"])),qa=(0,s.Fl)((()=>["SNo","description","quantity","rate","cost"])),Ha=(0,l.iH)(null),ja=(0,l.iH)({perPage:10,perPageValues:[10,20,50],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["SNo","name","type","fuel_type"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1,responseAdapter(a){return a.map(((a,t)=>({...a,SNo:t+1})))}}),Wa=()=>{v.value=!0,t.get("machine-consumptions").then((a=>{q.value=a.data.map(((a,t)=>{const e=(a.jobcards||[]).map(((a,t)=>{const e=(a.item_usages||[]).reduce(((a,t)=>a+Number(t.quantity)*Number(t.rate)),0),s=(a.tyres||[]).reduce(((a,t)=>a+Number(t.rate)),0),l=(a.cost_notes||[]).reduce(((a,t)=>a+Number(t.quantity)*Number(t.rate)),0);return{...a,SNo:t+1,cost:e+s+l}})),s=e.length,l=e.reduce(((a,t)=>a+t.cost),0),o=e.filter((a=>"completed"===a.status?.toLowerCase())).length,c=e.filter((a=>"active"===a.status?.toLowerCase())).length;return{SNo:t+1,id:a.machine_id,name:a.machine_name,type:a.machine_type,fuel_type:a.fuel_type??"-",jobcards:e,complete_jobcards:o,active_jobcards:c,total_jobcards:s,total_cost:l.toLocaleString()+"/="}})),v.value=!1})).catch((a=>{m(a.message||"Failed to fetch items"),v.value=!1}))},Ra=a=>{const t=q.value.find((t=>t.id===a));H.value=(t.jobcards||[]).map(((a,t)=>{const e=(a.item_usages||[]).reduce(((a,t)=>a+Number(t.quantity)*Number(t.rate)),0),s=(a.tyres||[]).reduce(((a,t)=>a+Number(t.rate)),0),l=(a.cost_notes||[]).reduce(((a,t)=>a+Number(t.quantity)*Number(t.rate)),0),o=e+s+l;return{...a,SNo:t+1,cost:o.toLocaleString()+"/=",status:{key:a.status,class:a.status_color}}}))},Aa=a=>{Ha.value=a,R.value=(a.item_usages.filter((a=>"spares"===a.usage_type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/="}))),pa.value=(a.item_usages.filter((a=>"body_works"===a.usage_type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/="}))),fa.value=(a.tyres||[]).map(((a,t)=>({...a,SNo:t+1,rate:Number(a.rate).toLocaleString()+"/="}))),ya.value=(a.cost_notes.filter((a=>"additional"===a.type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/="}))),Sa.value=(a.cost_notes.filter((a=>"engineering"===a.type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/="}))),xa.value=(a.cost_notes.filter((a=>"labour"===a.type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/="}))),ka.value=(a.cost_notes.filter((a=>"electric"===a.type))||[]).map(((a,t)=>({...a,SNo:t+1,cost:(a.quantity*a.rate).toLocaleString()+"/=",rate:Number(a.rate).toLocaleString()+"/"})))},Ea=()=>{H.value=[],R.value=[],pa.value=[],fa.value=[],ya.value=[],Sa.value=[],xa.value=[],ka.value=[],Ha.value=null};return(0,s.bv)((()=>{Wa()})),(a,t)=>{const c=(0,s.up)("v-client-table");return(0,s.wg)(),(0,s.iD)("div",r,[d,v.value?((0,s.wg)(),(0,s.iD)("div",{key:0,innerHTML:(0,l.SU)(e)()},null,8,n)):((0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(c,{data:q.value,columns:Na.value,options:ja.value},{actions:(0,s.w5)((a=>[((0,s.wg)(),(0,s.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"text-primary",onClick:t=>Ra(a.row.id),"data-bs-toggle":"modal","data-bs-target":"#ItemConsumption"},_,8,b))])),_:1},8,["data","columns","options"])])),(0,s._)("div",g,[(0,s._)("div",h,[(0,s._)("div",w,[(0,s._)("div",p,[y,(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=a=>Ea())})]),(0,s._)("div",S,[(0,s._)("div",x,[(0,s._)("div",k,[(0,s._)("div",f,[N,(0,s._)("div",C,[(0,s.Wm)(c,{data:H.value,columns:La.value},{status:(0,s.w5)((a=>[(0,s._)("span",{class:(0,o.C_)(["badge inv-status","badge-"+a.row.status.class])},(0,o.zw)(a.row.status.key),3)])),actions:(0,s.w5)((a=>[(0,s._)("span",{class:"text-success",onClick:t=>Aa(a.row)},[a.row.jobcard_id===Ha.value?.jobcard_id?((0,s.wg)(),(0,s.iD)("svg",D,j)):((0,s.wg)(),(0,s.iD)("svg",W,A))],8,L)])),_:1},8,["data","columns"])])])]),(0,s._)("div",E,[(0,s._)("div",U,[R.value.length>0?((0,s.wg)(),(0,s.iD)("div",I,[(0,s._)("div",O,[M,(0,s._)("div",T,[(0,s._)("div",B,[(0,s.Wm)(c,{data:R.value,columns:(0,l.SU)(Da)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),pa.value.length>0?((0,s.wg)(),(0,s.iD)("div",z,[(0,s._)("div",K,[P,(0,s._)("div",F,[(0,s._)("div",G,[(0,s.Wm)(c,{data:pa.value,columns:(0,l.SU)(Da)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),fa.value.length>0?((0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("div",J,[V,(0,s._)("div",Z,[(0,s._)("div",Q,[(0,s.Wm)(c,{data:fa.value,columns:Ca.value},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),ya.value.length>0?((0,s.wg)(),(0,s.iD)("div",X,[(0,s._)("div",$,[aa,(0,s._)("div",ta,[(0,s._)("div",ea,[(0,s.Wm)(c,{data:ya.value,columns:(0,l.SU)(qa)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),Sa.value.length>0?((0,s.wg)(),(0,s.iD)("div",sa,[(0,s._)("div",la,[oa,(0,s._)("div",ca,[(0,s._)("div",ia,[(0,s.Wm)(c,{data:Sa.value,columns:(0,l.SU)(qa)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),xa.value.length>0?((0,s.wg)(),(0,s.iD)("div",ra,[(0,s._)("div",da,[na,(0,s._)("div",ua,[(0,s._)("div",ba,[(0,s.Wm)(c,{data:xa.value,columns:(0,l.SU)(qa)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0),ka.value.length>0?((0,s.wg)(),(0,s.iD)("div",ma,[(0,s._)("div",va,[_a,(0,s._)("div",ga,[(0,s._)("div",ha,[(0,s.Wm)(c,{data:ka.value,columns:(0,l.SU)(qa)},null,8,["data","columns"])])])])])):(0,s.kq)("",!0)])])])]),(0,s._)("div",wa,[(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:t[1]||(t[1]=a=>Ea())},"Close")])])])])])}}};const ya=pa;var Sa=ya}}]);
//# sourceMappingURL=730.6197284c.js.map