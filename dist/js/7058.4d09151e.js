"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[7058],{67058:function(a,e,t){t.r(e),t.d(e,{default:function(){return N}});t(26699);var l=t(66252),s=t(2262),o=t(3577),r=t(49963),n=t(56296),i=t(19051);const d=(0,s.iH)({perPage:10,perPageValues:[10,50,100,200],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","Item"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1});var c=t(87066);const u={class:"layout-px-spacing dash_1"},m=(0,l._)("ul",{class:"navbar-nav flex-row"},[(0,l._)("li",null,[(0,l._)("div",{class:"page-header"},[(0,l._)("nav",{class:"breadcrumb-one","aria-label":"breadcrumb"},[(0,l._)("ol",{class:"breadcrumb"},[(0,l._)("li",{class:"breadcrumb-item"},[(0,l._)("a",{href:"javascript:;"},"Dashboard")]),(0,l._)("li",{class:"breadcrumb-item active","aria-current":"page"},[(0,l._)("span",null,"Sales")])])])])])],-1),p=(0,l._)("ul",{class:"navbar-nav flex-row ms-auto"},[(0,l._)("li",{class:"nav-item more-dropdown"},[(0,l._)("div",{class:"dropdown custom-dropdown-icon"},[(0,l._)("a",{href:"javascript:;",class:"nav-link dropdown-toggle",id:"ddlSettings","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,l._)("span",null,"Settings"),(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},[(0,l._)("polyline",{points:"6 9 12 15 18 9"})])]),(0,l._)("ul",{class:"dropdown-menu dropdown-menu-end","aria-labelledby":"ddlSettings"},[(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Settings",href:"javascript:void(0);"},"Settings")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Mail",href:"javascript:void(0);"},"Mail")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Print",href:"javascript:void(0);"},"Print")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Download",href:"javascript:void(0);"},"Download")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Share",href:"javascript:void(0);"},"Share")])])])])],-1),v={class:"row layout-top-spacing"},_=["innerHTML"],g={key:0,class:"col-xl-4 col-lg-6 col-md-6 col-sm-12 mb-4"},b={class:"card shadow-lg p-3 h-100 position-relative"},h={class:"mb-3"},w={class:"text-dark"},f={class:"row"},y={class:"modal fade mymodal",id:"update-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},k={class:"modal-dialog modal-lg"},S={class:"modal-content"},H={class:"modal-header"},x={class:"modal-body"},C={class:"custom-table table3"},D={class:"table table-striped table-bordered"},j=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Receiver"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Explanations"),(0,l._)("th",null,"Unit"),(0,l._)("th",null,"Shortage Cost")])],-1),q={class:"input-group"},M={class:"btn btn-primary"},I=["innerHTML"],R={key:1},z={class:"modal-footer"},E=(0,l._)("button",{style:{display:"none"},"data-bs-toggle":"modal","data-bs-target":"#shortage-grn",id:"shortage"},null,-1);var L={setup(a){(0,n.j)({title:"Dashboard"});const e=c.Z.create({baseURL:"https://bushman.ink/api/v1/"}),t=((0,l.Fl)((()=>d.value)),(0,s.iH)(["SNo","name","description","units","receiver","received","shortage","briefing","cost","date","actions"]),(0,s.iH)("")),L=(0,s.iH)(""),$=(0,s.iH)(!1),N=async a=>{$.value=!0;const l={status_id:L.value,remark:t.value};try{await e.put(`grn-items/${a}`,l);T("Saved!"),t.value="",document.getElementById("close2").click(),X()}catch(s){console.log(s),F(s.message)}finally{$.value=!1}},P=(0,s.iH)(!1),U=JSON.parse(localStorage.getItem("user")).permissions,O=(0,s.iH)(""),B=(0,s.iH)(""),T=(0,l.f3)("showMessage"),F=(0,l.f3)("showError"),J=(0,l.f3)("formatNumber"),A=(0,l.f3)("formatDate"),K=((0,l.f3)("tableShimmer"),(0,l.f3)("loadingSpinner")),V=(0,l.f3)("cardShimmer"),W=((0,s.iH)(!1),()=>{e.get("dashboard/summary").then((a=>{O.value=a.data})).catch((a=>{F(a.message),console.error("Error fetching summary :",a)}))});W();(0,s.iH)([]),(0,s.iH)([]),(0,s.iH)("nothing"),(0,s.iH)("");const Y=(0,s.iH)([]);function Q(a){if(!a||"string"!==typeof a)return 0;try{return Function("summary",`return ${a}`)(O.value)}catch(e){return 0}}const Z=async()=>{P.value=!0;try{const a=await e.get("main-cards");Y.value=a.data}catch(a){console.log(a),F(a.message)}finally{P.value=!1}},G=(0,s.iH)([]),X=async()=>{try{const a=await e.get("grn-items?status_id=2");G.value=a.data.map(((a,e)=>({...a,SNo:e+1,id:a.id,date:A(a.created_at),receiver:a?.receiver?.name,grn_no:a.grn_id,name:a.approval_item.requisition_item.remark,description:a.approval_item.requisition_item.description,units:a.approval_item.requisition_item.units,rate:a.approval_item.requisition_item.rate,received:a.quantity,approved:a.approval_item.quantity,shortage:(a.approval_item.quantity-a.quantity).toFixed(2),briefing:a.description,cost:J(a.approval_item.requisition_item.rate*(a.approval_item.quantity-a.quantity)),rate:a.approval_item.requisition_item.rate}))),G.value.length>0&&U.includes("can_view_grn_shortage_alert")&&!JSON.parse(localStorage.getItem("popped"))&&(aa("shortage-grn"),localStorage.setItem("popped",!0)),console.log(JSON.parse(localStorage.getItem("popped")))}catch(a){console.log(a),F(a.message)}},aa=a=>{const e=document.getElementById(a);if(!e)return;const t=new bootstrap.Modal(e);t.show()},ea=(0,s.iH)([]),ta=async()=>{try{const a=await e.get("dashboard/summary"),t=a.data,l=(a,e="")=>Object.keys(a).flatMap((t=>{const s=e?`${e}.${t}`:t;return"object"===typeof a[t]&&null!==a[t]?l(a[t],s):`summary?.${s} ?? 0`})),s=l(t);ea.value=s.map((a=>({name:a})))}catch(a){console.log(a),F(a.message)}};return(0,l.bv)((()=>{X(),Z(),ta()})),(a,e)=>{const n=(0,l.up)("Router-link");return(0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(),(0,l.j4)(l.lR,{to:"#breadcrumb"},[m,p])),(0,l._)("div",v,[P.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,s.SU)(V)()},null,8,_)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(Y.value,(a=>((0,l.wg)(),(0,l.iD)(l.HY,{key:a.id},[!a.permission||(0,s.SU)(U).includes(a.permission)?((0,l.wg)(),(0,l.iD)("div",g,[(0,l._)("div",b,[(0,l.Wm)(n,{to:a.path,class:"text-decoration-none"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l._)("h4",w,(0,o.zw)(a.name),1)]),(0,l._)("div",f,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.sub_cards,(a=>((0,l.wg)(),(0,l.iD)("div",{key:a.id,class:"col-6 mb-3"},[(0,l.Wm)(n,{to:a.path},{default:(0,l.w5)((()=>[(0,l._)("div",{class:(0,o.C_)(["card shadow border-start-primary h-100 p-3 d-flex flex-column align-items-center justify-content-center",`text-${a.color}`])},[(0,l._)("h6",{class:(0,o.C_)(`text-${a.color}`)},(0,o.zw)(a.name),3),(0,l._)("h4",{class:(0,o.C_)(`text-${a.color}`)},[(0,l.Wm)((0,s.SU)(i.FQ),{"start-val":0,"end-val":Q(a.count_source),duration:3e3},null,8,["end-val"])],2)],2)])),_:2},1032,["to"])])))),128))])])),_:2},1032,["to"])])])):(0,l.kq)("",!0),(0,l._)("div",y,[(0,l._)("div",k,[(0,l._)("div",S,[(0,l._)("div",H,[(0,l._)("h1",{class:(0,o.C_)(["modal-title fs-5",4==L.value?"text-danger":"text-success"]),id:"staticBackdropLabel"},(0,o.zw)(4==L.value?"REJECTION":"APPROVAL")+" REMARKS ",3),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close2",onClick:e[0]||(e[0]=a=>aa("shortage-grn"))})]),(0,l._)("div",x,[(0,l._)("div",C,[(0,l._)("table",D,[j,(0,l._)("tbody",null,[(0,l._)("tr",null,[(0,l._)("td",null,(0,o.zw)(B.value.receiver),1),(0,l._)("td",null,(0,o.zw)(B.value.name+" - "+B.value.description),1),(0,l._)("td",null,(0,o.zw)(B.value.briefing),1),(0,l._)("td",null,(0,o.zw)(B.value.units),1),(0,l._)("td",null,(0,o.zw)(B.value.cost),1)])])])]),(0,l._)("form",{onSubmit:e[2]||(e[2]=(0,r.iM)((a=>N(B.value.id)),["prevent"]))},[(0,l._)("div",q,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Enter Remarks",class:"form-control me-1","onUpdate:modelValue":e[1]||(e[1]=a=>t.value=a)},null,512),[[r.nr,t.value]]),(0,l._)("button",M,[$.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(K)()},null,8,I)):((0,l.wg)(),(0,l.iD)("span",R,"Send"))])])],32)]),(0,l._)("div",z,[(0,l._)("button",{type:"button",class:"btn btn-danger btn-sm","data-bs-dismiss":"modal",onClick:e[3]||(e[3]=a=>aa("shortage-grn"))},"Close")])])])]),E],64)))),128))])])}}};const $=L;var N=$}}]);
//# sourceMappingURL=7058.4d09151e.js.map