{"version":3,"file":"js/213.cf6a01bf.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/budgets/requisitionBudget.vue","webpack://cork-vue3/./src/views/budgets/requisitionBudget.vue?b9a4"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">\r\n        <ul class=\"navbar-nav flex-row\">\r\n            <li>\r\n                <div class=\"page-header\">\r\n                    <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                        <ol class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Budgets </a></li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n            </li>\r\n        </ul>  \r\n        <div>\r\n\r\n<div >\r\n\r\n<!-- budget status cards -->\r\n    <div v-if=\"showBudgetStatusCard\" class=\"d-flex justify-content-center my-4\">\r\n        <div class=\"budget-status-card-container mt-3 col-md-6\"> \r\n            <div class=\"card shadow border-start-primary h-100 p-4\" :class=\"'card-' + budgetStatusCardType\">\r\n                <div class=\"card-header d-flex justify-content-between align-items-center\">\r\n                    <h4 class=\"card-title mb-0 text-center w-100\">{{ budgetStatusCardTitle }}</h4>\r\n                </div>\r\n                <div class=\"card-body\">\r\n                    <p class=\"card-text fs-5 text-start\">{{ budgetStatusCardMessage }}</p>\r\n                    <div v-if=\"budgetStatusRemarks\" class=\"mt-4\">\r\n                        <h5 class=\"fs-5 text-dark text-start\">Remarks:</h5>\r\n                        <p class=\"remarks-text fs-5 text-start\">{{ budgetStatusRemarks }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        <div v-else>\r\n\r\n\r\n<!-- budget and project details starts-->\r\n <div class=\"d-flex\">\r\n                <router-link :to=\"`/budgets`\"\r\n                    class=\"btn btn-primary mx-2 mt-2 mb-2\" \r\n                    title=\"Go to budgets\"\r\n                    >\r\n                    &nbsp;Budgets\r\n                </router-link>\r\n\r\n                <div class=\"ms-auto\">\r\n                                <router-link :to=\"`/approval-chains/1`\"\r\n                    class=\"btn btn-success mx-2 mt-2 mb-2\" \r\n                    title=\"Go to budgets\"\r\n                    >\r\n                    &nbsp;Purchase Orders\r\n                </router-link>\r\n                </div>\r\n </div>\r\n\r\n\r\n\r\n                <table class=\"table table-bordered table-responsive mb-3\">\r\n          <thead>\r\n            <tr>\r\n              <th colspan=\"8\" class=\"bg-light text-center text-dark fs-6\">Budget Details</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <th>Project:</th>\r\n              <td>{{ project?.short_name }}</td>\r\n              <th>Budget Name:</th>\r\n              <td>{{ budget.name }}</td>\r\n               <th>Budget Iteme:</th>\r\n              <td>{{ budgetItem.name}}</td>\r\n              <th>Description:</th>\r\n              <td>{{ fetchedItem.name }}</td>\r\n            </tr>\r\n           \r\n            <tr>\r\n              <th>Allocated Amount:</th>\r\n              <td>{{ formatNumber(budget.funded_amount) }} Tsh</td>\r\n              <th>Budget Cost:</th>\r\n              <td>{{ formatNumber(budget.total_cost) }} Tsh</td>\r\n              <th>Used Cost:</th>\r\n              <td>{{ formatNumber(budget.total_used_cost) }} Tsh</td>\r\n              <th>Balance:</th>\r\n              <td>{{ formatNumber(budget.funded_amount - budget.total_used_cost) }} Tsh</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n\r\n               <table v-if=\"budget\" class=\"table table-bordered table-responsive table-striped\">\r\n                        <thead>\r\n                            <tr >\r\n                                <th class=\"text-dark fw-bold\">ALLOCATED AMOUNT</th>\r\n                                <th class=\"text-success\">ALLOCATED BALANCE</th>\r\n                                 <th class=\"text-danger\">UNALLOCATED AMOUNT</th>\r\n                                 <th class=\"text-dark\">BUDGET COST</th> \r\n                                 <th class=\"text-dark\">USED COST</th> \r\n                                <th class=\"text-dark\">BUDGET STATUS</th> \r\n                            </tr>\r\n                            <tr>\r\n                               <td v-if=\"add_fund\" >\r\n                               \r\n                              <form  @submit.prevent=\"addFund()\">\r\n                                <input type=\"number\" class=\"form-control\" placeholder=\"Add Funded amount\" v-model=\"fund\" step=\"any\" min=\"1\" required>\r\n                               <div class=\"d-flex mt-1\">\r\n                                 <div class=\"ms-auto btn-group\">\r\n                                    <button class=\"btn btn-danger me-1  btn-sm p-2\" \r\n                              @click=\"fund = '', add_fund = false\"\r\n                              >cancel</button>\r\n                               <button type=\"submit\" class=\"btn  btn-primary btn-sm p-2\"\r\n                                :disabled=\"loading\"\r\n                                ><span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n                              <span v-else>Submit</span>\r\n                              </button>\r\n                            \r\n                                 </div>\r\n                               </div>\r\n                               \r\n                               \r\n                              </form>\r\n                            </td>\r\n                              <td v-else\r\n                               @click=\"add_fund =  true\"\r\n                              >\r\n                               <span >\r\n                                   {{ formatNumber(budget.funded_amount) }}\r\n                                </span>\r\n                              \r\n                              </td>\r\n                               <td>{{ formatNumber(budget.funded_amount - budget.total_used_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.funded_amount - budget.total_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.total_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.total_used_cost) }}</td>\r\n                               <td>{{ budget.status }}</td>\r\n                              </tr>\r\n                        </thead>\r\n    </table> \r\n <!-- budget and project details ends -->\r\n              \r\n         <div class=\"d-flex flex-wrap gap-2 mb-2 mt-4 justify-content-end align-items-center\">\r\n            <div class=\"btn-group flex-wrap \" style=\"gap: 8px;\">\r\n                <!-- <router-link :to=\"`/requisition/budget/${budget.id}`\"\r\n                    class=\"btn btn-primary mx-2 mt-2\" \r\n                    title=\"Create Requisition\"\r\n                    v-if=\"user_permissions.includes('can_create_requisition') && budget.status === 'closed'\"\r\n                    >\r\n                    &nbsp;Requisition \r\n                </router-link> -->\r\n                <button \r\n                v-if=\"budget\"\r\n                    class=\"btn btn-success mx-2 mt-2\" \r\n                    @click=\"printReport\" \r\n                    title=\"Print Report\"\r\n                    >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n                        <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n                        <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n                    </svg>\r\n                    &nbsp;Print\r\n                </button>\r\n\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <!--Item form starts  -->\r\n\r\n<!-- item form ends -->\r\n<div v-if=\"budget\" class=\"table-responsive shadow-lg\"> \r\n<form v-if=\"add_item \" @submit.prevent=\"addItem()\">\r\n  <div class=\"row mt-2 justify-content-center g-2\">\r\n    <div class=\"col-md-6\">\r\n      <div class=\"input-group\">\r\n        <input type=\"text\" class=\"form-control\" placeholder=\"Add Item\" v-model=\"item_name\" required>\r\n        <button type=\"submit\" class=\"btn btn-primary\">\r\n          <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n          <span v-else>Save</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n\r\n\r\n                \r\n<table class=\"table table-bordered table-responsive mt-5\">\r\n    <thead class=\"thead-light table-reponsive\">\r\n        <tr>\r\n            <th>Sno:</th>\r\n            <th>Item</th>\r\n            <th>Description</th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <tr v-for=\"(item,i)  in items\">\r\n\r\n            <td> {{ i + 1  }}</td>\r\n            <td> {{ item.name  }}</td>\r\n            <td>\r\n \r\n\r\n                <table class=\"table table-bordered table-responsive mt-5\">\r\n                   <thead class=\"thead-light table-reponsive\">\r\n                           <tr>\r\n                               <th>Sno:</th>\r\n                               <th>Item</th>\r\n                               <th>Specification</th>\r\n                               <th>Units</th>\r\n                               <th>Qty 1</th>\r\n                               <th>Qty 2</th>\r\n                               <th>Rate</th>\r\n                               <th>Cost</th>\r\n                               <th>\r\n                               <button\r\n                               v-if=\"budget.status ==='open'\"\r\n  class=\"btn btn-sm p-2\"\r\n  :class=\"item.id === add_description ? 'btn-danger' : 'btn-primary'\"\r\n  @click=\"add_description = item.id === add_description ? 0 : item.id\"\r\n>\r\n  <template v-if=\"item.id !== add_description\" >\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      class=\"feather feather-plus-square\"\r\n    >\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\r\n      <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line>\r\n      <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line>\r\n    </svg>\r\n  </template>\r\n\r\n  <template v-else>\r\n    close\r\n  </template>\r\n                               </button>\r\n\r\n                            </th>\r\n                           </tr>\r\n                       </thead>\r\n                       <tbody>\r\n                           <tr v-for=\"(desc,j)  in item.descriptions\"\r\n                           @click=\"fillEdits(desc,item.id)\"\r\n                             \r\n                           >\r\n                               <td> {{ j + 1  }}</td>\r\n                               <td> {{ desc.name  }}\r\n                                <br/>\r\n                                <span\r\n                                @click=\"getBudgetEdits(desc.id),no_edit=true\"\r\n                                data-bs-toggle=\"modal\" data-bs-target=\"#edits\"\r\n                                style=\"cursor: pointer;\" class=\"badge badge-danger\" title=\"Click to view edit history\" v-if=\"desc.last_editor\">Edited By {{ desc.last_editor }}\r\n                              </span>\r\n                               </td>\r\n                               <td> {{ desc.specification  }}</td>\r\n                               <td> {{ desc.units  }}</td>\r\n                               <td> {{ desc.quantity  }}</td>\r\n                               <td> {{ desc.quantity_2  }}</td>\r\n                               <td> {{ formatNumber(desc.cost)  }}</td>\r\n                               <td> \r\n                                Budgeted : {{ formatNumber(desc.cost * desc.quantity * desc.quantity_2) }}\r\n                                <br/>\r\n                                Used Cost  : {{ formatNumber(desc.used_cost) }}<br>\r\n                                Used Qty : {{ (desc.used_cost/desc.cost).toFixed(2) }}\r\n                                <hr style=\"border-top: 1px solid red\"/>\r\n                                Balance Budget : {{ formatNumber((desc.cost * desc.quantity * desc.quantity_2) - desc.used_cost) }}<br>\r\n                                Balance Qty :   {{ (((desc.cost * desc.quantity * desc.quantity_2) - desc.used_cost)/desc.cost).toFixed(2) }}\r\n                              </td>\r\n                               <td>\r\n                                         <svg \r\n                                     xmlns=\"http://www.w3.org/2000/svg\" \r\n                                     width=\"28\" height=\"28\" \r\n                                     fill=\"currentColor\"\r\n                                      class=\"bi bi-eye text-secondary\" \r\n                                      viewBox=\"0 0 16 16\"\r\n                                      @click=\"getBudgetConsuption(desc),no_edit=true\"\r\n                                       data-bs-toggle=\"modal\" data-bs-target=\"#consuptions\"\r\n                                      >\r\n                                      <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z\"/>\r\n                                      <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0\"/>\r\n            </svg>\r\n                               </td>\r\n                           </tr>\r\n                       </tbody>\r\n                </table>\r\n                              <!-- item description form starts -->\r\n                <form \r\n                @submit.prevent=\"addDescription(item.id)\"\r\n                v-if=\"add_description === item.id \" >\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Item </label>\r\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Enter Item\" v-model=\"description\" required>\r\n                        </div>\r\n                        <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Specification </label>\r\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Enter Specification\" v-model=\"specification\">\r\n                        </div>\r\n                         <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Unit</label>\r\n                             <Multiselect\r\n        v-model=\"unit\"\r\n        :options=\"units\"\r\n        label=\"short_name\"\r\n        track-by=\"id\"\r\n        placeholder=\"Select Unit\"\r\n        :searchable=\"true\"        \r\n        :append-to-body=\"true\"\r\n    />\r\n                    \r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Quantity</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 1\" v-model=\"quantity\" step=\"any\" required>\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">quantity_2</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 2\" v-model=\"quantity_2\" step=\"any\" required>\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Rate</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Rate\" v-model=\"rate\" step=\"any\" required>\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Cost</label>\r\n                            <label class=\"form-control\">{{ Number(quantity * quantity_2 * rate).toLocaleString() }}/=</label>\r\n                        </div>\r\n                        \r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Save</label>\r\n                      \r\n                         \r\n                          <div class=\"btn-group\" role=\"group\">\r\n  <button type=\"submit\" class=\"btn btn-primary me-1\" :disabled=\"loading\">\r\n    <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n    <span v-else> Submit </span>\r\n  </button>\r\n\r\n  <button type=\"button\" class=\"btn btn-danger \" @click=\"add_description = false\">\r\n    Cancel\r\n  </button>\r\n</div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n               <!-- item description form ends -->\r\n\r\n               \r\n                <!-- item description form editing starts -->\r\n                                 <form \r\n                @submit.prevent=\"updateDescription(description_id)\"\r\n                v-if=\"edit_description === item.id && budget.status ==='open'\" >\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Item </label>\r\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Enter Item\" v-model=\"description\">\r\n                        </div>\r\n                        <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Specification </label>\r\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Enter Specification\" v-model=\"specification\">\r\n                        </div>\r\n                         <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Unit</label>\r\n                             <Multiselect\r\n        v-model=\"unit\"\r\n        :options=\"units\"\r\n        label=\"short_name\"\r\n        track-by=\"id\"\r\n        placeholder=\"Select Unit\"\r\n        :searchable=\"true\"        \r\n        :append-to-body=\"true\"\r\n    />\r\n                    \r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Quantity</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 1\" v-model=\"quantity\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Quantity_2</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 2\" v-model=\"quantity_2\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Rate</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Rate\" v-model=\"rate\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Cost</label>\r\n                            <label class=\"form-control\">{{ Number(quantity * quantity_2 * rate).toLocaleString() }}/=</label>\r\n                        </div>\r\n                          <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Save</label>\r\n                      \r\n                         \r\n                          <div class=\"btn-group\" role=\"group\">\r\n  <button type=\"submit\" class=\"btn btn-primary me-1\" :disabled=\"loading\">\r\n    <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n    <span v-else>Update</span>\r\n  </button>\r\n\r\n  <button type=\"button\" class=\"btn btn-danger \" @click=\"clearForm()\">\r\n    Cancel\r\n  </button>\r\n</div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n           \r\n                 <!-- item description form editing ends -->\r\n                  \r\n            </td>\r\n        </tr>\r\n    </tbody>\r\n    <tfoot>\r\n    \r\n    <tr>\r\n        <td colspan=\"2\" class=\"text-start fw-bold\">\r\n            SUMMARY \r\n        </td>\r\n        <td>\r\n              <table class=\"table table-bordered table-responsive table-striped\">\r\n                        <thead>\r\n                            <tr >\r\n                                <th class=\"text-dark fw-bold\">ALLOCATED AMOUNT</th>\r\n                                <th class=\"text-success\">ALLOCATED BALANCE</th>\r\n                                 <th class=\"text-danger\">UNALLOCATED AMOUNT</th>\r\n                                 <th class=\"text-dark\">BUDGET COST</th> \r\n                                 <th class=\"text-dark\">USED COST</th> \r\n                            </tr>\r\n                            <tr>\r\n                               <td>{{ formatNumber(budget.funded_amount) }}</td>\r\n                               <td>{{ formatNumber(budget.funded_amount - budget.total_used_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.funded_amount - budget.total_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.total_cost) }}</td>\r\n                               <td>{{ formatNumber(budget.total_used_cost) }}</td>\r\n                              </tr>\r\n                        </thead>\r\n    </table> \r\n        </td>\r\n     \r\n\r\n    </tr>\r\n  \r\n</tfoot>\r\n</table>\r\n</div>\r\n</div>\r\n        </div>\r\n       \r\n    </div>\r\n<!-- budget Remarks starts -->\r\n<div class=\"modal fade mymodal \" id=\"consuptions\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog  modal-fullscreen modal-dialog-scrollable\"> <!-- Add scrollable class -->\r\n    <div class=\"modal-content\" >\r\n      \r\n      <!-- Fixed Header -->\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Budget Consumption Remarks</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"\r\n        @click=\"clearForm()\"\r\n        ></button>\r\n      </div>\r\n\r\n      <!-- Scrollable Body -->\r\n      <div class=\"modal-body flex-grow-1 overflow-auto\">\r\n\r\n                <table class=\"table table-bordered table-responsive mb-3\">\r\n          <thead>\r\n            <tr>\r\n              <th colspan=\"8\" class=\"bg-light text-center text-dark fs-6\">Budget Details</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <th>Project:</th>\r\n              <td>{{ project?.short_name }}</td>\r\n              <th>Budget Name:</th>\r\n              <td>{{ budget.name }}</td>\r\n               <th>Budget Item:</th>\r\n              <td>{{ budgetItem.name}}</td>\r\n              <th>Description:</th>\r\n              <td>{{ fetchedItem.name}}</td>\r\n            </tr>\r\n           \r\n            <tr>\r\n              <th>Allocated Amount:</th>\r\n              <td>{{ formatNumber(budget.funded_amount) }} Tsh</td>\r\n              <th>Budget Cost:</th>\r\n              <td>{{ formatNumber(budget.total_cost) }} Tsh</td>\r\n              <th>Used Cost:</th>\r\n              <td>{{ formatNumber(budget.total_used_cost) }} Tsh</td>\r\n              <th>Balance:</th>\r\n              <td>{{ formatNumber(budget.funded_amount - budget.total_used_cost) }} Tsh</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <!-- add remark form starts -->\r\n<div class=\"d-flex\" v-if=\"!add_remark && user_permissions.includes('can_add_budget_consumption')\" >\r\n            <router-link to=\"/approval-chains/1\" class=\"btn btn-dark btn-sm \" >\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-arrow-left-circle\" viewBox=\"0 0 16 16\">\r\n  <path fill-rule=\"evenodd\" d=\"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z\"/>\r\n</svg>\r\n         &nbsp; Back </router-link>\r\n  <div class=\"ms-auto\">\r\n        <button class=\"btn btn-primary btn-sm \" @click=\"add_remark=! add_remark\"> Add Remark</button>\r\n    </div>\r\n</div>\r\n  <form\r\n  v-if=\"add_remark\"\r\n  @submit.prevent=\"addBudgetRemark()\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-2\">\r\n        <input\r\n          v-model=\"description_cost\"\r\n          class=\"form-control mb-2\"\r\n          type=\"number\"\r\n          placeholder=\"Enter cost spent\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n       <div class=\"col-md-8\">\r\n        <input\r\n          v-model=\"approval_id\"\r\n          class=\"form-control mb-2\"\r\n          type=\"number\"\r\n          placeholder=\"Enter LPO number\"\r\n          required\r\n        />\r\n      </div>\r\n      <div class=\"col-md-2\">\r\n  <div class=\"btn-group w-100\" role=\"group\">\r\n    <button type=\"button\" class=\"btn btn-danger me-1\" @click=\"clearForm()\">Close</button>\r\n    <button type=\"submit\" class=\"btn btn-primary\"\r\n    :disabled=\"loading\"\r\n    >\r\n    <span\r\n    v-if=\"loading\" v-html=\"loadingSpinner()\"\r\n    ></span>\r\n    <span\r\n    v-else\r\n    >Save</span>\r\n        \r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n\r\n    </div>\r\n\r\n  </form>\r\n\r\n\r\n         <!-- add remark form ends -->\r\n        <div class=\"row layout-top-spacing\">\r\n          <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\"\r\n          >\r\n                      <div\r\n            v-if=\"loading\" v-html=\"tableShimmer()\"\r\n            ></div>\r\n            <div\r\n             v-else            \r\n            class=\"panel p-0\" >\r\n              <div class=\"custom-table table3\"   style=\"max-height: 95vh; overflow-y: auto;\">\r\n                <v-client-table :data=\"consuptions\" :columns=\"consuptionColumns\" >\r\n                   <template #actions=\"props\">                        \r\n                             <svg xmlns=\"http://www.w3.org/2000/svg\"\r\n                              v-if=\"user_permissions.includes('can_delete_budget_description_remark')\" \r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBudgetRemark(props.row,budget_description)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n                                <router-link :to=\"`/approval/${props.row.approval_id}`\">\r\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-arrow-right\" style=\"cursor: pointer;\" viewBox=\"0 0 16 16\">\r\n  <path fill-rule=\"evenodd\" d=\"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8\"/>\r\n</svg>\r\n                                </router-link>\r\n\r\n                        </template>\r\n                </v-client-table>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Fixed Footer -->\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"clearForm()\">Close</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n <!-- budget remarks ends -->\r\n  <!--budget edits modal starts  -->\r\n  <div class=\"modal fade mymodal \" id=\"edits\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog  modal-xl modal-dialog-scrollable\"> <!-- Add scrollable class -->\r\n    <div class=\"modal-content\" >\r\n      \r\n      <!-- Fixed Header -->\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Budget Item Editing Record</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"\r\n        @click=\"clearForm()\"\r\n        ></button>\r\n      </div>\r\n\r\n      <!-- Scrollable Body -->\r\n      <div class=\"modal-body flex-grow-1 overflow-auto\">\r\n         <!-- add remark form ends -->\r\n        <div class=\"row layout-top-spacing\">\r\n          <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\"\r\n          >\r\n                      <div\r\n            v-if=\"loading\" v-html=\"tableShimmer()\"\r\n            ></div>\r\n            <div\r\n             v-else            \r\n            class=\"panel p-0\" >\r\n              <div class=\"custom-table table3\" >\r\n                <v-client-table :data=\"budgetEdits\" :columns=\"budgetEditColumns\" >\r\n                </v-client-table>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Fixed Footer -->\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"clearForm()\">Close</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n  <!-- budget edits modal ends -->\r\n\r\n\r\n  \r\n              <!-- budget edit modal starts -->\r\n              \r\n                                 <div class=\"modal fade mymodal\" id=\"edit\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\" >\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">{{ budget_description.name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close\" ></button>\r\n      </div>\r\n<div class=\"modal-body\" >\r\n              <form \r\n                @submit.prevent=\"updateDescription(description_id)\"\r\n                 >\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-12\">\r\n                            <label class=\"form-label\">Enter Any Remark </label>\r\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Enter Remark\" v-model=\"remark\">\r\n                        </div>\r\n\r\n                         <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Quantity</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 1\" v-model=\"quantity\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-2\">\r\n                            <label class=\"form-label\">Quantity_2</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Qty 2\" v-model=\"quantity_2\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-3\">\r\n                            <label class=\"form-label\">Rate</label>\r\n                            <input type=\"number\" class=\"form-control\" placeholder=\"Rate\" v-model=\"rate\" step=\"any\">\r\n                        </div>\r\n                         <div class=\"col-md-3\">\r\n                            <label class=\"form-label\">Cost</label>\r\n                            <label class=\"form-control\">{{ Number(quantity * quantity_2 * rate).toLocaleString() }}/=</label>\r\n                        </div>\r\n                          <div class=\"col-md-1\">\r\n                            <label class=\"form-label\">Save</label>\r\n                      \r\n                         \r\n                          <div class=\"btn-group\" role=\"group\">\r\n  <button type=\"submit\" class=\"btn btn-primary me-1\" :disabled=\"loading\">\r\n    <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n    <span v-else>Update</span>\r\n  </button>\r\n\r\n  <button type=\"button\" class=\"btn btn-danger \" @click=\"clearForm()\">\r\n    Cancel\r\n  </button>\r\n</div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger btn-sm py-2 px-2\" data-bs-dismiss=\"modal\">Close</button>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<button data-bs-toggle=\"modal\" data-bs-target=\"#edit\" style=\"display: none;\" id=\"edit_button\"></button>\r\n               <!-- budget edit modal ends -->\r\n\r\n    </div>\r\n</template>\r\n\r\n\r\n<script setup>\r\n    import axios from 'axios';    \r\n    import { onMounted, ref,inject,watch, computed } from 'vue';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    import '@/assets/sass/elements/tooltip.scss';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import { useRoute } from 'vue-router';\r\n    const route = useRoute();\r\n\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    useMeta({ title:'Budgets '});\r\n    const project = ref('');\r\n    const newBudget= ref(false)\r\n    const showError = inject('showError');\r\n    const formatNumber = inject('formatNumber');\r\n    const showMessage = inject('showMessage');\r\n    const pillShimmer = inject('pillShimmer')\r\n    const tableShimmer = inject('tableShimmer')\r\n    const loadingSpinner = inject('loadingSpinner')\r\n             const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n    const add_amendment_item = ref(true)\r\n    const budgets = ref([])\r\n    const budget = ref('')\r\n    const budgets_loading = ref(false)\r\n    const add_item = ref(false)\r\n    const add_description = ref('')\r\n    const edit_description = ref('')\r\n    const amend_description = ref('')\r\n    const items = ref([]);\r\n    \r\n    \r\n    // Watcher for automatic budget consumption modal\r\nconst routeParams = computed(() => {\r\n  return {\r\n    budget_item_description_id: route.params.budget_item_description_id ? parseInt(route.params.budget_item_description_id) : null\r\n  };\r\n});\r\n\r\nwatch([routeParams, budgets], ([params, budgetsList]) => {\r\n  if (params.budget_item_description_id && budgetsList && budgetsList.length > 0) {\r\n    // Find the budget that contains the description\r\n    const foundBudget = budgetsList.find(budget => \r\n      budget.items?.some(item => \r\n        item.descriptions?.some(desc => desc.id === params.budget_item_description_id)\r\n      )\r\n    );\r\n    \r\n    if (foundBudget) {\r\n      // Fill the budget first\r\n      fillBudget(foundBudget);\r\n      \r\n      // Then find and trigger the consumption view\r\n      const targetDescription = foundBudget.items?.flatMap(item => item.descriptions || [])\r\n        .find(desc => desc.id === params.budget_item_description_id);\r\n      \r\n      if (targetDescription) {\r\n        getBudgetConsuption(targetDescription);\r\n        \r\n        // Programmatically open the modal with proper event handling\r\n        const modalElement = document.getElementById('consuptions');\r\n        const modal = new bootstrap.Modal(modalElement);\r\n        \r\n        // Add event listener to properly clean up when modal is hidden\r\n        modalElement.addEventListener('hidden.bs.modal', function() {\r\n          // Force cleanup of backdrop\r\n          const backdrops = document.querySelectorAll('.modal-backdrop');\r\n          backdrops.forEach(backdrop => {\r\n            backdrop.remove();\r\n          });\r\n          \r\n          // Restore body scrolling\r\n          document.body.classList.remove('modal-open');\r\n          document.body.style.overflow = 'auto';\r\n          document.body.style.paddingRight = '';\r\n        });\r\n        \r\n        modal.show();\r\n      }\r\n    }\r\n  }\r\n}, { immediate: true });\r\n\r\n    \r\nconst budgetEdits = ref([])\r\nconst budgetEditColumns = ['Sno','editor','remark','quantity','quantity_2','rate','cost']\r\nconst getBudgetEdits = async (id)=>{\r\n  loading.value = true\r\n  const response = await axiosInstance.get(`budget-edit-logs?description_id=${id}`)\r\n  budgetEdits.value = response.data.map((item,index)=>({\r\n    ...item,\r\n    Sno : index +1,\r\n    editor:item.editor.name,\r\n    quantity: item.from_quantity + '' + item.to_quantity,\r\n    quantity_2: item.from_quantity_2 + '' + item.to_quantity_2,\r\n    rate : formatNumber(item.from_rate) + '  ' + formatNumber(item.to_rate),\r\n    cost : formatNumber(item.from_quantity * item.from_quantity_2 * item.from_rate) + '  ' + formatNumber(item.to_quantity * item.to_quantity_2 * item.to_rate)\r\n  }))\r\n  loading.value = false\r\n}\r\n\r\n\r\n  \r\n\r\nconst amendDescription = async (id) => {\r\n  loading.value = true;\r\n  edit_description.value = amend_description.value\r\n  const payload = {\r\n    budget_item_description_id: id,\r\n    from_quantity: budget_description.value.quantity,\r\n    to_quantity: quantity.value,\r\n    from_quantity_2: budget_description.value.quantity_2,\r\n    to_quantity_2: quantity_2.value,\r\n    from_rate: budget_description.value.cost,\r\n    to_rate: rate.value,\r\n    remark: remark.value,\r\n    editor_id: JSON.parse(localStorage.getItem(\"user\")).id\r\n  };\r\n\r\n  try {\r\n    await axiosInstance.post('budget-edit-logs', payload);\r\n    const user = JSON.parse(localStorage.getItem(\"user\"));\r\n    const item = budget.value.items.find(i => i.descriptions.some(d => d.id === id));\r\n    if (item) {\r\n      const desc = item.descriptions.find(d => d.id === id);\r\n      if (desc) {\r\n        desc.last_editor =  user.name ;\r\n      }\r\n    }\r\n\r\n    clearForm();\r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.log(error);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n\r\nconst add_fund = ref(false)\r\nconst fund = ref('')\r\nconst addFund = async() =>{\r\n  loading.value = true\r\n  const payload = {\r\n    funded_amount: budget.value.funded_amount + fund.value\r\n  }\r\n  try{\r\n  const response = await axiosInstance.put(`budgets/${budget.value.id}`,payload)\r\n  showMessage('Fund added successfully')\r\n  budget.value.funded_amount = budget.value.funded_amount + fund.value\r\n  fund.value = ''\r\n  }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n  }finally{\r\n    loading.value= false\r\n    add_fund.value = false\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n    const approval_id = ref('')\r\n    const remark = ref('')\r\n    const description_cost = ref('')\r\n    const add_remark = ref(false)\r\n\r\nconst addBudgetRemark = async () => {\r\n  loading.value = true\r\n  try {\r\n    const payload = {   \r\n      date: new Date().toISOString().split('T')[0],\r\n      remarker_id: JSON.parse(localStorage.getItem(\"user\")).id,\r\n      approval_id: approval_id.value,\r\n      description: remark.value + 'This was created from LPO No: ' + approval_id.value,\r\n\r\n      // remarker: JSON.parse(localStorage.getItem(\"user\")).name,\r\n      budget_item_description_id: description_id.value,\r\n      cost: description_cost.value,          \r\n    }\r\n\r\n\r\n    const response = await axiosInstance.post(`budget-remarks`, payload);\r\n\r\n    // push new remark locally\r\n    const newRemark = response.data\r\n    let currentBalance = parseFloat(budget_description.value.quantity * budget_description.value.quantity_2 * budget_description.value.cost)\r\n\r\n    // update used_cost\r\n    budget_description.value.used_cost = (parseFloat(budget_description.value.used_cost || 0) + parseFloat(newRemark.cost)).toFixed(2)\r\n    budget.value.total_used_cost = budget.value.total_used_cost + newRemark.cost \r\n\r\n    consuptions.value = [...consuptions.value, {\r\n      sno: consuptions.value.length + 1,\r\n      id: newRemark.id,\r\n      approved_by: JSON.parse(localStorage.getItem(\"user\")).name,\r\n      date: newRemark.date,\r\n      debit: newRemark.cost > 0 ? Number(newRemark.cost).toLocaleString() + \" Tsh\" : \"--\",\r\n      credit: newRemark.cost < 0 ? Number(Math.abs(newRemark.cost)).toLocaleString() + \" Tsh\" : \"--\",\r\n      description: newRemark.description,\r\n      balance: 0 // will recalc below\r\n    }]\r\n\r\n    // recalculate balance for all\r\n    consuptions.value = consuptions.value.map((c, i) => {\r\n      currentBalance -= parseFloat(c.debit.replace(/[^0-9.-]+/g,\"\")) || 0\r\n      return { ...c, sno: i + 1, balance: currentBalance.toLocaleString() + \" Tsh\" }\r\n    })\r\n\r\n    getBudgetConsuption(budget_description.value);\r\n\r\n    showMessage(\"Remark added successfully\");\r\n    remark.value = \"\"; \r\n    description_cost.value = \"\";\r\n    approval_id.value = \"\";\r\n    add_remark.value = ''\r\n\r\n  } catch (error) {\r\n    showError(error.message);\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n\r\n\r\nconst deleteBudgetRemark = async (item, desc) => {\r\n  if (confirm('Are you sure you want to delete ' + item.description + ' with cost ' + item.debit)) {\r\n    loading.value = true\r\n    try {\r\n      await axiosInstance.delete(`budget-remarks/${item.id}`)\r\n      const itemCost = parseFloat(item.debit.replace(/[^0-9.-]+/g,\"\")) || 0\r\n      desc.used_cost = (parseFloat(desc.used_cost) - itemCost).toFixed(2)\r\n      budget.value.total_used_cost = (parseFloat(budget.value.total_used_cost) - itemCost).toFixed(2)\r\n      consuptions.value = consuptions.value.filter(c => c.id !== item.id)\r\n      let currentBalance = parseFloat(desc.quantity * desc.quantity_2 * desc.cost)\r\n      consuptions.value = consuptions.value.map((c, i) => {\r\n        currentBalance -= parseFloat(c.debit.replace(/[^0-9.-]+/g,\"\")) || 0\r\n        return { ...c, sno: i + 1, balance: currentBalance.toLocaleString() + \" Tsh\" }\r\n      })\r\n\r\n      showMessage('Deleted successfully')\r\n    } catch (error) {\r\n      showError(error.message)\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n   const consuptions = ref([])\r\n   const consuptionColumns = [ 'sno','approved_by','date' ,'description','debit','credit','balance','actions'];\r\n   const balance = ref(0)\r\nconst getBudgetConsuption = async (desc) => {\r\n  \r\n  consuptions.value = [];\r\n  loading.value = true;\r\n\r\n  // initialize balance from desc.cost\r\n  balance.value = parseFloat(desc.quantity * desc.quantity_2 * desc.cost);\r\n\r\n  const response = await axiosInstance.get(\r\n    `budget-remarks?budget_item_description_id=${desc.id}`\r\n  );\r\n\r\n  consuptions.value = response.data.map((data, i) => {\r\n    balance.value -= parseFloat(data.cost);\r\n    return {\r\n      ...data,\r\n      sno: i + 1,\r\n      id: data.id,\r\n      approved_by: data.remarker.name,\r\n      date: data.date,\r\n      debit: data.cost > 0 ? Number(data.cost).toLocaleString() + \" Tsh\" : \"--\",\r\n      credit:\r\n        data.cost < 0\r\n          ? Number(Math.abs(data.cost)).toLocaleString() + \" Tsh\"\r\n          : \"--\",\r\n      description: data.description,\r\n      balance: balance.value.toLocaleString() + \" Tsh\",\r\n    };\r\n  });\r\n\r\n  loading.value = false;\r\n};\r\n\r\n\r\n\r\n   const description_id = ref('')\r\n   const budget_description = ref('')\r\n   const budget_description_clicks = ref(0)\r\n   const no_edit = ref(false)\r\n   const fillEdits = (item,id) =>{\r\n    budget_description.value = item\r\n    description_id.value = item.id\r\n    if(budget.value.status === 'closed'){\r\n       if(user_permissions.includes('can_open_budget') && no_edit.value == false){\r\n         amend_description.value = id\r\n         document.getElementById('edit_button').click()\r\n       }else{\r\n        budget_description_clicks.value += 1\r\n        if(budget_description_clicks.value >3){\r\n          showError('Budget Closed')\r\n          budget_description_clicks.value = 0\r\n        }\r\n        return ;\r\n       }\r\n    }else{\r\n     edit_description.value = id\r\n    }\r\n      description.value = item.name\r\n      specification.value = item.specification || ''\r\n     quantity.value = item.quantity\r\n     quantity_2.value = item.quantity_2\r\n     rate.value = item.cost\r\n     unit.value = units.value.find(u => u.short_name === item.units);\r\n   }\r\n\r\nconst updateDescription = async (id) => {\r\n  remark.value = description.value\r\n  loading.value = true;\r\n  if (!unit.value && !amend_description.value) {\r\n    showError(\"Please fill all items\");\r\n    loading.value = false;\r\n    return;\r\n  }\r\n\r\n  const payload = {\r\n    id,\r\n    name: description.value,\r\n    specification: specification.value,\r\n    quantity: quantity.value ?? 0,\r\n    quantity_2: quantity_2.value ?? 0,\r\n    ...(unit.value?.short_name && { units: unit.value.short_name }),\r\n    cost: rate.value ?? 0,\r\n  };\r\n\r\n  try {\r\n    await axiosInstance.put(`budget-item-descriptions/${id}`, payload);\r\n    showMessage(\"Updated Successfully\");\r\n    if(budget.value.status === 'closed' ){\r\n      edit_description.value = amend_description.value\r\n    }\r\n    const targetItem = items.value.find(i => i.id === edit_description.value);\r\n    if (targetItem && targetItem.descriptions) {\r\n      const index = targetItem.descriptions.findIndex(d => d.id === id);\r\n      if (index !== -1) {\r\n        targetItem.descriptions[index] = { ...targetItem.descriptions[index], ...payload };\r\n      }\r\n    }\r\n    amendDescription(id)\r\n    clearForm();\r\n    // getBudgets();\r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.log(error);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n\r\n    const units = ref('')\r\n    const getUnits = async ()=>{\r\n      const response = await axiosInstance.get('units')\r\n      units.value = response.data\r\n    }\r\n    const description = ref('')\r\n    const specification = ref('')\r\n    const quantity = ref('')\r\n    const quantity_2 = ref('')\r\n    const unit = ref('')\r\n    const rate = ref('')\r\n    const cost = ref(0)\r\nconst addDescription = async (id) => {\r\n  if(!unit.value){\r\n    showError(\"please enter unit\")\r\n    return ;\r\n  }\r\n    loading.value = true\r\n    const payload = {\r\n        budget_item_id : add_description.value,\r\n        name: description.value,\r\n        specification: specification.value,\r\n        quantity: quantity.value ?? 0,\r\n        quantity_2: quantity_2.value ?? 0,\r\n        units: unit.value.short_name,\r\n        cost : rate.value ?? 0,\r\n    };\r\n    \r\n\r\n    try {\r\n        const response = await axiosInstance.post('budget-item-descriptions', payload);\r\n        showMessage(\"Description added successfully\");\r\n        const targetItem = items.value.find(i => i.id === add_description.value);\r\n        if (targetItem) {\r\n            targetItem.descriptions = targetItem.descriptions || [];\r\n            targetItem.descriptions.push(payload);\r\n        }\r\n\r\n        clearForm();\r\n        getBudgets()\r\n    } catch (error) {\r\n        showError(error.message);\r\n        console.log(error);\r\n    }finally{\r\n        loading.value = false\r\n    }\r\n};\r\n\r\n\r\n\r\n    const item_name = ref('')\r\n    const addItem = async () =>{\r\n        loading.value = true\r\n        const payload = {\r\n            budget_id: budget.value.id,\r\n            name : item_name.value,\r\n        }\r\n        try {\r\n            const response = await axiosInstance.post('budget-items',payload)\r\n            showMessage(\"Item Added successfully\")\r\n             items.value.push(response.data)\r\n            getBudgets()\r\n            item_name.value = ''\r\n            add_item.value = false\r\n        }catch(error){\r\n            showError(error.message)\r\n           console.log(error)\r\n        }finally{\r\n            loading.value = false\r\n        }\r\n    }\r\n\r\n    const deleteBudget = async (data) =>{\r\n        // Find approval status for this budget\r\n        const approval = budgetApprovals.value.find(app => app.budget_id === data.id);\r\n        \r\n        // Only allow deletion if status is rejected or unapproved\r\n        if (approval && (approval.status?.name === 'Rejected' || approval.status?.name === 'Unapproved')) {\r\n            if(confirm (\"are you sure you want to delete budget \" + data.name)){\r\n                try{ \r\n                    budgets_loading.value = true\r\n                    await axiosInstance.delete(`budgets/${data.id}`)\r\n                    showMessage('Budget Deleted')\r\n                    getBudgets()\r\n                }catch(error){\r\n                    showError(error.message)\r\n                    console.log(error)\r\n                }\r\n            }\r\n        } else {\r\n            showError('Can only delete rejected or unapproved budgets')\r\n        }\r\n    } \r\n\r\n    const clearForm = ()=>{\r\n        budget_name.value = ''\r\n        approval_id.value = ''\r\n        newBudget.value=false\r\n        item_name.value = ''\r\n        add_item.value = false\r\n        description.value = ''\r\n        quantity.value = ''\r\n        quantity_2.value = ''\r\n        unit.value = ''\r\n        rate.value = ''\r\n        cost.value = ''\r\n        add_description.value = ''\r\n        description_id.value = ''\r\n        edit_description.value = ''\r\n        description_cost.value = '',\r\n        remark.value = '',\r\n        add_remark.value = ''\r\n        amend_description.value = ''\r\n        remark.value = ''\r\n        specification.value = ''\r\n        no_edit.value = false\r\n    }\r\n    const budget_name = ref('')\r\n    const loading = ref(false)\r\n\r\n\r\n\r\nconst showBudgetStatusCard = ref(false);\r\nconst budgetStatusCardType = ref('danger'); \r\nconst budgetStatusCardTitle = ref('');\r\nconst budgetStatusCardMessage = ref('');\r\nconst budgetStatusRemarks = ref('');\r\n\r\n\r\n\r\nconst fillBudget = (data) => {\r\n  if (budget.value && budget.value.id === data.id) {\r\n    \r\n    budget.value = '';\r\n    items.value = [];\r\n    showBudgetStatusCard.value = false;\r\n    return;\r\n  }\r\n  \r\n  const approval = budgetApprovals.value.find(app => app.budget_id === route.params.budget_id);\r\n  \r\n  if (approval) {\r\n    if (approval.status?.name === 'approved') {\r\n      budget.value = data;\r\n      items.value = data.items;\r\n      showBudgetStatusCard.value = false;\r\n      console.log('Budget data loaded successfully');\r\n    } else if (approval.status?.name === 'Unapproved') {\r\n      showBudgetStatusCard.value = true;\r\n      budgetStatusCardType.value = 'warning';\r\n      budgetStatusCardTitle.value = 'Budget Unapproved';\r\n      budgetStatusCardMessage.value = 'This budget is pending approval and cannot be accessed yet.';\r\n      budgetStatusRemarks.value = approval.remark || 'No remarks provided.';\r\n      \r\n      budget.value = data;\r\n      items.value = [];\r\n    } else if (approval.status?.name === 'Rejected') {\r\n      showBudgetStatusCard.value = true;\r\n      budgetStatusCardType.value = 'danger';\r\n      budgetStatusCardTitle.value = 'Budget Rejected';\r\n      budgetStatusCardMessage.value = 'This budget has been rejected and cannot be accessed.';\r\n      budgetStatusRemarks.value = approval.remark || 'No rejection remarks provided.';\r\n      \r\n     \r\n      budget.value = data;\r\n      items.value = [];\r\n    }\r\n  } else {\r\n    \r\n     budget.value = data;\r\n      items.value = data.items;\r\n    showBudgetStatusCard.value = false;\r\n  }\r\n}\r\n\r\n \r\nconst budgetApprovals = ref([]);\r\n\r\n\r\n\r\n// Add these refs to store the IDs\r\nconst currentBudgetId = ref(null);\r\nconst currentProjectId = ref(null);\r\nconst budgetItem = ref('')\r\nconst fetchedItem = ref('')\r\nconst getBudgetDetails = async () => {\r\n  budgets_loading.value = true;\r\n    try {\r\n        const response = await axiosInstance.get(`budget-item-descriptions/${route.params.budget_item_description_id}`);\r\n        const item = response.data;\r\n        fetchedItem.value = response.data\r\n        // Extract and store the IDs from the response\r\n        currentBudgetId.value = item.budget_item.budget.id;\r\n        currentProjectId.value = item.budget_item.budget.project_id;\r\n        project.value = item.budget_item.budget.project\r\n        budgetItem.value = item.budget_item\r\n        return item;\r\n    } catch (error) {\r\n        showError(error.message);\r\n        console.log(error);\r\n        return null;\r\n    }\r\n    finally {\r\n        budgets_loading.value = false;\r\n    }\r\n};\r\n\r\nconst getBudgets = async () => {\r\n    budgets_loading.value = true;\r\n\r\n    try {\r\n        // Ensure we have the IDs from getBudgetDetails\r\n        if (!currentBudgetId.value || !currentProjectId.value) {\r\n            await getBudgetDetails();\r\n        }\r\n\r\n        // Use the stored IDs\r\n        const response = await axiosInstance.get(`budgets?project_id=${currentProjectId.value}&budget_id=${currentBudgetId.value}`);\r\n        budgets.value = response.data;\r\n        \r\n        console.log('Budgets fetched with:', {\r\n            project_id: currentProjectId.value,\r\n            budget_id: currentBudgetId.value,\r\n            budgets_count: budgets.value.length\r\n        });\r\n        \r\n    } catch (error) {\r\n        showError(error.message);\r\n        console.log(error);\r\n    } finally {\r\n        budgets_loading.value = false;\r\n    }\r\n};\r\n\r\n\r\n    watch(project, (newVal) => {\r\n        if (newVal && newVal.id) {\r\n            budget.value = ''\r\n            getBudgets();\r\n        }\r\n    });\r\n\r\n    \r\n\r\n     watch(budget, (newVal) => {\r\n        if (newVal ) {\r\n            items.value = newVal.items;  \r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\n       const closeModal = ()=>{\r\n        const modalEl = document.querySelector('.modal.show');\r\n  if (modalEl) {\r\n    const modalInstance = bootstrap.Modal.getInstance(modalEl);\r\n    modalInstance?.hide();\r\n  }\r\n  document.body.classList.remove('modal-open');\r\n  document.body.style.overflow = 'auto';\r\n  document.body.style.paddingRight = '';\r\n    }\r\n\r\n onMounted(async () => { \r\n    try {\r\n        // First get the budget details to extract IDs\r\n        await getBudgetDetails();\r\n        \r\n        // Then get budgets using those IDs\r\n        await getBudgets();\r\n        \r\n        getUnits();\r\n        closeModal();\r\n    } catch (error) {\r\n        console.error('Error in onMounted:', error);\r\n        showError('Failed to load budget data');\r\n    }\r\n});\r\n\r\n\r\n\r\n// Watcher for automatic budget selection\r\nwatch([currentBudgetId, budgets], ([budgetId, budgetsList]) => {\r\n    if (budgetId && budgetsList && budgetsList.length > 0) {\r\n        const foundBudget = budgetsList.find(budget => budget.id === budgetId);\r\n        if (foundBudget && (!budget.value || budget.value.id !== budgetId)) {\r\n            console.log('Auto-selecting budget:', foundBudget.name);\r\n            fillBudget(foundBudget);\r\n        }\r\n    }\r\n}, { immediate: false });\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst printReport = async () => {\r\n  if (!budget.value) {\r\n    showError(\"Please select a budget first\");\r\n    return;\r\n  }\r\n\r\n  const iframe = document.createElement(\"iframe\");\r\n  iframe.style.display = \"none\";\r\n  document.body.appendChild(iframe);\r\n\r\n  const currentDate = new Date().toLocaleDateString();\r\n\r\n  // Budget summary calculations\r\n  const allocatedAmount = budget.value.funded_amount || 0;\r\n  const totalBudgeted = budget.value.total_cost || 0;\r\n  const totalUsed = budget.value.total_used_cost || 0;\r\n  const totalBalance = totalBudgeted - totalUsed;\r\n  const unallocatedAmount = allocatedAmount - totalBudgeted;\r\n\r\n  const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Budget Report - ${budget.value.name}</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 14px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }\r\n  .logo { width: 160px; height: auto; }\r\n  .report-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 14px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; flex-grow: 1; }\r\n  .company-title h2 { margin: 5px 0; font-size: 18px; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 12px; line-height: 1.4; font-weight: normal; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 15px 0 8px 0; font-size: 16px; }\r\n  .budget-info table { width: 100%; border-collapse: collapse; margin-bottom: 12px; border: 1px solid #666; }\r\n  .budget-info th, .budget-info td { padding: 6px; border: 1px solid #666; font-size: 13px; text-align: center; }\r\n  .budget-info th { background-color: #f5f5f5; }\r\n  .items-table { width: 100%; border-collapse: collapse; margin-top: 12px; border: 1px solid #666; }\r\n  .items-table th, .items-table td { border: 1px solid #666; padding: 6px; text-align: left; font-size: 13px; }\r\n  .items-table th { background-color: #f2f2f2; font-weight: bold; }\r\n  .summary-row { font-weight: bold; background-color: #e9e9e9; }\r\n  .text-right { text-align: right; }\r\n  .description-table { width: 100%; border-collapse: collapse; margin: 4px 0 8px 0; font-size: 12px; border: 1px solid #666; }\r\n  .description-table th, .description-table td { border: 1px solid #666; padding: 4px; }\r\n  .description-table th { background-color: #f8f8f8; }\r\n  .item-header { background-color: #eaeaea; font-weight: bold; padding: 4px; margin-top: 8px; border-bottom: 1px solid #666; font-size: 13px; }\r\n  @media print { body { margin: 8mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"report-box\">\r\n     Report Date <br>\r\n    <span style=\"color:red;\">${currentDate}</span>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"reg-info\">\r\n  TIN: 135-489-247<br>\r\n  VRN: 40-032826C\r\n</div>\r\n\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n\r\n<div class=\"section-title\">BUDGET DETAILS</div>\r\n\r\n<div class=\"budget-info\">\r\n  <table>\r\n    <thead>\r\n      <tr>\r\n        <th>Project</th>\r\n        <th>Budget Name</th>\r\n        <th>Allocated Amount</th>\r\n        <th>Unallocated Amount</th>\r\n        <th>Budget Cost</th>\r\n        <th>Used Cost</th>\r\n        <th>Balance</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td>${project.value.short_name}</td>\r\n        <td>${budget.value.name}</td>\r\n        <td class=\"text-right\">${formatNumber(allocatedAmount)} </td>\r\n        <td class=\"text-right\">${formatNumber(unallocatedAmount)} </td>\r\n        <td class=\"text-right\">${formatNumber(totalBudgeted)} </td>\r\n        <td class=\"text-right\">${formatNumber(totalUsed)} </td>\r\n        <td class=\"text-right\">${formatNumber(totalBalance)} </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<div class=\"section-title\">BUDGET ITEMS DETAILS</div>\r\n<table class=\"items-table\">\r\n  <thead>\r\n    <tr>\r\n      <th>#</th>\r\n      <th>Item</th>\r\n      <th>Descriptions</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${items.value.map((item, itemIndex) => {\r\n      return `\r\n        <tr>\r\n          <td>${itemIndex + 1}</td>\r\n          <td>${item.name}</td>\r\n          <td>\r\n            ${item.descriptions.map((desc, descIndex) => {\r\n              const descBudgeted = (desc.cost || 0) * (desc.quantity || 0) * (desc.quantity_2 || 1);\r\n              const descUsed = parseFloat(desc.used_cost) || 0;\r\n              const descBalance = descBudgeted - descUsed;\r\n              return `\r\n                <div class=\"item-header\">ITEM ${descIndex + 1}: ${desc.name || '-'}</div>\r\n                <table class=\"description-table\">\r\n                  <tr>\r\n                    <th>Specification</th>\r\n                    <th>Units</th>\r\n                    <th>Qty 1</th>\r\n                    <th>Qty 2</th>\r\n                    <th>Rate</th>\r\n                    <th>Budgeted</th>\r\n                    <th>Used</th>\r\n                    <th>Balance</th>\r\n                  </tr>\r\n                  <tr>\r\n                    <td>${desc.specification || '-'}</td>\r\n                    <td>${desc.units || '-'}</td>\r\n                    <td class=\"text-right\">${desc.quantity || 0}</td>\r\n                    <td class=\"text-right\">${desc.quantity_2 || 1}</td>\r\n                    <td class=\"text-right\">${formatNumber(desc.cost || 0)}</td>\r\n                    <td class=\"text-right\">${formatNumber(descBudgeted)}</td>\r\n                    <td class=\"text-right\">${formatNumber(descUsed)}</td>\r\n                    <td class=\"text-right\">${formatNumber(descBalance)}</td>\r\n                  </tr>\r\n                </table>\r\n              `;\r\n            }).join('')}\r\n          </td>\r\n        </tr>\r\n      `;\r\n    }).join('')}\r\n  </tbody>\r\n  <tfoot>\r\n    <tr class=\"summary-row\">\r\n      <td colspan=\"2\" class=\"text-right\"><strong>GRAND TOTAL</strong></td>\r\n      <td>\r\n        <table class=\"description-table\">\r\n          <tr>\r\n            <th>Total Budgeted</th>\r\n            <th>Total Used</th>\r\n            <th>Total Balance</th>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"text-right\">${formatNumber(totalBudgeted)} </td>\r\n            <td class=\"text-right\">${formatNumber(totalUsed)} </td>\r\n            <td class=\"text-right\">${formatNumber(totalBalance)} </td>\r\n          </tr>\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </tfoot>\r\n</table>\r\n\r\n<div style=\"margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;\">\r\n  <p> ${new Date().getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 135-489-247 | VRN: 40-032826C</p>\r\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n  const iframeDoc = iframe.contentWindow.document;\r\n  iframeDoc.open();\r\n  iframeDoc.write(printContent);\r\n  iframeDoc.close();\r\n\r\n  iframe.onload = () => {\r\n    iframe.contentWindow.focus();\r\n    iframe.contentWindow.print();\r\n    setTimeout(() => {\r\n      document.body.removeChild(iframe);\r\n    }, 1000);\r\n  };\r\n};\r\n\r\n\r\n\r\n\r\nconst getBudgetStatusClass = (budgetItem) => {\r\n  const approval = budgetApprovals.value.find(app => app.budget_id === budgetItem.id);\r\n  \r\n  if (approval) {\r\n    if (approval.status?.name === 'Unapproved') {\r\n      return 'status-unapproved'; // Purple for Unapproved\r\n    } else if (approval.status?.name === 'Approved') {\r\n      return 'status-approved'; // Green for Approved\r\n    } else if (approval.status?.name === 'Rejected') {\r\n      return 'status-rejected'; // Red for Rejected\r\n    }\r\n\r\n  }\r\n  \r\n  return ''; \r\n};\r\n\r\n</script>\r\n<style scoped>\r\n.nav-link.active {\r\n    background-color: #007bff !important;\r\n    color: white !important;\r\n}\r\n\r\n.nav-item {\r\n    margin-right: 12px;\r\n    margin-left:5px;\r\n}\r\n\r\n.budgets-container {\r\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n    max-width: 800px;\r\n    margin: 20px auto;\r\n    padding: 20px;\r\n    background: #f8f9fa;\r\n    border-radius: 10px;\r\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.budgets-title {\r\n    color: #2c3e50;\r\n    margin-bottom: 15px;\r\n    font-weight: 600;\r\n    text-align: center;\r\n}\r\n\r\n.budgets-buttons {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 10px;\r\n}\r\n\r\n.budget-button {\r\n    display: inline-block;\r\n    padding: 10px 20px;\r\n    border-radius: 20px;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n    text-align: center;\r\n    min-width: 120px;\r\n    border: none;\r\n    color: white;\r\n}\r\n\r\n.active-budget {\r\n    background: linear-gradient(135deg, #498284, #019dcd);\r\n}\r\n\r\n\r\n.budget-button {\r\n  margin: 2px;\r\n}\r\n\r\n\r\n/* Ensure these styles override the default project-button styles */\r\n.budget-button.project-button.status-unapproved,\r\n.budget-button.project-button.status-rejected,\r\n.budget-button.project-button.status-approved {\r\n  color: white !important;\r\n}\r\n\r\n.budget-button {\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.budget-button:active {\r\n  transform: scale(0.95);\r\n}\r\n\r\n</style>","import script from \"./requisitionBudget.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./requisitionBudget.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./requisitionBudget.vue?vue&type=style&index=0&id=7deb6b42&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\copexErp\\\\frontEnd\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7deb6b42\"]])\n\nexport default __exports__"],"names":["route","useRoute","user_permissions","JSON","parse","localStorage","getItem","permissions","useMeta","title","project","ref","newBudget","showError","inject","formatNumber","showMessage","tableShimmer","loadingSpinner","axiosInstance","axios","baseURL","process","budgets","budget","budgets_loading","add_item","add_description","edit_description","amend_description","items","routeParams","computed","budget_item_description_id","params","parseInt","watch","budgetsList","length","foundBudget","find","some","item","descriptions","desc","id","fillBudget","targetDescription","flatMap","getBudgetConsuption","modalElement","document","getElementById","modal","bootstrap","Modal","addEventListener","backdrops","querySelectorAll","forEach","backdrop","remove","body","classList","style","overflow","paddingRight","show","immediate","budgetEdits","budgetEditColumns","getBudgetEdits","async","loading","value","response","get","data","map","index","Sno","editor","name","quantity","from_quantity","to_quantity","quantity_2","from_quantity_2","to_quantity_2","rate","from_rate","to_rate","cost","amendDescription","payload","budget_description","remark","editor_id","post","user","i","d","last_editor","clearForm","error","message","console","log","add_fund","fund","addFund","funded_amount","put","approval_id","description_cost","add_remark","addBudgetRemark","date","Date","toISOString","split","remarker_id","description","description_id","newRemark","currentBalance","parseFloat","used_cost","toFixed","total_used_cost","consuptions","sno","approved_by","debit","Number","toLocaleString","credit","Math","abs","balance","c","replace","deleteBudgetRemark","confirm","delete","itemCost","filter","consuptionColumns","remarker","budget_description_clicks","no_edit","fillEdits","status","includes","click","specification","unit","units","u","short_name","updateDescription","targetItem","findIndex","getUnits","addDescription","budget_item_id","push","getBudgets","item_name","addItem","budget_id","budget_name","showBudgetStatusCard","budgetStatusCardType","budgetStatusCardTitle","budgetStatusCardMessage","budgetStatusRemarks","approval","budgetApprovals","app","currentBudgetId","currentProjectId","budgetItem","fetchedItem","getBudgetDetails","budget_item","project_id","budgets_count","newVal","closeModal","modalEl","querySelector","modalInstance","getInstance","hide","onMounted","budgetId","printReport","iframe","createElement","display","appendChild","currentDate","toLocaleDateString","allocatedAmount","totalBudgeted","total_cost","totalUsed","totalBalance","unallocatedAmount","printContent","itemIndex","descIndex","descBudgeted","descUsed","descBalance","join","getFullYear","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","__exports__"],"sourceRoot":""}