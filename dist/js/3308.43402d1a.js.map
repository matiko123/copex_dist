{"version":3,"file":"js/3308.43402d1a.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/boq/index.vue","webpack://cork-vue3/./src/views/boq/index.vue?f708"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n  <!-- boq header starts -->\r\n           <div \r\n          class=\" mt-5\" \r\n          :style=\"{ opacity: 1 - 0.1 * clickCount, transition: 'opacity 0.5s' }\"\r\n        >\r\n  <h4 class=\"text-center\" @click=\"handleClick\" style=\"cursor:pointer;\">\r\n    BILL OF QUANTITY \r\n  </h4>\r\n\r\n        </div>\r\n   <!-- boq header ends -->\r\n<!-- offcanvas start -->\r\n<div class=\"offcanvas offcanvas-end\" data-bs-scroll=\"true\" tabindex=\"-1\" id=\"offcanvasWithBothOptions\" aria-labelledby=\"offcanvasWithBothOptionsLabel\">\r\n  <div class=\"offcanvas-header\">\r\n    <h5 class=\"offcanvas-title\" id=\"offcanvasWithBothOptionsLabel\">PROJECT LISTS</h5>\r\n    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\"></button>\r\n  </div>\r\n  <div class=\"offcanvas-body\">\r\n  <div class=\"row\">\r\n  <div class=\"col-12\">\r\n    <div class=\"list-group\" id=\"list-tab\" role=\"tablist\"  >\r\n      <a v-for=\"projectList in projects\" :key=\"projectList.id\" class=\"list-group-item list-group-item-action\" :id=\"'project-link-' + projectList.id\" data-bs-toggle=\"list\" :href=\"'#project-' + projectList.id\" role=\"tab\" :aria-controls=\"'project-' + projectList.id\" @click=\"project = projectList\" data-bs-dismiss=\"offcanvas\">{{ projectList.short_name }}</a>\r\n    </div>\r\n  </div>\r\n</div>\r\n  </div>\r\n</div>\r\n <!-- offcanvas ends -->\r\n<!-- buttons starts -->\r\n<div class=\"d-flex mb-2 me-1\">\r\n  <div class=\"ms-auto\">\r\n        <button class=\"btn\" v-if=\"mobileView\"  data-bs-toggle=\"offcanvas\" data-bs-target=\"#offcanvasWithBothOptions\" aria-controls=\"offcanvasWithBothOptions\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-list-ul\" viewBox=\"0 0 16 16\">\r\n  <path fill-rule=\"evenodd\" d=\"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2\"/>\r\n</svg>\r\n</button>\r\n<button v-else class=\"btn btn-outline-primary\" type=\"button\" data-bs-toggle=\"offcanvas\" data-bs-target=\"#offcanvasWithBothOptions\" aria-controls=\"offcanvasWithBothOptions\">Select Project from the lists</button>\r\n  </div>\r\n</div>\r\n<div v-if=\"project\" class=\"d-flex mb-2\">\r\n  <div class=\"ms-auto\">\r\n  <button @click=\"addBoq = true\" class=\"btn btn-primary me-2\" v-if=\"user_permissions.includes('can_register_boq') &&  !addBoq \">Add BOQ</button>\r\n  <button  class=\"btn btn-success\" @click=\"printBoq()\" v-if=\"!addBoq \">Print BOQ</button>\r\n    <button @click=\"addBoq = false\" class=\"btn btn-secondary\" v-if=\"addBoq\">View BOQ</button>\r\n  </div>\r\n</div>\r\n<!-- buttons ends -->\r\n<!-- boq accordion and table starts -->\r\n\r\n\r\n<div v-if=\"addBoq\" class=\"accordion accordion-flush\" id=\"accordionFlushExample\">\r\n  <div class=\"bg-dark mt-2 mb-2\">\r\n    <h6 class=\"text-center text-white m-0\">{{ project.project_name }}</h6>\r\n  </div>\r\n\r\n  <div class=\"d-flex mb-2\">\r\n    <div class=\"ms-auto\">\r\n      <button class=\"btn btn-success\"\r\n              data-bs-toggle=\"modal\"\r\n              data-bs-target=\"#seriesModal\"\r\n              @click=\"series = ''\">\r\n        Add Series\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <div v-for=\"(item, b) in boq\" class=\"accordion-item\" style=\"border:1px solid green\">\r\n    <h2 class=\"accordion-header\">\r\n      <button class=\"accordion-button collapsed\" type=\"button\"\r\n              data-bs-toggle=\"collapse\"\r\n              :data-bs-target=\"`#accordion${item.id}`\"\r\n              aria-expanded=\"false\"\r\n              :aria-controls=\"`accordion${item.id}`\">\r\n        {{ b + 1 }}. {{ item.name }}\r\n      </button>\r\n    </h2>\r\n    <div :id=\"`accordion${item.id}`\" class=\"accordion-collapse collapse\">\r\n      <div class=\"accordion-body\">\r\n\r\n        <!-- Add Section Button -->\r\n        <div class=\"d-flex mb-2\">\r\n          <div class=\"ms-auto\">\r\n            <button class=\"btn btn-warning\"\r\n                    data-bs-toggle=\"modal\"\r\n                    data-bs-target=\"#sectionModal\"\r\n                    @click=\"series = item\">\r\n              Add Section\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Section Accordion -->\r\n        <div :id=\"`accordionSeries${item.id}`\" class=\"accordion\">\r\n          <div v-for=\"(lsection, s) in item.sections\" class=\"accordion-item\" style=\"border:1px solid orange\">\r\n            <h2 class=\"accordion-header\">\r\n              <button class=\"accordion-button collapsed\" type=\"button\"\r\n                      data-bs-toggle=\"collapse\"\r\n                      :data-bs-target=\"`#section${lsection.id}`\"\r\n                      aria-expanded=\"false\"\r\n                      :aria-controls=\"`section${lsection.id}`\">\r\n                {{ s + 1 }}. {{ lsection.name }}\r\n              </button>\r\n            </h2>\r\n            <div :id=\"`section${lsection.id}`\"\r\n                 class=\"accordion-collapse collapse\"\r\n                 :data-bs-parent=\"`#accordionSeries${item.id}`\">\r\n              <div class=\"accordion-body\">\r\n\r\n                <!-- Add Sub Section Button -->\r\n                <div class=\"d-flex mb-2\">\r\n                  <div class=\"ms-auto\">\r\n                    <div class=\"btn group\">\r\n                  <button class=\"btn btn-primary me-2\"\r\n        data-bs-toggle=\"modal\"\r\n        data-bs-target=\"#subSectionModal\"\r\n        @click=\"section = lsection; newSubSectionName = ''\">\r\n  Add Sub Section\r\n</button>\r\n\r\n                  <button class=\"btn btn-secondary\"\r\n        data-bs-toggle=\"modal\"\r\n        data-bs-target=\"#lineModal\"\r\n        @click=\"section = lsection; newSubSectionName = ''\">\r\n  Add Line\r\n</button>\r\n                    </div>\r\n\r\n                  </div>\r\n                </div>\r\n\r\n                                        <!-- Line List -->\r\n                                         <div class=\"table-responsive\">\r\n<table class=\"table table-bordered table-sm\">\r\n  <thead >\r\n    <tr>\r\n      <th>SN</th>\r\n      <th>Name</th>\r\n      <th>Unit</th>\r\n      <th>Quantity</th>\r\n      <th>Rate</th>\r\n      <th>Total</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr v-for=\"(line, li) in lsection.lines\" :key=\"line.id\">\r\n      <td class=\"text-center\">{{ li + 1 }}</td>\r\n      <td class=\"text-start\">{{ line.name }}</td>\r\n      <td>{{ line.unit }}</td>\r\n      <td>{{ line.quantity }}</td>\r\n      <td class=\"text-end\">{{ Number(line.rate).toLocaleString() }}</td>\r\n      <td class=\"text-end\">{{ (line.quantity * line.rate).toLocaleString() }}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n                                         </div>\r\n\r\n<!-- End Line List -->\r\n\r\n                <!-- Sub Section Accordion -->\r\n                <div :id=\"`accordionSub${lsection.id}`\" class=\"accordion\">\r\n                  <div v-for=\"(subsection, sb) in lsection.sub_sections\" class=\"accordion-item\" style=\"border:1px solid blue\">\r\n                    <h2 class=\"accordion-header\">\r\n                      <button class=\"accordion-button collapsed\" type=\"button\"\r\n                              data-bs-toggle=\"collapse\"\r\n                              :data-bs-target=\"`#sub${subsection.id}`\"\r\n                              aria-expanded=\"false\"\r\n                              :aria-controls=\"`sub${subsection.id}`\">\r\n                        {{ sb + 1 }}. {{ subsection.name }}\r\n                      </button>\r\n                    </h2>\r\n                    <div :id=\"`sub${subsection.id}`\"\r\n                         class=\"accordion-collapse collapse\"\r\n                         :data-bs-parent=\"`#accordionSub${lsection.id}`\">\r\n                      <div class=\"accordion-body\">\r\n\r\n                        <!-- Add Line Button -->\r\n                        <div class=\"d-flex mb-2\">\r\n                          <div class=\"ms-auto\">\r\n                            <button class=\"btn btn-secondary\"\r\n                                    data-bs-toggle=\"modal\"\r\n                                    data-bs-target=\"#lineModal\"\r\n                                    @click=\"sub_section = subsection\">\r\n                              Add Line\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <!-- Line List -->\r\n                        <!-- Line List -->\r\n<table class=\"table table-bordered table-sm\">\r\n  <thead >\r\n    <tr>\r\n      <th>SN</th>\r\n      <th>Name</th>\r\n      <th>Unit</th>\r\n      <th>Quantity</th>\r\n      <th>Rate</th>\r\n      <th>Total</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr v-for=\"(line, li) in subsection.lines\" :key=\"line.id\">\r\n      <td class=\"text-center\">{{ li + 1 }}</td>\r\n      <td class=\"text-start\">{{ line.name }}</td>\r\n      <td>{{ line.unit }}</td>\r\n      <td>{{ line.quantity }}</td>\r\n      <td class=\"text-end\">{{ (line.rate).toLocaleString() }}</td>\r\n      <td class=\"text-end\">{{ (line.quantity * line.rate).toLocaleString() }}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n<!-- End Line List -->\r\n\r\n                        <!-- End Line List -->\r\n\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <!-- End Sub Section Accordion -->\r\n\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- End Section Accordion -->\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n        <!-- boq registration ends -->\r\n          <!-- boq table starts -->\r\n<div class=\"table-responsive\" v-else style=\"max-height: 600px; overflow-y: auto;\">\r\n          <table class=\"table table-bordered mt-4\" v-if=\"project\">\r\n            <thead class=\"thead-light\" style=\"position: sticky; top: 0; background: white; z-index: 5;\">\r\n              <tr @click=\"scrollable =! scrollable\">\r\n                <th scope=\"col\" class=\"text-dark\">Code/SN</th>\r\n                <th scope=\"col\" class=\"text-dark\">Description</th>\r\n                <th scope=\"col\" class=\"text-dark\">Unit</th>\r\n                <th scope=\"col\" class=\"text-dark\">Quantity</th>\r\n                <th scope=\"col\" class=\"text-dark\">Rate</th>\r\n                <th scope=\"col\" class=\"text-dark\">Total</th>\r\n                <th v-if=\"user_permissions.includes('can_edit_boq_line') || user_permissions.includes('can_delete_boq_line')\" scope=\"col\" class=\"text-dark\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n     <tbody>\r\n  <tr>\r\n    <td colspan=\"6\" class=\"bg-dark text-white\">\r\n      Bill of Quantity {{ project.project_name }}\r\n    </td>\r\n  </tr>\r\n\r\n<template v-for=\"(series, i) in boq\" :key=\"'series-' + i\">\r\n  <tr>\r\n    <th colspan=\"1\" class=\"text-center\">SERIES {{ i + 1 }}</th>\r\n    <th colspan=\"5\" class=\"text-start\">{{ series.name }}</th>\r\n    <th>\r\n               <svg\r\n                 v-if=\"user_permissions.includes('can_delete_boq_line')\"\r\n                style=\"cursor: pointer;\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBoqSeries(series)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n    </th>\r\n  </tr>\r\n\r\n  <template v-for=\"(section, j) in series.sections\" :key=\"'section-' + j\">\r\n    <tr>\r\n      <th colspan=\"1\" class=\"text-center\">Section  {{ i + 1 }}.{{ j + 1 }}</th>\r\n      <th colspan=\"5\" class=\"text-start\">{{ section.name }}</th>\r\n      <th>\r\n                        <svg\r\n                 v-if=\"user_permissions.includes('can_delete_boq_line')\"\r\n                style=\"cursor: pointer;\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBoqSection(section)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n      </th>\r\n    </tr>\r\n\r\n    <template v-for=\"(line, a) in section.lines\" :key=\"'line-' + a\">\r\n      <tr>\r\n        <td class=\"text-center\">{{ line.item_no ??  String.fromCharCode(97 + a)   }} </td>\r\n        <td class=\"text-start\">{{ line.name }}</td>\r\n        <td>{{ line.unit }}</td>\r\n        <td>{{ line.quantity }}</td>\r\n        <td class=\"text-end\">{{ Number(line.rate).toLocaleString() }} </td>\r\n        <td class=\"text-end\">{{ (line.rate * line.quantity).toLocaleString() }}</td>\r\n             <td class=\"text-end\">\r\n           \r\n                <svg\r\n                 v-if=\"user_permissions.includes('can_delete_boq_line')\"\r\n                style=\"cursor: pointer;\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBoqLine(line)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n \r\n<svg \r\n@click=\"selectLine(line)\"\r\n   data-bs-toggle=\"modal\" data-bs-target=\"#edit\"\r\n    v-if=\"user_permissions.includes('can_edit_boq_line')\"\r\n    xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-pencil-square\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\r\n  <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z\"/>\r\n</svg>\r\n          </td>\r\n      </tr>\r\n    </template>\r\n\r\n    <template v-for=\"(sub, k) in section.sub_sections\" :key=\"'sub-' + k\">\r\n      <tr>\r\n        <th colspan=\"1\" class=\"text-center\">{{ i + 1 }}.{{ j + 1 }}.{{ k + 1 }}</th>\r\n        <th colspan=\"5\" class=\"text-start\">{{ sub.name }}</th>\r\n        <th>\r\n           <svg\r\n                 v-if=\"user_permissions.includes('can_delete_boq_line')\"\r\n                style=\"cursor: pointer;\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBoqSubSection(sub)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n        </th>\r\n      </tr>\r\n\r\n      <template v-for=\"(line, b) in sub.lines\" :key=\"'subline-' + b\">\r\n        <tr>\r\n          <td class=\"text-center\">{{ String.fromCharCode(97 + b) }}</td>\r\n          <td class=\"text-start\">{{ line.name }}</td>\r\n          <td>{{ line.unit }}</td>\r\n          <td>{{ line.quantity }}</td>\r\n          <td class=\"text-end\">{{ line.rate.toLocaleString() }}</td>\r\n          <td class=\"text-end\">{{ (line.rate * line.quantity).toLocaleString() }}</td>\r\n          <td class=\"text-end\">\r\n           \r\n                <svg\r\n                 v-if=\"user_permissions.includes('can_delete_boq_line')\"\r\n                style=\"cursor: pointer;\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                 width=\"26\"\r\n                                  height=\"26\"                                 \r\n                                   fill=\"currentColor\"\r\n                                    class=\"bi bi-trash text-danger me-2\"\r\n                                     @click=\"deleteBoqLine(line)\"\r\n                                     viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z\"/>\r\n                                    <path d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z\"/>\r\n                                </svg>\r\n \r\n              <svg \r\n@click=\"selectLine(line)\"\r\n   data-bs-toggle=\"modal\" data-bs-target=\"#edit\"\r\n    v-if=\"user_permissions.includes('can_edit_boq_line')\"\r\n    xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-pencil-square\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\r\n  <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z\"/>\r\n</svg>\r\n          </td>\r\n        </tr>\r\n      </template>\r\n    </template>\r\n  </template>\r\n</template>\r\n\r\n  <div v-if=\"boq.lenght == 0\">No Series Set for this project</div>\r\n</tbody>\r\n\r\n          </table>\r\n</div>\r\n        <div v-if=\"boq.length === 0 && project\" class=\"text-center\">No BoQ set for this project</div>\r\n        <div v-else-if=\"!project\" class=\"text-center\">Select a project to see its BOQ</div>\r\n<!-- boq table ends -->\r\n\r\n<!-- boq accordion and table ends -->\r\n        <!-- boq summary starts -->\r\n  <div class=\"table-responsive\" v-if=\"project\">\r\n  <h5  class=\"text-center bg-dark\">Summary</h5>\r\n<table  class=\"table table-bordered\">\r\n  <tbody>\r\n    <tr v-for=\"series in boq\" :key=\"series.id\">\r\n      <td class=\"fw-bold\">Series {{ series.name }}</td>\r\n      <td class=\"text-end fw-bold\">\r\n        {{\r\n          series.sections.reduce((sAcc, section) => {\r\n            const sectionLinesTotal = section.lines.reduce(\r\n              (lAcc, line) => lAcc + line.quantity * line.rate,\r\n              0\r\n            )\r\n            const subSectionsTotal = section.sub_sections.reduce(\r\n              (ssAcc, sub) =>\r\n                ssAcc + sub.lines.reduce(\r\n                  (lAcc, line) => lAcc + line.quantity * line.rate,\r\n                  0\r\n                ),\r\n              0\r\n            )\r\n            return sAcc + sectionLinesTotal + subSectionsTotal\r\n          }, 0).toLocaleString()\r\n        }}\r\n      </td>\r\n    </tr>\r\n\r\n    <tr class=\"table-secondary\">\r\n      <td class=\"fw-bold\">A Total of Bills</td>\r\n      <td class=\"text-end fw-bold\">\r\n        {{\r\n          boq.reduce((totalAcc, series) =>\r\n            totalAcc + series.sections.reduce((sAcc, section) => {\r\n              const sectionLinesTotal = section.lines.reduce(\r\n                (lAcc, line) => lAcc + line.quantity * line.rate,\r\n                0\r\n              )\r\n              const subSectionsTotal = section.sub_sections.reduce(\r\n                (ssAcc, sub) =>\r\n                  ssAcc + sub.lines.reduce(\r\n                    (lAcc, line) => lAcc + line.quantity * line.rate,\r\n                    0\r\n                  ),\r\n                0\r\n              )\r\n              return sAcc + sectionLinesTotal + subSectionsTotal\r\n            }, 0),\r\n            0\r\n          ).toLocaleString()\r\n        }}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n  </div>\r\n         <!-- boq summary ends -->\r\n                  <!-- boq line edit starts -->\r\n                     <div class=\"modal fade mymodal\" id=\"edit\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n    <div class=\"modal-content \">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Edit BOQ Line </h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close-edit\"></button>\r\n      </div>\r\n    <form @submit.prevent=\"editBoqLine()\">\r\n      <div class=\"modal-body\">\r\n          <div class=\"row\">\r\n            <div class=\"col-md-3\">\r\n              <input type=\"text\" class=\"form-control\" placeholder=\"Enter Line Details\" v-model=\"selectedLine.name\">\r\n            </div>\r\n             <div class=\"col-md-3\">\r\n               <multiselect \r\n      v-model=\"unit\"\r\n      :options=\"units\"\r\n      label=\"short_name\"\r\n      placeholder=\"Select unit\"\r\n      :required=\"true\"\r\n      :searchable=\"true\"\r\n      multple=\"false\"\r\n    />\r\n            </div>\r\n             <div class=\"col-md-3\">\r\n              <input type=\"number\" class=\"form-control\" placeholder=\"Enter Quantity\" v-model=\"selectedLine.quantity\" step=\"any\">\r\n            </div>\r\n             <div class=\"col-md-3\">\r\n              <input type=\"number\" class=\"form-control\" placeholder=\"Enter Rate\" v-model=\"selectedLine.rate\">\r\n            </div>\r\n          </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"loading\">\r\n        <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else>Save</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n         <!-- boq line edit ends -->\r\n                <!-- boq registration line starts -->\r\n            <div class=\"modal fade mymodal\" id=\"lineModal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n    <div class=\"modal-content \">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Add BOQ line for {{ sub_section.name ?? section.name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"closeLine\"></button>\r\n      </div>\r\n    <form @submit.prevent=\"registerBoqLine()\">\r\n      <div class=\"modal-body\">\r\n          <div class=\"row\">\r\n             <div class=\"col-md-3 mt-1\">\r\n              <input type=\"text\" class=\"form-control\" placeholder=\"Enter Line No\" v-model=\"line.no\" required>\r\n            </div>\r\n            <div class=\"col-md-9 mt-1\">\r\n              <input type=\"text\" class=\"form-control\" placeholder=\"Enter Line Details\" v-model=\"line.name\">\r\n            </div>\r\n             <div class=\"col-md-3 mt-1\">\r\n               <multiselect \r\n      v-model=\"line.unit\"\r\n      :options=\"units\"\r\n      label=\"short_name\"\r\n      placeholder=\"Select unit\"\r\n      :required=\"true\"\r\n      :searchable=\"true\"\r\n      multple=\"false\"\r\n    />\r\n            </div>\r\n             <div class=\"col-md-4 mt-1\">\r\n              <input type=\"number\" class=\"form-control\" placeholder=\"Enter Quantity\" v-model=\"line.quantity\" step=\"any\">\r\n            </div>\r\n             <div class=\"col-md-5 mt-1\">\r\n              <input type=\"number\" class=\"form-control\" placeholder=\"Enter Rate\" v-model=\"line.rate\">\r\n            </div>\r\n          </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"sending\">\r\n        <span v-if=\"sending\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else>submit</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n       <!-- boq registration line ends -->\r\n          <!-- series register modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"seriesModal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n    <div class=\"modal-content \">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Add BOQ Series for {{ project.short_name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close-series\"></button>\r\n      </div>\r\n    <form @submit.prevent=\"registerSeries\">\r\n      <div class=\"modal-body\">\r\n            <input type=\"text\" class=\"form-control\" v-model=\"series\" placeholder=\"Enter Series\">\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n        <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"sending\">\r\n        <span v-if=\"sending\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else>submit</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n   <!-- series register modal ends -->\r\n    <!-- section register modal starts -->\r\n     <div class=\"modal fade mymodal\" id=\"sectionModal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n    <div class=\"modal-content \">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Add BOQ section for {{ series.name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"closeSection\"></button>\r\n      </div>\r\n    <form @submit.prevent=\"registerSection()\">\r\n      <div class=\"modal-body\">\r\n            <input type=\"text\" class=\"form-control\" v-model=\"section\" placeholder=\"Enter Section Name\">\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n         <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"sending\">\r\n        <span v-if=\"sending\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else>submit</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n     <!-- section register modal ends -->\r\n          <!-- Sub section register modal starts -->\r\n     <div class=\"modal fade mymodal\" id=\"subSectionModal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n    <div class=\"modal-content \">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">Add BOQ sub section for {{ section.name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"closeSubSection\"></button>\r\n      </div>\r\n    <form @submit.prevent=\"registerSubSection()\">\r\n      <div class=\"modal-body\">\r\n           <input type=\"text\" class=\"form-control\" v-model=\"newSubSectionName\" placeholder=\"Enter Sub Section Name\">\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\">Close</button>\r\n       <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"sending\">\r\n        <span v-if=\"sending\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else>submit</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n     <!-- Sub section register modal ends -->\r\n</div>\r\n</template>\r\n\r\n<script setup>\r\n    import axios from 'axios';\r\n    import { onMounted, ref,inject,watch } from 'vue';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\nconst showMessage = inject('showMessage');\r\nconst showError = inject('showError');\r\nconst formatDate = inject('formatDate');\r\nconst loadingSpinner = inject('loadingSpinner');\r\nconst showConfirmation = inject('showConfirmation');\r\nconst user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\nconst addBoq = ref(false);\r\nconst project = ref('')\r\nconst selectedLine = ref('')\r\nconst scrollable = ref(false)\r\nconst loading = ref(false)\r\nconst unit = ref('')\r\nconst selectLine = (line)=>{\r\n  selectedLine.value = line\r\n  unit.value = units.value.find(unit => selectedLine.value.unit === unit.short_name)\r\n}\r\n\r\n\r\nconst editBoqLine = async ()=>{\r\n   loading.value = true\r\n   const payload = {\r\n    name : selectedLine.value.name,\r\n    quantity : selectedLine.value.quantity,\r\n    rate : selectedLine.value.rate,\r\n    unit : unit.value.short_name\r\n   }\r\n   try{\r\n   const response = await axiosInstance.put(`boq-lines/${selectedLine.value.id}`,payload)\r\n   showMessage('updated Successfully')\r\n   document.getElementById('close-edit').click()\r\n getBoq(project.value.id)\r\n   }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n   }finally{\r\n    loading.value = false\r\n   }\r\n}\r\nconst projects = ref([])\r\n    const getProjects = async () => {\r\n    try {\r\n        const response = await axiosInstance.get(`/projects`);\r\n        projects.value = response.data\r\n    } catch (error) {\r\n\r\n    }\r\n};\r\nconst deleteBoqLine = async (line) => {\r\n  const res = await showConfirmation(\r\n    'Delete BOQ Line',\r\n    'Confirm Deleting ' + line.name,\r\n    `/boq-lines/${line.id}`,\r\n    'delete'\r\n  )\r\n  if (res?.refresh) getBoq(project.value.id)\r\n}\r\n\r\n\r\nconst deleteBoqSeries = async (series) => {\r\n  const res = await showConfirmation(\r\n    'Delete BOQ Series',\r\n    'Confirm Deleting ' + series.name,\r\n    `/boq-series/${series.id}`,\r\n    'delete'\r\n  )\r\n  if (res?.refresh) getBoq(project.value.id)\r\n}\r\n\r\nconst deleteBoqSection = async (section) => {\r\n  const res = await showConfirmation(\r\n    'Delete BOQ Section',\r\n    'Confirm Deleting ' + section.name,\r\n    `/boq-sections/${section.id}`,\r\n    'delete'\r\n  )\r\n  if (res?.refresh) getBoq(project.value.id)\r\n}\r\n\r\nconst deleteBoqSubSection = async (subsection) => {\r\n  const res = await showConfirmation(\r\n    'Delete BOQ Section Sub Section',\r\n    'Confirm Deleting ' + subsection.name,\r\n    `/boq-sub-sections/${subsection.id}`,\r\n    'delete'\r\n  )\r\n  if (res?.refresh) getBoq(project.value.id)\r\n}\r\n\r\nconst units = ref([])\r\n    const getUnits = async () => {\r\n    try {\r\n        const response = await axiosInstance.get(`/units`);\r\n        units.value = response.data\r\n    } catch (error) {\r\n\r\n    }\r\n};\r\n\r\n\r\n\r\n        watch(project, (newValue) => {\r\n          getBoq(newValue.id)\r\n       });\r\n\r\n    const boq = ref([]);\r\n    const getBoq = async (id) => {\r\n    try {\r\n        const response = await axiosInstance.get(`/boq?project_id=${id}`);\r\n        boq.value = response.data.data\r\n    } catch (error) {\r\n\r\n    }\r\n};\r\n\r\n\r\nconst series = ref('');\r\nconst registerSeries = async () => {\r\n    sending.value = true\r\n    try {\r\n        const formData = {\r\n            project_id: project.value.id,\r\n            name: series.value\r\n        };\r\n        const response = await axiosInstance.post('/boq-series', formData);\r\n\r\n\r\n        getBoq(project.value.id)\r\n        showMessage(\"Series registered!\");\r\n        document.getElementById('close-series').click();\r\n        series.value = '';\r\n    } catch (error) {\r\n        showError(error.message);\r\n        console.log(error);\r\n    }finally{\r\n      sending.value = false\r\n    }\r\n};\r\n\r\nconst section = ref('')\r\nconst registerSection = async () => {\r\n  sending.value = true\r\n        const formData = {\r\n      series_id: series.value.id,\r\n      name: section.value\r\n    };\r\n\r\n  try {\r\n    const response = await axiosInstance.post('/boq-sections', formData);\r\n      getBoq(project.value.id)\r\n\r\n    showMessage(\"Section Registered!\");\r\n    document.getElementById('closeSection').click();\r\n    section.value = '';\r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.log(error);\r\n  }finally{\r\n    sending.value = false\r\n  }\r\n};\r\n\r\nconst newSubSectionName = ref('');\r\n\r\nconst registerSubSection = async () => {\r\n  sending.value = true\r\n  try {\r\n    const response = await axiosInstance.post(\"/boq-sub-sections\", {\r\n      name: newSubSectionName.value,\r\n      section_id: section.value.id,\r\n    });\r\n\r\n\r\n    getBoq(project.value.id)\r\n\r\n    // Reset\r\n    newSubSectionName.value = '';\r\n    document.getElementById('closeSubSection').click();\r\n    showMessage('sub section added!')\r\n  } catch (error) {\r\n    console.error(\"Error registering sub section:\", error);\r\n    showError(\"Failed to add sub section.\");\r\n  }finally{\r\n    sending.value = false\r\n  }\r\n};\r\n\r\nconst sub_section = ref('')\r\nconst line = ref({\r\n  no : '',\r\n  name: '',\r\n  unit: '',\r\n  quantity: '',\r\n  rate: ''\r\n});\r\n\r\nconst sending = ref(false)\r\nconst registerBoqLine = async () => {\r\n  sending.value = true\r\n  try {\r\n    const formData = {\r\n      item_no : line.value.no,\r\n      name: line.value.name,\r\n      unit: line.value.unit.short_name,\r\n      quantity: line.value.quantity,\r\n      rate: line.value.rate,\r\n    };\r\n    \r\n    if (sub_section.value.id) {\r\n      formData.sub_section_id = sub_section.value.id;\r\n    } else {\r\n      formData.section_id = section.value.id;\r\n    }\r\n\r\n    // console.log(formData)\r\n\r\n    // return ;\r\n    const response = await axiosInstance.post('/boq-lines', formData);\r\n\r\n    getBoq(project.value.id)\r\n\r\n    showMessage(\"Line Registered!\");\r\n    document.getElementById('closeLine').click();\r\n    line.value = { name: '', unit: '', quantity: '', rate: '' };\r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.log(error);\r\n  }finally{\r\n    sending.value = false\r\n  }\r\n};\r\n\r\n\r\n   const printBoq = async () => {\r\n   const row = boq.value;\r\n        try {\r\n            const iframe = document.createElement(\"iframe\");\r\n            iframe.style.display = \"none\";\r\n            document.body.appendChild(iframe);\r\n            \r\nconst printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Bill Of Quantity</title>\r\n<style>\r\n  body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; font-size: 13px; color: #222; }\r\n  .header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; }\r\n  .logo { width: 150px; height: auto; }\r\n  .gatepass-box { border: 2px solid #000; padding: 6px 14px; font-weight: bold; font-size: 14px; border-radius: 6px; background: #f9f9f9; box-shadow: 0 0 3px rgba(0,0,0,0.2); }\r\n  .company-title { text-align: center; margin: 25px 0 15px 0; }\r\n  .company-title h2 { margin: 0; font-size: 18px; text-transform: uppercase; }\r\n  .details { margin-top: 15px; line-height: 2; }\r\n  .line-field { display: flex; justify-content: space-between; margin-bottom: 6px; }\r\n  .label { width: 35%; font-weight: bold; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 11px; line-height: 1.4; font-weight: normal; }\r\n  .value { flex: 1; border-bottom: 1px solid #000; text-align: center; padding-bottom: 2px; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 15px; border-radius: 6px; overflow: hidden; }\r\n  table.items thead th { border: 1px solid #000; font-weight: bold; text-align: center; }\r\n  table.items td { border: 1px solid #000; padding: 6px; vertical-align: middle; text-align: center; }\r\n  .signatures { margin-top: 40px; display: flex; justify-content: space-between; align-items: center; }\r\n  .signature-box { text-align: center; width: 45%; }\r\n  .signature-line { margin-top: 50px; border-top: 1px solid #000; width: 80%; margin-left: auto; margin-right: auto; }\r\n  .check-square { width: 20px; height: 20px; border: 1px solid #000; display: inline-block; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n\r\n  thead th {\r\n    background: #f0f0f0 !important;\r\n    color: #000 !important;\r\n  }\r\n\r\n  tr.summary-header,\r\n  tr.boq-header {\r\n    background: #000 !important;\r\n    color: #fff !important;\r\n    -webkit-print-color-adjust: exact !important;\r\n    print-color-adjust: exact !important;\r\n  }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n  <div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"gatepass-box\">\r\n    Date : ${formatDate(project.value.created_at ?? '')}\r\n  </div>\r\n</div>\r\n<div class=\"reg-info\">\r\n  TIN: 135-489-247<br>\r\n  VRN: 40-032826C\r\n</div>\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n\r\n\r\n\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th>CODE/SN</th>\r\n      <th>DESCRIPTION</th>\r\n      <th>UNIT</th>\r\n      <th>QUANTITY</th>\r\n      <th>RATE</th>\r\n      <th>RATE</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr class=\"boq-header\">\r\n      <td colspan=\"6\">Bill of Quantity ${project.value.project_name}</td>\r\n    </tr>\r\n    ${(row).map((series, i) => `\r\n      <tr style=\"border:0.2px solid black\">\r\n        <th colspan=\"1\" class=\"text-center\">SERIES ${i + 1}</th>\r\n        <th colspan=\"5\" style=\"text-align:start\">${series.name}</th>\r\n        ${(series.sections).map((section, j) => `\r\n          <tr style=\"border:0.2px solid black\">\r\n            <th colspan=\"1\" class=\"text-center\">SECTION ${i + 1}.${j + 1}</th>\r\n            <th colspan=\"5\" style=\"text-align:start\">${section.name}</th>\r\n             ${(section.lines).map((line, l) => `\r\n                  <tr>\r\n                    <td class=\"text-center\">${String.fromCharCode(97 + l)}</td>\r\n                    <td class=\"text-start\">${line.name}</td>\r\n                    <td>${line.unit}</td>\r\n                    <td>${line.quantity}</td>\r\n                    <td class=\"text-end\">${line.rate.toLocaleString()}</td>\r\n                    <td class=\"text-end\">${(line.rate * line.quantity).toLocaleString()}</td>\r\n                  </tr>`\r\n                ).join(\"\")}\r\n\r\n            ${(section.sub_sections).map((subsection, k) => `\r\n              <tr style=\"border:0.2px solid black\">\r\n                <th colspan=\"1\" class=\"text-center\">${i + 1}.${j + 1}.${k + 1}</th>\r\n                <th colspan=\"5\" style=\"text-align:start\">${subsection.name}</th>\r\n                ${(subsection.lines).map((line, l) => `\r\n                  <tr>\r\n                    <td class=\"text-center\">${String.fromCharCode(97 + l)}</td>\r\n                    <td class=\"text-start\">${line.name}</td>\r\n                    <td>${line.unit}</td>\r\n                    <td>${line.quantity}</td>\r\n                    <td class=\"text-end\">${line.rate.toLocaleString()}</td>\r\n                    <td class=\"text-end\">${(line.rate * line.quantity).toLocaleString()}</td>\r\n                  </tr>`\r\n                ).join(\"\")}\r\n              </tr>`\r\n            ).join(\"\")}\r\n          </tr>`\r\n        ).join(\"\")}\r\n      </tr>`\r\n    ).join(\"\")}\r\n    ${(!row || row.length === 0) ? `<tr><td colspan=\"4\">No items found</td></tr>` : ''}\r\n\r\n    <tr class=\"summary-header\">\r\n      <th colspan=\"6\" style=\"text-align:center\">Summary</th>\r\n    </tr>\r\n${(() => {\r\n  let grandTotal = 0;\r\n  const rowsHtml = row.map((serie, x) => {\r\n    const total = serie.sections.reduce((sAcc, section) => {\r\n      const sectionLinesTotal = section.lines.reduce(\r\n        (lAcc, line) => lAcc + line.quantity * line.rate,\r\n        0\r\n      );\r\n      const subSectionsTotal = section.sub_sections.reduce((ssAcc, sub) => {\r\n        return ssAcc + sub.lines.reduce((lAcc, line) => lAcc + line.quantity * line.rate, 0);\r\n      }, 0);\r\n      return sAcc + sectionLinesTotal + subSectionsTotal;\r\n    }, 0);\r\n    grandTotal += total;\r\n    return `\r\n      <tr>\r\n        <th colspan=\"5\" style=\"text-align:start\">SERIES ${x + 1}</th>\r\n        <th colspan=\"1\" style=\"text-align:end\">${total.toLocaleString()}</th>\r\n      </tr>\r\n    `;\r\n  }).join(\"\");\r\n  return rowsHtml + `\r\n    <tr>\r\n      <th colspan=\"5\" style=\"text-align:start\">A Total of Bills</th>\r\n      <th colspan=\"1\" style=\"text-align:end\">${grandTotal.toLocaleString()}</th>\r\n    </tr>\r\n  `;\r\n})()}\r\n\r\n  </tbody>\r\n</table>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n\r\n            const iframeDoc = iframe.contentWindow.document;\r\n            iframeDoc.open();\r\n            iframeDoc.write(printContent);\r\n            iframeDoc.close();\r\n\r\n            iframe.onload = () => {\r\n                iframe.contentWindow.focus();\r\n                iframe.contentWindow.print();\r\n                setTimeout(() => {\r\n                    document.body.removeChild(iframe);\r\n                }, 1000);\r\n            };\r\n        } catch (error) {\r\n            console.error('Print error:', error);\r\n            showError(`Failed to print boq ${error.message}`);\r\n        }\r\n    };\r\n\r\n        const mobileView = ref(false)\r\n    const toggleMobileView = () => {\r\n        if (window.innerWidth < 991) {\r\n           mobileView.value = true \r\n        }\r\n    };\r\n\r\n    onMounted(() => {\r\n     toggleMobileView()\r\n     getProjects()\r\n     getUnits()\r\n    });\r\n\r\nconst clickCount = ref(0);\r\nfunction handleClick() {\r\n  if(clickCount.value < 10) {\r\n    clickCount.value++;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.accordion-button {\r\n  background-color: transparent !important;\r\n  /* color: white !important; */\r\n  box-shadow: none !important;\r\n}\r\n\r\n.accordion-button:not(.collapsed) {\r\n  background-color: transparent !important;\r\n  /* color: white !important; */\r\n}\r\n\r\n.accordion-button:focus {\r\n  box-shadow: none !important;\r\n}\r\n\r\ntable {\r\n  width: 100%;\r\n}\r\n\r\nthead th {\r\n  position: sticky;\r\n  top: 0;\r\n  background: #fff; \r\n  z-index: 10;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=dd14d3c8&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\copexErp\\\\frontEnd\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dd14d3c8\"]])\n\nexport default __exports__"],"names":["axiosInstance","axios","baseURL","process","showMessage","inject","showError","formatDate","loadingSpinner","showConfirmation","user_permissions","JSON","parse","localStorage","getItem","permissions","addBoq","ref","project","selectedLine","scrollable","loading","unit","selectLine","line","value","units","find","short_name","editBoqLine","async","payload","name","quantity","rate","put","id","document","getElementById","click","getBoq","error","message","console","log","projects","getProjects","response","get","data","deleteBoqLine","res","refresh","deleteBoqSeries","series","deleteBoqSection","section","deleteBoqSubSection","subsection","getUnits","watch","newValue","boq","registerSeries","sending","formData","project_id","post","registerSection","series_id","newSubSectionName","registerSubSection","section_id","sub_section","no","registerBoqLine","item_no","sub_section_id","printBoq","row","iframe","createElement","style","display","body","appendChild","printContent","created_at","project_name","map","i","sections","j","lines","l","String","fromCharCode","toLocaleString","join","sub_sections","k","length","grandTotal","rowsHtml","serie","x","total","reduce","sAcc","sectionLinesTotal","lAcc","subSectionsTotal","ssAcc","sub","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","mobileView","toggleMobileView","window","innerWidth","onMounted","clickCount","handleClick","__exports__"],"sourceRoot":""}