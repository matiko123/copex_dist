{"version":3,"file":"js/1874.d578a2ca.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/hr/encashment/list.vue","webpack://cork-vue3/./src/views/hr/encashment/list.vue?85a0"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">HR</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Leave</span></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Balance</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n\r\n            <h3 class=\"text-center\">LEAVE ENCASHMENT HISTORY</h3>\r\n\r\n            <div class=\"d-flex me-4 mt-2 \">\r\n                        <div class=\"ms-auto\">\r\n\r\n                           <button class=\"btn btn-success \"\r\n                             @click=\"printEmployees(items)\" \r\n                            >                           \r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n  <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n</svg>\r\n</button>\r\n \r\n                        </div>\r\n                    </div>  \r\n\r\n                    <!-- add leave starts -->\r\n\r\n                     <!-- add leave ends -->\r\n      \r\n        <div class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"employeesList\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge inv-status\" :class=\"'badge-' + props.row.status.color\">\r\n                                    {{ props.row.status.name }}\r\n                                </span>\r\n                            </template>\r\n                            <template #actions=\"props\">\r\n\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-eye text-primary\" viewBox=\"0 0 16 16\"\r\n   data-bs-toggle=\"modal\" data-bs-target=\"#view-leaves\"\r\n   @click=\"selected_encashment = props.row\"\r\n  >\r\n    <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z\"/>\r\n    <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0\"/>\r\n  </svg>\r\n                              \r\n<!-- modal starts -->\r\n\r\n\r\n \r\n                                \r\n                            </template>\r\n                           \r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Modal -->\r\n<div class=\"modal fade mymodal\" id=\"view-leaves\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\" data-bs-backdrop=\"false\">\r\n    <div class=\"modal-dialog modal-xl\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{selected_encashment?.employee?.toUpperCase()}} LEAVE ENCASHMENT REQUEST</h5>\r\n                <button type=\"button\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\" aria-label=\"Close\" class=\"btn-close\" id=\"close-approval\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n        <div class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n          <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">      \r\n<table class=\"table table-bordered\" v-if=\"selected_encashment\">\r\n  <thead class=\"table-light\">\r\n    <tr>\r\n      <th>Date Requested</th>\r\n      <th>Amount</th>\r\n      <th>Status</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td>{{ selected_encashment.date_requested }}</td>\r\n      <td>{{ selected_encashment.amount }}</td>\r\n      <td>\r\n        <span class=\"badge inv-status\" :class=\"'badge-' + selected_encashment.status.color\">\r\n          {{ selected_encashment.status.name }}\r\n        </span>\r\n      </td>\r\n    </tr>\r\n    <tr v-if=\"selected_encashment.remark\">\r\n        <td colspan=\"4\">Remark : {{ selected_encashment.remark }}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n</div>\r\n</div>\r\n                \r\n  <div class=\"d-flex justify-content-center mb-3 mt-2\" v-if=\"selected_encashment.status_id !=3\">\r\n    <div class=\"btn-group\" v-if=\"user_permissions.includes('can_approve_encashment')\">\r\n      <button class=\"btn btn-primary me-2\" @click=\"status = 3\" :disabled=\"spinner\">Approve</button>\r\n      <button class=\"btn btn-danger me-2\" @click=\"status = 4\" :disabled=\"spinner\">Reject</button>\r\n      <button class=\"btn btn-warning me-2\" @click=\"status = 17\" :disabled=\"spinner\">Hold Request</button>\r\n      <button class=\"btn btn-info me-2\" @click=\"status = 14\" :disabled=\"spinner\">Remark</button>\r\n    </div>\r\n  </div>\r\n\r\n  <div v-if=\"status\" class=\"mb-2 text-center\">\r\n    <span\r\n      class=\"badge rounded-pill\"\r\n      :class=\"{\r\n        'bg-danger': status == 4,\r\n        'bg-success': status == 3,\r\n        'bg-warning': status == 17,\r\n        'bg-info': status != 3 && status != 4\r\n      }\"\r\n      style=\"font-size: 1rem;\"\r\n    >\r\n      {{\r\n        status == 3\r\n          ? 'Approve Request'\r\n          : status == 17\r\n            ? 'Hold Request'\r\n          : status == 4\r\n          ? 'Reject Request'\r\n          : 'Fill Remark'\r\n      }}\r\n    </span>\r\n  </div>\r\n\r\n  <div class=\"input-group\" v-if=\"status\">\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control\"\r\n      :placeholder=\"status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark'\"\r\n      v-model=\"remark\"\r\n    >\r\n    <button class=\"btn btn-primary\" type=\"button\" :disabled=\"spinner\" @click=\"updateEncashmentStatus()\">\r\n      <span v-if=\"spinner\" v-html=\"loadingSpinner()\"></span>\r\n      <span v-else>Save</span>\r\n    </button>\r\n  </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n<!-- transaction proof starts -->\r\n       <div class=\"row layout-top-spacing\" v-if=\"selected_encashment.status_id == 3 && user_permissions.includes('is_accountant')\">\r\n        <h3 class=\"text-center m-2\">PROOF OF PAYMENT</h3>\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                      <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                          <label class=\"form-label\">Reference Number </label>\r\n                          <input  class=\"form-control\" type=\"text\"  placeholder=\"Enter Reference Number\" v-model=\"reference_number\">\r\n                        </div>\r\n\r\n                           <div class=\"col-md-6\">\r\n                          <label class=\"form-label\">Paid From </label>\r\n             <multiselect \r\n                v-model=\"account\"\r\n                :options= \"accounts\"\r\n                placeholder=\"Select provider\"\r\n                label=\"name\"\r\n                :searchable = \"true\"        \r\n                multple=\"false\"\r\n                :required=\"true\"\r\n                :allow-empty=\"false\"\r\n           />                      \r\n                        </div>\r\n\r\n                        <div class=\"col-md-3\">\r\n                          <label class=\"form-label\">Amount</label>\r\n                          <input  class=\"form-control\" type=\"number\"  step=\"any\"  placeholder=\"Enter Amount\" v-model=\"amount\">\r\n                        </div>\r\n\r\n                        <div class=\"col-md-4\">\r\n                          <label class=\"form-label\">Receiver</label>\r\n                          <input  class=\"form-control\" type=\"text\"    placeholder=\"Enter Receiver\" v-model=\"receiver\">\r\n                        </div>\r\n\r\n                           <div class=\"col-md-2\">\r\n                          <label class=\"form-label\">Date </label>\r\n                          <input  class=\"form-control\" type=\"date\" v-model=\"date\" >\r\n                        </div>\r\n\r\n                        \r\n                           <div class=\"col-md-3\">\r\n                          <label class=\"form-label\">Attachment </label>\r\n                          <input  class=\"form-control\" type=\"file\"\r\n                            @change=\"handleFileUpload\"\r\n                            accept=\"application/pdf\"\r\n                          >\r\n                        </div>\r\n\r\n                        <div class=\"col-md-12\">\r\n                          <label class=\"form-label\">Remark</label>\r\n                          <input  class=\"form-control\" type=\"text\"    placeholder=\"Enter Remark\" v-model=\"description\">\r\n                        </div>\r\n\r\n                      </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n <!-- transaction proof ends -->\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn bg-danger text-white me-2\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\"><i class=\"flaticon-cancel-12\"></i>CLOSE</button>\r\n                <button type=\"button\" class=\"btn bg-primary text-white\" ><i class=\"flaticon-cancel-12\"></i>SAVE</button>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n <!-- modal ends -->\r\n\r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref ,inject } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    useMeta({ title: 'Custom Table' });\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    const axiosInstance = axios.create({\r\n       baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const spinner = ref(false)\r\n    const remark = ref('')\r\n    const printEmployees = inject('printEmployees')\r\n    const showMessage = inject('showMessage')\r\n    const showError = inject('showError')\r\n    const formatNumber = inject('formatNumber')\r\n    const formatDate = inject('formatDate')\r\n    const name = ref('');\r\n    const columns = ref(['Sno', 'employee','date_requested','amount','status','actions']);\r\n    const columns2 = ref(['Sno', 'start_date','end_date','leave_days','status','remark','actions']);\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const status = ref('')\r\n    const items = ref([]);\r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 , 100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['id', 'service_name'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n\r\n       const addLeave = ref(false)\r\n\r\nconst selected_encashment = ref('')\r\n\r\n    const employeesList = ref([])\r\n\r\nconst getEncashments = async () => {\r\n  const response = await axiosInstance.get('leave-encashments')\r\n\r\n  employeesList.value = response.data.map((item, index) => {\r\n    const approved_leaves = (item.leaves ?? [])\r\n    .filter(leave => leave.status_id === 3)\r\n    .reduce((total, leave) => {\r\n      if (!leave.start_date || !leave.end_date) return total\r\n\r\n      const start = new Date(leave.start_date)\r\n      const end = new Date(leave.end_date)\r\n      const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1\r\n\r\n      return total + days\r\n    }, 0)\r\n\r\n    return {\r\n      ...item,\r\n      Sno: index + 1,\r\n      employee : item.employee.name,\r\n      date_requested : formatDate(item.created_at),\r\n      amount : formatNumber(item.amount)\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\r\n    const updateEncashmentStatus = async()=>{\r\n        const payload = {\r\n            status_id : status.value,\r\n            remark : remark.value\r\n        }\r\n\r\n         try{\r\n           const response = await axiosInstance.put(`leave-encashments/${selected_encashment.value.id}`,payload)\r\n           showMessage('Confirmed')\r\n           document.getElementById('close-approval').click()\r\n           getEncashments()\r\n           remark.value = ''\r\n           status.value = ''\r\n   }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n   }finally{\r\n\r\n   }\r\n\r\n    }\r\n\r\n    const accounts = ref([])\r\nconst account = ref('')\r\nconst getAccounts = async()=>{\r\n          try {\r\n            const response = await axiosInstance.get('account-transaction-points');\r\n            accounts.value = response.data.map((item, index) => ({\r\n                ...item,\r\nname: \r\n  (item?.name ?? '') + ' ' +\r\n  (item?.mobile_money?.name ?? '') + ' ' +\r\n  (item?.mobile_money?.category ?? 'CASH')\r\n            }));\r\n        } catch (error) {\r\n            showError(error.message);\r\n        }finally{\r\n\r\n        }\r\n}\r\n\r\n    onMounted(() => {\r\n        getEncashments()\r\n        getAccounts()\r\n    });\r\n</script>\r\n","import script from \"./list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./list.vue?vue&type=style&index=0&id=2be19366&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","axiosInstance","axios","baseURL","process","spinner","ref","remark","printEmployees","inject","showMessage","showError","formatNumber","formatDate","columns","user_permissions","JSON","parse","localStorage","getItem","permissions","status","items","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","selected_encashment","employeesList","getEncashments","async","response","get","value","data","map","item","index","leaves","leave","status_id","reduce","total","start_date","end_date","start","Date","end","days","Math","ceil","Sno","employee","name","date_requested","created_at","amount","updateEncashmentStatus","payload","put","id","document","getElementById","click","error","message","console","log","accounts","account","getAccounts","mobile_money","category","onMounted","__exports__"],"sourceRoot":""}