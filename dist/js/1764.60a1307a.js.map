{"version":3,"file":"js/1764.60a1307a.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/hr/labour/paymentRequests.vue","webpack://cork-vue3/./src/views/hr/labour/paymentRequests.vue?5c29"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n        <ul class=\"navbar-nav flex-row mt-2\">\r\n            <li>\r\n                <div class=\"page-header\">\r\n                    <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                        <ol class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Labours</a></li>\r\n                            <li class=\"breadcrumb-item active\" aria-current=\"page\"><span> Labour Payment Requests </span></li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n\r\n        <h3 class=\"text-center\">LABOUR PAYMENT REQUESTS</h3>\r\n        <div class=\"d-flex justify-content-end mb-3\" v-if=\"user_permissions.includes('can_issue_labour_payments')\">\r\n            <router-link to=\"/hr/labour/requests\" class=\"btn btn-primary\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-plus-square\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\"/>\r\n  <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4\"/>\r\n</svg>\r\n            </router-link>\r\n        </div>\r\n\r\n              <!-- loading spinner starts -->\r\n        <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n        <!-- Loading spinner ends -->\r\n        <div v-else class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"requests\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                               <span class=\"badge inv-status\" :class=\"'badge-' + props.row.status.class\">{{ props.row.status.key }} </span>\r\n                           </template>\r\n                            <template #actions=\"props\">\r\n                              \r\n                                <a href=\"javascript:;\" class=\"view me-3\" @click=\"openviewModal(props.row)\" data-bs-toggle=\"modal\" :data-bs-target=\"'#payment-request-modal'\">\r\n                                    <svg\r\n                                        xmlns=\"http://www.w3.org/2000/svg\"\r\n                                        width=\"24\"\r\n                                        height=\"24\"\r\n                                        viewBox=\"0 0 24 24\"\r\n                                        fill=\"none\"\r\n                                        stroke=\"currentColor\"\r\n                                        stroke-width=\"2\"\r\n                                        stroke-linecap=\"round\"\r\n                                        stroke-linejoin=\"round\"\r\n                                        class=\"feather feather-eye\"\r\n                                    >\r\n                                        <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"></path>\r\n                                        <circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\r\n                                    </svg>\r\n                                </a>\r\n\r\n                                <a href=\"javascript:;\" class=\"print\" @click=\"openviewModal(props.row); $nextTick(() => printReport())\" v-if=\"user_permissions.includes('can_print_labour_payment_request') && (props.row.status.key === 'approved' || props.row.status.key === 'paid')\">\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-printer text-success\">\r\n                                        <polyline points=\"6 9 6 2 18 2 18 9\"></polyline>\r\n                                        <path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\"></path>\r\n                                        <rect x=\"6\" y=\"14\" width=\"12\" height=\"8\"></rect>\r\n                                    </svg>\r\n                                </a>\r\n                                \r\n                            </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n<div\r\n    class=\"modal fade mymodal\"\r\n    id=\"payment-request-modal\"\r\n    tabindex=\"-1\"\r\n    role=\"dialog\"\r\n    aria-labelledby=\"exampleModalLabel\"\r\n    aria-hidden=\"true\"\r\n    data-bs-backdrop=\"false\" \r\n    ref=\"approvalModal\"\r\n  >\r\n    <div class=\"modal-dialog modal-fullscreen\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\" >Labour Payment Request </h5>\r\n          <button type=\"button\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\" aria-label=\"Close\" class=\"btn-close\" @click=\"clearForm()\" id=\"close-approval-modal\"></button>\r\n        </div>\r\n\r\n           <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3 table-responsive\">\r\n<table class=\"table table-bordered table-striped\">\r\n      <thead >\r\n        <tr>\r\n          <th >Ref No.</th>\r\n          <th >Requester</th>\r\n          <th >Requested</th>\r\n          <th>Approval Group</th>\r\n          <th>Start Date</th>\r\n          <th>End Date</th>\r\n          <th>project</th>\r\n          <th>Print</th>\r\n        </tr>\r\n          \r\n      </thead>\r\n      <tbody>\r\n        <tr >\r\n          <td>00{{ selectedRequest?.id }}</td>\r\n          <td >{{ selectedRequest?.issuer }}</td>\r\n          <td>{{ formatDate(selectedRequest?.date) }}</td>\r\n          <td>{{ selectedRequest?.approval_group }}</td>\r\n          <td>{{ selectedRequest?.start_date }}</td>\r\n          <td>{{ selectedRequest?.end_date }}</td>\r\n          <td>{{ selectedRequest?.project }}</td>\r\n          <td>\r\n            <a href=\"javascript:;\" class=\"print\" @click=\"printReport\" v-if=\"user_permissions.includes('can_print_labour_payment_request') && (selectedRequest?.status?.key === 'approved' || selectedRequest?.status?.key === 'paid')\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-printer text-success\">\r\n                <polyline points=\"6 9 6 2 18 2 18 9\"></polyline>\r\n                <path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\"></path>\r\n                <rect x=\"6\" y=\"14\" width=\"12\" height=\"8\"></rect>\r\n              </svg>\r\n            </a>\r\n          </td>\r\n          </tr>\r\n           <tr v-if=\"selectedRequest?.description\">\r\n      <td colspan=\"8\">\r\n        <b> Brief Description : </b>\r\n        {{ selectedRequest?.description }}\r\n      </td>\r\n      <tr v-if=\"selectedRequest?.remark\">\r\n      <td colspan=\"8\"> <b> Remark :  </b> {{ selectedRequest?.remark }}</td>\r\n      </tr>\r\n    </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    </div>\r\n    </div>\r\n    </div>\r\n             <div class=\"modal-body\">\r\n\r\n                <div \r\n           v-if=\"user_permissions.includes('can_complete_transaction') && selectedRequest?.status?.key === 'approved'\"\r\n           class=\"d-flex justify-content-center mt-2 mb-2\">\r\n    <button class=\"btn btn-primary\" type=\"button\" :disabled=\"loading\" @click=\"complete_transaction =! complete_transaction\">\r\n      <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n      <span v-else>Paid</span>\r\n    </button>\r\n</div>\r\n <form v-if=\"complete_transaction\" @submit.prevent=\"completeTransaction()\">\r\n    <div class=\"input-group container\"  >\r\n  <input type=\"text\" class=\"form-control\"\r\n   placeholder=\"Enter Any remark \"\r\n    v-model=\"remark\">\r\n  <button \r\n  class=\"btn btn-primary me-2\" type=\"submit\" :disabled=\"loading\">\r\n  <span  v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n  <span v-else>Save</span>\r\n  </button>\r\n</div>\r\n </form>\r\n\r\n\r\n<div class=\"d-flex justify-content-center mb-2\"  \r\n    v-if=\"(user_role_id == selectedRequest?.await || user_permissions.includes('is_md')) && selectedRequest?.status?.key !== 'paid'\">    \r\n    <div class=\"btn-group\">\r\n        <button class=\"btn btn-primary me-2\" @click=\"status = 3\" :disabled=\"spinner\">\r\n          Check \r\n        </button>\r\n        <button class=\"btn btn-danger me-2\" @click=\"status = 4\" :disabled=\"spinner\">\r\n          Reject\r\n        </button>\r\n        <button class=\"btn btn-info me-2\" @click=\"status = 14\" :disabled=\"spinner\">\r\n          Remark\r\n        </button>\r\n        <button class=\"btn btn-warning\" @click=\"status = 17\" :disabled=\"spinner\">\r\n           On Hold\r\n        </button>\r\n    </div>\r\n</div>\r\n\r\n      <div v-if=\"status\" class=\"mb-2 text-center\">\r\n        <span\r\n          class=\"badge rounded-pill\"\r\n          :class=\"{\r\n            'bg-danger': status == 4,\r\n            'bg-success': status == 3,\r\n            'bg-info': status == 14,\r\n            'bg-warning': status == 17\r\n          }\"\r\n          style=\"font-size: 1rem;\"\r\n        >\r\n          {{\r\n            status == 3\r\n              ? 'Check / Approve Request'\r\n              : status == 4\r\n              ? 'Reject Request'\r\n              : status == 14 ? 'Fill Remark' : 'On Hold'\r\n          }}\r\n        </span>\r\n      </div>\r\n\r\n<div class=\"input-group\"  v-if=\"status\">\r\n  <input type=\"text\" class=\"form-control\"\r\n    :placeholder=\"status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark'\" \r\n    v-model=\"remark\">\r\n  <button \r\n     @click=\"ApprovePaymentRequest()\"\r\n  class=\"btn btn-primary me-2\" type=\"button\" :disabled=\"spinner\">\r\n  <span v-if=\"spinner\" v-html=\"loadingSpinner()\"></span>\r\n  <span v-else>Save</span>\r\n  </button>\r\n</div>\r\n\r\n  <div class=\"custom-table table3 table-responsive\">\r\n          <table class=\"table\">\r\n  <thead>\r\n    <tr>\r\n      <th v-for=\"chain in approvalChain\" :key=\"chain.role_id || chain.position || chain.name\">\r\n        {{ chain.name }} <br/>\r\n      </th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td\r\n        v-for=\"(role, idx) in approvalChain\"\r\n        :key=\"role.role_id || role.position || idx\"\r\n        :class=\"role?.status?.color ? 'text-' + role.status.color : 'text-danger'\"\r\n      >\r\n        <span> {{ role?.status?.name ?? 'Unchecked' }}</span><br/>\r\n        <span class=\"text-dark\" v-if=\"role.approved_at\">\r\n          Checked At: {{ formatDate(role.approved_at) }}\r\n        </span><br>\r\n        <span class=\"text-dark\" v-if=\"role.remark\">\r\n          Remark: {{ role.remark }}\r\n        </span>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n</div>\r\n\r\n<div class=\"panel p-0 mt-3\">\r\n    <h5 class=\"text-center mt-3\">LABOUR PAYMENTS</h5>\r\n    <div class=\"custom-table table3 table-responsive\">\r\n        <table class=\"table table-bordered table-striped\">\r\n            <thead>\r\n                <tr>\r\n                    <th>No.</th>\r\n                    <th>Labour Name</th>\r\n                    <th>Labour Type</th>\r\n                    <th>phone number</th>\r\n                    <th v-for=\"date in dateColumnsForLabourTable\" :key=\"date\">{{ date }}</th>\r\n                    <th class=\"text-right\">No. Days Rate</th>\r\n                    <th class=\"text-right\">Rate</th>\r\n                    <th class=\"text-right\">Total</th>\r\n                    <th class=\"text-right\">action</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr v-for=\"(labour, index) in formattedLabourData\" :key=\"labour.labour_name\">\r\n                    <td>{{ index + 1 }}</td>\r\n                    <td>{{ labour.labour_name || 'N/A' }}</td>\r\n                    <td>{{ labour.labour_type || 'N/A' }}</td>\r\n                    <td>{{ labour.phone_number || '--' }}</td>\r\n                    <td v-for=\"date in dateColumnsForLabourTable\" :key=\"date\" class=\"text-center\">\r\n                        {{ labour.attendance[date] || 0 }}\r\n                    </td>\r\n                    <td class=\"text-right\">{{ labour.daysWorked }}</td>\r\n                    <td class=\"text-right\">{{ formatNumber(labour.rate) }}</td>\r\n                    <td class=\"text-right\">{{ formatNumber(labour.totalAmount) }}</td>\r\n                    <td>\r\n                        <button class=\"btn btn-primary\" \r\n                                data-bs-toggle=\"modal\" \r\n                                data-bs-target=\"#payment-proof\" \r\n                                @click=\"openProofModalForLabour(labour)\"\r\n                                v-if=\"user_permissions.includes('can_complete_transaction') && selectedRequest?.status?.key === 'approved'\">\r\n                            Paid\r\n                        </button>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n            <tfoot>\r\n                <tr style=\"background-color: #f0f0f0;\">\r\n                    <td colspan=\"4\" class=\"text-right\"><strong>TOTAL:</strong></td>\r\n                    <td v-for=\"date in dateColumnsForLabourTable\" :key=\"date\" class=\"text-center\">\r\n                        <strong>{{ dateTotalsForLabourTable[date] || 0 }}</strong>\r\n                    </td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td class=\"text-right\"><strong>{{ formatNumber(totalLabourAmount) }}</strong></td>\r\n                    <td></td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n    <!-- Items table -->\r\n     <div class=\"panel p-0 mt-3\">\r\n    <div class=\"d-flex justify-content-center align-items-center mt-3 mb-2 px-3 position-relative\">\r\n        <h5 class=\"mb-0\">LABOUR ATTENDANCE AND SITE WORKS</h5>\r\n        <a href=\"javascript:;\" class=\"print position-absolute end-0 me-3 ms-5\" @click=\"printAttendance()\" v-if=\"user_permissions.includes('can_print_labour_attendance') && selectedRequest?.status?.key === 'approved'\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-printer text-success\">\r\n                <polyline points=\"6 9 6 2 18 2 18 9\"></polyline>\r\n                <path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\"></path>\r\n                <rect x=\"6\" y=\"14\" width=\"12\" height=\"8\"></rect>\r\n            </svg>\r\n        </a>\r\n    </div>\r\n    <div class=\"custom-table table3\">\r\n        <v-client-table\r\n            :data=\"selectedItems\"\r\n            :columns=\"itemColumns\"\r\n            :options=\"table_option\"\r\n        />\r\n    </div>\r\n</div>\r\n\r\n<div class=\"row layout-top-spacing\" v-if=\"approvalTransactions.length > 0\">\r\n          <h4 class=\"text-center\">PROOF OF PAYMENT</h4>\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"approvalTransactions\" :columns=\"approval_transactions_columns\" :options=\"table_option\">\r\n                   \r\n                            <template #attachment=\"props\">\r\n                                <a :href=\"props.row.attachment\"\r\n                                          target=\"_blank\"\r\n                                          class=\"badge badge-primary text-white\"\r\n                                          style=\"cursor: pointer;\"\r\n                                          @click=\"fillTransaction(props.row)\"\r\n                                >\r\n                                    Open Attachment\r\n                              </a>\r\n                            </template>\r\n\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"row layout-top-spacing\" v-if=\"flattenedDebtData.length > 0\">\r\n          <h4 class=\"text-center\">LABOUR DEBTS</h4>\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"flattenedDebtData\" :columns=\"debtTableColumns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge inv-status\" :class=\"'badge-' + props.row.status_color\">\r\n                                    {{ props.row.status }}\r\n                                </span>\r\n                            </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n</div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-primary \" data-dismiss=\"modal\" data-bs-dismiss=\"modal\" @click=\"clearForm()\">close</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n                 <!-- payment modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"payment-proof\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-fullscreen\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">\r\n          PROOF OF PAYMENT - {{ selectedLabourForProof?.labour_name || 'Labour' }}\r\n        </h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close-proof-modal\" @click=\"selectedLabourForProof = null\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"panel p-0 mt-3\">\r\n          <h5 class=\"text-center mt-3\">LABOUR PAYMENT DETAILS</h5>\r\n          <div class=\"custom-table table3\">\r\n            <table class=\"table table-bordered table-striped\">\r\n              <thead>\r\n                <tr>\r\n                  <th>No.</th>\r\n                  <th>Labour Name</th>\r\n                  <th>Labour Type</th>\r\n                  <th v-for=\"date in filteredLabourTableForProof.dateColumns\" :key=\"date\">{{ date }}</th>\r\n                  <th class=\"text-right\">No. Days Rate</th>\r\n                  <th class=\"text-right\">Rate</th>\r\n                  <th class=\"text-right\">Total</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody v-html=\"filteredLabourTableForProof.rows\"></tbody>\r\n              <tfoot>\r\n                <tr style=\"background-color: #f0f0f0;\">\r\n                  <td colspan=\"3\" class=\"text-right\"><strong>TOTAL:</strong></td>\r\n                  <td v-for=\"date in filteredLabourTableForProof.dateColumns\" :key=\"date\" class=\"text-center\">\r\n                    <strong>{{ filteredLabourTableForProof.dateTotals[date] || 0 }}</strong>\r\n                  </td>\r\n                  <td class=\"text-right\"><strong>{{ filteredLabourTableForProof.dateColumns.length > 0 ? Object.values(selectedLabourForProof?.attendance || {}).reduce((sum, val) => sum + val, 0) : 0 }}</strong></td>\r\n                  <td></td>\r\n                  <td class=\"text-right\"><strong>{{ formatNumber(filteredLabourTableForProof.totalAmount) }}</strong></td>\r\n                </tr>\r\n              </tfoot>\r\n            </table>\r\n          </div>\r\n        </div>\r\n       <div class=\"row layout-top-spacing\" >\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                      <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                          <label class=\"form-label\">Reference Number </label>\r\n                          <input  class=\"form-control\" type=\"text\"  placeholder=\"Enter Reference Number\" v-model=\"reference_number\">\r\n                        </div>\r\n\r\n                           <div class=\"col-md-6\">\r\n                          <label class=\"form-label\">Paid From </label>\r\n             <multiselect \r\n                v-model=\"account\"\r\n                :options= \"accounts\"\r\n                placeholder=\"Select Account\"\r\n                label=\"name\"\r\n                :searchable = \"true\"        \r\n                multple=\"false\"\r\n                :required=\"true\"\r\n                :allow-empty=\"false\"\r\n           />                      \r\n                        </div>\r\n\r\n                        <div class=\"col-md-3\">\r\n                          <label class=\"form-label\">Amount</label>\r\n                          <input  class=\"form-control\" type=\"number\"  step=\"any\"  placeholder=\"Enter Amount\" v-model=\"amount\">\r\n                        </div>\r\n\r\n                        <div class=\"col-md-4\">\r\n                          <label class=\"form-label\">Receiver</label>\r\n                          <input  class=\"form-control\" type=\"text\"    placeholder=\"Enter Receiver\" v-model=\"receiver\">\r\n                        </div>\r\n\r\n                           <div class=\"col-md-2\">\r\n                          <label class=\"form-label\">Date </label>\r\n                          <input  class=\"form-control\" type=\"date\" v-model=\"date\" >\r\n                        </div>\r\n\r\n                        \r\n                           <div class=\"col-md-3\">\r\n                          <label class=\"form-label\">Attachment </label>\r\n                          <input  class=\"form-control\" type=\"file\"\r\n                            @change=\"handleFileUpload\"\r\n                            accept=\"application/pdf\"\r\n                          >\r\n                        </div>\r\n\r\n                        <div class=\"col-md-12\">\r\n                          <label class=\"form-label\">Remark</label>\r\n                          <input  class=\"form-control\" type=\"text\"    placeholder=\"Enter Remark\" v-model=\"description\">\r\n                        </div>\r\n\r\n                      </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger me-2\" data-bs-dismiss=\"modal\" @click=\"selectedLabourForProof = null\">Close</button>\r\n        <button type=\"button\" class=\"btn btn-success\" @click=\"submitProof()\" :disabled=\"submitting\">\r\n          <span v-if=\"submitting\" v-html=\"loadingSpinner()\"></span>\r\n          <span v-else>Save</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- payment modal ends -->\r\n    \r\n    </div>\r\n</template>\r\n\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n\r\n<script setup>\r\n    import { onMounted, ref, inject, watch, computed } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    \r\n    useMeta({ title: 'Labour Payment Requests' });  \r\n    \r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const user_role_id = ref(JSON.parse(localStorage.getItem('user')).role);\r\n    const user_id = ref(JSON.parse(localStorage.getItem('user')).id);\r\n    const formatDate = inject('formatDate');\r\n    const formatNumber = inject('formatNumber');\r\n    const tableShimmer = inject('tableShimmer');\r\n    const loadingSpinner = inject('loadingSpinner'); \r\n    const complete_transaction = ref(false);\r\n    const loading_spinner = ref(false);\r\n    const approval_transactions_columns = ref(['Sno','ref_no','issuer','host','amount','direction','target_account','attachment','date']);    \r\n    const columns = ref(['SNo','project','start_date', 'end_date','approval_group','issuer','description','awaits','status','actions']);    \r\n    const name = ref('');\r\n    const quantity = ref('');\r\n    const items = ref([]);\r\n    const requests = ref([]);\r\n    const awaiter = ref('');\r\n\r\n    \r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 ,100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const approvalChain = computed(() => {\r\n    return selectedRequest.value?.roles_sequence ?? [];\r\n});\r\n\r\nconst formatTableDate = (dateString) => {\r\n    if (!dateString) return '';\r\n    \r\n    const date = new Date(dateString);\r\n    if (isNaN(date.getTime())) return dateString;\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const year = String(date.getFullYear()).slice(-2);\r\n    \r\n    return `${day}.${month}.${year}`;\r\n};\r\n\r\n    const getLabourPaymentRequests = async () => {\r\n        loading_spinner.value = true;\r\n        try {\r\n            const response = await axiosInstance.get('labour-payment-requests');\r\n            requests.value = response.data.map((item, index) => ({\r\n                ...item,\r\n                SNo: index + 1,\r\n                id: item.id,\r\n                date: formatDate(item.created_at),\r\n                awaits: item.awaiting_approval?.name || 'no one',\r\n                project: item.project.short_name,\r\n                issuer: item.issuer.name,\r\n                approval_group: item.approval_group.name, \r\n                start_date: item.start_date,\r\n                end_date: item.end_date,\r\n                status: {\r\n                    key: item.status.name,\r\n                    class: item.status.color\r\n                },               \r\n                              \r\n            }));\r\n        } catch (error) {\r\n            console.log(error);\r\n            showError(error.message);\r\n        }finally{\r\n            loading_spinner.value = false;\r\n        }\r\n    };\r\n\r\n    const selectedRequest = ref(null);\r\nconst selectedItems = ref([]);\r\n\r\nconst status = ref(null); \r\nconst remark = ref(''); \r\n\r\nconst openviewModal = (row) => {\r\n    console.log(row);\r\n    selectedRequest.value = row;\r\n    awaiter.value = row.awaitingApproval;\r\n\r\n    selectedItems.value = row.items.map((item, index) => ({\r\n        SNo: index + 1,\r\n        labour: item.attendance.labour,\r\n        labour_name: item.attendance.labour_name,\r\n        labour_type: item.attendance.labour_type.name,\r\n        phone_number: item.attendance.labour?.phone_no,\r\n        task: item.attendance.task,\r\n        rate: formatNumber(item.attendance.labour_type.rate),\r\n        date:item.attendance.created_at,\r\n        attendance_date:formatDate(item.attendance.created_at),\r\n        labour_debt: item.attendance.labour?.labour_debt || []\r\n    }));\r\n    getApprovalTransactions();\r\n};\r\n\r\nconst clearForm = () => {\r\n    selectedRequest.value = null;\r\n    selectedItems.value = [];\r\n    status.value = null;\r\n    remark.value = '';\r\n};\r\n\r\nconst itemColumns = ref([\r\n    'SNo',\r\n    'labour_name',\r\n    'labour_type',\r\n    'task',\r\n    'rate',\r\n    'attendance_date'\r\n]);\r\n\r\n\r\nconst spinner = ref(false);\r\nconst ApprovePaymentRequest = async () => {\r\n    try {\r\n        spinner.value = true;\r\n        const payload = {\r\n            labour_payment_request_id: selectedRequest.value.id,\r\n            approval_role_id: user_role_id.value,\r\n            status_id: status.value,\r\n            remark: remark.value\r\n        };\r\n        await axiosInstance.post('labour-payment-approval-chains', payload);\r\n        showMessage(\r\n            status.value === 3 ? 'Request Approved' :\r\n            status.value === 4 ? 'Request Rejected' :\r\n            status.value === 14 ? 'Request Remarked' :\r\n            status.value === 17 ? 'Request On Hold' :\r\n            'Action Recorded'\r\n        );\r\n        getLabourPaymentRequests();\r\n        status.value = null;\r\n        remark.value = '';\r\n        document.getElementById('close-approval-modal').click();\r\n    } catch (error) {\r\n        console.log(error)\r\n        showError(error.message);\r\n    } finally {\r\n        spinner.value = false;\r\n    }\r\n};\r\n\r\nconst printReport = async () => {\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n\r\n    const startDate = new Date(selectedRequest.value?.start_date);\r\n    const endDate = new Date(selectedRequest.value?.end_date);\r\n    const dateColumns = [];\r\n    const dateKeys = [];\r\n    let currentDate = new Date(startDate);\r\n    \r\n    while (currentDate <= endDate) {\r\n      const formattedDate = formatTableDate(currentDate);\r\n      const dateKey = currentDate.toISOString().split('T')[0];\r\n      dateColumns.push(formattedDate);\r\n      dateKeys.push(dateKey);\r\n      currentDate.setDate(currentDate.getDate() + 1);\r\n    }\r\n\r\n    const labourAttendance = {};\r\n    \r\n    selectedItems.value.forEach(item => {\r\n      if (!labourAttendance[item.labour_name]) {\r\n        labourAttendance[item.labour_name] = {\r\n          labour_name: item.labour_name,\r\n          labour_type: item.labour_type,\r\n          phone_number: item.phone_number,\r\n          rate: item.rate,\r\n          attendance: {}\r\n        };\r\n      }\r\n      \r\n      const itemDate = new Date(item.date);\r\n      const itemDateKey1 = itemDate.toISOString().split('T')[0];\r\n      const itemDateKey2 = formatTableDate(itemDate);\r\n      \r\n      const dateIndex = dateKeys.findIndex(key => \r\n        key === itemDateKey1 || \r\n        formatTableDate(new Date(key)) === itemDateKey2\r\n      );\r\n      \r\n      if (dateIndex !== -1) {\r\n        const dateCol = dateColumns[dateIndex];\r\n        labourAttendance[item.labour_name].attendance[dateCol] = 1;\r\n      }\r\n    });\r\n\r\n    const dateTotals = {};\r\n    dateColumns.forEach(dateCol => {\r\n      dateTotals[dateCol] = Object.values(labourAttendance).reduce((sum, labour) => {\r\n        return sum + (labour.attendance[dateCol] || 0);\r\n      }, 0);\r\n    });\r\n\r\nconst tableRows = Object.values(labourAttendance).map((labour, index) => {\r\n  const dateCells = dateColumns.map(dateCol => {\r\n    const attended = labour.attendance[dateCol] || 0;\r\n    return `<td class=\"text-center\">${attended}</td>`;\r\n  }).join('');\r\n\r\n  const daysWorked = Object.values(labour.attendance).reduce((sum, val) => sum + val, 0);\r\n  const rate = typeof labour.rate === 'string' ? parseFloat(labour.rate.replace(/,/g, '')) : labour.rate;\r\n  const totalAmount = daysWorked * (isNaN(rate) ? 0 : rate);\r\n  \r\n  return `\r\n  <tr>\r\n    <td>${index + 1}</td>\r\n    <td>${labour.labour_name || 'N/A'}</td>\r\n    <td>${labour.labour_type || 'N/A'}</td>\r\n    <td>${labour.phone_number || '--'}</td>\r\n    ${dateCells}\r\n    <td class=\"text-right\">${daysWorked}</td> \r\n    <td class=\"text-right\">${labour.rate || '0'}</td>\r\n    <td class=\"text-right\">${formatNumber(totalAmount)}</td>\r\n  </tr>\r\n  `;\r\n});\r\n\r\n    const dateTotalsRow = dateColumns.map(dateCol => {\r\n      return `<td class=\"text-center\"><strong>${dateTotals[dateCol]}</strong></td>`;\r\n    }).join('');\r\n\r\n    const totalAmount = Object.values(labourAttendance).reduce((sum, labour) => {\r\n      const daysWorked = Object.values(labour.attendance).reduce((daySum, val) => daySum + val, 0);\r\n      const rate = typeof labour.rate === 'string' ? parseFloat(labour.rate.replace(/,/g, '')) : labour.rate;\r\n      return sum + (daysWorked * (isNaN(rate) ? 0 : rate));\r\n    }, 0);\r\n\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Labour Payment Request Report</title>\r\n<style>\r\n  body { font-family: 'Courier New', monospace; margin: 40px; font-size: 13px; }\r\n  .text-style { font-family: 'Courier New', monospace; }\r\n  .company-title { text-align: center; }\r\n  .title { text-align: center; font-size: 16px; margin: 10px 0; white-space: nowrap; }\r\n  .info-section { margin: 20px 0; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }\r\n  .info-row { margin: 5px 0; }\r\n  .description { margin: 20px 0; padding: 10px; text-align: justify; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n  th, td { border: 0.5px solid #000; padding: 6px; }\r\n  th { background-color: #f8f8f8; font-weight: bold; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  .text-success { color: green; }\r\n  .text-danger { color: red; }\r\n  hr { border: 0; border-top: 0.5px solid #000; margin: 0px 0; }\r\n  @media print { body { margin: 10mm; } }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"company-title text-style\">\r\n  <i>\r\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\r\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\r\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\r\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\r\n  </i>\r\n</div>\r\n\r\n<hr style=\"margin-top:20px\">\r\n\r\n<div class=\"title text-style\">\r\n  LABOUR PAYMENT REQUEST (${selectedRequest.value?.start_date || '--'} to ${selectedRequest.value?.end_date || '--'}) - ${selectedRequest.value?.project || 'N/A'}\r\n</div>\r\n\r\n<hr>\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>No.</th>\r\n      <th>Labour Name</th>\r\n      <th>Labour Type</th>\r\n      <th>Phone Number</th>\r\n      ${dateColumns.map(date => `<th>${date}</th>`).join('')}\r\n      <th class=\"text-right\">Days Rate</th>\r\n      <th class=\"text-right\">Rate</th>\r\n      <th class=\"text-right\">Total</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${tableRows.join('')}\r\n    <tr style=\"background-color: #f0f0f0;\">\r\n      <td colspan=\"4\" class=\"text-right\"><strong>TOTAL:</strong></td>\r\n      ${dateTotalsRow}\r\n      <td colspan=\"2\"></td>\r\n      <td class=\"text-right\"><strong>${formatNumber(totalAmount)}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n${selectedRequest.value?.description ? `\r\n<div class=\"description\">\r\n  <p><strong>Note:</strong> ${selectedRequest.value.description}</p>\r\n</div>\r\n` : ''}\r\n\r\n<h3 class=\"text-center\">APPROVAL CHAIN</h3>\r\n<table class=\"signatures\" style=\"margin-top: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      ${selectedRequest.value?.roles_sequence?.map(role => `\r\n      <td style=\"border-bottom:1px solid #000;border-top:1px solid #fff;border-right:1px solid #fff;border-left:1px solid #fff;\" class=\"text-center ${role?.status?.id == 3 ? 'text-success' : 'text-danger'}\">${role?.status?.name ?? 'Pending'}</td>\r\n      `).join('')}\r\n    </tr>\r\n  </tbody>\r\n  <tfoot>\r\n    <tr>\r\n      ${selectedRequest.value?.roles_sequence?.map(role => `\r\n      <th style=\"border-bottom:1px solid #fff;border-top:1px solid #fff;border-right:55px solid #fff;border-left:1px solid #fff;\">${role.name || 'N/A'}</th>\r\n      `).join('')}\r\n    </tr>\r\n  </tfoot>\r\n</table>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print report: ${error.message}`);\r\n  }\r\n};\r\n\r\nconst formattedLabourData = ref([]);\r\nconst dateColumnsForLabourTable = ref([]);\r\nconst dateTotalsForLabourTable = ref({});\r\nconst totalLabourAmount = ref(0);\r\n\r\nwatch([selectedItems, selectedRequest], () => {\r\n  if (selectedItems.value.length && selectedRequest.value) {\r\n    formatLabourData();\r\n  }\r\n}, { immediate: true });\r\n\r\nconst formatLabourData = () => {\r\n  if (!selectedItems.value.length || !selectedRequest.value) {\r\n    formattedLabourData.value = [];\r\n    dateColumnsForLabourTable.value = [];\r\n    dateTotalsForLabourTable.value = {};\r\n    totalLabourAmount.value = 0;\r\n    return;\r\n  }\r\n\r\n  const startDate = new Date(selectedRequest.value.start_date);\r\n  const endDate = new Date(selectedRequest.value.end_date);\r\n  const dateColumns = [];\r\n  const dateKeys = [];\r\n  \r\n  let currentDate = new Date(startDate);\r\n  while (currentDate <= endDate) {\r\n    const formattedDate = formatTableDate(currentDate);\r\n    dateColumns.push(formattedDate);\r\n    dateKeys.push(currentDate.toISOString().split('T')[0]);\r\n    currentDate.setDate(currentDate.getDate() + 1);\r\n  }\r\n  \r\n  dateColumnsForLabourTable.value = dateColumns;\r\n\r\n  const labourAttendance = {};\r\n  selectedItems.value.forEach(item => {\r\n    if (!labourAttendance[item.labour_name]) {\r\n      labourAttendance[item.labour_name] = {\r\n        labour_name: item.labour_name,\r\n        labour_type: item.labour_type,\r\n        phone_number: item.phone_number,\r\n        rate: item.rate,\r\n        attendance: {},\r\n        daysWorked: 0,\r\n        totalAmount: 0\r\n      };\r\n    }\r\n    \r\n    const itemDate = new Date(item.date);\r\n    const itemKey = itemDate.toISOString().split('T')[0];\r\n    const dateIndex = dateKeys.findIndex(key => key === itemKey);\r\n    \r\n    if (dateIndex !== -1) {\r\n      labourAttendance[item.labour_name].attendance[dateColumns[dateIndex]] = 1;\r\n    }\r\n  });\r\n\r\n  const dateTotals = {};\r\n  dateColumns.forEach(date => {\r\n    dateTotals[date] = 0;\r\n  });\r\n\r\n  const formattedData = Object.values(labourAttendance).map(labour => {\r\n    labour.daysWorked = Object.values(labour.attendance).reduce((sum, val) => sum + val, 0);\r\n \r\n    const rate = typeof labour.rate === 'string' \r\n      ? parseFloat(labour.rate.replace(/,/g, '')) \r\n      : parseFloat(labour.rate) || 0;\r\n    \r\n    labour.totalAmount = labour.daysWorked * rate;\r\n    labour.rate = rate;\r\n \r\n    dateColumns.forEach(date => {\r\n      dateTotals[date] += labour.attendance[date] || 0;\r\n    });\r\n    \r\n    return labour;\r\n  });\r\n\r\n  dateTotalsForLabourTable.value = dateTotals;\r\n  formattedLabourData.value = formattedData;\r\n  totalLabourAmount.value = formattedData.reduce((sum, labour) => sum + labour.totalAmount, 0);\r\n};\r\n\r\nconst printAttendance = async () => {\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n\r\n    const totalLabours = selectedItems.value.length;\r\n\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Labour Attendance Report</title>\r\n<style>\r\n  body { font-family: 'Courier New', monospace; margin: 40px; font-size: 13px; }\r\n  .text-style { font-family: 'Courier New', monospace; }\r\n  .company-title { text-align: center; }\r\n  .title { text-align: center; font-size: 16px; margin: 10px 0; white-space: nowrap; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n  th, td { border: 0.5px solid #000; padding: 6px; }\r\n  th { background-color: #f8f8f8; font-weight: bold; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  hr { border: 0; border-top: 0.5px solid #000; margin: 0px 0; }\r\n  @media print { body { margin: 10mm; } }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"company-title text-style\">\r\n  <i>\r\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\r\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\r\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\r\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\r\n  </i>\r\n</div>\r\n\r\n<hr style=\"margin-top:20px\">\r\n\r\n<div class=\"title text-style\">\r\n  LABOUR ATTENDANCE (${selectedRequest.value?.start_date || '--'} to ${selectedRequest.value?.end_date || '--'}) - ${selectedRequest.value?.project || 'N/A'}\r\n</div>\r\n\r\n<hr>\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>No.</th>\r\n      <th>Labour Name</th>\r\n      <th>Labour Type</th>\r\n      <th>Task</th>\r\n      <th>Attendance Date</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${selectedItems.value.map((item, index) => `\r\n    <tr>\r\n      <td>${index + 1}</td>\r\n      <td>${item.labour_name || 'N/A'}</td>\r\n      <td>${item.labour_type || 'N/A'}</td>\r\n      <td>${item.task || 'N/A'}</td>\r\n      <td>${item.attendance_date || 'N/A'}</td>\r\n    </tr>\r\n    `).join('')}\r\n  </tbody>\r\n  <tfoot>\r\n    <tr style=\"background-color: #f0f0f0;\">\r\n      <td colspan=\"5\" class=\"text-right\"><strong>Total Number of Labours: ${totalLabours}</strong></td>\r\n    </tr>\r\n  </tfoot>\r\n</table>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print attendance report: ${error.message}`);\r\n  }\r\n};\r\n\r\nconst proof = ref('')\r\nconst fillProofData = ()=>{\r\n  getAccounts()\r\n}\r\nconst accounts = ref([])\r\nconst account = ref('')\r\nconst getAccounts = async()=>{\r\n          try {\r\n            const response = await axiosInstance.get('account-transaction-points');\r\n            accounts.value = response.data.map((item, index) => ({\r\n                ...item,\r\nname: \r\n  (item?.name ?? '') + ' ' +\r\n  (item?.mobile_money?.name ?? '') + ' ' +\r\n  (item?.mobile_money?.category ?? 'CASH')\r\n            }));\r\n        } catch (error) {\r\n            showError(error.message);\r\n        }finally{\r\n\r\n        }\r\n}\r\n\r\nconst date = ref(new Date().toISOString().slice(0, 10))\r\nconst receiver = ref('')\r\nconst amount = ref('')\r\nconst reference_number = ref('')\r\nconst attachment = ref('')\r\nconst description = ref('')\r\nconst submitting = ref(false);\r\nconst submitProof = async()=>{\r\n  submitting.value = true;\r\n    const payload = new FormData();\r\n    payload.append(\"reference_number\", reference_number.value);\r\n    payload.append(\"account_transaction_point_id\", account.value.id);\r\n    payload.append(\"host\", receiver.value);\r\n    payload.append(\"amount\", amount.value);\r\n    payload.append(\"description\", description.value);\r\n    payload.append(\"issuer_id\", user_id.value);\r\n    payload.append(\"approval_item_id\", selectedRequest.value.id);\r\n    payload.append(\"direction\", 'DECREMENT');\r\n    payload.append(\"opening_balance\", account.value.transactions_sum);\r\n    payload.append(\"date\", date.value);\r\n    if (attachment.value instanceof File) {\r\n        payload.append(\"attachment\", attachment.value);\r\n    }\r\n\r\n    try{\r\n      const response =  await axiosInstance.post('account-transactions',payload)\r\n       showMessage(response.data.message)\r\n       document.getElementById('close-proof-modal').click()\r\n    }catch(error){\r\n      showError(error.message)\r\n      console.log(error)\r\n    }finally{\r\n      submitting.value = false; \r\n    }\r\n}\r\n\r\nconst handleFileUpload = (e) => {\r\n  attachment.value = e.target.files[0];\r\n};\r\n\r\nconst selectedLabourForProof = ref(null);\r\nconst openProofModalForLabour = (labour) => {\r\n  selectedLabourForProof.value = labour;\r\n  getAccounts();\r\n  clearProofForm();\r\n};\r\n\r\nconst clearProofForm = () => {\r\n  account.value = '';\r\n  receiver.value = '';\r\n  amount.value = '';\r\n  reference_number.value = '';\r\n  description.value = '';\r\n  attachment.value = null;\r\n  date.value = new Date().toISOString().slice(0, 10);\r\n};\r\n\r\n\r\nconst filteredLabourTableForProof = computed(() => {\r\n  if (!selectedLabourForProof.value || !selectedItems.value.length || !selectedRequest.value) {\r\n    return { \r\n        dateColumns: [], \r\n        rows: '', \r\n        dateTotals: {}, \r\n        totalAmount: 0 \r\n    };\r\n  }\r\n  const startDate = new Date(selectedRequest.value.start_date);\r\n  const endDate = new Date(selectedRequest.value.end_date);\r\n  const dateColumns = [];\r\n  const dateKeys = [];\r\n  \r\n  let currentDate = new Date(startDate);\r\n  while (currentDate <= endDate) {\r\n      const formattedDate = formatTableDate(currentDate);\r\n      dateColumns.push(formattedDate);\r\n      dateKeys.push(currentDate.toISOString().split('T')[0]);\r\n      currentDate.setDate(currentDate.getDate() + 1);\r\n  }\r\n\r\n  const labourAttendanceArray = [selectedLabourForProof.value];\r\n  const dateTotals = {};\r\n  dateColumns.forEach(d => {\r\n      dateTotals[d] = labourAttendanceArray.reduce((sum, labour) => {\r\n          return sum + (labour.attendance[d] || 0);\r\n      }, 0);\r\n  });\r\n\r\n  const rows = labourAttendanceArray.map((labour, index) => {\r\n      const dateCells = dateColumns.map(d => {\r\n          return `<td class=\"text-center\">${labour.attendance[d] || 0}</td>`;\r\n      }).join('');\r\n      \r\n      const daysWorked = Object.values(labour.attendance).reduce((sum, val) => sum + val, 0);\r\n      \r\n      const rate = typeof labour.rate === 'string' \r\n          ? parseFloat(labour.rate.replace(/,/g, '')) \r\n          : parseFloat(labour.rate) || 0;\r\n      \r\n      const totalAmount = daysWorked * rate;\r\n      \r\n      return `\r\n      <tr>\r\n          <td>${index + 1}</td>\r\n          <td>${labour.labour_name || 'N/A'}</td>\r\n          <td>${labour.labour_type || 'N/A'}</td>\r\n          ${dateCells}\r\n          <td class=\"text-right\">${daysWorked}</td> \r\n          <td class=\"text-right\">${formatNumber(rate)}</td>\r\n          <td class=\"text-right\">${formatNumber(totalAmount)}</td>\r\n      </tr>`;\r\n  }).join('');\r\n\r\n  const totalAmount = labourAttendanceArray.reduce((sum, labour) => {\r\n      const daysWorked = Object.values(labour.attendance).reduce((s, v) => s + v, 0);\r\n      const rate = typeof labour.rate === 'string' \r\n          ? parseFloat(labour.rate.replace(/,/g, '')) \r\n          : parseFloat(labour.rate) || 0;\r\n      return sum + (daysWorked * rate);\r\n  }, 0);\r\n\r\n  return {\r\n      dateColumns,\r\n      rows,\r\n      dateTotals,\r\n      totalAmount\r\n  };\r\n});\r\n\r\n\r\n const approvalTransactions = ref([])\r\n    const getApprovalTransactions = async () => {\r\n              approvalTransactions.value = []\r\n   try{\r\n      const response = await axiosInstance.get(`account-transactions?approval_item_id=${selectedRequest.value.id}`)\r\n      approvalTransactions.value = response.data.map((item,index)=>({\r\n    ...item,\r\n    Sno : index + 1,\r\n    attachment :  process.env.VUE_APP_API_BASE_URL+'../../'+ item.attachment,\r\n    amount : formatNumber(item.amount),\r\n    date : formatDate(item.date),\r\n    ref_no : item.reference_number,\r\n    issuer : item?.issuer?.name,\r\n    target_account :  (item?.transaction_point?.name ?? '') + ' ' +\r\n  (item?.transaction_point?.mobile_money?.name ?? '') + ' ' +\r\n  (item?.transaction_point?.mobile_money?.category ?? 'CASH')\r\n  }))\r\n   }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n   }finally{\r\n\r\n   }\r\n};\r\n\r\nconst loading = ref(false);\r\nconst completeTransaction = async ()=>{\r\n  const payload = {\r\n   status_id : 16,\r\n    remark : remark.value,\r\n  }\r\n  try{\r\n        loading.value = true\r\n    const response = await axiosInstance.put(`labour-payment-requests/${selectedRequest.value.id}`,payload)\r\n    showMessage('Transaction Completed')\r\n    getLabourPaymentRequests()\r\n   complete_transaction.value = false\r\n  }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n  }finally{\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n\r\nconst debtTableColumns = ref(['SNo','labour_name','labour_type','description','amount', 'date','status']);\r\nconst flattenedDebtData = computed(() => {\r\n  if (!selectedItems.value.length) return [];\r\n\r\n  const rows = [];\r\n\r\n  selectedItems.value.forEach(item => {\r\n    const labour = item.labour;\r\n    if (!labour?.labour_debt?.length) return;\r\n\r\n    labour.labour_debt.forEach(debt => {\r\n      rows.push({\r\n        SNo: rows.length + 1,\r\n        labour_id: labour.id,\r\n        labour_name: item.labour_name,\r\n        labour_type: item.labour_type,\r\n        date: formatDate(debt.date),\r\n        description: debt.description || '--',\r\n        amount: formatNumber(debt.amount),\r\n        status: debt.status?.name || 'Unknown',\r\n        status_color: debt.status?.color || 'secondary',\r\n        created_at: debt.created_at\r\n      });\r\n    });\r\n  });\r\n\r\n  return rows;\r\n});\r\n\r\n\r\n\r\n\r\n    onMounted(() => {\r\n        getLabourPaymentRequests();\r\n    });\r\n</script>","import script from \"./paymentRequests.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./paymentRequests.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./paymentRequests.vue?vue&type=style&index=0&id=342967ea&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","showMessage","inject","showError","user_permissions","JSON","parse","localStorage","getItem","permissions","user_role_id","ref","role","user_id","id","formatDate","formatNumber","tableShimmer","loadingSpinner","complete_transaction","loading_spinner","approval_transactions_columns","columns","requests","awaiter","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","axiosInstance","axios","baseURL","process","approvalChain","computed","selectedRequest","value","roles_sequence","formatTableDate","dateString","date","Date","isNaN","getTime","day","String","getDate","padStart","month","getMonth","year","getFullYear","slice","getLabourPaymentRequests","async","response","get","data","map","item","index","SNo","created_at","awaits","awaiting_approval","name","project","short_name","issuer","approval_group","start_date","end_date","status","key","class","color","error","console","log","message","selectedItems","remark","openviewModal","row","awaitingApproval","items","labour","attendance","labour_name","labour_type","phone_number","phone_no","task","rate","attendance_date","labour_debt","getApprovalTransactions","clearForm","itemColumns","spinner","ApprovePaymentRequest","payload","labour_payment_request_id","approval_role_id","status_id","post","document","getElementById","click","printReport","iframe","createElement","style","display","body","appendChild","startDate","endDate","dateColumns","dateKeys","currentDate","formattedDate","dateKey","toISOString","split","push","setDate","labourAttendance","forEach","itemDate","itemDateKey1","itemDateKey2","dateIndex","findIndex","dateCol","dateTotals","Object","values","reduce","sum","tableRows","dateCells","attended","join","daysWorked","val","parseFloat","replace","totalAmount","dateTotalsRow","daySum","printContent","description","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","formattedLabourData","dateColumnsForLabourTable","dateTotalsForLabourTable","totalLabourAmount","watch","length","formatLabourData","immediate","itemKey","formattedData","printAttendance","totalLabours","accounts","account","getAccounts","mobile_money","category","receiver","amount","reference_number","attachment","submitting","submitProof","FormData","append","transactions_sum","File","handleFileUpload","e","target","files","selectedLabourForProof","openProofModalForLabour","clearProofForm","filteredLabourTableForProof","rows","labourAttendanceArray","d","s","v","approvalTransactions","Sno","ref_no","target_account","transaction_point","loading","completeTransaction","put","debtTableColumns","flattenedDebtData","debt","labour_id","status_color","onMounted","__exports__"],"sourceRoot":""}