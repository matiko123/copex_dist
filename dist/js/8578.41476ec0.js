"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[8578],{8578:function(e,a,t){t.r(a),t.d(a,{default:function(){return ce}});var l=t(66252),n=t(3577),s=t(49963),o=t(2262),i=t(87066),r=t(56296),c=t(26212),d=t.n(c);const u={class:"layout-px-spacing"},v=(0,l.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item active" aria-current="page"><span>Jobcards</span></li></ol></nav></div></li></ul>',1),m={class:"offcanvas offcanvas-end","data-bs-scroll":"true",tabindex:"-1",id:"offcanvasWithBothOptions","aria-labelledby":"offcanvasWithBothOptionsLabel"},h=(0,l._)("div",{class:"offcanvas-header"},[(0,l._)("h5",{class:"offcanvas-title",id:"offcanvasWithBothOptionsLabel"},"COMPANIES LIST"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),p={class:"offcanvas-body"},b={class:"row"},g={class:"col-12"},_={class:"list-group",id:"list-tab",role:"tablist"},f=["id","href","aria-controls","onClick"],y={class:"d-flex me-4 mt-2"},w={class:"ms-auto"},x=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,l._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),k=[x],C=(0,l._)("button",{class:"me-2 btn btn-info","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},[(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-funnel",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"})]),(0,l.Uk)(" Select Company ")],-1),S={key:0,class:"spinner-border text-white mt-1",role:"status",style:{width:"1.5rem",height:"1.5rem"}},H=(0,l._)("span",{class:"sr-only"},"Loading...",-1),M=[H],A={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-printer me-1"},O=(0,l._)("polyline",{points:"6 9 6 2 18 2 18 9"},null,-1),V=(0,l._)("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"},null,-1),D=(0,l._)("rect",{x:"6",y:"14",width:"12",height:"8"},null,-1),T=[O,V,D],L=(0,l._)("div",{class:"btn-group ms-2 me-4",role:"group","aria-label":"Filter Job Cards"},[(0,l._)("div",{class:"btn-group",role:"group","aria-label":"Filter Job Cards"})],-1),E=["onSubmit"],j=(0,l._)("h4",{class:"text-center"}," JOBCARD REGISTRATION",-1),z={class:"row mb-2"},$={class:"col-md-4"},N=(0,l._)("label",{class:"form-label"},"Company ",-1),B={class:"col-md-4"},I=(0,l._)("label",{class:"form-label"},"Vehicle / Machine",-1),U={class:"col-md-4"},J=(0,l._)("label",{class:"form-label"},"Service Type",-1),R=(0,l._)("option",{value:""},"Select a Service Type",-1),W=["value"],P={class:"col-md-4"},K=(0,l._)("label",{class:"form-label"},"Current Km of Service",-1),q={class:"col-md-4"},Y=(0,l._)("label",{class:"form-label"},"Next Km of Service",-1),F={class:"col-md-4"},G=(0,l._)("label",{class:"form-label"},"Enter Date Created",-1),X={class:"text-center gap-2 justify-content-end"},Z=(0,l._)("button",{type:"submit",class:"btn btn-primary"},"Register",-1),Q={class:"text-center mb-2"},ee={key:0},ae={class:"row layout-top-spacing"},te={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},le={class:"panel p-0"},ne={class:"custom-table table3"},se=["innerHTML"],oe=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,l._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})],-1);var ie={setup(e){const a=(0,o.iH)(null),t=(0,o.iH)(""),c=(0,o.iH)(null),x=(0,o.iH)(""),H=(0,o.iH)(""),O=(0,o.iH)(!0),V=(0,o.iH)(!1),D=(0,o.iH)(!1),ie=(0,o.iH)([]),re=(0,o.iH)([]),ce=(0,l.f3)("showMessage"),de=(0,l.f3)("showError"),ue=(0,l.f3)("tableShimmer");(0,r.j)({title:"Jobcard Lists"});(0,o.iH)(localStorage.getItem("source")),(0,o.iH)(!1);const ve=(0,o.iH)([]),me=async e=>{D.value=!0;try{const a=await _e.get(`/jobcard-summary?asset_id=${e}`);ve.value=a.data,await(0,l.Y3)(),he()}catch(a){de(a.message),console.error("Error fetching jobcard summary:",a)}},he=()=>{const e=ve.value||[];D.value=!1;const a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);const t=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Jobcard Summary</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }\n  .logo { width: 150px; height: auto; }\n  .company-title { text-align: center; margin-top: 5px; }\n  .company-title h2 { margin: 5px 0; }\n  .reg-info { position: absolute; top: 40px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; font-weight: normal; }\n  table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n  th, td { border: 1px solid #000; padding: 6px; text-align: center; }\n  th { background-color: #f8f8f8; }\n</style>\n</head>\n<body>\n\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="reg-info">\n    TIN: 135-489-247<br>\n    VRN: 40-032826C\n  </div>\n</div>\n\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile: 0713 000 777, 0657 111 555</div>\n</div>\n\n\n<table>\n  <thead>\n    <tr>\n      <th>${c.value.category.name}</th>\n      <th>TYPE</th>\n    </tr>\n  </thead>\n  <tbody>\n      <tr>\n        <td>${c.value.name}</td>\n        <td>${c.value.type_name}</td>\n      </tr>\n  </tbody>\n</table>\n\n<h2 style="text-align:center; margin-top: 20px;">Jobcard Summary</h2>\n\n<table>\n  <thead>\n    <tr>\n      <th>SN</th>\n      <th>Jobcard NO</th>\n      <th>Date Created</th>\n      <th>Service Type</th>\n      <th>Current Km Service</th>\n      <th>Next Km Service</th>\n      <th>Status</th>\n      <th>Total Sum</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${e.map(((e,a)=>`\n      <tr>\n        <td>${a+1}</td>\n        <td>${e.id}</td>\n        <td>${e.date_created}</td>\n        <td>${e.service_type}</td>\n        <td>${e.current_km_service}</td>\n        <td>${e.next_km_service}</td>\n        <td>${e.status_name}</td>\n        <td style="text-align:right">${parseFloat(e.total_sum).toLocaleString()}/=</td>\n      </tr>\n    `)).join("")}\n    <tr>\n      <td colspan="7" style="text-align:right"><strong>Grand Total</strong></td>\n      <td style="text-align:right"><strong>${e.reduce(((e,a)=>e+parseFloat(a.total_sum||0)),0).toLocaleString()}/=</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n\n\n\n</body>\n</html>\n`,l=a.contentWindow.document;l.open(),l.write(t),l.close(),a.onload=()=>{a.contentWindow.focus(),a.contentWindow.print(),setTimeout((()=>{document.body.removeChild(a)}),1e3)}},pe=(0,o.iH)(["Sno","jobcard_id","name","date_created","service_type","current_km_of_service","next_km_of_service","status","actions"]),be=(0,o.iH)([]),ge=(0,o.iH)({perPage:50,perPageValues:[50,100,200,500,1e3],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","vehicle_no","date","service_type","current_service_kms","next_service_kms","status"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),_e=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),fe=(0,o.iH)(null),ye=(0,o.iH)("JOBCARD LIST"),we=async()=>{try{const e=await _e.get("job-card");be.value=e.data.map(((e,a)=>({...e,Sno:a+1,jobcard_id:e.id,name:e.machine.name+" - "+e.machine.type_name,status:{key:e.status.name,class:e.status.color}}))),Oe.value=be.value}catch(e){}},xe=(0,o.iH)(""),ke=()=>{V.value=!1,O.value=!0;const e={machine_id:a.value.id,machine_name:"none",status_name:"Active",status_color:"primary",status_id:6,service_type:re.value.find((e=>e.id===t.value)).name,current_km_of_service:x.value,next_km_of_service:H.value,date_created:xe.value,company_id:Me.value.id,issuer_id:JSON.parse(localStorage.getItem("user")).id};_e.post("/job-card",e).then((e=>{we(),ce("Jobcard registered successfully!"),O.value=!1})).catch((e=>{de(e.message),console.log(e),O.value=!1}))},Ce=()=>{O.value=!0,_e.get("/service-type").then((e=>{Array.isArray(e.data)?re.value=e.data:console.error("Invalid response format")})).catch((e=>{console.error("Error fetching user data:",e.message)})).finally((()=>{O.value=!1}))},Se=()=>{O.value=!0,_e.get("/machines").then((e=>{Array.isArray(e.data)?ie.value=e.data:console.error("Invalid response format")})).catch((e=>{console.error("Error fetching machine data:",e.message)})).finally((()=>{O.value=!1}))},He=(0,o.iH)([]),Me=(0,o.iH)(""),Ae=async()=>{const e=await _e.get("companies");He.value=e.data},Oe=(0,o.iH)([]);return(0,l.YP)(Me,(e=>{Oe.value=e?be.value.filter((a=>a.company_id===e.id)):be.value})),(0,l.bv)((()=>{Ae(),we(),Ce(),Se()})),(e,i)=>{const r=(0,l.up)("router-link"),c=(0,l.up)("v-client-table");return(0,l.wg)(),(0,l.iD)("div",u,[v,(0,l._)("div",m,[h,(0,l._)("div",p,[(0,l._)("div",b,[(0,l._)("div",g,[(0,l._)("div",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(He.value,(e=>((0,l.wg)(),(0,l.iD)("a",{key:e.id,class:"list-group-item list-group-item-action",id:"company-link-"+e.id,"data-bs-toggle":"list",href:"#company-"+e.id,role:"tab","aria-controls":"company-"+e.id,"data-bs-dismiss":"offcanvas",onClick:a=>Me.value=e},(0,n.zw)(e.short_name),9,f)))),128)),(0,l._)("a",{class:"list-group-item list-group-item-action",id:"company-link-all","data-bs-toggle":"list",href:"#company-all",role:"tab","aria-controls":"company-all","data-bs-dismiss":"offcanvas",onClick:i[0]||(i[0]=e=>Me.value="")},"ALL COMPANIES")])])])])]),(0,l._)("div",y,[(0,l._)("div",w,[(0,l._)("button",{class:"me-2 btn btn-primary me-2",onClick:i[1]||(i[1]=e=>V.value=!V.value)},k),C,fe.value?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-success",onClick:i[2]||(i[2]=e=>me(fe.value))},[D.value?((0,l.wg)(),(0,l.iD)("div",S,M)):((0,l.wg)(),(0,l.iD)("svg",A,T))])):(0,l.kq)("",!0),L])]),V.value?((0,l.wg)(),(0,l.iD)("form",{key:0,class:"mt-3 p-3 border rounded bg-white shadow",onSubmit:(0,s.iM)(ke,["prevent"])},[j,(0,l._)("div",z,[(0,l._)("div",$,[N,(0,l.Wm)((0,o.SU)(d()),{modelValue:Me.value,"onUpdate:modelValue":i[3]||(i[3]=e=>Me.value=e),options:He.value,"close-on-select":!0,label:"name","value-prop":"id",placeholder:"Select Company",searchable:!0},null,8,["modelValue","options"])]),(0,l._)("div",B,[I,(0,l.Wm)((0,o.SU)(d()),{disabled:!Me.value,modelValue:a.value,"onUpdate:modelValue":i[4]||(i[4]=e=>a.value=e),options:ie.value,"close-on-select":!0,label:"name","value-prop":"id",placeholder:"Select Machine",onChange:e.handleDescriptionChange,required:!e.machine_field,searchable:!0},null,8,["disabled","modelValue","options","onChange","required"])]),(0,l._)("div",U,[J,(0,l.wy)((0,l._)("select",{class:"form-select","onUpdate:modelValue":i[5]||(i[5]=e=>t.value=e),required:""},[R,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(re.value,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.id,value:e.id},(0,n.zw)(e.name),9,W)))),128))],512),[[s.bM,t.value]])]),(0,l._)("div",P,[K,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Current Km","onUpdate:modelValue":i[6]||(i[6]=e=>x.value=e)},null,512),[[s.nr,x.value]])]),(0,l._)("div",q,[Y,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Next Km","onUpdate:modelValue":i[7]||(i[7]=e=>H.value=e)},null,512),[[s.nr,H.value]])]),(0,l._)("div",F,[G,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",placeholder:"Enter Next Km","onUpdate:modelValue":i[8]||(i[8]=e=>xe.value=e)},null,512),[[s.nr,xe.value]])])]),(0,l._)("div",X,[(0,l._)("button",{type:"button",class:"btn btn-danger me-3",onClick:i[9]||(i[9]=e=>V.value=!1)},"Cancel"),Z])],40,E)):(0,l.kq)("",!0),(0,l._)("div",Q,[(0,l._)("h4",null,[(0,l.Uk)((0,n.zw)(ye.value)+" ",1),Me.value?((0,l.wg)(),(0,l.iD)("span",ee,(0,n.zw)("FOR ")+" "+(0,n.zw)(Me.value.short_name),1)):(0,l.kq)("",!0)])]),(0,l._)("div",ae,[(0,l._)("div",te,[(0,l._)("div",le,[(0,l._)("div",ne,[O.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,o.SU)(ue)()},null,8,se)):((0,l.wg)(),(0,l.j4)(c,{key:1,data:Oe.value,columns:pe.value,options:ge.value},{status:(0,l.w5)((e=>[(0,l._)("span",{class:(0,n.C_)(["badge inv-status","badge-"+e.row.status.class])},(0,n.zw)(e.row.status.key),3)])),actions:(0,l.w5)((e=>[(0,l.Wm)(r,{to:"/jobcard/"+e.row.id+"/"+e.row.machine_id,class:"text-primary"},{default:(0,l.w5)((()=>[oe])),_:2},1032,["to"])])),_:1},8,["data","columns","options"]))])])])])])}}};const re=ie;var ce=re}}]);
//# sourceMappingURL=8578.41476ec0.js.map