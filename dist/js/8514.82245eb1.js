"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[8514],{48514:function(e,a,t){t.r(a),t.d(a,{default:function(){return $}});t(26699);var l=t(66252),o=t(2262),s=t(3577),n=t(49963),i=t(56296),r=t(19051);const d=(0,o.iH)({perPage:10,perPageValues:[10,50,100,200],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","Item"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1});var c=t(87066);const u={class:"layout-px-spacing dash_1"},m=(0,l._)("ul",{class:"navbar-nav flex-row ms-auto"},[(0,l._)("li",{class:"nav-item more-dropdown"},[(0,l._)("div",{class:"dropdown custom-dropdown-icon"},[(0,l._)("a",{href:"javascript:;",class:"nav-link dropdown-toggle",id:"ddlSettings","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,l._)("span",null,"Settings"),(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},[(0,l._)("polyline",{points:"6 9 12 15 18 9"})])]),(0,l._)("ul",{class:"dropdown-menu dropdown-menu-end","aria-labelledby":"ddlSettings"},[(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Settings",href:"javascript:void(0);"},"Settings")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Mail",href:"javascript:void(0);"},"Mail")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Print",href:"javascript:void(0);"},"Print")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Download",href:"javascript:void(0);"},"Download")]),(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item","data-value":"Share",href:"javascript:void(0);"},"Share")])])])])],-1),p={class:"row layout-top-spacing"},v=["innerHTML"],_={key:0,class:"col-xl-4 col-lg-6 col-md-6 col-sm-12 mb-4"},g={class:"card shadow-lg p-3 h-100 position-relative"},h={class:"mb-3"},b={class:"text-dark"},w={class:"row"},f={class:"modal fade mymodal",id:"update-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},y={class:"modal-dialog modal-lg"},k={class:"modal-content"},S={class:"modal-header"},H={class:"modal-body"},x={class:"custom-table table3"},C={class:"table table-striped table-bordered"},q=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Receiver"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Explanations"),(0,l._)("th",null,"Unit"),(0,l._)("th",null,"Shortage Cost")])],-1),D={class:"input-group"},j={class:"btn btn-primary"},M=["innerHTML"],I={key:1},R={class:"modal-footer"},z=(0,l._)("button",{style:{display:"none"},"data-bs-toggle":"modal","data-bs-target":"#shortage-grn",id:"shortage"},null,-1);var E={setup(e){(0,i.j)({title:"Dashboard"});const a=c.Z.create({baseURL:"https://bushman.ink/api/v1/"}),t=((0,l.Fl)((()=>d.value)),(0,o.iH)(["SNo","name","description","units","receiver","received","shortage","briefing","cost","date","actions"]),(0,o.iH)("")),E=(0,o.iH)(""),L=(0,o.iH)(!1),$=async e=>{L.value=!0;const l={status_id:E.value,remark:t.value};try{await a.put(`grn-items/${e}`,l);B("Saved!"),t.value="",document.getElementById("close2").click(),G()}catch(o){console.log(o),T(o.message)}finally{L.value=!1}},N=(0,o.iH)(!1),P=JSON.parse(localStorage.getItem("user")).permissions,U=(0,o.iH)(""),O=(0,o.iH)(""),B=(0,l.f3)("showMessage"),T=(0,l.f3)("showError"),F=(0,l.f3)("formatNumber"),J=(0,l.f3)("formatDate"),A=((0,l.f3)("tableShimmer"),(0,l.f3)("loadingSpinner")),K=(0,l.f3)("cardShimmer"),V=((0,o.iH)(!1),()=>{a.get("dashboard/summary").then((e=>{U.value=e.data})).catch((e=>{T(e.message),console.error("Error fetching summary :",e)}))});V();(0,o.iH)([]),(0,o.iH)([]),(0,o.iH)("nothing"),(0,o.iH)("");const W=(0,o.iH)([]);function Y(e){if(!e||"string"!==typeof e)return 0;try{return Function("summary",`return ${e}`)(U.value)}catch(a){return 0}}const Q=async()=>{N.value=!0;try{const e=await a.get("main-cards");W.value=e.data}catch(e){console.log(e),T(e.message)}finally{N.value=!1}},Z=(0,o.iH)([]),G=async()=>{try{const e=await a.get("grn-items?status_id=2");Z.value=e.data.map(((e,a)=>({...e,SNo:a+1,id:e.id,date:J(e.created_at),receiver:e?.receiver?.name,grn_no:e.grn_id,name:e.approval_item.requisition_item.remark,description:e.approval_item.requisition_item.description,units:e.approval_item.requisition_item.units,rate:e.approval_item.requisition_item.rate,received:e.quantity,approved:e.approval_item.quantity,shortage:(e.approval_item.quantity-e.quantity).toFixed(2),briefing:e.description,cost:F(e.approval_item.requisition_item.rate*(e.approval_item.quantity-e.quantity)),rate:e.approval_item.requisition_item.rate}))),Z.value.length>0&&P.includes("can_view_grn_shortage_alert")&&!JSON.parse(localStorage.getItem("popped"))&&(X("shortage-grn"),localStorage.setItem("popped",!0)),console.log(JSON.parse(localStorage.getItem("popped")))}catch(e){console.log(e),T(e.message)}},X=e=>{const a=document.getElementById(e);if(!a)return;const t=new bootstrap.Modal(a);t.show()},ee=(0,o.iH)([]),ae=async()=>{try{const e=await a.get("dashboard/summary"),t=e.data,l=(e,a="")=>Object.keys(e).flatMap((t=>{const o=a?`${a}.${t}`:t;return"object"===typeof e[t]&&null!==e[t]?l(e[t],o):`summary?.${o} ?? 0`})),o=l(t);ee.value=o.map((e=>({name:e})))}catch(e){console.log(e),T(e.message)}};return(0,l.bv)((()=>{G(),Q(),ae()})),(e,a)=>{const i=(0,l.up)("Router-link");return(0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(),(0,l.j4)(l.lR,{to:"#breadcrumb"},[m])),(0,l._)("div",p,[N.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,o.SU)(K)()},null,8,v)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(W.value,(e=>((0,l.wg)(),(0,l.iD)(l.HY,{key:e.id},[!e.permission||(0,o.SU)(P).includes(e.permission)?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",g,[(0,l.Wm)(i,{to:e.path,class:"text-decoration-none"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l._)("h4",b,(0,s.zw)(e.name),1)]),(0,l._)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.sub_cards,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.id,class:"col-6 mb-3"},[(0,l.Wm)(i,{to:e.path},{default:(0,l.w5)((()=>[(0,l._)("div",{class:(0,s.C_)(["card shadow border-start-primary h-100 p-3 d-flex flex-column align-items-center justify-content-center",`text-${e.color}`])},[(0,l._)("h6",{class:(0,s.C_)(`text-${e.color}`)},(0,s.zw)(e.name),3),(0,l._)("h4",{class:(0,s.C_)(`text-${e.color}`)},[(0,l.Wm)((0,o.SU)(r.FQ),{"start-val":0,"end-val":Y(e.count_source),duration:3e3},null,8,["end-val"])],2)],2)])),_:2},1032,["to"])])))),128))])])),_:2},1032,["to"])])])):(0,l.kq)("",!0),(0,l._)("div",f,[(0,l._)("div",y,[(0,l._)("div",k,[(0,l._)("div",S,[(0,l._)("h1",{class:(0,s.C_)(["modal-title fs-5",4==E.value?"text-danger":"text-success"]),id:"staticBackdropLabel"},(0,s.zw)(4==E.value?"REJECTION":"APPROVAL")+" REMARKS ",3),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close2",onClick:a[0]||(a[0]=e=>X("shortage-grn"))})]),(0,l._)("div",H,[(0,l._)("div",x,[(0,l._)("table",C,[q,(0,l._)("tbody",null,[(0,l._)("tr",null,[(0,l._)("td",null,(0,s.zw)(O.value.receiver),1),(0,l._)("td",null,(0,s.zw)(O.value.name+" - "+O.value.description),1),(0,l._)("td",null,(0,s.zw)(O.value.briefing),1),(0,l._)("td",null,(0,s.zw)(O.value.units),1),(0,l._)("td",null,(0,s.zw)(O.value.cost),1)])])])]),(0,l._)("form",{onSubmit:a[2]||(a[2]=(0,n.iM)((e=>$(O.value.id)),["prevent"]))},[(0,l._)("div",D,[(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Enter Remarks",class:"form-control me-1","onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e)},null,512),[[n.nr,t.value]]),(0,l._)("button",j,[L.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,o.SU)(A)()},null,8,M)):((0,l.wg)(),(0,l.iD)("span",I,"Send"))])])],32)]),(0,l._)("div",R,[(0,l._)("button",{type:"button",class:"btn btn-danger btn-sm","data-bs-dismiss":"modal",onClick:a[3]||(a[3]=e=>X("shortage-grn"))},"Close")])])])]),z],64)))),128))])])}}};const L=E;var $=L}}]);
//# sourceMappingURL=8514.82245eb1.js.map