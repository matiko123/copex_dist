{"version":3,"file":"js/8192.5a0b2c1b.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/subcontractors/index.vue","webpack://cork-vue3/./src/views/subcontractors/index.vue?5983"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Subcontractors</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n\r\n            <div class=\"d-flex me-4 mt-2 \">\r\n                        <div class=\"ms-auto\">\r\n                            <button class=\"btn btn-primary \" @click=\"unit_registration =! unit_registration\">                           \r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-plus-square\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\"/>\r\n  <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4\"/>\r\n</svg>\r\n</button>\r\n \r\n                        </div>\r\n                    </div>  \r\n\r\n <!-- item registration form starts -->\r\n <form v-if=\"unit_registration\" class=\"mt-3 p-3 border rounded bg-white shadow\" @submit.prevent=\"registerAgreement\">\r\n        <h4 class=\"text-center\">SUBCONTRACTORS REGISTRATION FORM</h4>\r\n        <div class=\"row mb-2\">\r\n    \r\n                                    <div class=\"col-md-4\" >\r\n                    <label for=\"editunitStatus\">Select Project</label>\r\n                      <Multiselect\r\n        v-model=\"project\"\r\n        :options=\"projects\"\r\n        label=\"short_name\"\r\n        placeholder=\"Select Project\"\r\n        :searchable=\"true\"        \r\n        :append-to-body=\"true\"\r\n    />\r\n                </div>\r\n            <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Enter Work Name</label>\r\n                <input type=\"text\" class=\"form-control\" placeholder=\"Enter Work Name\" v-model=\"item\" required>\r\n            </div>\r\n\r\n            <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Enter Description</label>\r\n                <input type=\"text\" class=\"form-control\" placeholder=\"Enter Description\" v-model=\"description\" >\r\n            </div>\r\n\r\n                        <div class=\"col-md-4\" >\r\n                    <label for=\"editunitStatus\">Enter Unit</label>\r\n                      <Multiselect\r\n        v-model=\"unit\"\r\n        :options=\"units\"\r\n        label=\"short_name\"\r\n        placeholder=\"Select Unit\"\r\n        :searchable=\"true\"        \r\n        :append-to-body=\"true\"\r\n    />\r\n                </div>\r\n                <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Enter Quantity</label>\r\n                <input type=\"number\" class=\"form-control\" placeholder=\"Enter Quantity\" v-model=\"quantity\" required step=\"any\">\r\n            </div>\r\n                <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Enter Rate</label>\r\n                <input type=\"number\" class=\"form-control\" placeholder=\"Enter Rate\" v-model=\"rate\" required step=\"any\">\r\n            </div>\r\n\r\n             <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Subcontracated To</label>\r\n                <input type=\"text\" class=\"form-control\" placeholder=\"Subcontracted To\" v-model=\"subcontracted_to\" required >\r\n            </div>\r\n\r\n             <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Payment Details</label>\r\n                <input type=\"text\" class=\"form-control\" placeholder=\"Enter Payment Details\" v-model=\"payment_number\" required >\r\n            </div>\r\n            \r\n            <div class=\"col-md-4\" >\r\n                    <label for=\"editunitStatus\">Select Payment Term</label>\r\n                      <Multiselect\r\n        v-model=\"payment_term\"\r\n        :options=\"paymentTerms\"\r\n        label=\"name\"\r\n        placeholder=\"Select Payment Term\"\r\n        :searchable=\"true\"        \r\n        :append-to-body=\"true\"\r\n    />\r\n                </div>\r\n\r\n                    <div class=\"col-md-4\">\r\n                <label class=\"form-label\">Attachment (PDF only)</label>\r\n <input\r\n               type=\"file\"\r\n               class=\"form-control\"\r\n               @change=\"handleFileUpload\"\r\n               accept=\"application/pdf\"\r\n               required\r\n               >            </div>\r\n\r\n        </div>\r\n        <div class=\"text-center gap-2 justify-content-end\">\r\n            <button type=\"button\" class=\"btn btn-danger me-3\" @click=\"unit_registration = false; resetForm();\">Cancel</button>\r\n            <button type=\"submit\" class=\"btn btn-primary\">Register</button>\r\n        </div>\r\n    </form>\r\n             <!-- item registration form ends-->\r\n      \r\n                    <!-- loading spinner starts -->\r\n                 <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n        <!-- Loading spinner ends -->\r\n        <div v-else class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"agreements\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge\" :class=\"props.row.status === 'Active' ? 'bg-success' : 'bg-secondary'\">\r\n                                    {{ props.row.status }}\r\n                                </span>\r\n                            </template>\r\n                            <template #actions=\"props\">\r\n                                \r\n<div class=\"d-flex justify-content-center align-items-center\">\r\n<a :href=\"props.row.attachment\" class=\"text-primary\" target=\"_blank\" rel=\"noopener\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-link-45deg\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z\"/>\r\n        <path d=\"M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z\"/>\r\n    </svg>\r\n</a>\r\n\r\n<a href=\"javascript:void(0);\" class=\"text-primary me-2\" data-bs-toggle=\"modal\" data-bs-target=\"#view_details\" @click=\"viewDetails(props.row)\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z\"/>\r\n        <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0\"/>\r\n    </svg>\r\n</a>\r\n\r\n<a href=\"javascript:void(0);\" class=\"text-primary me-2\" @click=\"printDetails(props.row)\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n        <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n    </svg>\r\n</a> \r\n</div>\r\n                      \r\n                              \r\n                \r\n                            </template>\r\n                           <template #footer>\r\n                               <div class=\"modal-footer\">\r\n                                   <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n                                   <button type=\"button\" class=\"btn btn-primary\" @click=\"save_edit\" >Save changes</button>\r\n                               </div>\r\n                           </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n<div class=\"modal fade mymodal\" id=\"view_details\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-fullscreen\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">\r\n        Contractor Agreement Details for {{ selectedAgreement?.item }}\r\n        </h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close\" @click=\"clearForm\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <!-- Agreement Details Section -->\r\n       \r\n  <div class=\"card shadow border-start-danger  p-3\">\r\n  <div class=\"card-header\">\r\n    <h4 class=\"mb-0\">Contractor Agreement Details</h4>\r\n  </div>\r\n  <div class=\"card-body\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-4 text-start\">\r\n        <p><strong>Project:</strong> {{ selectedAgreement?.project }}</p>\r\n        <p><strong>Item Description:</strong> {{ selectedAgreement?.item }}</p>\r\n        <p><strong>Sub Contracted To:</strong> {{ selectedAgreement?.subcontracted_to }}</p>\r\n      </div>\r\n      <div class=\"col-md-4 text-start\">\r\n        <p><strong>Unit:</strong> {{ selectedAgreement?.unit }}</p>\r\n        <p><strong>Quantity:</strong> {{ selectedAgreement?.quantity }}</p>\r\n        <p><strong>Rate:</strong> {{ selectedAgreement?.rate }}</p>\r\n      </div>\r\n      <div class=\"col-md-4 text-start\">\r\n        <p><strong>Total Cost:</strong> {{ selectedAgreement?.cost }}</p>\r\n        <p><strong>Payment Term:</strong> {{ selectedAgreement?.payment_term }}</p>\r\n        <p><strong>Payment Details:</strong> {{ selectedAgreement?.payment_number }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n        <!-- Payments Table Section -->\r\n        <div class=\"row layout-top-spacing\">\r\n          <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n            <h4 class=\"mb-3\">Payment History</h4>\r\n            <div class=\"panel p-0\">\r\n              <div class=\"custom-table table3\">\r\n                <v-client-table\r\n                  :data=\"selectedAgreement?.payments || []\"\r\n                  :columns=\"paymentColumns\"\r\n                  :options=\"table_option\"\r\n                >\r\n                 <template #actions=\"props\">\r\n                                \r\n<div class=\"d-flex justify-content-center align-items-center\">\r\n<a href=\"javascript:void(0);\" class=\"text-primary me-2\" @click=\"printDetails(selectedAgreement, props.row)\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n        <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n    </svg>\r\n</a>\r\n</div>\r\n                                      \r\n                \r\n                            </template>\r\n\r\n                </v-client-table>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger btn-sm py-2 px-2\" data-bs-dismiss=\"modal\">Close</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n   </div>\r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref,inject } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    useMeta({ title: 'Subcontractors Agreements' });\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const tableShimmer = inject('tableShimmer');\r\n    const formatNumber = inject('formatNumber');\r\n    \r\n    let editModal = null;\r\n    const editingRow = ref({});\r\n    const name = ref('');\r\n    const short_name = ref('');\r\n    const status = ref('');\r\n    const loading_spinner = ref(false);\r\n    const columns = ref(['SNo','project','subcontractor', 'item', 'unit','quantity','archived','rate','cost','payable','balance','actions']);\r\n    const units = ref([]);\r\n    const unit_registration = ref(false);\r\n    const selectedAgreement = ref(null)\r\n    const paymentColumns = ref(['id', 'type', 'amount','balance','paid_at','actions' ]);\r\n    const viewDetails = (row) => {\r\n  selectedAgreement.value = row\r\n}\r\n\r\n    const table_option = ref({\r\n        perPage: 10,\r\n        perPageValues: [10, 20, 50],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const agreements = ref([])\r\nconst getAgreements = async () => {\r\n  loading_spinner.value = true;\r\n  try {\r\n    const response = await axiosInstance.get('/subcontractor-agreements');\r\n\r\n    agreements.value = response.data.map((item, index) => {\r\n      const totalCost = item.quantity * item.rate;\r\n      let cumulativePaid = 0;\r\n      const paymentsWithRemaining = item.payments.map((p, idx) => {\r\n        cumulativePaid += p.quantity;\r\n        const remaining = totalCost - cumulativePaid;\r\n        return {\r\n          ...p,\r\n          id: idx + 1,\r\n          amount: formatNumber(p.quantity),\r\n          paid_at: new Date(p.created_at).toLocaleDateString(),\r\n          balance: formatNumber(remaining === 0 ? p.quantity : remaining)\r\n        };\r\n      });\r\n      const totalPaid = item.payments.reduce((sum, p) => sum + p.quantity, 0);\r\n      const payable = totalCost - totalPaid;\r\n      const remainingAmount = totalCost - payable;\r\n      const balance = remainingAmount === 0 ? payable : remainingAmount;\r\n      return {\r\n        ...item,\r\n        SNo: index + 1,\r\n        project: item.project.short_name,\r\n        subcontractor : item.subcontracted_to,\r\n        attachment: 'https://copex.trustdigital.space/' + item.attachment,\r\n        payment_term: item.payment_term.name,\r\n        rate: formatNumber(item.rate),\r\n        cost: formatNumber(totalCost),\r\n        balance: formatNumber(payable),\r\n        payable: formatNumber(balance), \r\n        payments: paymentsWithRemaining,\r\n        archived : item.archived_quantity\r\n      };\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    showError(error.message);\r\n  } finally {\r\n    loading_spinner.value = false;\r\n  }\r\n};\r\n\r\n\r\n\r\nconst handleFileUpload = (e) => {\r\n  attachment.value = e.target.files[0];\r\n};\r\n\r\n\r\n    const paymentTerms = ref([])\r\n    const payment_term = ref('')\r\n    const getPaymentTerms = async () =>{\r\n     try{\r\n        const response = await axiosInstance.get('/payment-terms')\r\n        paymentTerms.value = response.data\r\n        }catch(error){\r\n           console.log(error)\r\n           showError(error.message)\r\n        }\r\n    }\r\n    const unit = ref('')\r\n        const getUnits = async () =>{\r\n     try{\r\n        const response = await axiosInstance.get('/units')\r\n        units.value = response.data\r\n        }catch(error){\r\n           console.log(error)\r\n           showError(error.message)\r\n        }\r\n    }\r\n\r\n    const projects = ref([])\r\n    const project = ref('')\r\n      const getProjects = async () =>{\r\n     try{\r\n        const response = await axiosInstance.get('/projects')\r\n        projects.value = response.data\r\n        }catch(error){\r\n           console.log(error)\r\n           showError(error.message)\r\n        }\r\n    }\r\n    const description = ref('')\r\n    const quantity = ref('')\r\n    const rate = ref('')\r\n    const item = ref('')\r\n    const attachment = ref('')\r\n    const subcontracted_to = ref('')\r\n    const payment_number = ref('')\r\n\r\n\r\nconst registerAgreement = async () => {\r\n    unit_registration.value = false;\r\n    loading_spinner.value = true;\r\n\r\n    const payload = new FormData();\r\n    payload.append(\"project_id\", project.value.id);\r\n    payload.append(\"item\", item.value);\r\n    payload.append(\"description\", description.value);\r\n    payload.append(\"unit\", unit.value.short_name);\r\n    payload.append(\"quantity\", quantity.value);\r\n    payload.append(\"rate\", rate.value);\r\n    payload.append(\"subcontracted_to\", subcontracted_to.value);\r\n    payload.append(\"payment_number\", payment_number.value);\r\n    payload.append(\"payment_term_id\", payment_term.value.id);\r\n    if (attachment.value instanceof File) {\r\n        payload.append(\"attachment\", attachment.value);\r\n    }\r\n\r\n    try {\r\n        const response = await axiosInstance.post('subcontractor-agreements', payload, {\r\n            headers: { 'Content-Type': 'multipart/form-data' }\r\n        });\r\n       showMessage('Agreement Saved')\r\n       getAgreements()\r\n    } catch (error) {\r\n        console.error(error);\r\n        showError(error.message)\r\n    } finally {\r\n        loading_spinner.value = false;\r\n    }\r\n};\r\n\r\n\r\n\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n\r\n\r\n    const save_edit = async () => {\r\n        editModal.hide();\r\n        if (loading_spinner.value) return;\r\n        try {\r\n            \r\n            loading_spinner.value = true;\r\n            const response = await axiosInstance.put(`/units/${editingRow.value.id}`, {\r\n                name: editingRow.value.name,\r\n                short_name: editingRow.value.short_name,\r\n                status: editingRow.value.status\r\n            });\r\n            \r\n            if (response.status === 200) {\r\n                const index = units.value.findIndex(item => item.id === editingRow.value.id);\r\n                if (index !== -1) {\r\n                    units.value[index].name = editingRow.value.name;\r\n                    units.value[index].short_name = editingRow.value.short_name;\r\n                    units.value[index].status = editingRow.value.status;\r\n                }\r\n                showMessage('Unit updated successfully!');\r\n            }\r\n           \r\n        } catch (error) {\r\n            showError(\"Error updating Unit: \" + (error.response?.data?.message || error.message));\r\n        } finally {\r\n            loading_spinner.value = false;\r\n        }\r\n      \r\n    }; \r\n\r\n\r\n    const resetForm = () => {\r\n    name.value = '';\r\n    short_name.value = '';\r\n    status.value = '';\r\n};\r\n\r\nconst printDetails = async (row, specificPayment = null) => {\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n\r\n    // Date formatting\r\n    const now = new Date();\r\n    const day = String(now.getDate()).padStart(2, '0');\r\n    const month = String(now.getMonth() + 1).padStart(2, '0');\r\n    const year = now.getFullYear();\r\n    const dateString = `${day}/${month}`;\r\n    const formattedDate = `${day}/${month}/${year}`;\r\n    const formatDate = `${day}.${month}.${year}`;\r\n    const formattedDateTime = `${formattedDate}, ${now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}`;\r\n\r\n    // Use specific payment ID if provided, otherwise use the main row ID (not last payment)\r\n    const paymentId = specificPayment ? specificPayment.id : row.id;\r\n    const noticeNo = `${paymentId}/${year}`;\r\n    const agreementId = `${String(paymentId).padStart(3, '0')}/${dateString}`;\r\n    // Calculate the specific payment amount or total payable\r\n    const specificPaymentAmount = specificPayment ? \r\n      formatNumber(specificPayment.quantity) : \r\n      (row.payments && row.payments.length > 0 ? \r\n        formatNumber(row.payments.reduce((sum, p) => sum + Number(p.quantity), 0)) : \r\n        row.payable);\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Subcontractor Agreement Details</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n  .logo { width: 160px; height: auto; }\r\n  .agreement-box { border: 1px solid #000; padding: 5px 10px; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .company-title h2 { margin: 5px 0; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n  .title { text-align: center; font-weight: bold; margin: 20px 0 10px 0; }\r\n  .details-list { margin-top: 15px; line-height: 1.6; }\r\n  .details-list div { margin-bottom: 4px; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n  table.items th, table.items td { border: 1px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"agreement-box\">\r\n    Agreement ID:<br>\r\n    <span style=\"color:red;\">${agreementId}</span>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"reg-info\">\r\n  TIN: 103-826-519<br>\r\n  VRN: 20-01-017530R\r\n</div>\r\n\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n\r\n<div class=\"section-title\">SUBCONTRACTOR AGREEMENT DETAILS</div>\r\n<div class=\"title\"> ${row.project.toUpperCase()} - ${row.item.toUpperCase()}</div>\r\n\r\n<div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n  <div class = 'text-start'><strong>NOTICE NO. 00${noticeNo}</strong></div>\r\n  <div class = 'text-end'><strong>Date: ${formatDate}</strong></div>\r\n</div>\r\n\r\n<div class=\"text-center\"> <strong> REF: SUBCONTRACTING NOTICE No. ${paymentId}</strong></div>\r\n\r\n<div class = 'text-start'><P> Refer the subject matter above </p> </div>\r\n\r\n<div class = 'text-start'><P> This form as internal notice on subcontracting piece work on <strong>${row.item.toUpperCase()}</strong> </p> </div>\r\n\r\n<div class=\"details-list\">\r\n  <div><strong>Subcontracted :${row.subcontracted_to}</strong> </div><br>\r\n  <div>Item Description:</strong> ${row.item}</div><br>\r\n  <div><strong>Contracted Quantity: ${row.quantity} ${row.unit}</strong></div><br>\r\n    <div><strong>Archived Qty To Date: </div><br>\r\n  <div>This payment certificate : ${row.payment_term}</div><br>\r\n  <div>Subcontracted To : ${row.subcontracted_to}</div><br>\r\n  <div><strong>Payment Details :</strong> ${row.payment_number}</div><br>\r\n  <div>Subcontracting Unit Price is:<strong> TZS ${row.rate} per ${row.unit}</strong></div><br>\r\n  <div><strong>Total Amount of Contract : TZS ${row.cost}</strong></div><br>\r\n  <div><strong>Pending Contract Amount :</strong> ${row.balance}</div><br>\r\n  <div><strong>Total Amount Archived :</strong></div><br>\r\n  <div> This Certificate Payable Amount:<strong> TZS ${specificPaymentAmount}</strong></div>\r\n</div>\r\n\r\n${row.payments && row.payments.length > 0 ? `\r\n<div class=\"section-title\">PAYMENT HISTORY</div>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th style=\"width: 30px;\"><strong>Sno.</strong></th>\r\n      <th><strong>Date</strong></th>\r\n      <th><strong>Description</strong></th>\r\n      <th><strong>Amount</strong></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${row.payments.map((payment, index) => {\r\n      const date = new Date(payment.created_at);\r\n      const formattedPaidAt = `${String(date.getDate()).padStart(2, '0')}.${String(date.getMonth() + 1).padStart(2, '0')}.${date.getFullYear()}`;\r\n      return `\r\n    <tr>\r\n      <td class=\"text-center\">${index + 1}</td>\r\n      <td class=\"text-center\">${formattedPaidAt}</td>\r\n      <td class=\"text-center\">${payment.description || ' '}</td>\r\n      <td class=\"text-center\">${payment.amount}</td>\r\n    </tr>\r\n    `}).join('')}\r\n  </tbody>\r\n</table>\r\n` : ''}\r\n\r\n<div style=\"margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;\">\r\n  <p>Â© ${new Date().getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 135-489-247 | VRN: 40-032826C</p>\r\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\r\n</div>\r\n\r\n<div style=\"margin-top: 10px; font-size: 11px; text-align: left;\">\r\n  ${formattedDateTime}\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print agreement details: ${error.message}`);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nonMounted(() => {\r\n        getProjects()\r\n        getAgreements();\r\n        getPaymentTerms();\r\n        getUnits();\r\n\r\n    });\r\n</script>\r\n\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=ac201aa8&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","axiosInstance","axios","baseURL","process","tableShimmer","inject","formatNumber","editModal","editingRow","ref","name","short_name","status","loading_spinner","columns","units","unit_registration","selectedAgreement","paymentColumns","viewDetails","row","value","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","agreements","getAgreements","async","response","get","data","map","item","index","totalCost","quantity","rate","cumulativePaid","paymentsWithRemaining","payments","p","idx","remaining","id","amount","paid_at","Date","created_at","toLocaleDateString","balance","totalPaid","reduce","sum","payable","remainingAmount","SNo","project","subcontractor","subcontracted_to","attachment","payment_term","cost","archived","archived_quantity","error","console","log","showError","message","handleFileUpload","e","target","files","paymentTerms","getPaymentTerms","unit","getUnits","projects","getProjects","description","payment_number","registerAgreement","payload","FormData","append","File","post","headers","showMessage","save_edit","hide","put","findIndex","resetForm","printDetails","specificPayment","iframe","document","createElement","style","display","body","appendChild","now","day","String","getDate","padStart","month","getMonth","year","getFullYear","dateString","formattedDate","formatDate","formattedDateTime","toLocaleTimeString","hour","minute","paymentId","noticeNo","agreementId","specificPaymentAmount","length","Number","printContent","toUpperCase","payment","date","formattedPaidAt","join","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","onMounted","__exports__"],"sourceRoot":""}