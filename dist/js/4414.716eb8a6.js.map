{"version":3,"file":"js/4414.716eb8a6.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/budgets/allocation.vue","webpack://cork-vue3/./src/views/budgets/allocation.vue?da7e"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n        <ul class=\"navbar-nav flex-row mt-2\">\r\n            <li>\r\n                <div class=\"page-header\">\r\n                    <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                        <ol class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                            <li class=\"breadcrumb-item active\" aria-current=\"page\"><span> Budget Allocations </span></li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n                     \r\n        <h4 class=\"text-center\">\r\n            {{ budgetInfo?.name ? `Budget Allocations for ${budgetInfo.name}` : 'No Allocations Found for This Budget' }}\r\n        </h4>\r\n <div class=\"mb-3\">\r\n            <button @click=\"$router.back()\" class=\"btn btn-dark\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-arrow-left\" viewBox=\"0 0 16 16\">\r\n                    <path fill-rule=\"evenodd\" d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z\"/>\r\n                </svg>\r\n                Back\r\n            </button>\r\n        </div>\r\n\r\n              <!-- loading spinner starts -->\r\n        <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n        <!-- Loading spinner ends -->\r\n        <div v-else class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"allocations\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #actions=\"props\">\r\n                              <div class=\"d-flex justify-content-center align-items-center gap-2\">\r\n                               <a href=\"javascript:;\" class=\"edit me-3\" @click=\"openEditModal(props.row)\" data-bs-toggle=\"modal\" :data-bs-target=\"'#edit-allocation-modal'\">\r\n                                   <svg\r\n                                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                                width=\"24\"\r\n                                                height=\"24\"\r\n                                                viewBox=\"0 0 24 24\"\r\n                                                fill=\"none\"\r\n                                                stroke=\"currentColor\"\r\n                                                stroke-width=\"1.5\"\r\n                                                stroke-linecap=\"round\"\r\n                                                stroke-linejoin=\"round\"\r\n                                                class=\"text-primary\"\r\n                                            >\r\n                                                <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                                                <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                                            </svg>\r\n                                </a>\r\n                                <!-- <router-link  :to=\"`/requisition-budget/${props.row.budget_id}`\">     \r\n                            <button class=\"btn btn-outline-primary\">Budget</button>\r\n                      </router-link> -->\r\n                      </div>\r\n                            </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n                <!-- Edit allocation modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"edit-allocation-modal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"editallocationModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"editallocationModalLabel\">Edit Allocation</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"closeEditModal()\"></button>\r\n      </div>\r\n      <form @submit.prevent=\"updateAllocation(props.row.id)\">\r\n        <div class=\"modal-body\">\r\n            <div class=\"row mb-3\">\r\n                <div class=\"col-md-6\">\r\n                <label for=\"budget\">Budget</label>\r\n                <Multiselect\r\n                    v-model=\"budget\"\r\n                    :options=\"budgets\"\r\n                    label=\"name\"\r\n                    placeholder=\"Select Budget\"\r\n                    :searchable=\"true\"\r\n                    :required=\"true\"\r\n                    :allow-empty=\"false\"\r\n                />\r\n            </div>\r\n           \r\n            <div class=\"col-md-6\">\r\n                <label for=\"amount\">Amount</label>\r\n                <input type=\"number\" v-model=\"amount\" class=\"form-control\" placeholder=\"name\" required>\r\n            </div>\r\n             <div class=\"col-md-12\">\r\n                <label for=\"project\">Purpose</label>\r\n                <input type=\"text\" v-model=\"purpose\" class=\"form-control\" placeholder=\"name\" required>\r\n            </div>\r\n           \r\n            \r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"closeEditModal()\" id=\"close_editing\">Close</button>\r\n          <button type=\"submit\" class=\"btn btn-primary\">\r\n            <span v-if=\"loading_spinner\" class=\"spinner-border spinner-border-sm text-white me-2\" role=\"status\"></span>\r\n            Edit\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- Edit conversion factor modal ends -->\r\n      \r\n    </div>\r\n</template>\r\n\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n\r\n<script setup>\r\n    import { onMounted, ref, inject, watch } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    import { useRoute } from 'vue-router';\r\n    const route = useRoute();\r\n   \r\n    \r\n    useMeta({ title: 'Budget Allocations' });  \r\n    \r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const formatDate = inject('formatDate');\r\n    const tableShimmer = inject('tableShimmer');\r\n    const loadingSpinner = inject('loadingSpinner');\r\n    const formatNumber = inject('formatNumber');\r\n     const purpose = ref('');\r\n     const amount = ref('');\r\n     const budget = ref('');\r\n     const budgetInfo = ref(null);\r\n\r\n    \r\n    const loading_spinner = ref(false);\r\n    const columns = ref(['SNo','budget','project','purpose','funded_amount','allocated_date','allocated_by','actions']);    \r\n\r\n\r\n    \r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 ,100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const allocations = ref([]);\r\n    const getBudgetAllocations = async () => {\r\n        loading_spinner.value = true;\r\n        try {\r\n            const response = await axiosInstance.get( `budget-allocations?budget_id=${route.params.budget_id}`);\r\n            allocations.value = response.data.map((item, index) => ({\r\n                SNo: index + 1,\r\n                id: item.id,\r\n                budget_id: item.budget.id,\r\n                budget: item.budget.name,\r\n                purpose: item.description,\r\n                project: item.budget.project.short_name,\r\n                amount: item.amount,\r\n                funded_amount: formatNumber(item.amount),\r\n                allocated_date: formatDate(item.date),\r\n                allocated_by: item.issuer.name,             \r\n            }));\r\n\r\n            if (response.data.length > 0) {\r\n      budgetInfo.value = response.data[0].budget;\r\n    }\r\n    \r\n        } catch (error) {\r\n            showError(error.message);\r\n        }finally{\r\n            loading_spinner.value = false;\r\n        }\r\n    };\r\n    \r\n     const budgets = ref([])\r\n    const getBudgets = async () => {\r\n        try {\r\n            const response = await axiosInstance.get('budgets');\r\n            budgets.value = response.data.map((item) => ({\r\n                id: item.id,\r\n                name: item.name,\r\n            }));\r\n        } catch (error) {\r\n            showError(error.message);\r\n        }\r\n    };\r\n    \r\n    const openEditModal = (row) => {\r\n        budget.value = budgets.value.find(v => v.id === row.budget_id) || '';\r\n        purpose.value = row.purpose;\r\n        amount.value = row.amount;\r\n    };\r\n\r\n    const updateAllocation = async (id) => {\r\n        loading_spinner.value = true;\r\n        try {\r\n            const payload = {\r\n                budget_id: budget.value.id,\r\n                description: purpose.value,\r\n                amount: amount.value,\r\n            };\r\n            await axiosInstance.put(`/budget-allocations/${id}`, payload);\r\n            showMessage('Allocation updated successfully');\r\n            getBudgetAllocations();\r\n            closeEditModal();\r\n        } catch (error) {\r\n            showError(error.message);\r\n        }finally{\r\n            loading_spinner.value = false;\r\n        }\r\n    };\r\n\r\n    const closeEditModal = () => {\r\n        budget.value = '';\r\n        purpose.value = '';\r\n        amount.value = '';\r\n    };\r\n    \r\n// watch for route param change\r\nwatch(\r\n  () => route.params.budget_id,\r\n  (newVal) => {\r\n    if (newVal) getBudgetAllocations();\r\n  },\r\n  { immediate: true } // ensures it runs on first render too\r\n);\r\n\r\n    onMounted(() => {\r\n        getBudgets()\r\n        \r\n       \r\n    });\r\n</script>","import script from \"./allocation.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./allocation.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./allocation.vue?vue&type=style&index=0&id=3f69eb8e&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","useMeta","title","showMessage","inject","showError","formatDate","JSON","parse","localStorage","getItem","permissions","tableShimmer","formatNumber","purpose","ref","amount","budget","budgetInfo","loading_spinner","columns","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","axiosInstance","axios","baseURL","process","allocations","getBudgetAllocations","async","value","response","get","params","budget_id","data","map","item","index","SNo","id","name","description","project","short_name","funded_amount","allocated_date","date","allocated_by","issuer","length","error","message","budgets","getBudgets","openEditModal","row","find","v","updateAllocation","payload","put","closeEditModal","watch","newVal","immediate","onMounted","__exports__"],"sourceRoot":""}