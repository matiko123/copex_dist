"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[8901],{48901:function(e,a,t){t.r(a),t.d(a,{default:function(){return ue}});var l=t(66252),n=t(3577),s=t(49963),o=t(2262),i=t(87066),r=t(56296),c=t(26212),d=t.n(c);const u={class:"layout-px-spacing"},v=(0,l.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item active" aria-current="page"><span>Jobcards</span></li></ol></nav></div></li></ul>',1),m={class:"offcanvas offcanvas-end","data-bs-scroll":"true",tabindex:"-1",id:"offcanvasWithBothOptions","aria-labelledby":"offcanvasWithBothOptionsLabel"},h=(0,l._)("div",{class:"offcanvas-header"},[(0,l._)("h5",{class:"offcanvas-title",id:"offcanvasWithBothOptionsLabel"},"COMPANIES LIST"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),p={class:"offcanvas-body"},b={class:"row"},g={class:"col-12"},_={class:"list-group",id:"list-tab",role:"tablist"},f=["id","href","aria-controls","onClick"],y={class:"d-flex me-4 mt-2"},w=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-arrow-left",viewBox:"0 0 16 16"},[(0,l._)("path",{"fill-rule":"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"})],-1),x=[w],k={class:"ms-auto"},C=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,l._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),S=[C],H=(0,l._)("button",{class:"me-2 btn btn-info","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},[(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-funnel",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"})]),(0,l.Uk)(" Select Company ")],-1),M={key:0,class:"spinner-border text-white mt-1",role:"status",style:{width:"1.5rem",height:"1.5rem"}},A=(0,l._)("span",{class:"sr-only"},"Loading...",-1),O=[A],V={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-printer me-1"},D=(0,l._)("polyline",{points:"6 9 6 2 18 2 18 9"},null,-1),L=(0,l._)("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"},null,-1),T=(0,l._)("rect",{x:"6",y:"14",width:"12",height:"8"},null,-1),E=[D,L,T],$=(0,l._)("div",{class:"btn-group ms-2 me-4",role:"group","aria-label":"Filter Job Cards"},[(0,l._)("div",{class:"btn-group",role:"group","aria-label":"Filter Job Cards"})],-1),j=["onSubmit"],z=(0,l._)("h4",{class:"text-center"}," JOBCARD REGISTRATION",-1),B={class:"row mb-2"},N={class:"col-md-4"},I=(0,l._)("label",{class:"form-label"},"Company ",-1),U={class:"col-md-4"},J=(0,l._)("label",{class:"form-label"},"Vehicle / Machine",-1),R={class:"col-md-4"},W=(0,l._)("label",{class:"form-label"},"Service Type",-1),P=(0,l._)("option",{value:""},"Select a Service Type",-1),K=["value"],q={class:"col-md-4"},Y=(0,l._)("label",{class:"form-label"},"Current Km of Service",-1),F={class:"col-md-4"},G=(0,l._)("label",{class:"form-label"},"Next Km of Service",-1),X={class:"col-md-4"},Z=(0,l._)("label",{class:"form-label"},"Enter Date Created",-1),Q={class:"text-center gap-2 justify-content-end"},ee=(0,l._)("button",{type:"submit",class:"btn btn-primary"},"Register",-1),ae={class:"text-center mb-2"},te={key:0},le={class:"row layout-top-spacing"},ne={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},se={class:"panel p-0"},oe={class:"custom-table table3"},ie=["innerHTML"],re=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,l._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})],-1);var ce={setup(e){const a=(0,o.iH)(null),t=(0,o.iH)(""),c=(0,o.iH)(null),w=(0,o.iH)(""),C=(0,o.iH)(""),A=(0,o.iH)(!0),D=(0,o.iH)(!1),L=(0,o.iH)(!1),T=(0,o.iH)([]),ce=(0,o.iH)([]),de=(0,l.f3)("showMessage"),ue=(0,l.f3)("showError"),ve=(0,l.f3)("tableShimmer");(0,r.j)({title:"Jobcard Lists"});(0,o.iH)(localStorage.getItem("source")),(0,o.iH)(!1);const me=(0,o.iH)([]),he=async e=>{L.value=!0;try{const a=await fe.get(`/jobcard-summary?asset_id=${e}`);me.value=a.data,await(0,l.Y3)(),pe()}catch(a){ue(a.message),console.error("Error fetching jobcard summary:",a)}},pe=()=>{const e=me.value||[];L.value=!1;const a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);const t=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Jobcard Summary</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }\n  .logo { width: 150px; height: auto; }\n  .company-title { text-align: center; margin-top: 5px; }\n  .company-title h2 { margin: 5px 0; }\n  .reg-info { position: absolute; top: 40px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; font-weight: normal; }\n  table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n  th, td { border: 1px solid #000; padding: 6px; text-align: center; }\n  th { background-color: #f8f8f8; }\n</style>\n</head>\n<body>\n\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="reg-info">\n    TIN: 135-489-247<br>\n    VRN: 40-032826C\n  </div>\n</div>\n\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile: 0713 000 777, 0657 111 555</div>\n</div>\n\n\n<table>\n  <thead>\n    <tr>\n      <th>${c.value.category.name}</th>\n      <th>TYPE</th>\n    </tr>\n  </thead>\n  <tbody>\n      <tr>\n        <td>${c.value.name}</td>\n        <td>${c.value.type_name}</td>\n      </tr>\n  </tbody>\n</table>\n\n<h2 style="text-align:center; margin-top: 20px;">Jobcard Summary</h2>\n\n<table>\n  <thead>\n    <tr>\n      <th>SN</th>\n      <th>Jobcard NO</th>\n      <th>Date Created</th>\n      <th>Service Type</th>\n      <th>Current Km Service</th>\n      <th>Next Km Service</th>\n      <th>Status</th>\n      <th>Total Sum</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${e.map(((e,a)=>`\n      <tr>\n        <td>${a+1}</td>\n        <td>${e.id}</td>\n        <td>${e.date_created}</td>\n        <td>${e.service_type}</td>\n        <td>${e.current_km_service}</td>\n        <td>${e.next_km_service}</td>\n        <td>${e.status_name}</td>\n        <td style="text-align:right">${parseFloat(e.total_sum).toLocaleString()}/=</td>\n      </tr>\n    `)).join("")}\n    <tr>\n      <td colspan="7" style="text-align:right"><strong>Grand Total</strong></td>\n      <td style="text-align:right"><strong>${e.reduce(((e,a)=>e+parseFloat(a.total_sum||0)),0).toLocaleString()}/=</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n\n\n\n</body>\n</html>\n`,l=a.contentWindow.document;l.open(),l.write(t),l.close(),a.onload=()=>{a.contentWindow.focus(),a.contentWindow.print(),setTimeout((()=>{document.body.removeChild(a)}),1e3)}},be=(0,o.iH)(["Sno","jobcard_id","name","date_created","service_type","current_km_of_service","next_km_of_service","status","actions"]),ge=(0,o.iH)([]),_e=(0,o.iH)({perPage:50,perPageValues:[50,100,200,500,1e3],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","vehicle_no","date","service_type","current_service_kms","next_service_kms","status"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),fe=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),ye=(0,o.iH)(null),we=(0,o.iH)("JOBCARD LIST"),xe=async()=>{try{const e=await fe.get("job-card");ge.value=e.data.map(((e,a)=>({...e,Sno:a+1,jobcard_id:e.id,name:e.machine.name+" - "+e.machine.type_name,status:{key:e.status.name,class:e.status.color}}))),Ve.value=ge.value}catch(e){}},ke=(0,o.iH)(""),Ce=()=>{D.value=!1,A.value=!0;const e={machine_id:a.value.id,machine_name:"none",status_name:"Active",status_color:"primary",status_id:6,service_type:ce.value.find((e=>e.id===t.value)).name,current_km_of_service:w.value,next_km_of_service:C.value,date_created:ke.value,company_id:Ae.value.id,issuer_id:JSON.parse(localStorage.getItem("user")).id};fe.post("/job-card",e).then((e=>{xe(),de("Jobcard registered successfully!"),A.value=!1})).catch((e=>{ue(e.message),console.log(e),A.value=!1}))},Se=()=>{A.value=!0,fe.get("/service-type").then((e=>{Array.isArray(e.data)?ce.value=e.data:console.error("Invalid response format")})).catch((e=>{console.error("Error fetching user data:",e.message)})).finally((()=>{A.value=!1}))},He=()=>{A.value=!0,fe.get("/machines").then((e=>{Array.isArray(e.data)?T.value=e.data:console.error("Invalid response format")})).catch((e=>{console.error("Error fetching machine data:",e.message)})).finally((()=>{A.value=!1}))},Me=(0,o.iH)([]),Ae=(0,o.iH)(""),Oe=async()=>{const e=await fe.get("companies");Me.value=e.data},Ve=(0,o.iH)([]);return(0,l.YP)(Ae,(e=>{Ve.value=e?ge.value.filter((a=>a.company_id===e.id)):ge.value})),(0,l.bv)((()=>{Oe(),xe(),Se(),He()})),(e,i)=>{const r=(0,l.up)("router-link"),c=(0,l.up)("v-client-table");return(0,l.wg)(),(0,l.iD)("div",u,[v,(0,l._)("div",m,[h,(0,l._)("div",p,[(0,l._)("div",b,[(0,l._)("div",g,[(0,l._)("div",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Me.value,(e=>((0,l.wg)(),(0,l.iD)("a",{key:e.id,class:"list-group-item list-group-item-action",id:"company-link-"+e.id,"data-bs-toggle":"list",href:"#company-"+e.id,role:"tab","aria-controls":"company-"+e.id,"data-bs-dismiss":"offcanvas",onClick:a=>Ae.value=e},(0,n.zw)(e.short_name),9,f)))),128)),(0,l._)("a",{class:"list-group-item list-group-item-action",id:"company-link-all","data-bs-toggle":"list",href:"#company-all",role:"tab","aria-controls":"company-all","data-bs-dismiss":"offcanvas",onClick:i[0]||(i[0]=e=>Ae.value="")},"ALL COMPANIES")])])])])]),(0,l._)("div",y,[(0,l._)("button",{class:"btn btn-dark me-2 px-3",onClick:i[1]||(i[1]=a=>e.$router.go(-1))},x),(0,l._)("div",k,[(0,l._)("button",{class:"me-2 btn btn-primary me-2",onClick:i[2]||(i[2]=e=>D.value=!D.value)},S),H,ye.value?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-success",onClick:i[3]||(i[3]=e=>he(ye.value))},[L.value?((0,l.wg)(),(0,l.iD)("div",M,O)):((0,l.wg)(),(0,l.iD)("svg",V,E))])):(0,l.kq)("",!0),$])]),D.value?((0,l.wg)(),(0,l.iD)("form",{key:0,class:"mt-3 p-3 border rounded bg-white shadow",onSubmit:(0,s.iM)(Ce,["prevent"])},[z,(0,l._)("div",B,[(0,l._)("div",N,[I,(0,l.Wm)((0,o.SU)(d()),{modelValue:Ae.value,"onUpdate:modelValue":i[4]||(i[4]=e=>Ae.value=e),options:Me.value,"close-on-select":!0,label:"name","value-prop":"id",placeholder:"Select Company",searchable:!0},null,8,["modelValue","options"])]),(0,l._)("div",U,[J,(0,l.Wm)((0,o.SU)(d()),{disabled:!Ae.value,modelValue:a.value,"onUpdate:modelValue":i[5]||(i[5]=e=>a.value=e),options:T.value,"close-on-select":!0,label:"name","value-prop":"id",placeholder:"Select Machine",onChange:e.handleDescriptionChange,required:!e.machine_field,searchable:!0},null,8,["disabled","modelValue","options","onChange","required"])]),(0,l._)("div",R,[W,(0,l.wy)((0,l._)("select",{class:"form-select","onUpdate:modelValue":i[6]||(i[6]=e=>t.value=e),required:""},[P,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ce.value,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.id,value:e.id},(0,n.zw)(e.name),9,K)))),128))],512),[[s.bM,t.value]])]),(0,l._)("div",q,[Y,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Current Km","onUpdate:modelValue":i[7]||(i[7]=e=>w.value=e)},null,512),[[s.nr,w.value]])]),(0,l._)("div",F,[G,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Next Km","onUpdate:modelValue":i[8]||(i[8]=e=>C.value=e)},null,512),[[s.nr,C.value]])]),(0,l._)("div",X,[Z,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",placeholder:"Enter Next Km","onUpdate:modelValue":i[9]||(i[9]=e=>ke.value=e)},null,512),[[s.nr,ke.value]])])]),(0,l._)("div",Q,[(0,l._)("button",{type:"button",class:"btn btn-danger me-3",onClick:i[10]||(i[10]=e=>D.value=!1)},"Cancel"),ee])],40,j)):(0,l.kq)("",!0),(0,l._)("div",ae,[(0,l._)("h4",null,[(0,l.Uk)((0,n.zw)(we.value)+" ",1),Ae.value?((0,l.wg)(),(0,l.iD)("span",te,(0,n.zw)("FOR ")+" "+(0,n.zw)(Ae.value.short_name),1)):(0,l.kq)("",!0)])]),(0,l._)("div",le,[(0,l._)("div",ne,[(0,l._)("div",se,[(0,l._)("div",oe,[A.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,o.SU)(ve)()},null,8,ie)):((0,l.wg)(),(0,l.j4)(c,{key:1,data:Ve.value,columns:be.value,options:_e.value},{status:(0,l.w5)((e=>[(0,l._)("span",{class:(0,n.C_)(["badge inv-status","badge-"+e.row.status.class])},(0,n.zw)(e.row.status.key),3)])),actions:(0,l.w5)((e=>[(0,l.Wm)(r,{to:"/jobcard/"+e.row.id+"/"+e.row.machine_id,class:"text-primary"},{default:(0,l.w5)((()=>[re])),_:2},1032,["to"])])),_:1},8,["data","columns","options"]))])])])])])}}};const de=ce;var ue=de}}]);
//# sourceMappingURL=8901.e9d0b82d.js.map