{"version":3,"file":"js/8369.3eb8ed85.js","mappings":"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","sources":["webpack://cork-vue3/./src/components/reusables/globalSearch.js","webpack://cork-vue3/./src/components/reusables/globalSearchField.vue","webpack://cork-vue3/./src/components/reusables/globalSearchField.vue?f760","webpack://cork-vue3/./src/views/approvalChain/individual.vue","webpack://cork-vue3/./src/views/approvalChain/individual.vue?d897","webpack://cork-vue3/./node_modules/@babel/runtime/helpers/esm/typeof.js"],"sourcesContent":["export function globalSearch(data, keyword) {\r\n  const lowerKeyword = keyword.toLowerCase().trim()\r\n  if (!lowerKeyword) return data\r\n\r\n  const containsKeyword = obj => {\r\n    if (obj == null) return false\r\n    if (typeof obj === 'string') return obj.toLowerCase().includes(lowerKeyword)\r\n    if (Array.isArray(obj)) return obj.some(containsKeyword)\r\n    if (typeof obj === 'object')\r\n      return Object.values(obj).some(containsKeyword)\r\n    return false\r\n  }\r\n\r\n  return data.filter(item => containsKeyword(item))\r\n}","<template>\r\n     <form @submit.prevent class=\"input-group container\">\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control border-end-0\"\r\n      placeholder=\"Search a word...\"\r\n      v-model=\"filter\"\r\n    >\r\n    <span class=\"input-group-text bg-white border-start-0\">\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-search\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.442.656a5 5 0 1 1 \r\n        0-10 5 5 0 0 1 0 10z\"/>\r\n      </svg>\r\n    </span>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\n\r\n\r\nconst emit = defineEmits(['update:filterValue'])\r\nconst props = defineProps({\r\n  filterValue: String\r\n})\r\nconst filter = ref(props.filterValue || null)\r\n\r\nwatch(filter, val => emit('update:filterValue', val))\r\n</script>\r\n","import script from \"./globalSearchField.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./globalSearchField.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n      \r\n             <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing my-4\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3 table-responsive\">\r\n<table class=\"table table-bordered table-striped\">\r\n      <thead >\r\n        <tr>\r\n          <th>Order No</th>\r\n          <th >Requester</th>\r\n          <th>Date Requested</th>\r\n          <th>Purpose</th>\r\n          <th>Approval Chain</th>\r\n          <th v-if=\"item.project\">Project</th>\r\n          <th v-if=\"item.vendor\">\r\n          <span\r\n           v-if=\"item?.type?.toLowerCase().includes('voucher')\"\r\n          >\r\n           Beneficiary\r\n          </span>\r\n          <span v-else>\r\n           Vendor\r\n          </span>\r\n          </th>\r\n          <th>Awaits</th>\r\n          <th>Cost</th>\r\n          <th   v-if=\"user_permissions.includes('can_print_lpo')\">Action</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr >\r\n          <td>{{ item?.approval }}</td>\r\n          <td @click=\"printTest(item,item.vendor_data)\">{{ item.requester }}</td>\r\n          <td>{{ item?.date }}</td>\r\n          <td>{{item?.type }}</td>\r\n          <td>{{item?.purpose }}</td>\r\n          <td v-if=\"item.project\">{{ item.project }}</td>\r\n          <td v-if=\"item.vendor\">{{ item.vendor }}</td>\r\n          <td>{{ item?.awaits }}</td>\r\n          <td>{{ item?.cost }}</td>\r\n          <td>\r\n              <a \r\n                v-if=\"user_permissions.includes('can_print_lpo')\"\r\n                href=\"javascript:void(0);\" @click=\"printVoucher(item,item.vendor_data)\" class=\"text-success me-2\">\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"/>\r\n    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"/>\r\n  </svg>\r\n</a>\r\n<button \r\n@click=\"toggleApproval()\"\r\nv-if=\"item.purpose === 'Labour Request' && user_permissions.includes('can_create_labour_voucher')\"\r\nclass=\"btn btn-outline-primary\">Create Voucher</button>\r\n          </td>\r\n        </tr>\r\n    <tr v-if=\"item.description \">\r\n      <td colspan=\"8\">\r\n        <b> Brief Description : </b>\r\n        {{ item.description }}\r\n        <span v-if=\"approval_description\"> ( {{ approval_description }} )</span>\r\n      </td>\r\n\r\n    </tr>\r\n      <tr v-if=\"item.remark\">\r\n      <td colspan=\"8\"> <b> Remark :  </b> {{ item.remark }}</td>\r\n    </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    </div>\r\n    </div>\r\n    </div>\r\n\r\n       \r\n          <div \r\n           v-if=\"item.status?.name === 'approved' && user_permissions.includes('can_complete_transaction')\"\r\n           class=\"d-flex justify-content-center mt-2 mb-2\">\r\n    <button class=\"btn btn-primary\" type=\"button\" :disabled=\"loading\" @click=\"complete_transaction =! complete_transaction\">\r\n      <span v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n      <span v-else>Received</span>\r\n    </button>\r\n</div>\r\n <form v-if=\"complete_transaction\" @submit.prevent=\"completeTransaction(item.id)\">\r\n    <div class=\"input-group container\"  >\r\n  <input type=\"text\" class=\"form-control\"\r\n   placeholder=\"Enter Transaction details eg cheque No or MPESA Transaction Id \" required\r\n    v-model=\"remark\">\r\n  <button \r\n  class=\"btn btn-primary me-2\" type=\"submit\" :disabled=\"loading\">\r\n  <span  v-if=\"loading\" v-html=\"loadingSpinner()\"></span>\r\n  <span v-else>Save</span>\r\n  </button>\r\n</div>\r\n </form>\r\n\r\n\r\n \r\n\r\n        <div class=\"modal-body\">\r\n\r\n          <div class=\"d-flex justify-content-center mb-2\"  v-if=\"user_role_id == awaiter.role_id && awaits !=='no one'\">    \r\n    <div class=\"btn-group\" >\r\n            <button class=\"btn btn-primary me-2\" @click=\"status = 3\" :disabled=\"spinner\">\r\n              Check \r\n            </button>\r\n            <button class=\"btn btn-danger me-2\" @click=\"status = 4\" :disabled=\"spinner\">\r\n              Reject\r\n            </button>\r\n\r\n            <button class=\"btn btn-info\" @click=\"status = 14\" :disabled=\"spinner\">\r\n              Remark\r\n            </button>\r\n          </div>\r\n            </div>\r\n   \r\n      <!-- <p class=\"text-center\">{{ status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark' }}</p> -->\r\n      <div v-if=\"status\" class=\"mb-2 text-center\">\r\n        <span\r\n          class=\"badge rounded-pill\"\r\n          :class=\"{\r\n            'bg-danger': status == 4,\r\n            'bg-success': status == 3,\r\n            'bg-info': status == 14\r\n          }\"\r\n          style=\"font-size: 1rem;\"\r\n        >\r\n          {{\r\n            status == 3\r\n              ? 'Check / Approve Request'\r\n              : status == 4\r\n              ? 'Reject Request'\r\n              : 'Fill Remark'\r\n          }}\r\n        </span>\r\n      </div>\r\n\r\n<div class=\"input-group\"  v-if=\"status\">\r\n  <input type=\"text\" class=\"form-control\"\r\n    :placeholder=\"status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark'\" \r\n    v-model=\"remark\">\r\n  <button \r\n     @click=\"onApproveClick()\"\r\n  class=\"btn btn-primary me-2\" type=\"button\" :disabled=\"spinner\">\r\n  <span v-if=\"spinner\" v-html=\"loadingSpinner()\"></span>\r\n  <span v-else>Save</span>\r\n  </button>\r\n</div>\r\n\r\n\r\n       \r\n      \r\n   \r\n        <div class=\"custom-table table3 table-responsive\">\r\n          <table class=\"table\">\r\n            <thead>\r\n              <tr>\r\n                <th v-for=\"chain in approvalChain\" :key=\"chain.role_id || chain.position || chain.name\">\r\n                  {{ chain.name }} <br/>\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                <td\r\n                  v-for=\"(role, idx) in approvalChain\"\r\n                  :key=\"role.role_id || role.position || idx\"\r\n                  :class=\"role?.status?.color ? 'text-' + role.status.color : 'text-danger'\"\r\n                >\r\n                <span> {{ role?.status?.name ?? 'Unchecked' }}</span><br/>\r\n                <span class=\"text-dark\" v-if=\"role.approved_at\">Checked At  :{{ formatDate(role.approved_at) }} </span>  <br>\r\n                <span class=\"text-dark\" v-if=\"role.remark\">Remark :  {{ role.remark }}</span> \r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <!-- approval items starts -->\r\n        <h4 class=\"text-center\" style=\"font-size: 1.3rem;\">APPROVAL ITEMS</h4>\r\n        <div class=\"d-flex justify-content-center mb-3\">\r\n          <input\r\n            v-if=\"create_approval\"\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            style=\"max-width: 350px; font-size: 1rem;\"\r\n            placeholder=\"Enter Brief Description \"\r\n            v-model=\"description\"\r\n          >\r\n        </div>\r\n        <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n          <div class=\"panel p-0\">\r\n            <div class=\"custom-table table3\">\r\n              <table class=\"table table-bordered table-striped\">\r\n      <thead >\r\n        <tr>\r\n          <th>ID</th>\r\n          <th>Item</th>\r\n          <th>Decription</th>\r\n          <th>Quantity</th>\r\n          <th>Rate</th>\r\n          <th>Total</th>\r\n          <th>Receiver</th>\r\n          <th   v-if=\"create_approval\" class=\"text-center\" >select</th>\r\n          <th>Actions</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"reqItem in requisitionItems\">\r\n           <td>{{ reqItem.order_item_id }}</td>\r\n          <td>{{ reqItem.item }}</td>\r\n          <td>\r\n               <router-link class=\"btn btn-outline-primary\" :to=\"`/requisition-budget/${reqItem.requisition_items.item_id}`\"  v-if =\"item.requisition_type ==='budget' && !reqItem.requisition_items.asset_id\">  \r\n               {{ reqItem.description }}\r\n              </router-link>\r\n              <span v-else> \r\n                <span v-if=\"reqItem.selected\">\r\n                     {{ reqItem.description }} ( {{ reqItem.request_description }} )\r\n                </span>\r\n                <span v-else>\r\n                       {{ reqItem.description }}\r\n                </span>\r\n              \r\n              </span>\r\n           </td>\r\n          <td>{{ reqItem.quantity}}\r\n            <span v-if=\"reqItem?.requested_sum\">\r\n             <br> \r\n            Requested : {{ reqItem?.requested_sum }}\r\n            <br>\r\n            Balance :{{ (reqItem.quantity - reqItem?.requested_sum).toFixed(2) }}  \r\n            </span>\r\n\r\n            <span v-if=\"reqItem.selected\"> <br>Requesting : {{ reqItem.requesting_quantity }} </span>\r\n            \r\n          </td>\r\n          <td>{{ reqItem.rate }}</td>\r\n          <td>\r\n\r\n            <span>\r\n              {{ reqItem.total }}<br>\r\n            </span>\r\n            <span v-if=\"reqItem.selected\">\r\n                Requesting : {{ formatNumber(reqItem.requesting_quantity * reqItem.rate_original) }}\r\n            </span>\r\n\r\n          </td>\r\n          <td>{{ reqItem.receiver ?? reqItem.beneficiary }}</td>\r\n          <td  \r\n          v-if=\"create_approval\"\r\n          class=\"text-center\" >\r\n                <svg\r\n     v-if=\"reqItem.selected\"\r\n      @click=\"reqItem.selected =! reqItem.selected\"\r\n      xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\"\r\n      fill=\"currentColor\" class=\"bi bi-check2-circle\" viewBox=\"0 0 16 16\">\r\n      <path d=\"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0\"/>\r\n      <path d=\"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z\"/>\r\n    </svg>\r\n\r\n    <svg\r\n    v-else\r\n     @click=\"reqItem.selected =! reqItem.selected\"\r\n      xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\"\r\n      fill=\"currentColor\" class=\"bi bi-circle\" viewBox=\"0 0 16 16\">\r\n      <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\"/>\r\n    </svg>\r\n        <input v-if=\"reqItem.selected\" type=\"number\" placeholder=\"enter quantity\" class=\"form-control w-75\" step=\"any\"\r\n         v-model=\"reqItem.requesting_quantity\"\r\n          @input=\"reqItem.requesting_quantity = enforceMax(reqItem.requesting_quantity,(reqItem.quantity - reqItem?.requested_sum).toFixed(2))\"\r\n         >\r\n\r\n          <input v-if=\"reqItem.selected\" type=\"text\" placeholder=\"enter Description\" class=\"form-control w-75 mt-1\" v-model=\"reqItem.request_description\">\r\n          <input v-if=\"reqItem.selected\" type=\"text\" placeholder=\"enter Beneficiary\" class=\"form-control w-75 mt-1\"   v-model=\"reqItem.receiver\">\r\n\r\n          </td>\r\n          <td>\r\n                      <router-link  :to=\"`/assets/fuel-statement/${reqItem.requisition_items.asset_id}`\"  v-if =\"reqItem.requisition_items.asset_id\" class=\"me-2\">     \r\n                            <button class=\"btn btn-outline-primary me-2\">Diesel </button>\r\n                      </router-link>  \r\n\r\n                       <router-link  :to=\"`/requisition-budget/${reqItem.requisition_items.item_id}`\"  v-if =\"item.requisition_type ==='budget'\">     \r\n                            <button class=\"btn btn-outline-primary me-2\">Budget</button>\r\n                      </router-link>  \r\n\r\n                         <router-link  :to=\"`/subcontractor/${approval.subcontractor_agreement_id}`\"  v-if =\"approval.subcontractor_agreement_id\">     \r\n                            <button class=\"btn btn-outline-primary me-2\">Subcontractor</button>\r\n                      </router-link>  \r\n                      <button\r\n                       v-if=\"user_permissions.includes('can_print_lpo')\"\r\n                      class=\"btn btn-outline-success\"\r\n                      @click=\"printOrder(reqItem,item)\"\r\n                      >\r\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"/>\r\n    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"/>\r\n  </svg>\r\n\r\n                      </button>\r\n          </td>\r\n    </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- approval items ends -->\r\n        </div>\r\n\r\n</template>\r\n\r\n<style>\r\n.table3 .actions svg {\r\n  padding: 2px;\r\n}\r\n</style>\r\n\r\n<script setup>\r\nimport { onMounted, onBeforeUnmount, ref, inject, computed } from 'vue';\r\nimport axios from 'axios';\r\nimport { useMeta } from '@/composables/use-meta';\r\nimport globalSearchField from '@/components/reusables/globalSearchField.vue';\r\nimport { globalSearch } from '@/components/reusables/globalSearch';\r\n\r\n\r\nconst filter = ref('')\r\n\r\nuseMeta({ title: 'Approval Chains' });\r\n import { useRoute } from 'vue-router';\r\nconst route = useRoute();\r\nconst axiosInstance = axios.create({\r\n  baseURL: process.env.VUE_APP_API_BASE_URL\r\n});\r\nimport { watch } from 'vue';\r\nconst complete_transaction = ref(false)\r\nconst completeTransaction = async (id)=>{\r\n  const payload = {\r\n    status_id : 16,\r\n    remark : remark.value\r\n  }\r\n  try{\r\n        loading.value = true\r\n    const response = await axiosInstance.put(`approval-lists/${id}`,payload)\r\n    showMessage('Transaction Completed')\r\n   getApprovalItems()\r\n   remark.value = ''\r\n   complete_transaction.value = false\r\n  }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n  }finally{\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst create_approval = ref(false)\r\nconst toggleApproval = ()=>{\r\n  create_approval.value =! create_approval.value\r\n}\r\n\r\nconst beneficiary = ref('')\r\nconst description = ref('')\r\nconst createApproval = async () => {\r\n  loading.value = true\r\n  const payload = {\r\n      labour_request_id : item.value.id,\r\n      approval_group_id: 8,\r\n      source: 'Labour Request',\r\n      source_id: item.value.approval_id,\r\n      requester_id: user_id,\r\n      beneficiary : beneficiary.value,\r\n      description : description.value,\r\n    items: requisitionItems.value\r\n      .filter(item => Number(item.requesting_quantity) > 0)\r\n      .map(item => ({\r\n        id: item.id,\r\n        quantity: item.requesting_quantity,\r\n        description : item.request_description,\r\n        beneficiary : item.receiver\r\n      }))\r\n  };\r\n  try{\r\n     const response = await axiosInstance.post('approval-lists',payload)\r\n     showMessage('Request Sent')\r\n     const message =  JSON.parse(localStorage.getItem(\"user\")).name + ' Created Voucher from Labour Request '+ item.value.id\r\n     const message_id = \"wamid.HBgMMjU1Njk4MjY3NjYyFQIAEhggQUM4NzUzOTAxQTIxOEQ2NkZCNDM5RDM4NjUzQjY2QzEA\"\r\n     const receivers = ['255697315583','255698267662']\r\n     receivers.forEach(receiver => {\r\n                whatsappAlert(message,message_id,receiver)\r\n      });\r\n     clearForm()\r\n     getApprovalItems()\r\n     document.getElementById('close').click()\r\n  }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n  }finally{\r\n loading.value = false\r\n  }\r\n}\r\nconst user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\nconst spinner = ref(false);\r\nconst user_id = JSON.parse(localStorage.getItem(\"user\")).id\r\nconst total_amount = ref(0);\r\nconst user_role_id = ref(JSON.parse(localStorage.getItem('user')).role);\r\nconst columns = ref(['Sno','requisition', 'approval', 'purpose','type','requester','project','cost', 'status','date', 'awaits','actions']);\r\nconst itemColumns = ref(['Sno', 'item','description', 'quantity', 'rate', 'total','actions']);\r\nconst items = ref([]);\r\nconst whatsappAlert = inject('whatsappAlert');\r\nconst requisitionItems = ref([]);\r\nconst table_option = ref({\r\n  perPage: 50,\r\n  perPageValues: [  50,100,200],\r\n  skin: 'table table-hover table-striped',\r\n  columnsClasses: { actions: 'actions text-center' },\r\n  sortable: ['id', 'service_name'],\r\n  sortIcon: { base: 'sort-icon-none', up: 'sort-icon-asc', down: 'sort-icon-desc' },\r\n  pagination: { nav: 'scroll', chunk: 5 },\r\n  texts: { count: 'Showing {from} to {to} of {count}', filter: '', filterPlaceholder: 'Search...', limit: 'Results:' },\r\n  resizableColumns: false,\r\n  headings: {\r\n    vendor: function() {\r\n      return isBeneficiaryGroup.value ? 'Beneficiary' : 'Vendor';\r\n    }\r\n  }\r\n});\r\n\r\n\r\n\r\nconst isBeneficiaryGroup = computed(() => {\r\n  return route.params.group_id == '4' || route.params.group_id == '8';\r\n});\r\n\r\n\r\n\r\n\r\n\r\nconst clearForm = () =>{\r\n  status.value = '',\r\n  remark.value = ''\r\n  create_approval.value = false\r\n  beneficiary.value = ''\r\n}\r\nconst showMessage = inject('showMessage');\r\nconst showError = inject('showError');\r\nconst formatNumber = inject('formatNumber');\r\nconst tableShimmer = inject('tableShimmer');\r\nconst formatDate = inject('formatDate');\r\nconst loadingSpinner = inject('loadingSpinner')\r\n const enforceMax = inject('enforceMax');\r\nconst approvalChain = ref([]);\r\nconst awaiter = ref({});\r\nconst awaiter_id = ref('');\r\nconst item_id = ref('');\r\nconst status = ref('')\r\n/** local flag you wanted */\r\nconst localChecked = ref(false);\r\n\r\n/** modal ref to reset flag when closed */\r\nconst approvalModal = ref(null);\r\nlet onHidden = null;\r\nconst loading = ref(false)\r\n const isAllowedTime = () => {\r\n  const hour = new Date().getHours();\r\n  return hour >= 16 || hour < 9;\r\n}\r\n\r\n\r\nconst getApprovalItems = async () => {\r\n\r\n  try {\r\n    const response = await axiosInstance.get(`get-approval-lists?approval_list_id=${route.params.approval_list_id}`);\r\n    items.value = response.data.map((item, index) => {\r\n      let status = item.status;\r\n      if (item.last_checked_in?.status?.id == 4 || item.last_checked_in?.status?.id == 14) {\r\n        status = {\r\n          name: item.last_checked_in.status.name,\r\n          color: item.last_checked_in.status.color\r\n        };\r\n      }\r\n\r\n      let awaits = item.awaiting_approval?.name || 'no one';\r\n      if (item.last_checked_in?.status?.id == 4 || item.last_checked_in?.status?.id == 14) {\r\n        awaits = 'no one';\r\n      }\r\n\r\n      let awaiter_role_id = item.awaiting_approval?.role_id || null;\r\n      if (item.last_checked_in?.status?.id == 4 || item.last_checked_in?.status?.id == 14) {\r\n        awaiter_role_id = null;\r\n      }\r\n\r\n      return {\r\n        ...item,\r\n        status,\r\n        Sno: index + 1,\r\n        group_id : item.group_id,\r\n        purpose: item.approval_group,\r\n        type: item.requisition_type ?? item?.source,\r\n        approval: '0' + item.id,\r\n        approval_id: item.id,\r\n        requisition: item?.requisition_id ?? item?.source_id,\r\n        requester : item.requester?.name ?? item?.requester,\r\n        requester_id : item.requester?.id,\r\n        awaits,\r\n        awaiter_role_id,\r\n        vendor: item.vendor && item.vendor.name ? item.vendor.name : item.beneficiary,\r\n        vendor_data: item.vendor,\r\n        date : formatDate(item.date),\r\n        created_at : item.date,\r\n        last_checked: formatDate(item.last_checked_in?.approved_at),\r\n        cost: item.items\r\n          ? formatNumber(item.items.reduce(\r\n              (sum, i) =>\r\n                sum +\r\n                ((i?.quantity || 0) *\r\n                  (i.requisition_items?.rate || 0)),\r\n              0\r\n            ))\r\n          : 0,\r\n        approved_at: item.last_checked_in?.approved_at\r\n          ? new Date(item.last_checked_in.approved_at).toLocaleString('en-GB', {\r\n              year: 'numeric',\r\n              month: '2-digit',\r\n              day: '2-digit',\r\n              hour: '2-digit',\r\n              minute: '2-digit',\r\n              second: '2-digit'\r\n            })\r\n          : null\r\n      };\r\n    });\r\n\r\n    items.value.sort((a, b) => {\r\n      const role = Number(user_role_id.value);\r\n      const aMatch = a.awaiter_role_id === role;\r\n      const bMatch = b.awaiter_role_id === role;\r\n\r\n      if (aMatch && !bMatch) return -1;\r\n      if (!aMatch && bMatch) return 1;\r\n      return 0;\r\n    });\r\n\r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.error(error);\r\n  } finally {\r\n  }\r\n};\r\n\r\nconst filteredData = computed(()=>{\r\n  return globalSearch(items.value,filter.value)\r\n})\r\n\r\n\r\nwatch(\r\n  () => route.params.group_id,\r\n  (newGroupId, oldGroupId) => {\r\n    if (newGroupId !== oldGroupId) {\r\n      getApprovalGroup()\r\n      getApprovalItems();\r\n    }\r\n  }\r\n);\r\n\r\nconst lastApprovalRole = ref('')\r\nconst requisition_source_item_id = ref(0)\r\nconst item_date =  ref('')\r\nconst awaits = ref('')\r\nconst item = ref('')\r\nconst approval_description = ref('')\r\nconst approval = ref('')\r\nconst getApprovalChain = (row) => {\r\n  approval.value = row\r\n  requisitionItems.value = row.items.map((item, index) => ({\r\n    ...item,\r\n    order_item_id :  item?.requisition_items?.id,\r\n    Sno: index + 1,\r\n    item: item?.requisition_items?.remark,\r\n    description: item?.requisition_items?.description + (item.description ? ' ( ' + item.description + ' )' : ''),\r\n    rate: Number(item?.requisition_items?.rate).toLocaleString() + '/=',\r\n    rate_original :item?.requisition_items?.rate,\r\n    total: (item?.quantity * item?.requisition_items?.rate).toLocaleString() + '/=',\r\n    selected:false,\r\n    rate_original : item?.requisition_items?.rate,\r\n    requesting_quantity : '',\r\n    request_description : ''\r\n  }));\r\n\r\n  awaits.value = row.awaits\r\n  approval_description.value = row.approval_description;\r\n  approvalChain.value = (row.roles_sequence || []).slice();\r\n  lastApprovalRole.value = (row.roles_sequence?.length > 0)\r\n  ? row.roles_sequence[row.roles_sequence.length - 1].role_id\r\n  : null;\r\n  awaiter.value = row.awaiting_approval || {};\r\n  awaiter_id.value = row.awaiting_approval?.role_id || null;\r\n  item_id.value = row.id;\r\n  item_date.value = row.date;\r\n  requisition_source_item_id.value = row;\r\n  item.value = row;\r\n  localChecked.value = false;\r\n};\r\n\r\n\r\nconst remark = ref('')\r\nconst approveRequest = async () => {\r\n  const payload = {\r\n    subcontractor_agreement_id : item.value.subcontractor_agreement_id,\r\n    approval_group_id : route.params.group_id,\r\n    status_id : status.value,\r\n    approval_item_id: item_id.value,\r\n    role_id: user_role_id.value,\r\n    remark: remark.value,\r\n    last_role: lastApprovalRole.value,\r\n    requisition_type: requisition_source_item_id.value.requisition_type,\r\n    project : requisition_source_item_id.value,\r\n    requisition_items : requisition_source_item_id.value.items.map((item)=>({\r\n      source_id: item.requisition_items.item_id,\r\n      cost : item.requisition_items.quantity * item.requisition_items.rate,\r\n      description : item.requisition_items.description,\r\n      remark : \"From LPO NO : \" + item_id.value + \" created on date \" + item_date.value,\r\n      remarker_id : JSON.parse(localStorage.getItem('user')).id,\r\n      remarker : JSON.parse(localStorage.getItem('user')).name\r\n    }))\r\n  };\r\n\r\n\r\n  await axiosInstance.post('approval-chains', payload);\r\n  awaiter_id.value = '';\r\n  remark.value = ''\r\n  showMessage('data saved successfully');\r\n};\r\n\r\n\r\nconst onApproveClick = async () => {\r\n  try {\r\n    spinner.value = true;\r\n    await approveRequest();\r\n    localChecked.value = true; \r\n    awaiter.value.role_id = ''\r\n    remark.value = ''\r\n    status.value = ''\r\n       \r\n  } catch (error) {\r\n    showError(error.message);\r\n    console.error(error);\r\n  } finally {\r\n    spinner.value = false;\r\n  }\r\n};\r\n\r\n\r\nconst printVoucher = async (voucher,vendor) => {\r\n  console.log(voucher)\r\n  total_amount.value = voucher.items.reduce((acc, item) => acc + (item.quantity * item.requisition_items?.rate), 0); // calculate total amount\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n    const today = new Date();\r\n   const date = new Date(voucher.created_at)\r\n    const dateString = `${date.getDate().toString().padStart(2,'0')}/${(date.getMonth()+1).toString().padStart(2,'0')}`\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Print Voucher</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n  .logo { width: 160px; height: auto; }\r\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .company-title h2 { margin: 5px 0; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; font-weight: normal; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n  .title { text-align: center; font-weight: bold;  margin: 20px 0 10px 0; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 4px; overflow: hidden; }\r\n  table.details td, table.items th, table.items td, .signatures th, .signatures td { border: 0.5px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border-bottom: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  .text-success { color: green; }\r\n .signature-area { margin-top: 30px; }\r\n  .signature-line { border-top: 1px solid #000; width: 200px; display: inline-block; margin-top: 50px; }\r\n  .text-danger { color: red; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"voucher-box\">\r\n    ${voucher.type.toLowerCase().includes('voucher') || voucher.type.toLowerCase().includes('labour')  ? `Voucher`:'LPO'} NO: <br>\r\n    <span style=\"color:red;\">${(\"0000\" + voucher.approval).slice(-4)}/${dateString}</span>\r\n  </div>\r\n</div>\r\n<div class=\"reg-info\">\r\n  TIN: 135-489-247<br>\r\n  VRN: 40-032826C\r\n</div>\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n<div class=\"section-title\"> ${voucher?.purpose?.toUpperCase()  } DETAILS</div>\r\n\r\n<div class=\"title\">PROJECT :  ${voucher?.project?.toUpperCase() ?? \"NO PROJECT\" }</div>\r\n\r\n\r\n<p><strong>ORDER ITEMS</strong></p>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th>SN</th>\r\n      <th>Item</th>\r\n      <th>Description</th>\r\n      <th>Quantity</th>\r\n      <th>Rate</th>\r\n      <th>Total</th>\r\n      <th>Receiver</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${voucher.items.map((item, index) => `\r\n    <tr>\r\n      <td>${index + 1}</td>\r\n      <td>${item.requisition_items?.remark || 'N/A'}</td>\r\n      <td>${item.requisition_items?.description + (item.description ? ' , ' + item.description : '') || 'N/A'}</td>\r\n      <td class=\"text-right\">${item.requisition_items?.quantity || '0'}</td>\r\n      <td class=\"text-right\">${Number(item.rate || 0).toLocaleString()}/=</td>\r\n      <td class=\"text-right\">${(item.quantity * item.requisition_items?.rate || 0).toLocaleString()}/=</td>\r\n      <td>${item.receiver ||item.beneficiary || 'N/A'}</td>\r\n    </tr>\r\n\r\n    `\r\n  )\r\n    .join(\"\")}\r\n ${voucher.description? `\r\n  <tr>\r\n    <td colspan=\"7\" style=\"text-align:start;\">\r\n      Brief Description : ${voucher.description + (voucher.approval_description ? ' , ' + voucher.approval_description : '') } \r\n    </td>\r\n  </tr>\r\n` : ''}\r\n\r\n    <tr>\r\n     <td colspan=\"7\" style=\"text-align:right;\"><strong>TOTAL</strong>  <strong>${total_amount.value.toLocaleString()}/=</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<div class=\"section-title\">APPROVAL CHAIN </div>\r\n<table class=\"signatures\" style=\"margin-top: 20px;\">\r\n  <thead>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <th>${role.name || 'N/A'}</td>\r\n            `).join('')}\r\n    </tr>\r\n\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <td class=\"text-center ${role?.status?.id == 3 ? 'text-success' : 'text-danger'}\">${role?.status?.name ?? 'Pending'}</td>\r\n       `).join('')}\r\n      </tr>\r\n  </tbody>\r\n</table>\r\n\r\n\r\n\r\n${voucher.purpose.toLowerCase().includes('voucher') ? `\r\n<div class=\"signature-area\" style=\"display: flex; justify-content: space-between; margin-top: 20px;\">\r\n  <div style=\"text-align: center;\">\r\n    \r\n<div style=\"text-align: center; margin-top: 30px;\">\r\n  <!-- Beneficiary name above the line -->\r\n  <div style=\"margin-bottom: 5px;\">\r\n    <strong>${voucher.beneficiary || '&nbsp;'}</strong>\r\n  </div>\r\n\r\n  <!-- The signature line -->\r\n  <div style=\"border-bottom: 1px solid #000; width: 200px; margin: 0 auto;\"></div>\r\n</div>    <p>Received By: </p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Receiver's Signature</p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Received Date</p>\r\n  </div>\r\n</div>\r\n` : ''}\r\n</body>\r\n</html>\r\n`;\r\n\r\n    // Write content to iframe and print\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print voucher: ${error.message}`);\r\n  }\r\n};\r\n\r\nconst printOrder = async (item,voucher) => {\r\n  total_amount.value = voucher.items.reduce((acc, item) => acc + (item.quantity * item.requisition_items?.rate), 0); // calculate total amount\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n    const today = new Date();\r\n   const date = new Date(voucher.created_at)\r\n   const dateString = `${formatDate(date)}`\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Print Order</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n  .logo { width: 160px; height: auto; }\r\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 8px;  margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .company-title h2 { margin: 5px 0; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 11px; line-height: 1.4; font-weight: normal; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n  .title { text-align: center; font-weight: bold;  margin: 20px 0 10px 0; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 4px; overflow: hidden; }\r\n  table.details td, table.items th, table.items td, .signatures th, .signatures td { border: 0.5px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border-bottom: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  .text-success { color: green; }\r\n .signature-area { margin-top: 30px; }\r\n  .signature-line { border-top: 1px solid #000; width: 200px; display: inline-block; margin-top: 50px; }\r\n  .text-danger { color: red; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"voucher-box\">\r\n    Date : ${dateString}<br>\r\n    ${item.requisition_items.beneficiary || voucher.type.toLowerCase().includes('labour')  ? `ORDER`:'ORDER'} NO: <span style=\"color:red;\">${(\"0000\" + voucher.approval).slice(-4)}</span><br>\r\n    ${item.requisition_items.beneficiary || voucher.type.toLowerCase().includes('labour') ? `VOUCHER`:'LPO'} NO: <span style=\"color:red;\">${(\"00\" + item.requisition_items.id).slice(-4)}</span>\r\n  </div>\r\n</div>\r\n<div class=\"reg-info\">\r\n  TIN: 135-489-247<br>\r\n  VRN: 40-032826C\r\n</div>\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n<div class=\"section-title\"> ${item.requisition_items.beneficiary || voucher.type.toLowerCase().includes('labour') ?'VOUCHER':'PURCHASE ORDER' } DETAILS </div>\r\n\r\n<div class=\"title\">PROJECT :  ${voucher?.project?.toUpperCase() ?? \"NO PROJECT\" }</div>\r\n\r\n${item.vendor ? `\r\n\r\n\r\n<p><strong>Vendor Details </strong></p>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th>Vendor Name</th>\r\n      <th>Location</th>\r\n      <th>Email</th>\r\n      <th>Phone</th>\r\n      <th>Address</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n\r\n    <tr>\r\n      <td>${item?.vendor?.name || '&nbsp;'}</td>\r\n      <td>${item?.vendor?.location || ' '}</td>\r\n      <td class=\"text-right\">${item?.vendor?.email || ' '}</td>\r\n      <td class=\"text-right\">${item?.vendor?.phone || ' '}</td>\r\n      <td class=\"text-right\">${item?.vendor?.address|| ' '}</td>\r\n    </tr>\r\n\r\n  </tbody>\r\n</table>\r\n    ` : ''}\r\n\r\n<p><strong>Please provide the following as per requisition details belows</strong></p>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th>Item</th>\r\n      <th>Description</th>\r\n      <th>Quantity</th>\r\n      <th>Rate</th>\r\n      <th>Total</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${`\r\n    <tr>\r\n      <td>${item.requisition_items?.remark || 'N/A'}</td>\r\n      <td>${item.requisition_items?.description || 'N/A'}</td>\r\n      <td class=\"text-right\">${item.quantity || '0'}</td>\r\n      <td class=\"text-right\">${Number(item.requisition_items?.rate || 0).toLocaleString()}/=</td>\r\n      <td class=\"text-right\">${(item.quantity * item.requisition_items?.rate || 0).toLocaleString()}/=</td>\r\n    </tr>\r\n\r\n    `\r\n  }\r\n\r\n ${voucher.description? `\r\n  <tr>\r\n    <td colspan=\"6\" style=\"text-align:start;\">\r\n      Brief Description : ${voucher.description + (voucher.approval_description ? ' , ' + voucher.approval_description : '') } \r\n    </td>\r\n  </tr>\r\n` : ''}\r\n\r\n    <tr>\r\n     <td colspan=\"6\" style=\"text-align:right;\"><strong>TOTAL</strong>  <strong>${total_amount.value.toLocaleString()}/=</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<div class=\"section-title\">APPROVAL CHAIN</div>\r\n<table class=\"signatures\" style=\"margin-top: 20px;\">\r\n  <thead>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <th>${role.name || 'N/A'}</td>\r\n            `).join('')}\r\n    </tr>\r\n\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <td class=\"text-center ${role?.status?.id == 3 ? 'text-success' : 'text-danger'}\">${role?.status?.name ?? 'Pending'}</td>\r\n       `).join('')}\r\n      </tr>\r\n  </tbody>\r\n</table>\r\n\r\n\r\n\r\n${item.requisition_items.beneficiary || item.beneficiary ? `\r\n<div class=\"signature-area\" style=\"display: flex; justify-content: space-between; margin-top: 20px;\">\r\n  <div style=\"text-align: center;\">\r\n    \r\n<div style=\"text-align: center; margin-top: 30px;\">\r\n  <div style=\"margin-bottom: 5px;\">\r\n    <strong>${item.requisition_items.beneficiary || item.beneficiary ||  '&nbsp;'}</strong>\r\n  </div>\r\n\r\n  <!-- The signature line -->\r\n  <div style=\"border-bottom: 1px solid #000; width: 200px; margin: 0 auto;\"></div>\r\n</div>    <p>Received By: </p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Receiver's Signature</p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Received Date</p>\r\n  </div>\r\n</div>\r\n` : ''}\r\n</body>\r\n</html>\r\n`;\r\n\r\n    // Write content to iframe and print\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print voucher: ${error.message}`);\r\n  }\r\n};\r\n\r\n\r\nconst printTest = async (voucher,vendor) => {\r\n  total_amount.value = voucher.items.reduce((acc, item) => acc + (item.requisition_items?.quantity * item.requisition_items?.rate), 0); // calculate total amount\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n    const today = new Date();\r\n   const date = new Date(voucher.created_at)\r\n    const dateString = `${date.getDate().toString().padStart(2,'0')}/${(date.getMonth()+1).toString().padStart(2,'0')}`\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Print Voucher</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header {  display: flex; justify-content: space-between; align-items: flex-start;font-weight:bold }\r\n  .logo { width: 160px; height: auto; }\r\n  .text-style { font-family: 'Courier New', monospace; }\r\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .company-title h2 { margin: 5px 0; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; font-weight: normal; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n  .title { text-align: center;   margin: 10px 0 10px 0; font-size:20px }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 4px; overflow: hidden; }\r\n  table.details td, table.items th, table.items td, .signatures th, .signatures td { border: 0.5px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border-bottom: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  .text-success { color: green; }\r\n .signature-area { margin-top: 30px; }\r\n  .signature-line { border-top: 1px solid #000; width: 200px; display: inline-block; margin-top: 50px; }\r\n  .text-danger { color: red; }\r\n  hr {\r\n  border: 0;\r\n  border-top: 0.4px solid #000 !important;\r\n  opacity: 1 !important;\r\n  margin: 0px 0;\r\n}\r\n\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"text-style\">\r\n  ${voucher.purpose.toLowerCase().includes('voucher') ? `VOUCHER`:'LPO'}  NO. ${voucher.approval}\r\n</div>\r\n<div class=\"company-title text-style\">\r\n  <i>\r\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\r\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div><b>Tel:</b> , 0713 000 777, 0657 111 555</div>\r\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\r\n  <div><b>TIN:</b> 135-489-247    <b>VRN:</b> 40-032826C</div>\r\n  </i>\r\n</div>\r\n<hr style=\"margin-top:20px\">\r\n<div class=\"title text-style\">  ${voucher?.purpose?.toUpperCase()  } :  ${voucher?.project?.toUpperCase() ?? \"NO PROJECT\" }</div>\r\n<hr>\r\n${!voucher.purpose.toLowerCase().includes('voucher') ? `\r\n\r\n<div style=\"display:flex;justify-content:space-between;gap:20px;margin-top:10px;font-size:13px;\">\r\n  <div style=\"flex:1;border:1px solid #f0f0f0;padding:8px;\">\r\n  <table style=\"width:100%; border-collapse: collapse;\">\r\n  <tr><td style=\"background:#333; border-top:1px solid #000; border-right:1px solid #000; border-bottom:1px solid #000; padding:5px;width:2cm\">\r\n  <b>Vendor</b>\r\n</td>\r\n</tr>\r\n  <tr ><td>Name</td><td style=\"border-bottom:1px solid #000;\">${vendor?.name || ''}</td></tr>\r\n  <tr ><td>Address</td><td class=\"text-style\" style=\"border-bottom:1px solid #000;\">${vendor?.address || ''}</td></tr>\r\n  <tr ><td>City</td><td class=\"text-style\" style=\"border-bottom:1px solid #000;\">${vendor?.location || ''}</td></tr>\r\n  <tr ><td>Phone</td><td class=\"text-style\" style=\"border-bottom:1px solid #000;\">${vendor?.phone || ''}</td></tr>\r\n  <tr ><td >TIN</td><td class=\"text-style\" style=\"border-bottom:1px solid #000;\">${vendor?.tin || ''}</td></tr>\r\n  <tr ><td >VRN</td><td  class=\"text-style\" style=\"border-bottom:1px solid #000;\">${vendor?.vrn || ''}</td></tr>\r\n</table>\r\n\r\n  </div>\r\n  <div style=\"width:35%;border:1px solid #f0f0f0;padding:8px;margin-top:1cm\">\r\n    <table style=\"width:100%;border-collapse:collapse;\">\r\n      <tr><td class=\"text-style\"> ${voucher.purpose.toLowerCase().includes('voucher') ? `VOUCHER`:'LPO'} :</td><td class=\"text-style\">${voucher?.requisition || ''}</td></tr>\r\n      <tr><td class=\"text-style\"> ${voucher.purpose.toLowerCase().includes('voucher') ? `VOUCHER`:'LPO'} DATE:</td><td class=\"text-style\">${dateString}/${date.getFullYear()}</td></tr>\r\n      <tr><td class=\"text-style\">REQ:</td><td class=\"text-style\">${voucher?.id || ''}</td></tr>\r\n      <tr><td class=\"text-style\">REQ DATE:</td><td class=\"text-style\">${dateString}/${date.getFullYear()}</td></tr>\r\n      <tr><td class=\"text-style\">STATUS:</td><td class=\"text-style\">${voucher?.status.name || ''}</td></tr>\r\n      <tr><td class=\"text-style\">AWAITS:</td><td class=\"text-style\">${voucher?.awaits || ''}</td></tr>\r\n    </table>\r\n  </div>\r\n</div>\r\n<br>\r\n\r\n  </tbody>\r\n</table>\r\n    ` : ''}\r\n\r\n<p class=\"text-style\">Please provide the following as per requisition details below</p>\r\n<h2 class=\"text-style\">CURRENCY : TSH</h2>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th class=\"text-style\">No.</th>\r\n      <th class=\"text-style\">ITEM NAME</th>\r\n      <th class=\"text-style\">DESCRIPTION</th>\r\n      <th class=\"text-style\">QUANTITY</th>\r\n      <th class=\"text-style\">RATE</th>\r\n      <th class=\"text-style\">TOTAL</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${voucher.items.map((item, index) => `\r\n    <tr>\r\n      <td class=\"text-style\">${index + 1}</td>\r\n      <td class=\"text-style\">${item.requisition_items?.remark || 'N/A'}</td>\r\n      <td class=\"text-style\">${item.requisition_items?.description || 'N/A'}</td>\r\n      <td class=\"text-style text-right\">${item.requisition_items?.quantity || '0'}</td>\r\n      <td class=\" text-style text-right\">${Number(item.requisition_items?.rate || 0).toLocaleString()}/=</td>\r\n      <td class=\"text-style text-right\">${(item.requisition_items?.quantity * item.requisition_items?.rate || 0).toLocaleString()}/=</td>\r\n    </tr>\r\n\r\n    `\r\n  )\r\n    .join(\"\")}\r\n\r\n    <tr>\r\n     <td colspan=\"6\" class=\"text-style\" style=\"text-align:right;\"><strong>TOTAL</strong>  <strong>${total_amount.value.toLocaleString()}/=</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<h2 style=\"text-style\">Note : </h2>\r\n<p class=\"text-style\">${voucher.description ?? ''}</p>\r\n<div class=\"title text-style\" style=\"margin-top:40px\">APPROVAL CHAIN</div>\r\n<table class=\"signatures\" style=\"margin-top: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <td style=\"border-bottom:1px solid #000;border-top:1px solid #fff;border-right:1px solid #fff;border-left:1px solid #fff;\" class=\"text-center ${role?.status?.id == 3 ? 'text-success' : 'text-danger'}\">${role?.status?.name ?? 'Pending'}</td>\r\n       `).join('')}\r\n      </tr>\r\n  </tbody>\r\n    <tfooter>\r\n    <tr>\r\n          ${voucher.roles_sequence.map(role => `\r\n      <th style=\"border-bottom:1px solid #fff;border-top:1px solid #fff;border-right:55px solid #fff;border-left:1px solid #fff;\">${role.name || 'N/A'}</td>\r\n            `).join('')}\r\n    </tr>\r\n\r\n  </tfooter>\r\n</table>\r\n\r\n\r\n\r\n${voucher.purpose.toLowerCase().includes('voucher') ? `\r\n    <div class=\"title text-style\" style=\"margin-top:40px;margin-bottom:-20px\">BENEFICIARY</div>\r\n\r\n<div class=\"signature-area\" style=\"display: flex; justify-content: space-between; margin-top: 20px;\">\r\n  <div style=\"text-align: center;\">\r\n<div style=\"text-align: center; margin-top: 30px;\">\r\n  <!-- Beneficiary name above the line -->\r\n  <div class=\"text-style\" style=\"margin-bottom: 5px;\">\r\n    <strong>${voucher.beneficiary || '&nbsp;'}</strong>\r\n  </div>\r\n\r\n  <!-- The signature line -->\r\n  <div style=\"border-bottom: 1px solid #000; width: 200px; margin: 0 auto;\"></div>\r\n</div>    <p>Received By: </p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Receiver's Signature</p>\r\n  </div>\r\n  <div style=\"text-align: center;\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Received Date</p>\r\n  </div>\r\n</div>\r\n` : ''}\r\n</body>\r\n</html>\r\n`;\r\n\r\n    // Write content to iframe and print\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print voucher: ${error.message}`);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\nimport jsPDF from \"jspdf\";\r\nimport \"jspdf-autotable\";\r\nimport logo from \"@/assets/images/logo.jpg\";\r\n\r\nconst downloadApprovalItem = async (voucher, vendor) => {\r\n  try {\r\n    const totalAmount = voucher.items.reduce(\r\n      (acc, item) =>\r\n        acc + (item.requisition_items?.quantity * item.requisition_items?.rate || 0),\r\n      0\r\n    );\r\n\r\n    const today = new Date();\r\n    const date = today.getDate().toString().padStart(2, \"0\");\r\n    const month = (today.getMonth() + 1).toString().padStart(2, \"0\");\r\n    const dateString = `${date}/${month}`;\r\n\r\n    const doc = new jsPDF(\"p\", \"pt\", \"a4\");\r\n    let cursorY = 20;\r\n\r\n    const img = new Image();\r\n    img.src = logo;\r\n    img.onload = () => {\r\n      doc.addImage(img, \"PNG\", 40, cursorY, 160, 50);\r\n\r\n    // Voucher Ref box\r\ndoc.setDrawColor(0);\r\ndoc.rect(480, cursorY, 90, 40); // moved right and reduced size\r\ndoc.setFontSize(12);\r\ndoc.text(\"Ref NO:\", 500, cursorY + 15);\r\ndoc.setTextColor(255, 0, 0);\r\ndoc.text(\r\n  `${(\"0000\" + voucher.ref_no).slice(-4)}/${dateString}`,\r\n  500,\r\n  cursorY + 30\r\n);\r\ndoc.setTextColor(0);\r\n\r\n\r\n      doc.setFontSize(10);\r\n      doc.text(\"TIN: 103-826-519\", 400, cursorY + 65);\r\n      doc.text(\"VRN: 20-01-017530R\", 400, cursorY + 80);\r\n\r\n      cursorY += 100;\r\n\r\n      const pageWidth = doc.internal.pageSize.getWidth();\r\n\r\n      doc.setFontSize(16);\r\n      doc.setFont(undefined, \"bold\");\r\n      doc.text(\"COPEX CONTRACTORS CO.LTD\", pageWidth / 2, cursorY, { align: \"center\" });\r\n      cursorY += 15;\r\n      doc.setFontSize(10);\r\n      doc.setFont(undefined, \"normal\");\r\n      doc.text(\"Msamvu, P.O.BOX 678, Morogoro\", pageWidth / 2, cursorY, { align: \"center\" });\r\n      cursorY += 12;\r\n      doc.text(\"Mobile: 0713 000 777, 0657 111 555\", pageWidth / 2, cursorY, { align: \"center\" });\r\n      cursorY += 20;\r\n\r\n      doc.setFontSize(12);\r\n      doc.setFont(undefined, \"bold\");\r\n      doc.text(`${voucher.type.toUpperCase()} DETAILS`, pageWidth / 2, cursorY, { align: \"center\" });\r\n      cursorY += 20;\r\n\r\n      doc.autoTable({\r\n        startY: cursorY,\r\n        head: [[\"Vendor Name\", \"Location\", \"Email\", \"Phone\", \"Address\"]],\r\n        body: [[\r\n          vendor.name || \"N/A\",\r\n          vendor.location || \"N/A\",\r\n          vendor.email || \"N/A\",\r\n          vendor.phone || \"N/A\",\r\n          vendor.address || \"N/A\",\r\n        ]],\r\n        theme: \"grid\",\r\n        headStyles: { fillColor: [248, 248, 248], textColor: 0 },\r\n        styles: { fontSize: 10 },\r\n      });\r\n      cursorY = doc.lastAutoTable.finalY + 15;\r\n\r\n      const itemsBody = voucher.items.map((item, i) => [\r\n        i + 1,\r\n        item.requisition_items?.remark || \"N/A\",\r\n        item.requisition_items?.description || \"N/A\",\r\n        item.requisition_items?.quantity || 0,\r\n        Number(item.requisition_items?.rate || 0).toLocaleString(),\r\n        ((item.requisition_items?.quantity || 0) * (item.requisition_items?.rate || 0)).toLocaleString(),\r\n      ]);\r\n      itemsBody.push([{ content: \"TOTAL\", colSpan: 5, styles: { halign: \"right\", fontStyle: \"bold\" } }, totalAmount.toLocaleString()]);\r\n\r\n      doc.autoTable({\r\n        startY: cursorY,\r\n        head: [[\"SN\", \"Item\", \"Description\", \"Quantity\", \"Rate\", \"Total\"]],\r\n        body: itemsBody,\r\n        theme: \"grid\",\r\n        headStyles: { fillColor: [248, 248, 248], textColor: 0 },\r\n        styles: { fontSize: 10, halign: \"center\" },\r\n        columnStyles: { 0: { halign: \"center\" }, 1: { halign: \"left\" }, 2: { halign: \"left\" } },\r\n      });\r\n      cursorY = doc.lastAutoTable.finalY + 25;\r\n\r\n      doc.setFontSize(12);\r\n      doc.setFont(undefined, \"bold\");\r\n      doc.text(\"APPROVAL CHAIN\", pageWidth / 2, cursorY, { align: \"center\" });\r\n      cursorY += 10;\r\n\r\n      const approvalHead = voucher.roles_sequence.map(r => r.name || \"N/A\");\r\n      const approvalBody = [\r\n        voucher.roles_sequence.map(r => ({\r\n          content: r.checked ? \"Approved\" : \"Pending\",\r\n          styles: { halign: \"center\", textColor: r.checked ? [0, 128, 0] : [255, 0, 0] },\r\n        })),\r\n      ];\r\n\r\n      doc.autoTable({\r\n        startY: cursorY,\r\n        head: [approvalHead],\r\n        body: approvalBody,\r\n        theme: \"grid\",\r\n        headStyles: { fillColor: [248, 248, 248], textColor: 0 },\r\n        styles: { fontSize: 10 },\r\n      });\r\n\r\n      doc.save(`voucher_${voucher.ref_no}.pdf`);\r\n    };\r\n  } catch (error) {\r\n    console.error(`Failed to generate voucher: ${error.message}`);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst approvalGroup = ref('')\r\nconst getApprovalGroup = async(groupId = null) => {\r\n  approvalGroup.value = '';\r\n  \r\n  // Use provided groupId or get from first approval item\r\n  let targetGroupId = groupId;\r\n  if (!targetGroupId && items.value.length > 0) {\r\n    targetGroupId = items.value[0].group_id;\r\n  }\r\n  \r\n  if (!targetGroupId) {\r\n    console.warn('No group ID available for fetching approval group');\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    const response = await axiosInstance.get(`approval-groups/${targetGroupId}`);\r\n    approvalGroup.value = response.data;\r\n  } catch (error) {\r\n    showError(`Failed to fetch approval group: ${error.message}`);\r\n  }\r\n};\r\nonMounted(async () => {\r\n  await getApprovalItems();\r\n  await getApprovalGroup(); // Now uses group_id from items\r\n  \r\n  // Auto-load first approval chain if items exist\r\n  if (items.value.length > 0) {\r\n    getApprovalChain(items.value[0]);\r\n  }\r\n\r\n  if (approvalModal.value) {\r\n    onHidden = () => {\r\n      localChecked.value = false;\r\n      spinner.value = false;\r\n    };\r\n    approvalModal.value.addEventListener('hidden.bs.modal', onHidden);\r\n  }\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (approvalModal.value && onHidden) {\r\n    approvalModal.value.removeEventListener('hidden.bs.modal', onHidden);\r\n  }\r\n});\r\n</script>\r\n","import script from \"./individual.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./individual.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./individual.vue?vue&type=style&index=0&id=d1646e78&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };"],"names":["globalSearch","data","keyword","lowerKeyword","toLowerCase","trim","containsKeyword","obj","includes","Array","isArray","some","Object","values","filter","item","ref","props","filterValue","watch","val","emit","__exports__","useMeta","title","route","useRoute","axiosInstance","axios","baseURL","process","complete_transaction","completeTransaction","async","payload","status_id","remark","value","loading","put","id","showMessage","getApprovalItems","error","showError","message","console","log","create_approval","toggleApproval","description","user_permissions","JSON","parse","localStorage","getItem","permissions","spinner","total_amount","user_role_id","role","items","requisitionItems","inject","isBeneficiaryGroup","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filterPlaceholder","limit","resizableColumns","headings","vendor","computed","params","group_id","formatNumber","formatDate","loadingSpinner","enforceMax","approvalChain","awaiter","awaiter_id","item_id","status","localChecked","approvalModal","onHidden","response","get","approval_list_id","map","index","last_checked_in","name","color","awaits","awaiting_approval","awaiter_role_id","role_id","Sno","purpose","approval_group","type","requisition_type","source","approval","approval_id","requisition","requisition_id","source_id","requester","requester_id","beneficiary","vendor_data","date","created_at","last_checked","approved_at","cost","reduce","sum","i","quantity","requisition_items","rate","Date","toLocaleString","year","month","day","hour","minute","second","sort","a","b","Number","aMatch","bMatch","newGroupId","oldGroupId","getApprovalGroup","lastApprovalRole","requisition_source_item_id","item_date","approval_description","getApprovalChain","row","order_item_id","rate_original","total","selected","requesting_quantity","request_description","roles_sequence","slice","length","approveRequest","subcontractor_agreement_id","approval_group_id","approval_item_id","last_role","project","remarker_id","remarker","post","onApproveClick","printVoucher","voucher","acc","iframe","document","createElement","style","display","body","appendChild","dateString","getDate","toString","padStart","getMonth","printContent","toUpperCase","receiver","join","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","printOrder","location","email","phone","address","printTest","tin","vrn","getFullYear","approvalGroup","groupId","targetGroupId","warn","onMounted","addEventListener","onBeforeUnmount","removeEventListener","_typeof","o","Symbol","iterator","constructor","prototype"],"sourceRoot":""}