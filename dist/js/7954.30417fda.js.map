{"version":3,"file":"js/7954.30417fda.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/hr/labour/attendances.vue","webpack://cork-vue3/./src/views/hr/labour/attendances.vue?dc64"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Services</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n\r\n            <h3 class=\"text-center\">SITE LABOUR ATTENDANCE FROM {{ start_date }} TO {{ end_date }}</h3>\r\n            <!-- <span v-if=\"loading\" v-html=\"waitIndicator()\"></span> -->\r\n            <div class=\"d-flex me-4 mt-2 \">\r\n                        <div class=\"ms-auto btn-group\">\r\n                           <button class=\"btn btn-success me-2\"\r\n                             @click=\"printLabourAttendance(attendances)\" \r\n                            >                           \r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n  <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n</svg>\r\n</button>\r\n\r\n<input type=\"date\" v-model=\"start_date\" class=\"form-control me-2\">\r\n<input type=\"date\" v-model=\"end_date\" class=\"form-control me-2\">\r\n                    <Multiselect\r\n  v-model=\"project\"\r\n  :options=\"projects\"\r\n  label=\"short_name\"\r\n  placeholder=\"Select Project\"  \r\n  :searchable=\"true\" \r\n  :allow-empty=\"false\"\r\n   style=\"min-width: 300px;\"\r\n/>                       \r\n<button class=\"btn btn-primary\" @click=\"getLabourAttendance()\">Search</button>\r\n                        </div>\r\n                    </div>  \r\n      \r\n        <div class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <div v-if=\"loading\" v-html=\"tableShimmer()\"></div>\r\n                        <v-client-table v-else :data=\"attendances\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge inv-status\" :class=\"'badge-' + props.row.status.color\">\r\n                                    {{ props.row.status.name }}\r\n                                </span>\r\n                            </template>\r\n                            <template #actions=\"props\">\r\n                                <a href=\"javascript:void(0)\" class=\"text-success\" title=\"Approve\">\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-check2-square\" viewBox=\"0 0 16 16\">\r\n                                        <path d=\"M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z\"/>\r\n                                        <path d=\"m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0\"/>\r\n                                    </svg>\r\n                                </a>\r\n\r\n                        \r\n                                <a href=\"javascript:void(0);\" class=\"text-primary\"  >\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\r\n                                      <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z\"/>\r\n                                      <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0\"/>\r\n                                    </svg>\r\n                                </a>\r\n                                \r\n\r\n                              \r\n<!-- modal starts -->\r\n\r\n<!-- Modal -->\r\n<div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"exampleModalLabel\">Service Registration</h5>\r\n                <button type=\"button\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\" aria-label=\"Close\" class=\"btn-close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n             <input type=\"text\" class=\"form-control\" placeholder=\"Enter Service Name\" v-model=\"name\" />\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\"><i class=\"flaticon-cancel-12\"></i> Discard</button>\r\n                <button type=\"button\" class=\"btn btn-primary\">Save</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n <!-- modal ends -->\r\n \r\n                                \r\n                            </template>\r\n                           \r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref ,inject ,watch } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    useMeta({ title: 'Labour Attendance' });\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n    const waitIndicator = inject('waitIndicator')\r\n    const printEmployees = inject('printEmployees')\r\n    const formatNumber = inject('formatNumber')\r\n    const formatDate =inject('formatDate')\r\n    const tableShimmer = inject('tableShimmer');\r\n    const name = ref('');\r\n    const loading = ref(false);\r\n    const columns = ref(['Sno', 'full_name','type','rate','project','supervisor','task','status','date']);\r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 , 100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['id', 'service_name'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\nconst attendances = ref([])\r\nconst date = ref(new Date().toISOString().slice(0, 10))\r\nconst start_date = ref(new Date().toISOString().slice(0, 10))\r\nconst end_date = ref(new Date().toISOString().slice(0, 10))\r\nconst getLabourAttendance = async () => {\r\n  loading.value = true\r\n  try {\r\n    const params = {\r\n      start_date: start_date.value,\r\n      end_date: end_date.value\r\n    }\r\n\r\n    if (project.value?.short_name) {\r\n      params.project_id = project.value.id\r\n    }\r\n\r\n    const response = await axiosInstance.get('labour-attendants', { params })\r\n\r\n    attendances.value = response.data.map((item, index) => ({\r\n      ...item,\r\n      Sno: index + 1,\r\n      full_name: item.labour_name,\r\n      type: item.labour_type.name,\r\n      rate: formatNumber(item.labour_type.rate),\r\n      rate_original: item.labour_type.rate,\r\n      project: item.project.short_name,\r\n      supervisor: item.registrar.name,\r\n      date: formatDate(item.created_at)\r\n    }))\r\n  } catch (error) {\r\n    showError(error.message)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n\r\n//     watch(start_date, (newVal) => {\r\n//     if (newVal) {\r\n//      getLabourAttendance();\r\n//     }\r\n// });\r\n\r\nconst projects = ref([''])\r\nconst project = ref()\r\n\r\n\r\nconst getProjects = async () => {\r\n   try{\r\n     const response = await axiosInstance.get('projects')\r\n     projects.value = response.data\r\n   }catch(error){\r\n    showError(error.message)\r\n    console.log(error)\r\n   }finally{\r\n\r\n   }\r\n};\r\n\r\n\r\nconst printLabourAttendance = async (data) => {\r\n  try {\r\n    const items = data || []\r\n\r\n    const totalCost = items.reduce((sum, item) => {\r\n      return sum + Number(item?.labour_type?.rate || 0)\r\n    }, 0)\r\n\r\n    const iframe = document.createElement('iframe')\r\n    iframe.style.display = 'none'\r\n    document.body.appendChild(iframe)\r\n\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<style>\r\n  body { font-family: 'Courier New', monospace; margin: 20px; font-size: 8px; }\r\n  .company-title { text-align: center; font-size: 9px; }\r\n  .company-title h1 { font-size: 14px; margin: 5px 0; }\r\n  .title { text-align: center; font-size: 12px; margin: 8px 0; font-weight: bold; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 9px; }\r\n  th, td { border: 1px solid #000; padding: 3px 4px; }\r\n  th { background-color: #f0f0f0; font-weight: bold; }\r\n  .text-right { text-align: right; }\r\n  hr { border: 0; border-top: 1px solid #000; margin: 8px 0; }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"company-title\">\r\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\r\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\r\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\r\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\r\n</div>\r\n\r\n<hr>\r\n\r\n<div class=\"title\">${project.value.short_name ?? 'ALL'} SITE LABOUR ATTENDANCE REPORT </div>\r\n<div class=\"title\">FROM ${start_date.value} TO ${end_date.value} </div>\r\n\r\n<hr>\r\n\r\n<table>\r\n<thead>\r\n<tr>\r\n  <th>S/No.</th>\r\n  <th>Labour</th>\r\n  <th>Type</th>\r\n  <th>Task</th>\r\n  <th>Time Reported</th>\r\n  <th>Date</th>\r\n  <th>Status</th>\r\n  <th>Cost Per Day</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n${items.map((item, index) => `\r\n<tr>\r\n  <td>${index + 1}</td>\r\n  <td>${item.labour_name || 'N/A'}</td>\r\n  <td>${item?.labour_type?.name || 'N/A'}</td>\r\n  <td>${item.task || 'N/A'}</td>\r\n  <td>${item.reporting_time || 'N/A'}</td>\r\n  <td>${formatDate(item.created_at) || 'N/A'}</td>\r\n  <td>${item?.status?.name || 'N/A'}</td>\r\n  <td class=\"text-right\">${formatNumber(item?.labour_type?.rate || 0)}</td>\r\n</tr>\r\n`).join('')}\r\n<tr style=\"font-weight:bold;\">\r\n  <td colspan=\"7\" class=\"text-right\">TOTAL COST :</td>\r\n  <td class=\"text-right\">${formatNumber(totalCost)}</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\n<div style=\"margin-top: 15px; font-size: 7px;\">\r\n  <p><strong>Report Generated:</strong> ${new Date().toLocaleString()}</p>\r\n  <p><strong>Generated By:</strong> ${JSON.parse(localStorage.getItem('user'))?.name}</p>\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`\r\n\r\n    const iframeDoc = iframe.contentWindow.document\r\n    iframeDoc.open()\r\n    iframeDoc.write(printContent)\r\n    iframeDoc.close()\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus()\r\n      iframe.contentWindow.print()\r\n      setTimeout(() => document.body.removeChild(iframe), 1000)\r\n    }\r\n  } catch (error) {\r\n    showError(`Failed to print report: ${error.message}`)\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n    onMounted(() => {\r\n        getLabourAttendance();\r\n        getProjects()\r\n    });\r\n</script>\r\n","import script from \"./attendances.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./attendances.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./attendances.vue?vue&type=style&index=0&id=00a4df51&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","axiosInstance","axios","baseURL","process","showError","inject","formatNumber","formatDate","tableShimmer","name","ref","loading","columns","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","attendances","start_date","Date","toISOString","slice","end_date","getLabourAttendance","async","value","params","project","short_name","project_id","id","response","get","data","map","item","index","Sno","full_name","labour_name","type","labour_type","rate","rate_original","supervisor","registrar","date","created_at","error","message","projects","getProjects","console","log","printLabourAttendance","items","totalCost","reduce","sum","Number","iframe","document","createElement","style","display","body","appendChild","printContent","task","reporting_time","status","join","toLocaleString","JSON","parse","localStorage","getItem","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","onMounted","__exports__"],"sourceRoot":""}