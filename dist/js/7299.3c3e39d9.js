"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[7299],{17299:function(t,e,a){a.r(e),a.d(e,{default:function(){return I}});var n=a(66252),o=a(2262),l=a(3577),i=a(49963),r=a(56296),s=a(87066);const d={class:"layout-px-spacing"},c={class:"seperator-header layout-top-spacing"},u={class:"d-flex justify-content-between mt-3"},p=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-arrow-left",viewBox:"0 0 16 16"},[(0,n._)("path",{"fill-rule":"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"})],-1),v=[p],m={class:"d-flex align-items-center"},w={class:"dropdown me-3"},h=(0,n._)("option",{value:"all"},"All Budget",-1),g=["value"],f=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-printer me-1"},[(0,n._)("polyline",{points:"6 9 6 2 18 2 18 9"}),(0,n._)("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),(0,n._)("rect",{x:"6",y:"14",width:"12",height:"8"})],-1),y=(0,n.Uk)(" Print "),_=[f,y],b={class:"mt-3 mx-2"},x={key:0,class:"text-center text-primary mt-2 mb-2"},k=(0,n._)("span",{class:"text-sm"},[(0,n._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),(0,n.Uk)(" Please wait ... ")],-1),S=[k],C={class:"d-flex mt-3 mb-3"},$={class:"ms-auto d-inline-flex align-items-center bg-light p-3 border rounded shadow-sm"},q=(0,n._)("div",{class:"fw-bold me-2"},"Total Quantity:",-1),A={class:"bg-white px-3 py-2 rounded fw-bold"},U={class:"row layout-top-spacing"},z={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},H={class:"panel br-6 p-0"},j={class:"custom-table"},B={class:"actions text-center"},P=["onClick"],D=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x-circle table-cancel"},[(0,n._)("circle",{cx:"12",cy:"12",r:"10"}),(0,n._)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,n._)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1),N=[D];var E={setup(t){(0,r.j)({title:"Budget Allocation Report"});const e=(0,o.iH)(["SNo","user_name","action","type","date","time","quantity"]),a=(0,o.iH)([]),p=(0,o.iH)([]),f=(0,o.iH)(!1),y=(0,o.iH)("all"),k=(0,n.Fl)((()=>{let t=a.value.filter((t=>t.quantity>0));return"all"===y.value?t:t.filter((t=>t.type===y.value))})),D=(0,n.Fl)((()=>{const t=p.value.filter((t=>t.quantity>0)),e=t.map((t=>t.type));return[...new Set(e)].filter((t=>t))})),E=()=>{const t=p.value.filter((t=>t.quantity>0));"all"===y.value?a.value=[...t]:a.value=t.filter((t=>t.type===y.value)),a.value=a.value.map(((t,e)=>({...t,SNo:e+1})))},F=t=>{window.Swal?window.Swal.fire({icon:"error",title:"Error",text:t,padding:"2em"}):alert("Error: "+t)},I=(0,o.iH)({perPage:10,perPageValues:[5,10,20,50],skin:"table table-hover",pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},sortable:["SNo","user_name","action","type","date","time","quantity"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},resizableColumns:!1}),R=s.Z.create({baseURL:"https://construction.trustdigital.space/api/v1",headers:{"Content-Type":"application/json",Accept:"application/json"}}),T=t=>{if(!t)return"";const e=new Date(t),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${a}.${n}.${o}`},L=t=>null===t||void 0===t?"0/=":`${Number(t).toLocaleString()}/=`,M=()=>{const t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);const a=e.value,n="all"===y.value?"All Budget":`Budget: ${y.value}`;let o=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Budget Allocation Report - ${n}</title>\n          <style>\n            body {\n              font-family: Arial, sans-serif;\n              margin: 20px;\n            }\n            h1 {\n              text-align: center;\n              margin-bottom: 10px;\n              font-size: 13px;\n            }\n            h2 {\n              text-align: center;\n              margin-bottom: 20px;\n              font-size: 12px;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-bottom: 20px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 5px;\n              text-align: left;\n              font-size: 9px;\n            }\n            th {\n              background-color: #f2f2f2;\n              font-weight: bold;\n            }\n            tr:nth-child(even) {\n              background-color: #f9f9f9;\n            }\n            .print-date {\n              text-align: right;\n              margin-bottom: 20px;\n              font-size: 9px;\n            }\n          </style>\n        </head>\n        <body>\n          <h1>Budget Allocation Report</h1>\n          <h2>${n}</h2>\n          <div class="print-date">Printed on: ${T((new Date).toISOString())}</div>\n          <table>\n            <thead>\n              <tr>\n                ${a.map((t=>`<th>${W(t)}</th>`)).join("")}\n              </tr>\n            </thead>\n            <tbody>\n      `;k.value.forEach((t=>{o+="<tr>",a.forEach((e=>{o+="date"===e||"created_at"===e||"updated_at"===e?`<td>${T(t[e])}</td>`:"quantity"===e?`<td>${L(t[e])}</td>`:`<td>${t[e]||""}</td>`})),o+="</tr>"})),o+=`\n                  <tr>\n                    <td colspan="6" class="text-end"><strong>Total Quantity:</strong></td>\n                    <td>${L(O.value)}</td>\n                  </tr>\n            </tbody>\n          </table>\n        </body>\n        </html>\n      `;const l=t.contentWindow.document;l.open(),l.write(o),l.close(),t.onload=()=>{t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{document.body.removeChild(t)}),1e3)}},W=t=>t.replace(/_/g," ").replace(/-/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" "),Y=async()=>{f.value=!0;try{const t=await R.get("/activity-logs");if(t.data&&"success"===t.data.status&&Array.isArray(t.data.data)){const e=t.data.data.map(((t,e)=>({SNo:e+1,id:t.id,user_id:t.user_id,user_name:t.user_name,action:t.action,type:t.type,activity_id:t.activity_id,date:t.date,time:t.time,created_at:t.created_at,updated_at:t.updated_at,quantity:t.quantity||0})));p.value=[...e];const n=e.filter((t=>t.quantity>0));a.value=n.map(((t,e)=>({...t,SNo:e+1})))}else F("Invalid response format"),console.error("API response format unexpected:",t.data)}catch(t){F(t.message||"Failed to fetch data"),console.error("API error:",t)}finally{f.value=!1}},O=(0,n.Fl)((()=>k.value.reduce(((t,e)=>t+(Number(e.quantity)||0)),0)));return(0,n.bv)((()=>{Y()})),(t,a)=>{const r=(0,n.up)("v-client-table");return(0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",c,[(0,n._)("div",u,[(0,n._)("button",{class:"btn btn-dark me-2 px-3",onClick:a[0]||(a[0]=e=>t.$router.go(-1))},v),(0,n._)("div",m,[(0,n._)("div",w,[(0,n.wy)((0,n._)("select",{class:"form-select","onUpdate:modelValue":a[1]||(a[1]=t=>y.value=t),onChange:E},[h,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(D),(t=>((0,n.wg)(),(0,n.iD)("option",{key:t,value:t},(0,l.zw)(t),9,g)))),128))],544),[[i.bM,y.value]])]),(0,n._)("button",{class:"btn btn-primary px-3",onClick:M},_)])])]),(0,n._)("div",b,[f.value?((0,n.wg)(),(0,n.iD)("div",x,S)):(0,n.kq)("",!0)]),(0,n._)("div",C,[(0,n._)("div",$,[q,(0,n._)("div",A,(0,l.zw)(L((0,o.SU)(O))),1)])]),(0,n._)("div",U,[(0,n._)("div",z,[(0,n._)("div",H,[(0,n._)("div",j,[(0,n.Wm)(r,{data:(0,o.SU)(k),columns:e.value,options:I.value},{date:(0,n.w5)((t=>[(0,n.Uk)((0,l.zw)(T(t.row.date)),1)])),created_at:(0,n.w5)((t=>[(0,n.Uk)((0,l.zw)(T(t.row.created_at)),1)])),updated_at:(0,n.w5)((t=>[(0,n.Uk)((0,l.zw)(T(t.row.updated_at)),1)])),quantity:(0,n.w5)((t=>[(0,n.Uk)((0,l.zw)(L(t.row.quantity)),1)])),actions:(0,n.w5)((e=>[(0,n._)("div",B,[(0,n._)("a",{href:"javascript:;",class:"cancel",onClick:a=>t.delete_row(e.row)},N,8,P)])])),_:1},8,["data","columns","options"])])])])])])}}};const F=E;var I=F}}]);
//# sourceMappingURL=7299.3c3e39d9.js.map