{"version":3,"file":"js/2769.c50bcd6a.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/goodIssueNotes/issueNote.vue","webpack://cork-vue3/./src/views/goodIssueNotes/issueNote.vue?e1cd"],"sourcesContent":["<template>\r\n  <div class=\"layout-px-spacing\">  \r\n    <ul class=\"navbar-nav flex-row mt-2\">\r\n      <li>\r\n        <div class=\"page-header\">\r\n          <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n            <ol class=\"breadcrumb\">\r\n              <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n              <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Good Issue Notes</span></li>\r\n            </ol>\r\n          </nav>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n\r\n    <div class=\"d-flex justify-content-between align-items-center mb-2\">\r\n      <!-- <button class=\"btn btn-dark\" @click=\"$router.go(-1)\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-arrow-left\" viewBox=\"0 0 16 16\">\r\n          <path fill-rule=\"evenodd\" d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8\"/>\r\n        </svg>\r\n        Back\r\n      </button> -->\r\n      \r\n      <h4 class=\"mb-0 text-center flex-grow-1\">GOOD ISSUE NOTE</h4>\r\n      <div class=\"d-flex gap-2\">\r\n        <router-link to=\"/requisition-group/6/all\" class=\"btn btn-primary\">Store Requisitions</router-link>\r\n        <router-link to=\"/gate-passes\" class=\"btn btn-success\">Gate Passes</router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Split Layout -->\r\n    <div class=\"row\">\r\n      <!-- Left Side: Issue Notes List -->\r\n      <div :class=\"notes.length === 1 ? 'd-none' : 'col-md-4'\">\r\n        <div class=\"card shadow\">\r\n          <div class=\"card-header text-white\">\r\n            <h5 class=\"mb-0\">Issue Notes</h5>\r\n          </div>\r\n          <div class=\"card-body p-0\">\r\n            <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n            <div v-else class=\"list-group list-group-flush\">\r\n              <a \r\n  v-for=\"note in notes\" \r\n  :key=\"note.id\"\r\n  href=\"javascript:void(0);\" \r\n  class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\"\r\n  @click=\"selectIssue(note)\"\r\n>\r\n  <div class=\"row\">\r\n    \r\n    <div class=\"col-md-6\">\r\n       <label class=\"form-label fw-bold\">Issue No : &nbsp;</label>\r\n      <label class=\"form-label \"> {{ note.id }}</label>\r\n    </div>\r\n    <div class=\"col-md-6\">\r\n      <label class=\"form-label fw-bold\"> Date : &nbsp;</label>\r\n      <label class=\"form-label fw-bold\">{{ formatDate(note.date_issued) }}</label>\r\n    </div>\r\n  </div>\r\n\r\n  <span>\r\n    <svg \r\n      v-if=\"selectedIssue && selectedIssue.id === note.id\"\r\n      xmlns=\"http://www.w3.org/2000/svg\" \r\n      width=\"24\" height=\"24\" \r\n      fill=\"#28a745\"  \r\n      class=\"bi bi-check2-circle\"\r\n      viewBox=\"0 0 16 16\"\r\n    >\r\n      <path d=\"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0\"/>\r\n      <path d=\"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z\"/>\r\n    </svg>\r\n\r\n    <svg \r\n      v-else \r\n      xmlns=\"http://www.w3.org/2000/svg\" \r\n      width=\"24\" height=\"24\" \r\n      fill=\"#adb5bd\" \r\n      class=\"bi bi-circle\"\r\n      viewBox=\"0 0 16 16\"\r\n    >\r\n      <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\"/>\r\n    </svg>\r\n  </span>\r\n</a>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Right Side: Selected Issue Details -->\r\n       <div :class=\"notes.length === 1 ? 'col-md-12' : 'col-md-8'\">\r\n        <div v-if=\"selectedIssue\" class=\"card shadow\">\r\n          <div class=\"card-header bg-light\">\r\n            <div class=\"d-flex justify-content-between align-items-center\">\r\n              <h5 class=\"mb-0\">Issue Note Details (No: {{ selectedIssue.id }})</h5>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-body\">\r\n          \r\n\r\n            <!-- Gate Pass Section -->\r\n            <div class=\"mb-4\">\r\n              <div class=\"d-flex justify-content-between align-items-center mb-3\">\r\n                <h5 class=\"mb-0\">Gate Pass Details</h5>\r\n                <div>\r\n                  <button \r\n                    class=\"btn btn-success btn-sm me-2\" \r\n                    @click=\"printGatePass(selectedIssue)\" \r\n                    v-if=\"selectedIssue.gate_pass\"\r\n                  >\r\n                    Print Gate Pass\r\n                  </button>\r\n                  <button \r\n                    class=\"btn btn-primary btn-sm\" \r\n                    @click=\"create_gate_pass = !create_gate_pass\" \r\n                    v-if=\"!selectedIssue.gate_pass && user_permissions.includes('can_create_gate_pass')\"\r\n                  >\r\n                    Create Gate Pass\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div v-if=\"!selectedIssue.gate_pass && !create_gate_pass\" class=\"alert alert-warning\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-info-circle me-2\" viewBox=\"0 0 16 16\">\r\n                  <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\"/>\r\n                  <path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\"/>\r\n                </svg>\r\n                No Gate Pass Created\r\n              </div>\r\n\r\n              <!-- Existing Gate Pass Details -->\r\n              <div v-if=\"selectedIssue.gate_pass\" class=\"card shadow mb-3\">\r\n                <div class=\"card-body\">\r\n                  <div class=\"row\">\r\n                    <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Gate Pass No : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.id }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Asset : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.asset?.name }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Asset Type : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.asset?.type_name }}</label>\r\n                </div>\r\n\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Current Reading : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.current_reading }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold \">Return Reading : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.return_reading }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Driver Name : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.driver_name }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Security Name : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.gate_pass.security_name }}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Source Store : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.source_store.project.short_name}}-{{ selectedIssue.source_store.name}}</label>\r\n                </div>\r\n                <div class=\"col-md-4 text-start\">\r\n                  <label class=\"form-label fw-bold\">Destination Store : &nbsp;</label>\r\n                  <label class=\"form-label \">{{ selectedIssue.destination_store.project.short_name}}-{{ selectedIssue.destination_store.name}}</label>\r\n                </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Create Gate Pass Form -->\r\n              <div v-if=\"create_gate_pass && !selectedIssue.gate_pass\" class=\"card mt-3\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title\">Create New Gate Pass</h6>\r\n                  <div class=\"row\">\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label class=\"form-label small\">Select Asset</label>\r\n                      <multiselect \r\n                        v-model=\"asset\"\r\n                        :options=\"assets\"\r\n                        placeholder=\"Select An Asset\"\r\n                        label=\"name\"\r\n                        :searchable=\"true\"        \r\n                        :multiple=\"false\"\r\n                        :required=\"true\"\r\n                        :allow-empty=\"false\"\r\n                      ></multiselect>\r\n                    </div>\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label for=\"driver_name\" class=\"form-label\">Driver Name</label>\r\n                      <input type=\"text\" v-model=\"driver_name\" class=\"form-control\" placeholder=\"Enter Driver Name\" required>\r\n                    </div>\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label for=\"current_reading\" class=\"form-label\">Current Reading</label>\r\n                      <input type=\"number\" v-model=\"current_reading\" class=\"form-control\" placeholder=\"Enter Current Reading\">\r\n                    </div>\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label for=\"return_reading\" class=\"form-label\">Return Reading</label>\r\n                      <input type=\"number\" v-model=\"return_reading\" class=\"form-control\" placeholder=\"Enter Return Reading\">\r\n                    </div>\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label for=\"security_name\" class=\"form-label\">Security Name</label>\r\n                      <input type=\"text\" v-model=\"security_name\" class=\"form-control\" placeholder=\"Enter Security Name\" required>\r\n                    </div>\r\n                    <div class=\"col-md-6 mb-3\">\r\n                      <label for=\"date\" class=\"form-label\">Date</label>\r\n                      <input type=\"date\" v-model=\"date\" class=\"form-control\" required>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"d-flex justify-content-end\">\r\n                    <button type=\"button\" class=\"btn btn-secondary me-2\" @click=\"create_gate_pass = false\">\r\n                      Cancel\r\n                    </button>\r\n                    <button \r\n                      type=\"button\"\r\n                      class=\"btn btn-primary\"\r\n                      :disabled=\"!isFormValid || loading\"\r\n                      @click=\"CreateGatePass(selectedIssue.id)\"\r\n                    >\r\n                      <span \r\n                        v-if=\"loading\" \r\n                        class=\"spinner-border spinner-border-sm text-white me-2\" \r\n                        role=\"status\">\r\n                      </span>\r\n                      Create Gate Pass\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Items Section -->\r\n            <div>\r\n              <h5 class=\"mb-3 text-start\">Issued Items</h5>\r\n               <div class=\"panel p-0\">\r\n                   \r\n              <div class=\"custom-table table3\">\r\n                <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n                <v-client-table\r\n  v-else \r\n  :data=\"mappedItems\" \r\n  :columns=\"Itemscolumn\" \r\n  :options=\"table_option\"\r\n></v-client-table>\r\n              </div>\r\n            </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Empty State -->\r\n        <div v-else class=\"card shadow\">\r\n          <div class=\"card-body text-center py-5\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" fill=\"currentColor\" class=\"bi bi-file-text text-muted mb-3\" viewBox=\"0 0 16 16\">\r\n              <path d=\"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0-2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm-4 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z\"/>\r\n              <path d=\"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1\"/>\r\n            </svg>\r\n            <h5 class=\"text-muted\">Select an Issue Note</h5>\r\n            <p class=\"text-muted\">Choose an issue note from the list to view its details</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, inject, computed } from 'vue';\r\nimport axios from 'axios';\r\nimport { useMeta } from '@/composables/use-meta';\r\nimport Multiselect from '@suadelabs/vue3-multiselect';\r\nimport '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\nimport { useRoute } from 'vue-router';\r\nconst route = useRoute();\r\nconst user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n\r\nuseMeta({ title: 'Good Issue Notes' });\r\n\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: process.env.VUE_APP_API_BASE_URL\r\n});\r\n\r\n// Refs\r\nconst create_gate_pass = ref(false);\r\nconst asset = ref('');\r\nconst current_reading = ref('');\r\nconst return_reading = ref('');\r\nconst driver_name = ref('');\r\nconst security_name = ref('');\r\nconst date = ref('');\r\nconst loading_spinner = ref(false);\r\nconst loading = ref(false);\r\nconst notes = ref([]);\r\nconst assets = ref([]);\r\nconst selectedIssue = ref(null);\r\nconst Itemscolumn = ref(['SNo','item','category','unit','quantity']);\r\n\r\n\r\nconst table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 ,100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n// Computed\r\nconst isFormValid = computed(() => {\r\n    return driver_name.value.trim() !== '' && security_name.value.trim() !== '' && asset.value;\r\n});\r\n\r\nconst mappedItems = computed(() => {\r\n  if (!selectedIssue.value?.items) return [];\r\n  return selectedIssue.value.items.map((it, index) => ({\r\n    SNo: index + 1,\r\n    item: it.store_item?.item?.name || 'N/A',\r\n    category: it.store_item?.item?.category?.name || 'N/A',\r\n    unit: it.requisition_item?.units || 'N/A',\r\n    quantity: it.quantity || 0,\r\n  }));\r\n});\r\n\r\n\r\n// Injections\r\nconst formatDate = inject('formatDate');\r\nconst tableShimmer = inject('tableShimmer');\r\nconst loadingSpinner = inject('loadingSpinner');\r\nconst showMessage = inject('showMessage');\r\nconst showError = inject('showError');\r\n\r\n\r\n\r\n// Methods\r\nconst selectIssue = (issue) => {\r\n    selectedIssue.value = issue;\r\n    create_gate_pass.value = false;\r\n    resetGatePassForm();\r\n};\r\n\r\n\r\nconst resetGatePassForm = () => {\r\n    asset.value = '';\r\n    current_reading.value = '';\r\n    return_reading.value = '';\r\n    driver_name.value = '';\r\n    security_name.value = '';\r\n    date.value = '';\r\n};\r\n\r\n// API Calls\r\nconst getIssueNotes = async () => {\r\n    loading_spinner.value = true;\r\n    try {\r\n        const response = await axiosInstance.get(`/good-issue-notes?requisition_type_id=${route.params.requisition_type_id}`);\r\n        notes.value = response.data;\r\n \r\n        if (notes.value.length > 0 && !selectedIssue.value) {\r\n            selectedIssue.value = notes.value[0];\r\n        }\r\n\r\n        loading_spinner.value = false;\r\n    } catch (error) {\r\n        showError(error.message || \"Failed to fetch good issue notes\");\r\n        loading_spinner.value = false;\r\n    }\r\n};\r\n\r\nconst getAssets = async () => {\r\n    try {\r\n        const response = await axiosInstance.get('machines');\r\n        assets.value = response.data.map((item) => ({\r\n            ...item,\r\n            name: item.name + ' - ' + item.type_name,\r\n            AssetNo: item.name,\r\n            AssetType: item.type_name\r\n        }));\r\n    } catch (error) {\r\n        showError(error.message || \"Failed to fetch assets\");\r\n    }\r\n};\r\n\r\nconst CreateGatePass = async (id) => {\r\n    loading.value = true;\r\n    const payload = {\r\n        good_issue_note_id: id,\r\n        asset_id: asset.value.id,\r\n        current_reading: current_reading.value,\r\n        return_reading: return_reading.value,\r\n        destination_store_id: selectedIssue.value.destination_store_id,\r\n        source_store_id: selectedIssue.value.source_store_id,\r\n        driver_name: driver_name.value,\r\n        security_name: security_name.value,\r\n        date: date.value,\r\n    };\r\n\r\n    try {\r\n        const response = await axiosInstance.post('gate-passes', payload);\r\n        showMessage('Gate Pass created successfully!');\r\n\r\n        await getIssueNotes();\r\n\r\n        const updatedIssue = notes.value.find(note => note.id === id);\r\n        if (updatedIssue) {\r\n            selectedIssue.value = updatedIssue;\r\n        }\r\n\r\n        create_gate_pass.value = false;\r\n        resetGatePassForm();\r\n    } catch (error) {\r\n        showError(error.message || \"Failed to create gate pass\");\r\n    } finally {\r\n        loading.value = false;\r\n    }\r\n};\r\n\r\n    const printGatePass = async (row) => {\r\n        try {\r\n            const iframe = document.createElement(\"iframe\");\r\n            iframe.style.display = \"none\";\r\n            document.body.appendChild(iframe);\r\n\r\n            const gatePass = row.gate_pass || {};\r\n            const assetName = gatePass.asset?.name || 'N/A';\r\n            const assetType = gatePass.asset?.type_name || 'N/A';\r\n            const sourceStore = row.source_store ? `${row.source_store.project?.short_name || ''} - ${row.source_store.name || ''}` : 'N/A';\r\n            const destinationStore = row.destination_store ? `${row.destination_store.project?.short_name || ''} - ${row.destination_store.name || ''}` : 'N/A';\r\n\r\nconst printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Print Gate Pass</title>\r\n<style>\r\n  body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; font-size: 13px; color: #222; }\r\n  .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #000; padding-bottom: 10px; }\r\n  .logo { width: 150px; height: auto; }\r\n  .gatepass-box { border: 2px solid #000; padding: 6px 14px; font-weight: bold; font-size: 14px; border-radius: 6px; background: #f9f9f9; box-shadow: 0 0 3px rgba(0,0,0,0.2); }\r\n  .company-title { text-align: center; margin: 25px 0 15px 0; }\r\n  .company-title h2 { margin: 0; font-size: 18px; text-transform: uppercase;  }\r\n  .details { margin-top: 15px; line-height: 2; }\r\n  .line-field { display: flex; justify-content: space-between; margin-bottom: 6px; }\r\n  .label { width: 35%; font-weight: bold; }\r\n  .value { flex: 1; border-bottom: 1px solid #000; text-align: center; padding-bottom: 2px; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 15px; border-radius: 6px; overflow: hidden; }\r\n  table.items thead th { background: #f0f0f0; border: 1px solid #000; font-weight: bold; text-align: center; }\r\n  table.items td { border: 1px solid #000; padding: 6px; vertical-align: middle; text-align: center; }\r\n  .signatures { margin-top: 40px; display: flex; justify-content: space-between; align-items: center; }\r\n  .signature-box { text-align: center; width: 45%; }\r\n  .signature-line { margin-top: 50px; border-top: 1px solid #000; width: 80%; margin-left: auto; margin-right: auto; }\r\n.check-square {\r\n  width: 20px;\r\n  height: 20px;\r\n  border: 1px solid #000;\r\n  display: inline-block;\r\n}\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"gatepass-box\">\r\n    PASS NO: <span style=\"color:red;\">${\"00\" + (gatePass.id || '')}</span><br>\r\n    GIN NO: ${row.id || ''}<br>\r\n    Date : ${formatDate(gatePass.date)}\r\n  </div>\r\n</div>\r\n\r\n<div class=\"company-title\">\r\n  <h2>Gate Pass for Construction Equipment / Vehicles</h2>\r\n</div>\r\n\r\n<table style=\"width:100%; border-collapse:separate; border-spacing:0 8px; margin-top:15px; font-size:13px;\">\r\n  <tr>\r\n    <td style=\"font-weight:bold; width:20%;\">Driver Name:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${gatePass.driver_name || ''}</td>\r\n     <td style=\"font-weight:bold; padding-left:20px;\">Security Name:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${gatePass.security_name || ''}</td>\r\n  </tr>\r\n  <tr>\r\n    <td style=\"font-weight:bold;\">Reg No:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${assetName}</td>\r\n    <td style=\"font-weight:bold; padding-left:20px;\">Type:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${assetType}</td>\r\n  </tr>\r\n  <tr>\r\n    <td style=\"font-weight:bold;\">Start Kms/Hrs:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${gatePass.current_reading || ''}</td>\r\n    <td style=\"font-weight:bold; padding-left:20px;\">Return&nbsp;Kms/Hrs:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px; white-space:nowrap;\">${gatePass.return_reading || ''}</td>\r\n  </tr>\r\n  <tr>\r\n    <td style=\"font-weight:bold;\">Destination:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${destinationStore}</td>\r\n    <td style=\"font-weight:bold; padding-left:20px;\">Source Location:</td>\r\n    <td style=\"border-bottom:1px solid #000; padding:4px;\">${sourceStore}</td>\r\n  </tr>\r\n\r\n</table>\r\n\r\n\r\n<h4 style=\"margin-top:25px;\">CARRIED ITEMS:</h4>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th>SN</th>\r\n      <th>Item</th>\r\n      <th>Description</th>\r\n      <th>Quantity</th>\r\n      <th>Check</th>\r\n      \r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${(row.items || []).map((item, index) => `\r\n    <tr>\r\n      <td>${index + 1}</td>\r\n      <td>${item.store_item?.item?.name || 'N/A'}</td>\r\n      <td>${item.store_item?.item?.description || '--'}</td>\r\n      <td style=\"text-align: right;\">${item.quantity || '0'}</td>\r\n      <td><div class=\"check-square\"></div></td>\r\n    </tr>`).join(\"\")}\r\n    ${(!row.items || row.items.length === 0) ? `<tr><td colspan=\"4\">No items found</td></tr>` : ''}\r\n  </tbody>\r\n</table>\r\n\r\n<div class=\"signatures\">\r\n  <div class=\"signature-box\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Driver's Signature</p>\r\n  </div>\r\n  <div class=\"signature-box\">\r\n    <div class=\"signature-line\"></div>\r\n    <p>Security Signature</p>\r\n  </div>\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n            const iframeDoc = iframe.contentWindow.document;\r\n            iframeDoc.open();\r\n            iframeDoc.write(printContent);\r\n            iframeDoc.close();\r\n\r\n            iframe.onload = () => {\r\n                iframe.contentWindow.focus();\r\n                iframe.contentWindow.print();\r\n                setTimeout(() => {\r\n                    document.body.removeChild(iframe);\r\n                }, 1000);\r\n            };\r\n        } catch (error) {\r\n            console.error('Print error:', error);\r\n            showError(`Failed to print gate pass: ${error.message}`);\r\n        }\r\n    };\r\n\r\n\r\nonMounted(() => {\r\n    getIssueNotes();\r\n    getAssets();\r\n});\r\n</script>","import script from \"./issueNote.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./issueNote.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","user_permissions","JSON","parse","localStorage","getItem","permissions","useMeta","title","axiosInstance","axios","baseURL","process","create_gate_pass","ref","asset","current_reading","return_reading","driver_name","security_name","date","loading_spinner","loading","notes","assets","selectedIssue","Itemscolumn","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","isFormValid","computed","value","trim","mappedItems","items","map","it","index","SNo","item","store_item","name","category","unit","requisition_item","units","quantity","formatDate","inject","tableShimmer","showMessage","showError","selectIssue","issue","resetGatePassForm","getIssueNotes","async","response","get","params","requisition_type_id","data","length","error","message","getAssets","type_name","AssetNo","AssetType","CreateGatePass","payload","good_issue_note_id","id","asset_id","destination_store_id","source_store_id","post","updatedIssue","find","note","printGatePass","iframe","document","createElement","style","display","body","appendChild","gatePass","row","gate_pass","assetName","assetType","sourceStore","source_store","project","short_name","destinationStore","destination_store","printContent","description","join","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","console","onMounted","__exports__"],"sourceRoot":""}