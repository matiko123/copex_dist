{"version":3,"file":"js/9326.272c4a6b.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/distribution/bulk_distribution.vue","webpack://cork-vue3/./src/views/distribution/bulk_distribution.vue?11db"],"sourcesContent":["<template>\r\n   \r\n\r\n    <div  class=\"layout-px-spacing mt-3\">\r\n        <button class=\"btn btn-dark me-2 px-3\" @click=\"$router.go(-1)\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-arrow-left\" viewBox=\"0 0 16 16\">\r\n  <path fill-rule=\"evenodd\" d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8\"/>\r\n</svg>\r\n                </button>\r\n        <div class=\"text-center \">\r\n            <h6>{{ bulkData?.project_name }}</h6>\r\n        </div>\r\n    <!-- tab starts -->\r\n    <ul class=\"nav nav-tabs\">    \r\n    <li class=\"nav-item \">\r\n      <button\r\n        class=\"nav-link  fs-6\"\r\n        :class=\"{ active: activeTab === 'dieseldistribution' }\"\r\n        @click=\"viewDistribution(); isDiesel=true; item_id = 364;  activeTab = 'dieseldistribution'\"\r\n      >\r\n        Diesel Distibution \r\n      </button>\r\n    </li>\r\n    <li class=\"nav-item\">\r\n      <button\r\n        class=\"nav-link fs-6\"\r\n        :class=\"{ active: activeTab === 'petroldistribution' }\"\r\n        @click=\"viewDistribution(); isDiesel=false; item_id= 365 ; activeTab ='petroldistribution'\"\r\n      >\r\n       Petrol Distribution\r\n      </button>\r\n    </li>\r\n  </ul>\r\n     <!-- tab ends -->\r\n\r\n         \r\n               <!-- distribution starts -->\r\n               <div v-if=\"view_distribution\" class=\"panel p-0\" >\r\n                    <div class=\"custom-table table3 \">\r\n                           <div v-if=\"!loading_spinner\" class=\" col-12 d-flex align-items-center justify-content-between\">\r\n                        <div class=\" d-flex flex-column align-items-start p-1 \">                            \r\n                          <table class=\"table\">\r\n    <thead>\r\n      <tr>\r\n        <th></th>\r\n        <th class=\"text-primary\"> Used</th>\r\n        <th class=\"text-success\">Balance</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>        \r\n      <tr v-if=\"isDiesel\">\r\n        <td class=\"fw-bold\">Diesel</td>\r\n        <td>{{ bulkData?.diesel_used}} L</td>\r\n        <td>{{ bulkData?.diesel_balance}} L</td>\r\n      </tr>\r\n      <tr v-else>\r\n        <td class=\"fw-bold\">Petrol</td>\r\n        <td>{{ bulkData?.petrol_used}} L</td>\r\n        <td>{{ bulkData?.petrol_balance}} L</td>\r\n      </tr>\r\n    </tbody>\r\n                          </table>                                        \r\n                        </div>  \r\n                           </div>\r\n                        \r\n             \r\n                 \r\n                        <div v-if=\"!loading_spinner\" class=\"text-center mt-1\"> <h5 v-if=\"isDiesel\"> Diesel Distribution </h5> <h5 v-else>Petrol Distribution </h5> </div>\r\n                        <div class=\"d-flex\">\r\n                           \r\n                    </div>\r\n                        \r\n                   \r\n\r\n        <div  class=\"d-flex\" v-if=\"user_permissions.includes('can_issue_fuel') && !loading_spinner\">\r\n             \r\n                  <button class=\"btn btn-success ms-auto mx-3\"  v-if=\"isClosed\"   @click=\"isfilling = !isfilling; isClosed=!isClosed;\">\r\n                   add\r\n                </button>\r\n                <button class=\"btn btn-danger ms-auto mx-3\" v-else  @click=\"isfilling = !isfilling; isClosed=!isClosed\">\r\n                    X\r\n                </button>\r\n            \r\n            </div>      \r\n          <!-- fuel usage form start -->\r\n\r\n      \r\n <div id=\"allocation\" v-if=\"isfilling\" class=\"col-lg-12 layout-spacing col-md-12 p-4\">\r\n                <div class=\"statbox panel box box-shadow\">\r\n                    <div class=\"panel-heading\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col-xl-12 col-md-12 col-sm-12 col-12\">\r\n                                <h4 class=\"text-center text-primary\"><strong v-if=\"isDiesel\">Table For Diesel Distribution </strong><strong v-else>Table For Petrol Distribution </strong></h4>\r\n                            </div>\r\n                        </div>\r\n                        <form  @submit.prevent=\"registerMachineDistribution\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-md-4\">\r\n                                    <label for=\"machine\">Select Machine</label>\r\n<Multiselect\r\n  v-model=\"selectedMachine\"\r\n  :options=\"Machines\"\r\n  label=\"name\"\r\n  value-prop=\"id\"\r\n  :multiple=\"false\"   \r\n  placeholder=\"Select Machine\"\r\n/>\r\n\r\n                                </div>\r\n                                \r\n                                <div v-if=\"machine_field\" class=\"col-md-4\">\r\n                                <label class=\"form-label\">Machine Name</label>                            \r\n                                <input type=\"text\" v-model=\"machine\" class=\"form-control\" id=\"fuel_quantity\" required />                                \r\n                                </div>\r\n                                <div class=\"col-md-4\">\r\n                                    <label for=\"fuel_quantity\">Fuel Issued</label>\r\n                                    <input type=\"number\" v-model=\"fuel_quantity\" class=\"form-control\" id=\"fuel_quantity\" required />\r\n                                </div>\r\n                \r\n                                <div class=\"col-md-4\">\r\n                                    <label for=\"consuption_type\">Consuption Ratio</label>\r\n                                    <select class=\"form-control\" v-model=\"ratio\" name=\"consuption_type\" required>\r\n                                        <option value=\"\">Select Consuption Type</option>\r\n                                        <option value=\"km/Litre\">km/Litre</option>\r\n                                        <option value=\"Litre/hr\">Litre/hr</option>\r\n                                    </select>\r\n                                </div>\r\n                         <div class=\"col-md-4\">\r\n                         <label class=\"form-label\">Driver Name</label>\r\n                         <input type=\"text\" class=\"form-control\" v-model=\"driver_name\" >\r\n                         </div>\r\n                \r\n                         <div class=\"col-md-4\">\r\n                         <label class=\"form-label\">Initial Reading</label>\r\n                         <input type=\"number\" class=\"form-control\"  name=\"initial_reading\" v-model=\"initial_reading\"  step=\"any\" >\r\n                        </div>\r\n                        <div class=\"col-md-4\">\r\n                         <label class=\"form-label\">Final Reading</label>\r\n                         <input type=\"number\" class=\"form-control\"  name=\"initial_reading\" v-model=\"final_reading\" step=\"any\" >\r\n                        </div>\r\n            \r\n            \r\n            <div class=\"row mb-2\">\r\n              <div class=\"col-md-12\">\r\n                    <label class=\"form-label\">Task</label>\r\n                    <textarea type=\"number\" class=\"form-control\" v-model=\"task\" name=\"fuel_provided\" required style=\"height:2cm\"></textarea>\r\n                </div>\r\n               \r\n            </div>\r\n                                \r\n                                \r\n                               \r\n                              \r\n                               \r\n                            </div>\r\n                            <div class=\"d-flex justify-content-end mt-3\">\r\n                                <button class=\"btn btn-danger me-2\" @click=\"isfilling =!isfilling;isClosed=!isClosed\">Cancel</button>\r\n                                <button class=\"btn btn-primary\" type=\"submit\">Assign</button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                \r\n                </div>\r\n</div>\r\n  \r\n<div class=\"mt-5\" v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n\r\n        <v-client-table \r\n        v-else\r\n        :data=\"bulkDistribution\" :columns=\"distributionColumn\" :options=\"table_option\" >\r\n            \r\n                            <template #actions=\"props\">\r\n  \r\n                                <svg \r\n    xmlns=\"http://www.w3.org/2000/svg\" \r\n    width=\"26\" \r\n    height=\"26\" \r\n    fill=\"currentColor\" \r\n    viewBox=\"0 0 24 24\"\r\n    style=\"cursor: pointer;\"\r\n    title=\"Add Remark\"\r\n     data-bs-toggle=\"modal\" data-bs-target=\"#edit\"\r\n      @click=\"statement = props.row\"\r\n\r\n  >\r\n\r\n   <!-- @click=\"openRemarkModal(props.row)\" -->\r\n    <!-- Speech Bubble -->\r\n    <path d=\"M4 4h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H7l-4 4v-16a2 2 0 0 1 2-2z\" \r\n          stroke=\"currentColor\" \r\n          stroke-width=\"2\" \r\n          fill=\"none\" \r\n          stroke-linejoin=\"round\"/>\r\n    \r\n    <!-- Horizontal Remark Lines -->\r\n    <line x1=\"7\" y1=\"9\" x2=\"17\" y2=\"9\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\r\n    <line x1=\"7\" y1=\"13\" x2=\"14\" y2=\"13\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\r\n    \r\n  <!-- notification circle starts -->\r\n    <circle\r\n    v-if=\"props.row.remark\"\r\n    cx=\"19\" cy=\"6\" r=\"6\" fill=\"red\" stroke=\"white\" stroke-width=\"1.5\"/>\r\n  <!-- notification circle ends -->\r\n  </svg>\r\n  \r\n    <!-- Modal -->\r\n    <teleport to=\"body\">\r\n  <div v-if=\"showRemarkModal\" class=\"modal fade show d-block\" role=\"dialog\">\r\n    <div class=\"modal-dialog modal-dialog modal-lg\">\r\n      <div class=\"modal-content d-flex flex-column\" style=\"height: 90vh;\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\">Remark(s) On Machine <span style=\"color:blue;\">{{ name }}</span></h5>\r\n          <button type=\"button\" class=\"btn-close\" @click=\"closeRemarkModal\"></button>\r\n        </div>\r\n  \r\n        <div class=\"modal-body flex-grow-1\" style=\"overflow-y: auto;\">\r\n          <div v-if=\"isfetching\" class=\"d-flex justify-content-center align-items-center\" style=\"height: 100px;\">\r\n            <span class=\"text-primary spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n          </div>\r\n          <div v-else>\r\n            <div v-for=\"remark in remarks\" :key=\"remark.id\">\r\n              <div v-if=\"remarks.length === 0\" class=\"text-center\">\r\n                <p>No remarks found</p>\r\n              </div>\r\n              <!-- Current user's remark -->\r\n              <div v-else>\r\n                <div v-if=\"remark.remarker_id == useId\" class=\"d-flex justify-content-end mb-2\">\r\n                  <div class=\"chat-bubble p-3 shadow-sm\" style=\"background-color: rgb(221 226 226); max-width: 80%; font-size: 0.5rem;\">\r\n                    <p class=\"mb-0 fw-bold text-dark fs-5\">You</p> \r\n                    <hr class=\"mt-0\" style=\"border: 1px solid #ccc;\" />\r\n                    <p class=\"mb-0 text-dark fs-4\">{{ remark.description }}</p>\r\n                  </div>\r\n                </div>\r\n  \r\n                <!-- Other users' remarks -->\r\n                <div v-if=\"remark.remarker_id !== useId\" class=\"d-flex justify-content-start mb-2\">\r\n                  <div class=\"chat-bubble p-3 shadow-sm\" style=\"background-color: rgb(241 226 226); max-width: 80%; font-size: 0.5rem;\">\r\n                    <p class=\"mb-0 fw-bold text-dark fs-5\">{{ remark.sender_name}}</p>\r\n                    <hr class=\"mt-0\" style=\"border: 1px solid #ccc;\" />\r\n                    <p class=\"mb-0 text-dark fs-4\">{{ remark.description }}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Form for adding a new remark - fixed at bottom -->\r\n        <div class=\"p-3 border-top\" style=\"background-color: #f8f9fa;\">\r\n          <form @submit.prevent=\"saveRemark\">\r\n            <textarea v-model=\"newremark\" class=\"form-control mb-2\" rows=\"3\" placeholder=\"Enter your remark\"></textarea>\r\n            <div class=\"d-flex justify-content-end gap-2\">\r\n              <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeRemarkModal\">Close</button>\r\n              <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"isSending\"> \r\n                <span v-if=\"isSending\">\r\n                  <span class=\"spinner-border spinner-border-xs\" role=\"status\" aria-hidden=\"true\"></span>            \r\n                </span>\r\n                <span v-else>Save</span>\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  </teleport>\r\n  \r\n    <!-- Modal Background Overlay -->\r\n    <div v-if=\"showRemarkModal\" class=\"modal-backdrop fade show\"></div>\r\n  \r\n  \r\n    <!-- <svg \r\n   data-bs-toggle=\"modal\" data-bs-target=\"#edit\"\r\n   @click=\"statement = props.row\"\r\n    v-if=\"user_permissions.includes('can_issue_fuel')\"\r\n    xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-pencil-square\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\r\n  <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z\"/>\r\n</svg> -->\r\n                            </template>\r\n                        </v-client-table>\r\n        \r\n                    </div>\r\n                </div>\r\n      \r\n  <!-- distribution ends -->\r\n\r\n    </div>\r\n  \r\n  <!-- edit modal starts -->\r\n                 <div class=\"modal fade mymodal\" id=\"edit\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\" >\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"staticBackdropLabel\">   {{ statement.type }} - {{ statement.machine }} CONSUMPTION  SUMMARY</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" id=\"close\" ></button>\r\n      </div>\r\n<div class=\"modal-body\" >\r\n<div class=\"card mb-3\">\r\n  <div class=\"card-body\">\r\n    <div class=\"row mb-2 text-start\">\r\n      <div class=\"col-md-4\"><strong>Issued Date:</strong> {{statement.issued_date}}</div>\r\n      <div class=\"col-md-4\"><strong>Issuer:</strong> {{ statement.issuer }}</div>\r\n      <div class=\"col-md-4\"><strong>Driver:</strong> {{ statement.driver }}</div>\r\n    </div>\r\n    <div class=\"row mb-2 text-start\">\r\n      <div class=\"col-md-4\"><strong>Machine:</strong> {{ statement.machine }}</div>\r\n      <div class=\"col-md-4\"><strong>Type:</strong> {{ statement.type }}</div>\r\n      <div class=\"col-md-4\"><strong>Fuel:</strong> {{ statement.fuel }}</div>\r\n    </div>\r\n    <div class=\"row mb-2 text-start\">\r\n      <div class=\"col-md-4\"><strong>Initial:</strong> {{statement.initial}}</div>\r\n      <div class=\"col-md-4\"><strong>Final:</strong> {{ statement.final }}</div>\r\n      <div class=\"col-md-4\"><strong>Ratio:</strong> {{ statement.ratio }}</div>\r\n    </div>\r\n    <div class=\"row text-start\">\r\n      <div class=\"col-md-12\"><strong>Task:</strong> {{ statement.task }}</div>\r\n    </div>\r\n\r\n     <div v-if=\"statement.remark\" class=\"row text-start\">\r\n      <div class=\"col-md-12\"><strong>Remark :</strong> {{ statement.remark }}</div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n<form\r\nv-if=\"user_permissions.includes('can_issue_fuel') || user_permissions.includes('is_md')\"\r\n@submit.prevent=\"updateReadings()\">\r\n   <div class=\"row layout-top-spacing\" >\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                 <div class=\"row g-3\">\r\n  <div class=\"col-md-4\" v-if=\"user_permissions.includes('can_issue_fuel')\">\r\n    <label class=\"form-label\">Initial Reading</label>\r\n    <input class=\"form-control\" type=\"number\" step=\"any\" placeholder=\"Enter Initial Reading\" v-model=\"statement.initial\">\r\n  </div>\r\n\r\n  <div class=\"col-md-4\" v-if=\"user_permissions.includes('can_issue_fuel')\">\r\n    <label class=\"form-label\">Final Reading</label>\r\n    <input class=\"form-control\" type=\"number\" step=\"any\" placeholder=\"Enter Final Reading\" v-model=\"statement.final\">\r\n  </div>\r\n\r\n   <div class=\"col-md-11\" v-if=\"user_permissions.includes('is_md')\">\r\n    <label class=\"form-label\">Enter Remark</label>\r\n    <input class=\"form-control\" type=\"text\" step=\"any\" placeholder=\"Enter Final Reading\" v-model=\"statement.remark\">\r\n  </div>\r\n\r\n\r\n  <div class=\"col-md-1 d-flex justify-content-between align-items-center\">\r\n    <div class=\"pt-4\">\r\n      <button class=\"btn btn-success\" :disabled=\"isSending\">\r\n        <span v-if=\"isSending\" v-html=\"loadingSpinner()\"></span>\r\n        <span v-else> Save</span>\r\n       </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n</form>\r\n   \r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-danger btn-sm py-2 px-2\" data-bs-dismiss=\"modal\">Close</button>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n   <!-- edit modal ends -->\r\n</template>\r\n\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n\r\n<script setup>\r\n    import axios from 'axios';\r\n    import { onMounted, ref } from 'vue';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css'\r\n    import '@/assets/sass/elements/tooltip.scss';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import { useRoute } from 'vue-router';\r\n    import { inject } from 'vue';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n    const loadingSpinner = inject('loadingSpinner');\r\n    const formatDate = inject('formatDate');\r\n    const tableShimmer = inject('tableShimmer')\r\n    const statement = ref('')\r\n    const isClosed = ref(true)\r\n    const isDiesel = ref(true);\r\n    const route = useRoute();\r\n    useMeta({ title: 'Purchase Order' });\r\n    const activeTab = ref(\"dieseldistribution\");\r\n    const machine_field = ref(false);\r\n    const driver_name = ref('');\r\n    const initial_reading= ref(' ');\r\n    const final_reading = ref('');\r\n    const task = ref('');\r\n    const item_id = ref(364);\r\n    const machine = ref('');\r\n    const fuel_quantity = ref('');\r\n    const issued_date = ref(new Date().toISOString().substr(0, 10));\r\n    const details = ref('');\r\n    const ratio = ref('');   \r\n    const Machines = ref([]);\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const bulkDistribution = ref([]);\r\n    const distributionColumn = ref(['SNo','issued_date','issuer','machine','type', 'task','fuel','ratio','actions']);\r\n    const table_option = ref({\r\n        perPage: 50,\r\n        perPageValues: [  50 ,100,200,500],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo','date_issued','ratio',],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n  \r\n    const view_machines = ref(false);\r\n    const view_distribution = ref(true);\r\n    const loading_spinner = ref(false);   \r\n    const selectedMachine = ref('');\r\n    const total_fuel = ref(0);\r\n      \r\n    const isfilling  = ref(false);\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const viewDistribution = ()=>{\r\n    \r\n      getBulkDistribution();     \r\n      view_machines.value=false;\r\n      view_distribution.value=true;\r\n    }\r\n\r\n\r\n    const getBulkDistribution = async () => {\r\n    loading_spinner.value = true;   \r\n    try {\r\n        const response = await axiosInstance.get(`/asset-consumptions?store_id=${route.params.store_id}`);\r\n        if (Array.isArray(response.data)) {   \r\n         bulkDistribution.value = response.data.filter(distribution => \r\n         distribution.store_id == route.params.store_id && distribution.item_id== item_id.value\r\n        )\r\n            .map((statement, index) => {\r\n                let ratio;\r\n                // Calculate the ratio based on the consumption_type\r\n                if (statement.consumption_type === \"Litre/hr\") {\r\n                    ratio = statement.quantity / (statement.final_reading - statement.initial_reading);\r\n                } else {\r\n                    ratio = (statement.final_reading - statement.initial_reading) / statement.quantity;\r\n                }\r\n\r\n              ratio = (ratio > 50 || ratio < 0) ? \"---\" : ratio.toFixed(2);\r\n               \r\n                return {\r\n                    SNo: index + 1,\r\n                    fuel: statement.quantity,\r\n                    consuption: statement.consumption_type,\r\n                    issued_date: formatDate(statement.created_at),\r\n                    task: statement.task,\r\n                    driver: statement.driver_name,\r\n                    issuer: statement.issuer_name,\r\n                    initial: statement.initial_reading,\r\n                    final: statement.final_reading,\r\n                    machine: statement.machine_name,\r\n                    type:statement.machine_type,\r\n                    ratio: ratio,\r\n                    project_id:statement.project_id,\r\n                    store_id:statement.store_id,\r\n                    id:statement.id,\r\n                    remark :statement.remark\r\n                  \r\n                };\r\n            });\r\n\r\n\r\n     total_fuel.value = bulkDistribution.value.reduce((sum, statement) => {\r\n                return sum + Number(statement.fuel); // Summing up the fuel_issued after mapping\r\n            }, 0);\r\n           \r\n            loading_spinner.value = false;\r\n        } else {\r\n          showError(error.message);\r\n            console.error(\"Invalid response format\");\r\n        }\r\n    } catch (error) {\r\n      showError(error.message);\r\n      loading_spinner.value = false;\r\n        console.error(\"Error fetching Bulk Distribution: \", error);\r\n    }\r\n};\r\nconst registerMachineDistribution = () => {\r\n            isfilling.value=false;\r\n    const storeItemId = isDiesel.value\r\n        ? bulkData.value.store_diesel_id  \r\n        : bulkData.value.store_petrol_id; \r\n\r\n         const itemData = {\r\n            store_item_id: storeItemId, \r\n            asset_id:selectedMachine.value.id,\r\n            project_id: bulkData.value.project_id, \r\n            consumption_type: ratio.value,\r\n            issuer_id: JSON.parse(localStorage.getItem(\"user\")).id,\r\n            quantity:fuel_quantity.value,\r\n            usage_date: issued_date.value,\r\n            initial_reading: initial_reading.value,\r\n            final_reading: final_reading.value,\r\n            task: task.value,\r\n            driver_name: driver_name.value\r\n \r\n        };\r\n        if (item_id.value == 364 && (bulkData.value.diesel_balance) < fuel_quantity.value) {\r\n        showError(\"Unsufficient Diesel in bulk.\");\r\n        isClosed.value = true;\r\n        return;\r\n        }\r\n        if (item_id.value == 365 && (bulkData.value.petrol_balance) < fuel_quantity.value) {\r\n         showError(\"Unsufficient Petrol in bulk.\");\r\n        isClosed.value = true;\r\n        return;\r\n    }\r\n\r\n    // console.log('item',item_id.value,'fuel ',fuel_quantity.value, 'bulk',bulkData.value)\r\n    // return ;\r\n    loading_spinner.value = true;\r\n        axiosInstance\r\n            .post('asset-consumptions', itemData)\r\n            .then((response) => {\r\n                getBulk()\r\n                getBulkDistribution();\r\n                selectedMachine.value = '';\r\n                fuel_quantity.value = '';\r\n                details.value = '';\r\n                ratio.value = '';\r\n                driver_name.value = '';\r\n                initial_reading.value = '';\r\n                final_reading.value = '';\r\n                task.value = '';\r\n                isClosed.value = true;\r\n                loading_spinner.value = false;\r\n                // Display success or error messages based on response status\r\n               \r\n            if (response.status === 201) {\r\n                showMessage(\"Fuel distributed successfully\");\r\n            } else {\r\n                console.error(\"Error registering Distribution:\", response.data);\r\n                showError(response.data.message || \"An error occurred while registering the distribution.\");\r\n            }\r\n            })\r\n            .catch((error) => {\r\n                console.error(\"Error registering Distribution:\", error);\r\n                showError(\"Error code :\"+ error.message);\r\n            });\r\n    };\r\n\r\n    const bulkData = ref([])\r\n    const getBulk = async () =>{\r\n      const response = await axiosInstance.get(`get-fuel?store_id=${route.params.store_id}`)\r\n       bulkData.value = response.data.map((item,index)=>({\r\n        ...item,\r\n        Sno : index + 1,\r\n        project_id: item.project_id, \r\n        store_diesel_id: item.store_diesel_id,\r\n        store_petrol_id: item.store_petrol_id,\r\n        diesel_quantity: item.diesel_quantity,\r\n        petrol_quantity: item.petrol_quantity,\r\n        petrol_used: item.petrol_used,\r\n        diesel_used: item.diesel_used,\r\n        diesel_balance: item.diesel_quantity - item.diesel_used,\r\n        petrol_balance: item.petrol_quantity - item.petrol_used\r\n       }))[0];      \r\n       loading_spinner.value = false;\r\n       }\r\n        \r\n\r\n    const fetchMachines = async () => {\r\n        loading_spinner.value=true;\r\n    axiosInstance\r\n      .get(`/machines`)\r\n      .then((response) => {\r\n        if (Array.isArray(response.data)) {\r\n          Machines.value = response.data.map((machine, index) => ({\r\n            SNo: index + 1,\r\n            id: machine.id,\r\n            name: machine.name,\r\n            type: machine.type_name,\r\n            ratio: machine.ratio,\r\n            category: machine.category_id === 1 ? 'machine' : \r\n                     machine.category_id === 2 ? 'vehicle' : \r\n                     machine.category_id === 3 ? 'supervision' : 'no category',\r\n            capacity: machine.capacity,\r\n            category_id:machine.category_id,\r\n            reserve_litre: machine.reserve_litre\r\n          }));\r\n        } else {\r\n          console.error(\"Invalid response format\");\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        showError(error.message);\r\n        loading_spinner.value = false;\r\n      })\r\n      .finally(() => {\r\n       loading_spinner.value = false;\r\n      });\r\n}\r\n\r\n\r\n\r\n\r\n//method for fetching remarks\r\nconst name =  ref();\r\nconst user_role = JSON.parse(localStorage.getItem(\"user\")).role;\r\nconst isfetching = ref(false);   \r\nconst status = ref(\"unchecked\"); // Default status\r\nconst usage = ref(); // Default usage ID\r\nconst newremark = ref();\r\nconst remarks = ref([]);\r\nconst showRemarkModal = ref(false);\r\nconst useId =  JSON.parse(localStorage.getItem(\"user\")).id;\r\nconst isSending = ref(false);\r\n\r\n   const openRemarkModal= (row) => {\r\n    fetchRemarks(row.id);\r\n    name.value= row.machine\r\n    usage.value = row.id;     \r\n        showRemarkModal.value = true;\r\n    }\r\n  const   closeRemarkModal = () => {\r\n    showRemarkModal.value = false;\r\n    newremark.value = ''; // Clear the remark input\r\n    remarks.value = []; // Reset the remarks list\r\n    name.value = ''; // Clear the machine name\r\n    \r\n    }\r\n\r\n\r\n   const fetchRemarks = async (id) => {\r\n    isfetching.value = true;\r\n\r\n    try {\r\n        const response = await axiosInstance.get(`/usage-remark/${id}`);\r\n        remarks.value = response.data.filter(item => item.remark_type === 'distribution');\r\n    } catch (error) {\r\n        console.error(\"Error fetching remarks:\", error);\r\n    }\r\n\r\n    isfetching.value = false;\r\n}\r\n\r\n    const saveRemark = async () => {\r\n        if (!newremark.value.trim()) {\r\n            showError(\"Remark cannot be empty!\");\r\n            return;\r\n        }\r\n   isSending.value= true;\r\n        try {\r\n            const response = await  axiosInstance.post(\"/remark\", {   \r\n                created_at: new Date().toISOString(), \r\n                remarker_id: JSON.parse(localStorage.getItem(\"user\")).id,\r\n                description: newremark.value,\r\n                status: status.value, // Default to unchecked\r\n                type_id:usage.value,\r\n                remark_type:\"distribution\"  \r\n            });\r\n\r\n            remarks.value.push(response.data); // Add new remark to the list\r\n            newremark.value = \"\"; // Clear input field\r\n            showMessage(\"Remark added:\", \"success\");\r\n        } catch (error) {\r\n            showError(\"Error adding remark:\", error);\r\n        }\r\n        isSending.value= false;\r\n    };\r\n\r\n\r\n    const updateReadings = async()=>{\r\n      isSending.value = true\r\n      const payload = {\r\n        initial_reading : statement.value.initial,\r\n        final_reading :statement.value.final,\r\n        remark : statement.value.remark\r\n      }\r\n\r\n    \r\n      try{\r\n        const response = await axiosInstance.put(`asset-consumptions/${statement.value.id}`,payload)\r\n        showMessage(\"Readings Updated\")\r\n        getBulkDistribution()\r\n        document.getElementById('close').click()\r\n      }catch(error){\r\n        showError(error.message)\r\n        console.log(error)\r\n      }finally{\r\n        isSending.value = false\r\n      }\r\n    }\r\n\r\n    onMounted(() => {   \r\n        getBulk()    \r\n        getBulkDistribution();\r\n        fetchMachines();\r\n       \r\n    });\r\n    \r\n</script>\r\n","import script from \"./bulk_distribution.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./bulk_distribution.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./bulk_distribution.vue?vue&type=style&index=0&id=1c01f65a&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["showMessage","inject","showError","loadingSpinner","formatDate","tableShimmer","statement","ref","isClosed","isDiesel","route","useRoute","useMeta","title","activeTab","machine_field","driver_name","initial_reading","final_reading","task","item_id","machine","fuel_quantity","issued_date","Date","toISOString","substr","details","ratio","Machines","user_permissions","JSON","parse","localStorage","getItem","permissions","bulkDistribution","distributionColumn","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","view_machines","view_distribution","loading_spinner","selectedMachine","total_fuel","isfilling","axiosInstance","axios","baseURL","process","viewDistribution","getBulkDistribution","value","async","response","get","params","store_id","Array","isArray","data","distribution","map","index","consumption_type","quantity","toFixed","SNo","fuel","consuption","created_at","driver","issuer","issuer_name","initial","final","machine_name","type","machine_type","project_id","id","remark","reduce","sum","Number","error","message","console","registerMachineDistribution","storeItemId","bulkData","store_diesel_id","store_petrol_id","itemData","store_item_id","asset_id","issuer_id","usage_date","diesel_balance","petrol_balance","post","then","getBulk","status","catch","item","Sno","diesel_quantity","petrol_quantity","petrol_used","diesel_used","fetchMachines","name","type_name","category","category_id","capacity","reserve_litre","finally","isfetching","role","usage","newremark","remarks","showRemarkModal","useId","isSending","closeRemarkModal","saveRemark","trim","remarker_id","description","type_id","remark_type","push","updateReadings","payload","put","document","getElementById","click","log","onMounted","__exports__"],"sourceRoot":""}