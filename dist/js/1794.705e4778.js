"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[1794],{61794:function(t,e,n){n.r(e),n.d(e,{default:function(){return O}});var a=n(66252),l=n(3577),s=n(2262),i=n(87066),o=n(42119);const r={class:"row layout-top-spacing"},d={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing my-4"},c={class:"panel p-0"},u={class:"custom-table table3"},p={class:"table table-bordered table-striped"},h=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Requester"),(0,a._)("th",null,"Date Requested"),(0,a._)("th",null,"Purpose"),(0,a._)("th",null,"Project"),(0,a._)("th",null,"Vendor"),(0,a._)("th",null,"Awaits"),(0,a._)("th",null,"Cost"),(0,a._)("th",null,"Action")])],-1),m={key:0},v=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,a._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),(0,a._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 \r\n                        0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 \r\n                        0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 \r\n                        2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 \r\n                        2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 \r\n                        1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 \r\n                        2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 \r\n                        1 1-1h12a1 1 0 0 1 1 1v3a1 1 \r\n                        0 0 1-1 1h-1v-1a2 2 0 0 \r\n                        0-2-2H5zm7 2v3a1 1 0 0 \r\n                        1-1 1H5a1 1 0 0 1-1-1v-3a1 \r\n                        1 0 0 1 1-1h6a1 1 0 0 \r\n                        1 1 1z"})],-1),g=[v],b={colspan:"5"},_=(0,a._)("b",null,"Brief Description:",-1),x={key:0,class:"custom-table table3 table-responsive"},y={class:"table"},w={key:0},f=(0,a._)("br",null,null,-1),k={key:0,class:"text-dark"},q=(0,a._)("br",null,null,-1),$={key:1,class:"text-dark"},C={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},D={class:"panel p-0"},z={class:"custom-table table3"};var P={setup(t){const e=(0,a.f3)("formatDate"),n=(0,a.f3)("formatNumber"),v=(0,a.f3)("showError"),P=(0,o.yj)(),S=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),O=(0,s.iH)({perPage:10,perPageValues:[10],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","Item"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),R=(0,s.iH)([]),H=(0,s.iH)(["Sno","Item","Description","Quantity","Rate","Total"]),L=(0,s.iH)(null),A=(0,a.Fl)((()=>L.value?.items?L.value.items.reduce(((t,e)=>{const n=parseFloat(e.quantity)||0,a=parseFloat(e.requisition_items?.rate)||0;return t+n*a}),0):0)),T=async()=>{try{const t=await S.get(`/approval-lists/${P.params.approval_id}`);L.value=t.data;const e=t=>t.map(((t,e)=>({Sno:e+1,Item:t.requisition_items?.description,Description:t.requisition_items?.remark,Quantity:t.quantity,Rate:n(t.requisition_items?.rate),Total:n(t.quantity*t.requisition_items?.rate)})));R.value=e(t.data.items||[])}catch(t){v(t.message),console.error(t)}},j=(0,s.iH)(0),N=async(t,e)=>{j.value=t.items.reduce(((t,e)=>t+e.quantity*e.requisition_items?.rate),0);try{const n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);const a=new Date(t.date),l=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}`,s=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Print LPO</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\n  .logo { width: 160px; height: auto; }\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; }\n  .company-title h2 { margin: 5px 0; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n  table.items th, table.items td { border: 0.5px solid #000; padding: 6px; }\n  table.items thead tr th { background-color: #f8f8f8; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  .text-success { color: green; }\n  .text-danger { color: red; }\n</style>\n</head>\n<body>\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="voucher-box">\n    LPO NO:<br>\n    <span style="color:red;">${("0000"+P.params.Lpo_id).slice(-4)}/${l}</span>\n  </div>\n</div>\n<div class="reg-info">\n  TIN: 135-489-247<br>\n  VRN: 40-032826C\n</div>\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\n</div>\n\n<div class="section-title">LOCAL PURCHASE ORDER</div><br>\n<div class="title text-center"><strong>PROJECT : ${t?.project?.toUpperCase()??"NO PROJECT"} </strong></div>\n\n<p><strong>Vendor Details </strong></p>\n<table class="items">\n  <thead>\n    <tr>\n      <th>Vendor Name</th>\n      <th>Location</th>\n      <th>Email</th>\n      <th>Phone</th>\n      <th>Address</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>${e?.name||""}</td>\n      <td>${e?.location||""}</td>\n      <td>${e?.email||""}</td>\n      <td>${e?.phone||""}</td>\n      <td>${e?.address||""}</td>\n    </tr>\n  </tbody>\n</table>\n\n<p><strong>Please provide the following as per requisition details below</strong></p>\n<table class="items">\n  <thead>\n    <tr>\n      <th>SN</th>\n      <th>Item</th>\n      <th>Description</th>\n      <th>Quantity</th>\n      <th>Rate</th>\n      <th>Total</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${t.items.map(((t,e)=>`\n      <tr>\n        <td>${e+1}</td>\n        <td>${t.requisition_items?.remark||""}</td>\n        <td>${t.requisition_items?.description||""}</td>\n        <td class="text-right">${t.quantity}</td>\n        <td class="text-right">${Number(t.requisition_items?.rate||0).toLocaleString()}/=</td>\n        <td class="text-right">${(t.quantity*t.requisition_items?.rate||0).toLocaleString()}/=</td>\n      </tr>\n    `)).join("")}\n    <tr>\n      <td colspan="6" style="text-align:right;">\n        <strong>TOTAL</strong> ${j.value.toLocaleString()}/=\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<div class="section-title">APPROVAL CHAIN</div>\n<table class="items">\n  <thead>\n    <tr>\n      ${t.roles_sequence.map((t=>`<th>${t.name}</th>`)).join("")}\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      ${t.roles_sequence.map((t=>`\n        <td class="text-center ${3==t?.status?.id?"text-success":"text-danger"}">\n          ${t?.status?.name??"Pending"}<br/>\n        </td>\n      `)).join("")}\n    </tr>\n  </tbody>\n</table>\n</body>\n</html>\n`,i=n.contentWindow.document;i.open(),i.write(s),i.close(),n.onload=()=>{n.contentWindow.focus(),n.contentWindow.print(),setTimeout((()=>document.body.removeChild(n)),1e3)}}catch(n){v(`Failed to print LPO: ${n.message}`)}};(0,a.f3)("whatsappAlert");return(0,a.bv)((()=>T())),(0,a.YP)((()=>P.params.Lpo_id),((t,e)=>{t!==e&&T()})),(t,i)=>{const o=(0,a.up)("v-client-table");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",d,[(0,a._)("div",c,[(0,a._)("div",u,[(0,a._)("table",p,[h,L.value?((0,a.wg)(),(0,a.iD)("tbody",m,[(0,a._)("tr",null,[(0,a._)("td",null,(0,l.zw)(L.value.requester?.name),1),(0,a._)("td",null,(0,l.zw)((0,s.SU)(e)(L.value.date)),1),(0,a._)("td",null,(0,l.zw)(L.value.description),1),(0,a._)("td",null,(0,l.zw)(L.value.project),1),(0,a._)("td",null,(0,l.zw)(L.value.vendor?.name),1),(0,a._)("td",null,(0,l.zw)(L.value.awaiting_approval?.name),1),(0,a._)("td",null,(0,l.zw)((0,s.SU)(n)((0,s.SU)(A))),1),(0,a._)("td",null,[(0,a._)("a",{href:"javascript:void(0);",class:"text-success",onClick:i[0]||(i[0]=t=>N(L.value,L.value.vendor))},g)])]),(0,a._)("tr",null,[(0,a._)("td",b,[_,(0,a.Uk)(" "+(0,l.zw)(L.value.description),1)])])])):(0,a.kq)("",!0)])])])]),L.value?.roles_sequence?((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("table",y,[(0,a._)("thead",null,[(0,a._)("tr",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(L.value.roles_sequence,(t=>((0,a.wg)(),(0,a.iD)("th",{key:t.position},(0,l.zw)(t.name),1)))),128))])]),L.value?.roles_sequence?((0,a.wg)(),(0,a.iD)("tbody",w,[(0,a._)("tr",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(L.value.roles_sequence,((t,n)=>((0,a.wg)(),(0,a.iD)("td",{key:t.role_id||t.position||n,class:(0,l.C_)(t?.status?.color?"text-"+t.status.color:"text-danger")},[(0,a._)("span",null,(0,l.zw)(t?.status?.name??"Unchecked"),1),f,t.approved_at?((0,a.wg)(),(0,a.iD)("span",k," Checked At: "+(0,l.zw)((0,s.SU)(e)(t.approved_at)),1)):(0,a.kq)("",!0),q,t.remark?((0,a.wg)(),(0,a.iD)("span",$," Remark: "+(0,l.zw)(t.remark),1)):(0,a.kq)("",!0)],2)))),128))])])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),(0,a._)("div",C,[(0,a._)("div",D,[(0,a._)("div",z,[(0,a.Wm)(o,{data:R.value,columns:H.value,options:O.value},null,8,["data","columns","options"])])])])])}}};const S=P;var O=S}}]);
//# sourceMappingURL=1794.705e4778.js.map