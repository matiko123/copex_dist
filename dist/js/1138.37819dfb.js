"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[1138],{58483:function(e,t,a){a.d(t,{i:function(){return n}});a(26699);function n(e,t){const a=t.toLowerCase().trim();if(!a)return e;const n=e=>null!=e&&("string"===typeof e?e.toLowerCase().includes(a):Array.isArray(e)?e.some(n):"object"===typeof e&&Object.values(e).some(n));return e.filter((e=>n(e)))}},86500:function(e,t,a){a.d(t,{Z:function(){return d}});var n=a(66252),l=a(49963),i=a(2262);const s=(0,n._)("span",{class:"input-group-text bg-white border-start-0"},[(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.442.656a5 5 0 1 1 \r\n        0-10 5 5 0 0 1 0 10z"})])],-1);var o={props:{filterValue:String},emits:["update:filterValue"],setup(e,{emit:t}){const a=e,o=(0,i.iH)(a.filterValue||null);return(0,n.YP)(o,(e=>t("update:filterValue",e))),(e,t)=>((0,n.wg)(),(0,n.iD)("form",{onSubmit:t[1]||(t[1]=(0,l.iM)((()=>{}),["prevent"])),class:"input-group container"},[(0,n.wy)((0,n._)("input",{type:"text",class:"form-control border-end-0",placeholder:"Search a word...","onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e)},null,512),[[l.nr,o.value]]),s],32))}};const r=o;var d=r},21138:function(e,t,a){a.r(t),a.d(t,{default:function(){return kn}});a(26699);var n=a(66252),l=a(3577),i=a(2262),s=a(49963),o=a(87066),r=a(56296),d=a(86500),c=a(58483),u=a(26212),p=a.n(u),m=a(42119),v=a(69218),g=a(80599),_=a.n(g);const b={class:"layout-px-spacing"},h={class:"navbar-nav flex-row mt-2"},y={class:"page-header"},w={class:"breadcrumb-one","aria-label":"breadcrumb"},x={class:"breadcrumb"},f={class:"breadcrumb-item"},k={href:"javascript:;"},q=(0,n._)("li",{class:"breadcrumb-item active","aria-current":"page"}," Purchase / Payment Approal Chain ",-1),C={class:"d-flex align-items-center justify-content-between mb-3 mt-3"},S=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-box-arrow-in-left",viewBox:"0 0 16 16"},[(0,n._)("path",{"fill-rule":"evenodd",d:"M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0z"}),(0,n._)("path",{"fill-rule":"evenodd",d:"M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708z"})],-1),D=(0,n.Uk)(" Requisitions "),$={key:1,class:"text-center m-0 flex-grow-1"},R=(0,n.Uk)(" GRN "),H=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-right-square",viewBox:"0 0 16 16"},[(0,n._)("path",{"fill-rule":"evenodd",d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z"})],-1),z={class:"mb-3 d-flex justify-content-end align-items-center gap-2"},A={style:{display:"inline-block","min-width":"200px"}},N={class:"d-flex justify-content-end flex-wrap gap-2"},O=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),U=[O],V={class:"row layout-top-spacing"},T=["innerHTML"],E={key:1,class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},L={class:"panel p-0"},M={class:"custom-table table3"},P=["onClick"],j=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,n._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})],-1),I=[j],B=["onClick"],F=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"})],-1),Y=[F],W=["onClick"],J=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-download",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v3.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5a.5.5 0 0 1 1 0v3.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-3.5a.5.5 0 0 1 .5-.5"}),(0,n._)("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"})],-1),Q=[J],X=["onClick"],G=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),(0,n._)("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1),Z=[G],K={class:"modal-dialog modal-fullscreen",role:"document"},ee={class:"modal-content"},te={class:"modal-header"},ae=(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Approval Chain ",-1),ne={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},le={class:"panel p-0"},ie={class:"custom-table table3 table-responsive"},se={class:"table table-bordered table-striped"},oe=(0,n._)("th",null,"Order No",-1),re=(0,n._)("th",null,"Requester",-1),de=(0,n._)("th",null,"Date Requested",-1),ce=(0,n._)("th",null,"Purpose",-1),ue=(0,n._)("th",null,"Approval Chain",-1),pe={key:0},me={key:1},ve={key:0},ge={key:1},_e=(0,n._)("th",null,"Awaits",-1),be=(0,n._)("th",null,"Cost",-1),he={key:2},ye={key:0},we={key:1},xe=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"})],-1),fe=[xe],ke=(0,n.Uk)(" view History "),qe={key:0},Ce={colspan:"8"},Se=(0,n._)("b",null," Brief Description : ",-1),De={key:0},$e={key:1},Re={colspan:"8"},He=(0,n._)("b",null," Remark : ",-1),ze={key:0,class:"d-flex justify-content-center mt-2 mb-2"},Ae=["disabled"],Ne=["innerHTML"],Oe={key:1},Ue={class:"input-group container"},Ve=["disabled"],Te=["innerHTML"],Ee={key:1},Le={class:"modal-body"},Me={class:"text-center mb-2"},Pe={class:"btn-group mb-2"},je=["disabled"],Ie=["disabled"],Be={key:0,class:"d-flex justify-content-center align-items-end gap-2"},Fe=["disabled"],Ye=["innerHTML"],We={key:1},Je={key:0,class:"d-flex justify-content-center mb-2"},Qe={class:"btn-group"},Xe=["disabled"],Ge=["disabled"],Ze=["disabled"],Ke=["disabled"],et=["disabled"],tt={key:1,class:"mb-2 text-center"},at={key:2,class:"input-group"},nt=["placeholder"],lt=["disabled"],it=["innerHTML"],st={key:1},ot={class:"custom-table table3 table-responsive"},rt={class:"table"},dt=(0,n._)("br",null,null,-1),ct=(0,n._)("br",null,null,-1),ut={key:0,class:"text-dark"},pt=(0,n.Uk)(),mt=(0,n._)("br",null,null,-1),vt={key:1,class:"text-dark"},gt=(0,n._)("h4",{class:"text-center",style:{"font-size":"1.3rem"}},"APPROVAL ITEMS",-1),_t={class:"d-flex justify-content-center mb-3"},bt={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},ht={class:"panel p-0"},yt={class:"custom-table table3 table-responsive"},wt={class:"table table-bordered table-striped"},xt=(0,n._)("th",null,"ID",-1),ft=(0,n._)("th",null,"Item",-1),kt=(0,n._)("th",null,"Decription",-1),qt=(0,n._)("th",null,"Quantity",-1),Ct=(0,n._)("th",null,"Unit",-1),St=(0,n._)("th",null,"Rate",-1),Dt=(0,n._)("th",null,"Total",-1),$t=(0,n._)("th",null,"Receiver",-1),Rt={key:0,class:"text-center"},Ht=(0,n._)("th",null,"Actions",-1),zt={key:1},At={key:0},Nt={key:1},Ot=["onClick"],Ut={key:0},Vt=(0,n._)("br",null,null,-1),Tt=(0,n._)("br",null,null,-1),Et={key:1},Lt=(0,n._)("br",null,null,-1),Mt=["onUpdate:modelValue"],Pt=["onClick"],jt=["onUpdate:modelValue"],It=(0,n._)("br",null,null,-1),Bt={key:0},Ft={key:0,class:"text-center"},Yt=["onClick"],Wt=(0,n._)("path",{d:"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0"},null,-1),Jt=(0,n._)("path",{d:"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"},null,-1),Qt=[Wt,Jt],Xt=["onClick"],Gt=(0,n._)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},null,-1),Zt=[Gt],Kt=["onUpdate:modelValue","onInput"],ea=["onUpdate:modelValue"],ta=["onUpdate:modelValue"],aa=(0,n._)("button",{class:"btn btn-outline-primary me-2"},"Diesel ",-1),na=(0,n._)("button",{class:"btn btn-outline-primary me-2"},"Budget",-1),la=(0,n._)("button",{class:"btn btn-outline-primary me-2"},"Jobcard",-1),ia=(0,n._)("button",{class:"btn btn-outline-primary me-2"},"Subcontractor",-1),sa={class:"btn btn-outline-dark me-2"},oa=["onClick"],ra=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"})],-1),da=[ra],ca=["onClick"],ua={key:3},pa=(0,n._)("h4",{class:"text-center"},"PROFORMA INVOICE",-1),ma=["href"],va=["src"],ga={key:4,class:"row layout-top-spacing"},_a=(0,n._)("h4",{class:"text-center"},"PROOF OF PAYMENT",-1),ba={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},ha={class:"panel p-0"},ya={class:"custom-table table3"},wa=["href","onClick"],xa={key:5,class:"row layout-top-spacing"},fa=(0,n._)("h4",{class:"text-center"},"ORDER RECEIPTS",-1),ka={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},qa={class:"panel p-0"},Ca={class:"custom-table table3"},Sa=["href","onClick"],Da={class:"modal-footer"},$a=["disabled"],Ra=["innerHTML"],Ha={key:1},za={class:"modal fade mymodal",id:"payment-proof","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Aa={class:"modal-dialog modal-xl"},Na={class:"modal-content"},Oa=(0,n._)("div",{class:"modal-header"},[(0,n._)("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," PROOF OF PAYMENT"),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close-proof-modal"})],-1),Ua={class:"modal-body"},Va={class:"custom-table table3 table-responsive"},Ta={class:"table table-bordered table-striped"},Ea=(0,n._)("th",null,"Order No",-1),La=(0,n._)("th",null,"Item No",-1),Ma=(0,n._)("th",null,"Requester",-1),Pa=(0,n._)("th",null,"Date Requested",-1),ja=(0,n._)("th",null,"Purpose",-1),Ia=(0,n._)("th",null,"Approval Chain",-1),Ba={key:0},Fa=(0,n._)("th",null,"Cost",-1),Ya={key:0},Wa={key:0},Ja={colspan:"9"},Qa={key:1},Xa={colspan:"9"},Ga={key:2},Za={colspan:"9"},Ka={class:"row layout-top-spacing"},en={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},tn={class:"panel p-0"},an={class:"custom-table table3"},nn={class:"row"},ln={class:"col-md-6"},sn=(0,n._)("label",{class:"form-label"},"Reference Number ",-1),on={class:"col-md-6"},rn=(0,n._)("label",{class:"form-label"},"Paid From ",-1),dn={class:"col-md-3"},cn=(0,n._)("label",{class:"form-label"},"Amount",-1),un={class:"col-md-4"},pn=(0,n._)("label",{class:"form-label"},"Receiver",-1),mn={class:"col-md-2"},vn=(0,n._)("label",{class:"form-label"},"Date ",-1),gn={class:"col-md-3"},_n=(0,n._)("label",{class:"form-label"},"Attachment ",-1),bn={class:"col-md-12"},hn=(0,n._)("label",{class:"form-label"},"Remark",-1),yn={class:"modal-footer"},wn=(0,n._)("button",{type:"button",class:"btn btn-danger me-2","data-bs-dismiss":"modal"},"Close",-1);var xn={setup(e){const t=(0,i.iH)("");(0,r.j)({title:"Approval Chains"});const a=(0,m.yj)(),u=o.Z.create({baseURL:"https://bushman.ink/api/v1/"}),g=(0,n.f3)("showConfirmation"),O=(0,i.iH)(""),j=(0,i.iH)([{id:"all",name:"All"},{id:2,name:"Unapproved"},{id:3,name:"Approved"},{id:4,name:"Rejected"},{id:17,name:"On Hold"},{id:14,name:"Remarked"},{id:16,name:"Paid"}]),F=(0,i.iH)(!1),J=async e=>{const t={status_id:16,remark:il.value,approval_list_id:e,approval_item_id:In.value,requisition_type:Zn.value.requisition_type,requisition_items:Zn.value.items.map((e=>({source_id:e.requisition_items.item_id,cost:e.requisition_items.quantity*e.requisition_items.rate,description:e.requisition_items.description,remark:"From LPO NO : "+In.value+" created on date "+Kn.value,remarker_id:JSON.parse(localStorage.getItem("user")).id,remarker:JSON.parse(localStorage.getItem("user")).name})))};try{Jn.value=!0;await u.put(`complete-transaction/${e}`,t);Nn("Transaction Completed"),Qn(),il.value="",F.value=!1,document.getElementById("close-approval-modal").click()}catch(a){On(a.message),console.log(a)}finally{Jn.value=!1}},G=(0,i.iH)(!1),xe=()=>{G.value=!G.value},Wt=(0,i.iH)(""),Jt=(0,i.iH)(""),Gt=async()=>{Jn.value=!0;const e={labour_request_id:tl.value.id,approval_group_id:8,source:"Labour Request",source_id:tl.value.approval_id,requester_id:fn,beneficiary:Wt.value,description:Jt.value,items:$n.value.filter((e=>Number(e.requesting_quantity)>0)).map((e=>({id:e.id,quantity:e.requesting_quantity,description:e.request_description,beneficiary:e.receiver})))};try{await u.post("approval-lists",e);Nn("Request Sent");const t=JSON.parse(localStorage.getItem("user")).name+" Created Voucher from Labour Request "+tl.value.id,a="wamid.HBgMMjU1Njk4MjY3NjYyFQIAEhggQUM4NzUzOTAxQTIxOEQ2NkZCNDM5RDM4NjUzQjY2QzEA",n=["255697315583","255698267662"];n.forEach((e=>{Dn(t,a,e)})),An(),Qn(),document.getElementById("close").click()}catch(t){On(t.message),console.log(t)}finally{Jn.value=!1}},ra=JSON.parse(localStorage.getItem("user")).permissions,xn=(0,i.iH)(!1),fn=JSON.parse(localStorage.getItem("user")).id,kn=(0,i.iH)(0),qn=(0,i.iH)(JSON.parse(localStorage.getItem("user")).role),Cn=(0,i.iH)(["Sno","requisition","order","purpose","type","requester","project","cost","status","date","awaits","actions"]),Sn=(0,i.iH)([]),Dn=(0,n.f3)("whatsappAlert"),$n=(0,i.iH)([]),Rn=(0,i.iH)({perPage:50,perPageValues:[50,100,200],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","service_name"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1,headings:{vendor:function(){return zn.value?"Beneficiary":"Vendor"}}}),Hn=(0,i.iH)(!1),zn=(0,n.Fl)((()=>"4"==a.params.group_id||"8"==a.params.group_id)),An=()=>{Bn.value="",il.value="",G.value=!1,Wt.value="",F.value="",O.value=""},Nn=(0,n.f3)("showMessage"),On=(0,n.f3)("showError"),Un=(0,n.f3)("formatNumber"),Vn=(0,n.f3)("tableShimmer"),Tn=(0,n.f3)("formatDate"),En=(0,n.f3)("loadingSpinner"),Ln=(0,n.f3)("enforceMax"),Mn=(0,i.iH)([]),Pn=(0,i.iH)({}),jn=(0,i.iH)(""),In=(0,i.iH)(""),Bn=(0,i.iH)(""),Fn=(0,i.iH)(!1),Yn=(0,i.iH)(null);let Wn=null;const Jn=(0,i.iH)(!1),Qn=async()=>{Jn.value=!0;try{let e=`approval-lists?status_id=${Bn?.value?.id??"all"}&date=${Cl.value}&`;"all"!==a.params.group_id&&(e+=`group_id=${a.params.group_id}`);const t=await u.get(e);Sn.value=t.data.map(((e,t)=>{let a=e.status;4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id||(a={name:e.last_checked_in.status.name,color:e.last_checked_in.status.color});let n=e.awaiting_approval?.name||"no one";4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id&&"approved"!==a.name&&"paid"!==a.name||(n="no one");let l=e.awaiting_approval?.role_id||null;return 4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id||(l=null),{...e,status:a,Sno:t+1,purpose:e.approval_group,type:e.requisition_type??e?.source,order:"0"+e.id,approval_id:e.id,requisition:e?.requisition_id??e?.source_id,requester:e.requester?.name??e?.requester,requester_id:e.requester?.id,awaits:n,awaiter_role_id:l,vendor:e.vendor&&e.vendor.name?e.vendor.name:e.beneficiary,vendor_data:e.vendor,date:Tn(e.date),created_at:e.date,last_checked:Tn(e.last_checked_in?.approved_at),last_checker_id:e?.last_checked_in?.role_id??"null",cost:e.items?Un(e.items.reduce(((e,t)=>e+(t?.quantity||0)*(t.requisition_items?.rate||0)),0)):0,approved_at:e.last_checked_in?.approved_at?new Date(e.last_checked_in.approved_at).toLocaleString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):null}})),Sn.value.sort(((e,t)=>{const a=Number(qn.value),n=e.awaiter_role_id===a,l=t.awaiter_role_id===a;return n&&!l?-1:!n&&l?1:0}))}catch(e){On(e.message),console.error(e)}finally{Jn.value=!1}},Xn=(0,n.Fl)((()=>(0,c.i)(Sn.value,t.value)));(0,n.YP)((()=>a.params.group_id),((e,t)=>{e!==t&&(pl(),Qn())}));const Gn=(0,i.iH)(""),Zn=(0,i.iH)(0),Kn=(0,i.iH)(""),el=(0,i.iH)(""),tl=(0,i.iH)(""),al=(0,i.iH)(""),nl=(0,i.iH)(""),ll=e=>{Ml(e.id),nl.value=e,$n.value=e.items.map(((e,t)=>({...e,order_item_id:e?.requisition_items?.id,Sno:t+1,item:e?.requisition_items?.remark,description:e?.requisition_items?.description+(e.description?" ( "+e.description+" )":""),rate:Number(e?.rate).toLocaleString()+"/=",total:(e?.quantity*e?.rate).toLocaleString()+"/=",selected:!1,rate_original:e?.rate,requesting_quantity:"",request_description:""}))),el.value=e.awaits,al.value=e.approval_description,Mn.value=(e.roles_sequence||[]).slice(),Gn.value=e.roles_sequence?.length>0?e.roles_sequence[e.roles_sequence.length-1].role_id:null,Pn.value=e.awaiting_approval||{},jn.value=e.awaiting_approval?.role_id||null,In.value=e.id,Kn.value=e.date,Zn.value=e,tl.value=e,Fn.value=!1},il=(0,i.iH)(""),sl=async()=>{const e={subcontractor_agreement_id:tl.value.subcontractor_agreement_id,approval_group_id:a.params.group_id,status_id:O.value,approval_item_id:In.value,role_id:qn.value,remark:il.value,last_role:Gn.value,requisition_type:Zn.value.requisition_type,project:Zn.value,requisition_items:Zn.value.items.map((e=>({source_id:e.requisition_items.item_id,cost:e.requisition_items.quantity*e.requisition_items.rate,description:e.requisition_items.description,remark:"From LPO NO : "+In.value+" created on date "+Kn.value,remarker_id:JSON.parse(localStorage.getItem("user")).id,remarker:JSON.parse(localStorage.getItem("user")).name}))),approval_items:$n.value.map((e=>({id:e.id,quantity:Number(e.quantity),rate:Number(e.rate_original)})))};await u.post("approval-chains",e),jn.value="",il.value="",O.value="",Qn(),Nn("data saved successfully")},ol=async()=>{try{xn.value=!0,await sl(),Fn.value=!0,Pn.value.role_id="",il.value="",Bn.value="",document.getElementById("close-approval-modal").click()}catch(e){On(e.message),console.error(e)}finally{xn.value=!1,vl.value=""}},rl=async(e,t)=>{kn.value=e.items.reduce(((e,t)=>e+t.quantity*t.requisition_items?.rate),0);try{const t=new Date(e.created_at),a=`${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}`,n=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Print Voucher</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; font-weight: 500; color: #000; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\n  .logo { width: 160px; height: auto; }\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-weight: 600; font-size: 8px; color: #000; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; color: #000; }\n  .company-title h2 { margin: 5px 0; font-weight: 700; color: #000; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 11px; line-height: 1.4; font-weight: 500; color: #000; }\n  .section-title { text-align: center; font-weight: 700; text-decoration: underline; margin: 20px 0 10px 0; color: #000; }\n  .title { text-align: center; font-weight: 700; margin: 20px 0 10px 0; color: #000; }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 4px; overflow: hidden; }\n  table.details td, table.items th, table.items td, .signatures th, .signatures td { border: 0.5px solid #000; padding: 6px; font-weight: 500; color: #000; }\n  table.items thead tr th { background-color: #f8f8f8; border-bottom: 1px solid #000; font-weight: 700; color: #000; }\n  .text-right { text-align: right; color: #000; }\n  .text-center { text-align: center; color: #000; }\n  .text-success { color: green; font-weight: 600; }\n  .signature-area { margin-top: 30px; }\n  .signature-line { border-top: 1px solid #000; width: 200px; display: inline-block; margin-top: 50px; }\n  .text-danger { color: red; font-weight: 600; }\n  strong { font-weight: 700; color: #000; }\n  p { color: #000; }\n  td { color: #000; }\n  th { color: #000; }\n  div { color: #000; }\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\n</style>\n</head>\n<body>\n<div class="header">\n  <img src="${v}" class="logo" />\n  <div class="voucher-box">\n    ${e.type.toLowerCase().includes("voucher")||e.type.toLowerCase().includes("labour")?"Voucher":"LPO"} NO: <br>\n    <span style="color:red; font-weight: 700;">${("0000"+e.approval).slice(-4)}/${a}</span>\n  </div>\n</div>\n<div class="reg-info">\n  TIN: 135-489-247<br>\n  VRN: 40-032826C\n</div>\n<div class="company-title">\n  <h3>COPEX CONTRACTORS CO.LTD</h3>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\n</div>\n<div class="section-title"> ${e?.purpose?.toUpperCase()} DETAILS</div>\n\n<div class="title">PROJECT :  ${e?.project?.toUpperCase()??"NO PROJECT"}</div>\n\n<p><strong>ORDER ITEMS</strong></p>\n<table class="items">\n  <thead>\n    <tr>\n      <th>SN</th>\n      <th>Item</th>\n      <th>Description</th>\n      <th>Quantity</th>\n      <th>Rate</th>\n      <th>Total</th>\n      <th>Receiver</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${e.items.map(((e,t)=>`\n    <tr>\n      <td>${t+1}</td>\n      <td>${e.requisition_items?.remark||"N/A"}</td>\n      <td>${e.requisition_items?.description+(e.description?" , "+e.description:"")||"N/A"}</td>\n      <td class="text-right">${e.requisition_items?.quantity||"0"}</td>\n      <td class="text-right">${Number(e.requisition_items?.rate||0).toLocaleString()}/=</td>\n      <td class="text-right">${(e.quantity*e.requisition_items?.rate||0).toLocaleString()}/=</td>\n      <td>${e.receiver||e.beneficiary||"N/A"}</td>\n    </tr>\n    `)).join("")}\n ${e.description?`\n  <tr>\n    <td colspan="7" style="text-align:start; color: #000;">\n      <strong>Brief Description :</strong> ${e.description+(e.approval_description?" , "+e.approval_description:"")} \n    </td>\n  </tr>\n`:""}\n    <tr>\n     <td colspan="7" style="text-align:right; color: #000;"><strong>TOTAL</strong>  <strong>${kn.value.toLocaleString()}/=</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n<div class="section-title">APPROVAL CHAIN </div>\n<table class="signatures" style="margin-top: 20px;">\n  <thead>\n    <tr>\n          ${e.roles_sequence.map((e=>`\n      <th>${e.name||"N/A"}</th>\n            `)).join("")}\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n          ${e.roles_sequence.map((e=>`\n      <td class="text-center ${3==e?.status?.id?"text-success":"text-danger"}">${e?.status?.name??"Pending"}</td>\n       `)).join("")}\n      </tr>\n  </tbody>\n</table>\n\n${e.purpose.toLowerCase().includes("voucher")?`\n<div class="signature-area" style="display: flex; justify-content: space-between; margin-top: 20px;">\n  <div style="text-align: center;">\n    \n<div style="text-align: center; margin-top: 30px;">\n  <div style="margin-bottom: 5px; color: #000;">\n    <strong>${e.beneficiary||"&nbsp;"}</strong>\n  </div>\n  <div style="border-bottom: 1px solid #000; width: 200px; margin: 0 auto;"></div>\n</div>    <p><strong>Received By:</strong></p>\n  </div>\n  <div style="text-align: center;">\n    <div class="signature-line"></div>\n    <p><strong>Receiver's Signature</strong></p>\n  </div>\n  <div style="text-align: center;">\n    <div class="signature-line"></div>\n    <p><strong>Received Date</strong></p>\n  </div>\n</div>\n`:""}\n</body>\n</html>\n`,l={margin:10,filename:`voucher_${("0000"+e.approval).slice(-4)}_${a}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await _()().from(n).set(l).save()}catch(a){On(`Failed to download PDF: ${a.message}`)}},dl=async(e,t)=>{const a=e.requisition_items.beneficiary||t.type.toLowerCase().includes("labour");kn.value=t.items.reduce(((e,t)=>e+t.quantity*t.rate),0);try{const n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);new Date(t.created_at);const l=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Print</title>\n<style>\nbody { font-family:'Courier New', monospace; margin:40px; font-size:13px }\n.company-title { text-align:center }\n.title { text-align:center; font-size:20px; margin:15px 0 }\ntable { width:100%; border-collapse:collapse; margin-top:10px }\nth,td { border:0.5px solid #000; padding:6px }\n.text-right { text-align:right }\n.text-center { text-align:center }\n.signature-line { border-top:1px solid #000; width:200px; margin-top:40px }\nhr { border-top:0.5px solid #000 }\n@media print { body { margin:10mm } }\n</style>\n</head>\n<body>\n\n<div style="font-size:18px">\n${a?"VOUCHER":"ORDER"} NO:\n<span style="color:red">${t.approval_id}/${new Date(t.created_at).getFullYear().toString().slice(-2)}</span>\n</div>\n\n<div class="company-title">\n<h1>COPEX CONTRACTORS CO.LTD</h1>\n<div>Msamvu, P.O.BOX 678, Morogoro</div>\n<div>0713 000 777, 0657 111 555</div>\n<div>TIN: 135-489-247 &nbsp; VRN: 40-032826C</div>\n</div>\n\n<hr>\n\n<div class="title">\n${a?"VOUCHER":"PURCHASE ORDER"} :\n${t?.project?.toUpperCase()??"NO PROJECT"}\n</div>\n\n${a?"":`\n<div style="display:flex;gap:20px">\n<div style="flex:1">\n<table>\n<tr><th colspan="2">Vendor</th></tr>\n<tr><td>Name</td><td>${e.vendor?.name||""}</td></tr>\n<tr><td>Location</td><td>${e.vendor?.location||""}</td></tr>\n<tr><td>Email</td><td>${e.vendor?.email||""}</td></tr>\n<tr><td>Phone</td><td>${e.vendor?.phone||""}</td></tr>\n<tr><td>Address</td><td>${e.vendor?.address||""}</td></tr>\n</table>\n</div>\n\n<div style="width:35%">\n<table>\n<tr><td>Date</td><td>${Tn(t.created_at)}</td></tr>\n<tr><td>LPO No</td><td>${("00"+e.requisition_items.id).slice(-4)}</td></tr>\n</table>\n</div>\n</div>\n`}\n\n<p>Please provide the following as per requisition details below</p>\n\n<table>\n<thead>\n<tr>\n<th>Item</th>\n<th>Description</th>\n<th>Qty</th>\n<th>Unit</th>\n<th>Rate</th>\n<th>Total</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>${e.requisition_items?.remark||"N/A"}</td>\n<td>${e.requisition_items?.description||"N/A"}</td>\n<td class="text-right">${e.quantity}</td>\n<td>${e.requisition_items?.units||"N/A"}</td>\n<td class="text-right">${Number(e.rate_original).toLocaleString()}/=</td>\n<td class="text-right">${(e.quantity*e.rate_original).toLocaleString()}/=</td>\n</tr>\n\n${t.description?`\n<tr>\n<td colspan="6">\nBrief Description:\n${t.description}${t.approval_description?", "+t.approval_description:""}\n</td>\n</tr>\n`:""}\n\n\n</tbody>\n</table>\n\n<h3 class="text-center">APPROVAL CHAIN</h3>\n<table class="signatures" style="margin-top: 10px;">\n  <tbody>\n    <tr>\n          ${t.roles_sequence.map((e=>`\n      <td style="border-bottom:1px solid #000;border-top:1px solid #fff;border-right:1px solid #fff;border-left:1px solid #fff;" class="text-center ${3==e?.status?.id?"text-success":"text-danger"}">${e?.status?.name??"Pending"}</td>\n       `)).join("")}\n      </tr>\n  </tbody>\n    <tfooter>\n    <tr>\n          ${t.roles_sequence.map((e=>`\n      <th style="border-bottom:1px solid #fff;border-top:1px solid #fff;border-right:55px solid #fff;border-left:1px solid #fff;">${e.name||"N/A"}</td>\n            `)).join("")}\n    </tr>\n\n  </tfooter>\n</table>\n${a?`\n<div style="display:flex;justify-content:space-between;margin-top:30px">\n<div class="text-center">\n<div class="signature-line"></div>\n<p>Received By : ${e.requisition_items.beneficiary||e.beneficiary||""}</p>\n</div>\n\n<div class="text-center">\n<div class="signature-line"></div>\n<p>Date</p>\n</div>\n</div>\n`:""}\n\n</body>\n</html>\n`,i=n.contentWindow.document;i.open(),i.write(l),i.close(),n.onload=()=>{n.contentWindow.focus(),n.contentWindow.print(),setTimeout((()=>document.body.removeChild(n)),1e3)}}catch(n){On(n.message)}},cl=async(e,t)=>{kn.value=e.items.reduce(((e,t)=>e+t?.quantity*t?.rate),0);try{const a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);new Date;const n=new Date(e.created_at),l=(n.getDate().toString().padStart(2,"0"),(n.getMonth()+1).toString().padStart(2,"0"),`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Print Voucher</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header {  display: flex; justify-content: space-between; align-items: flex-start;font-weight:bold }\n  .logo { width: 160px; height: auto; }\n  .text-style { font-family: 'Courier New', monospace; }\n  .voucher-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; }\n  .company-title h2 { margin: 5px 0; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; font-weight: normal; }\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\n  .title { text-align: center;   margin: 10px 0 10px 0; font-size:20px }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 4px; overflow: hidden; }\n  table.details td, table.items th, table.items td, .signatures th, .signatures td { border: 0.5px solid #000; padding: 6px; font-weight: normal; }\n  table.items thead tr th { background-color: #f8f8f8; border-bottom: 1px solid #000; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  .text-success { color: green; }\n .signature-area { margin-top: 30px; }\n  .signature-line { border-top: 1px solid #000; width: 200px; display: inline-block; margin-top: 50px; }\n  .text-danger { color: red; }\n  hr {\n  border: 0;\n  border-top: 0.4px solid #000 !important;\n  opacity: 1 !important;\n  margin: 0px 0;\n}\n\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\n</style>\n</head>\n<body>\n<div class="text-style" style="font-size:20px">\n ORDER NO. ${e.approval_id}/${new Date(e.created_at).getFullYear().toString().slice(-2)}\n</div>\n<div class="company-title text-style">\n  <i>\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\n  <div><b>Tel:</b> , 0713 000 777, 0657 111 555</div>\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\n  <div><b>TIN:</b> 135-489-247    <b>VRN:</b> 40-032826C</div>\n  </i>\n</div>\n<hr style="margin-top:20px">\n<div class="title text-style">  ${e?.purpose?.toUpperCase()} :  ${e?.project?.toUpperCase()??"NO PROJECT"}</div>\n<hr>\n${e.purpose.toLowerCase().includes("voucher")?"":`\n\n<div style="display:flex;justify-content:space-between;gap:20px;margin-top:10px;font-size:13px;">\n  <div style="flex:1;border:1px solid #f0f0f0;padding:8px;">\n  <table style="width:100%; border-collapse: collapse;">\n  <tr><td style="background:#333; border-top:1px solid #000; border-right:1px solid #000; border-bottom:1px solid #000; padding:5px;width:2cm">\n  <b>Vendor</b>\n</td>\n</tr>\n  <tr ><td>Name</td><td style="border-bottom:1px solid #000;">${t?.name||""}</td></tr>\n  <tr ><td>Address</td><td class="text-style" style="border-bottom:1px solid #000;">${t?.address||""}</td></tr>\n  <tr ><td>City</td><td class="text-style" style="border-bottom:1px solid #000;">${t?.location||""}</td></tr>\n  <tr ><td>Phone</td><td class="text-style" style="border-bottom:1px solid #000;">${t?.phone||""}</td></tr>\n  <tr ><td >TIN</td><td class="text-style" style="border-bottom:1px solid #000;">${t?.tin||""}</td></tr>\n  <tr ><td >VRN</td><td  class="text-style" style="border-bottom:1px solid #000;">${t?.vrn||""}</td></tr>\n</table>\n\n  </div>\n  <div style="width:35%;border:1px solid #f0f0f0;padding:8px;margin-top:1cm">\n    <table style="width:100%;border-collapse:collapse;">\n      <tr><td class="text-style"> ${e.purpose.toLowerCase().includes("voucher")?"VOUCHER":"LPO"} :</td><td class="text-style">0${e?.id||""}/${new Date(e.created_at).getFullYear().toString().slice(-2)}</td></tr>\n      <tr><td class="text-style"> ${e.purpose.toLowerCase().includes("voucher")?"VOUCHER":"LPO"} DATE:</td><td class="text-style">${Tn(e.created_at)}</td></tr>\n      <tr><td class="text-style">REQ:</td><td class="text-style">${e?.requisition||""}</td></tr>\n      <tr><td class="text-style">REQ DATE:</td><td class="text-style">${Tn(e.requested_date)}</td></tr>\n      <tr><td class="text-style">STATUS:</td><td class="text-style">${e?.status.name||""}</td></tr>\n      <tr><td class="text-style">AWAITS:</td><td class="text-style">${e?.awaits||""}</td></tr>\n    </table>\n  </div>\n</div>\n<br>\n\n  </tbody>\n</table>\n    `}\n\n<p class="text-style">Please provide the following as per requisition details below</p>\n<h2 class="text-style">CURRENCY : TSH</h2>\n<table class="items">\n  <thead>\n    <tr>\n      <th class="text-style">No.</th>\n      <th class="text-style">ITEM NAME</th>\n      <th class="text-style">DESCRIPTION</th>\n      <th class="text-style">QUANTITY</th>\n       <th class="text-style">UNIT</th>\n      <th class="text-style">RATE</th>\n      <th class="text-style">TOTAL</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${e.items.map(((e,t)=>`\n    <tr>\n      <td class="text-style">${t+1}</td>\n      <td class="text-style">${e.requisition_items?.remark||"N/A"}</td>\n      <td class="text-style">${e.requisition_items?.description||"N/A"}</td>\n      <td class="text-style">${e.requisition_items?.units||"N/A"}</td>\n      <td class="text-style text-right">${e?.quantity||"0"}</td>\n      <td class=" text-style text-right">${Number(e?.rate||0).toLocaleString()}/=</td>\n      <td class="text-style text-right">${(e?.quantity*e?.rate||0).toLocaleString()}/=</td>\n    </tr>\n\n    `)).join("")}\n\n    <tr>\n     <td colspan="7" class="text-style" style="text-align:right;"><strong>TOTAL</strong>  <strong>${kn.value.toLocaleString()}/=</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n<h2 style="text-style">Note : </h2>\n<p class="text-style">${e.description??""}</p>\n<div class="title text-style" style="margin-top:40px">APPROVAL CHAIN</div>\n<table class="signatures" style="margin-top: 10px;">\n  <tbody>\n    <tr>\n          ${e.roles_sequence.map((e=>`\n      <td style="border-bottom:1px solid #000;border-top:1px solid #fff;border-right:1px solid #fff;border-left:1px solid #fff;" class="text-center ${3==e?.status?.id?"text-success":"text-danger"}">${e?.status?.name??"Pending"}</td>\n       `)).join("")}\n      </tr>\n  </tbody>\n    <tfooter>\n    <tr>\n          ${e.roles_sequence.map((e=>`\n      <th style="border-bottom:1px solid #fff;border-top:1px solid #fff;border-right:55px solid #fff;border-left:1px solid #fff;">${e.name||"N/A"}</td>\n            `)).join("")}\n    </tr>\n\n  </tfooter>\n</table>\n\n\n\n${e.purpose.toLowerCase().includes("voucher")?`\n    <div class="title text-style" style="margin-top:40px;margin-bottom:-20px">BENEFICIARY</div>\n\n<div class="signature-area" style="display: flex; justify-content: space-between; margin-top: 20px;">\n  <div style="text-align: center;">\n<div style="text-align: center; margin-top: 30px;">\n  \x3c!-- Beneficiary name above the line --\x3e\n  <div class="text-style" style="margin-bottom: 5px;">\n    <strong>${e.beneficiary||"&nbsp;"}</strong>\n  </div>\n\n  \x3c!-- The signature line --\x3e\n  <div style="border-bottom: 1px solid #000; width: 200px; margin: 0 auto;"></div>\n</div>    <p>Received By: </p>\n  </div>\n  <div style="text-align: center;">\n    <div class="signature-line"></div>\n    <p>Receiver's Signature</p>\n  </div>\n  <div style="text-align: center;">\n    <div class="signature-line"></div>\n    <p>Received Date</p>\n  </div>\n</div>\n`:""}\n</body>\n</html>\n`),i=a.contentWindow.document;i.open(),i.write(l),i.close(),a.onload=()=>{a.contentWindow.focus(),a.contentWindow.print(),setTimeout((()=>{document.body.removeChild(a)}),1e3)}}catch(a){On(`Failed to print voucher: ${a.message}`)}},ul=(0,i.iH)(""),pl=async()=>{ul.value="";const e=await u.get(`approval-groups/${a.params.group_id}`);ul.value=e.data},ml=JSON.parse(localStorage.getItem("user")).role,vl=(0,i.iH)(),gl=e=>{(ra.includes("can_edit_approval_items")&&qn.value==Pn.value.role_id&&"no one"!==el.value||1==ml)&&(vl.value=e)},_l=(0,i.iH)(""),bl=(0,i.iH)(""),hl=(e,t)=>{xl(),_l.value=e,bl.value=t},yl=(0,i.iH)([]),wl=(0,i.iH)(""),xl=async()=>{try{const e=await u.get("account-transaction-points");yl.value=e.data.map(((e,t)=>({...e,name:(e?.name??"")+" "+(e?.mobile_money?.name??"")+" "+(e?.mobile_money?.category??"CASH")})))}catch(e){On(e.message)}},fl=e=>{Rl.value=e.target.files[0]},kl=(0,i.iH)(""),ql=async()=>{xn.value=!0;const e=new FormData;e.append("registrar_id",fn),e.append("approval_list_id",tl.value.id),e.append("date",kl.value),Rl.value instanceof File&&e.append("attachment",Rl.value);try{const t=await u.post("purchase-order-receipts",e);Nn(t.data.message),jl(tl.value.id)}catch(t){On(t.message),console.log(t)}finally{xn.value=!1,Hn.value=!1}},Cl=(0,i.iH)((new Date).toISOString().slice(0,10)),Sl=(0,i.iH)(""),Dl=(0,i.iH)(""),$l=(0,i.iH)(""),Rl=(0,i.iH)(""),Hl=async()=>{const e=new FormData;e.append("reference_number",$l.value),e.append("account_transaction_point_id",wl.value.id),e.append("host",Sl.value),e.append("amount",Dl.value),e.append("description",Jt.value),e.append("issuer_id",fn),e.append("approval_item_id",_l.value.id),e.append("direction","DECREMENT"),e.append("opening_balance",wl.value.transactions_sum),e.append("date",Cl.value),Rl.value instanceof File&&e.append("attachment",Rl.value);try{const t=await u.post("account-transactions",e);Nn(t.data.message),document.getElementById("close-proof-modal").click()}catch(t){On(t.message),console.log(t)}};(0,n.YP)(Cl,(e=>{e&&Qn()})),(0,n.YP)(Bn,(e=>{e&&Qn()}));const zl=async()=>{try{const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const t=Sn.value.reduce(((e,t)=>{const a="string"===typeof t.cost?parseFloat(t.cost.replace(/,/g,"")):t.cost;return e+(isNaN(a)?0:a)}),0),n=`\n<!DOCTYPE html>\n<html>\n<head>\n<style>\n  body { font-family: 'Courier New', monospace; margin: 20px; font-size: 8px; }\n  .text-style { font-family: 'Courier New', monospace; }\n  .company-title { text-align: center; font-size: 9px; }\n  .company-title h1 { font-size: 14px; margin: 5px 0; }\n  .title { text-align: center; font-size: 12px; margin: 8px 0; font-weight: bold; }\n  table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 9px; }\n  th, td { border: 1px solid #000; padding: 3px 4px; }\n  th { background-color: #f0f0f0; font-weight: bold; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  .badge { padding: 2px 5px; border-radius: 2px; font-size: 8px; display: inline-block; }\n  .badge-success { background-color: #28a745; color: white; }\n  .badge-warning { background-color: #ffc107; color: black; }\n  .badge-danger { background-color: #dc3545; color: white; }\n  .badge-info { background-color: #17a2b8; color: white; }\n  hr { border: 0; border-top: 1px solid #000; margin: 8px 0; }\n  @media print { \n    body { margin: 5mm; } \n    table { page-break-inside: auto; }\n    tr { page-break-inside: avoid; page-break-after: auto; }\n  }\n</style>\n</head>\n<body>\n\n<div class="company-title text-style">\n  <i>\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\n  </i>\n</div>\n\n<hr>\n\n<div class="title text-style">\n${"1"===a.params.group_id?"LOCAL PURCHASE ORDERS":"4"===a.params.group_id?"PAYMENT VOUCHERS":ul.value?.group?.toUpperCase()||"APPROVAL"} REPORT\n</div>\n\n<hr>\n\n<table>\n  <thead>\n    <tr>\n      <th>S/No.</th>\n      <th>Order_no</th>\n      <th>Purpose</th>\n      <th>Type</th>\n      <th>Requester</th>\n      <th>Project</th>\n      <th>Status</th>\n      <th>Date</th>\n      <th>Awaits</th>\n      <th class="text-right">Cost</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${Sn.value.map(((e,t)=>`\n    <tr>\n      <td>${t+1}</td>\n      <td>${e.order||"N/A"}</td>\n      <td>${e.purpose||"N/A"}</td>\n      <td>${e.type||"N/A"}</td>\n      <td>${e.requester||"N/A"}</td>\n      <td>${e.project||"N/A"}</td>\n      <td class="text-center">${e.status?.name||"N/A"}</span></td>\n      <td>${e.date||"N/A"}</td>\n      <td>${e.awaits||"N/A"}</td>\n      <td class="text-right">${e.cost||"0"}</td>\n    </tr>\n    `)).join("")}\n    <tr style="font-weight: bold;">\n      <td colspan="9" class="text-right"><strong>TOTAL:</strong></td>\n      <td class="text-right"><strong>${Un(t)}</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n<div style="margin-top: 15px; font-size: 7px;">\n  <p><strong>Report Generated:</strong> ${(new Date).toLocaleString()}</p>\n  <p><strong>Generated By:</strong> ${JSON.parse(localStorage.getItem("user")).name}</p>\n</div>\n\n</body>\n</html>\n`,l=e.contentWindow.document;l.open(),l.write(n),l.close(),e.onload=()=>{e.contentWindow.focus(),e.contentWindow.print(),setTimeout((()=>{document.body.removeChild(e)}),1e3)}}catch(e){On(`Failed to print report: ${e.message}`)}},Al=async e=>{const t=await g("Delete Record","Are you sure you want to delete Ref No. "+e.approval,`/approval-lists/${e.id}?deleted=1`,"put");t?.refresh&&Nl()},Nl=async()=>{let e="approval-lists";"all"!==a.params.group_id&&(e+=`?group_id=${a.params.group_id}`);const t=await u.get(e);Sn.value=t.data.map(((e,t)=>{let a=e.status;4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id||(a={name:e.last_checked_in.status.name,color:e.last_checked_in.status.color});let n=e.awaiting_approval?.name||"no one";4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id&&"approved"!==a.name&&"paid"!==a.name||(n="no one");let l=e.awaiting_approval?.role_id||null;return 4!=e.last_checked_in?.status?.id&&14!=e.last_checked_in?.status?.id||(l=null),{...e,status:a,Sno:t+1,purpose:e.approval_group,type:e.requisition_type??e?.source,approval:"0"+e.id,approval_id:e.id,requisition:e?.requisition_id??e?.source_id,requester:e.requester?.name??e?.requester,requester_id:e.requester?.id,awaits:n,awaiter_role_id:l,vendor:e.vendor&&e.vendor.name?e.vendor.name:e.beneficiary,vendor_data:e.vendor,date:Tn(e.date),created_at:e.date,last_checked:Tn(e.last_checked_in?.approved_at),cost:e.items?Un(e.items.reduce(((e,t)=>e+(t?.quantity||0)*(t.requisition_items?.rate||0)),0)):0,approved_at:e.last_checked_in?.approved_at?new Date(e.last_checked_in.approved_at).toLocaleString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):null}})),Sn.value.sort(((e,t)=>{const a=Number(qn.value),n=e.awaiter_role_id===a,l=t.awaiter_role_id===a;return n&&!l?-1:!n&&l?1:0}))},Ol=(0,i.iH)(!1),Ul=()=>{window.innerWidth<991&&(Ol.value=!0)},Vl=async(e,t)=>{const a={status_id:t};xn.value=!0;try{await u.put(`approval-lists/${e}`,a),Nn("Status Changed"),Qn(),document.getElementById("close-approval-modal").click()}catch(n){On(n.message),console.log(n)}finally{xn.value=!1}},Tl=(0,i.iH)(["Sno","ref_no","issuer","host","amount","direction","target_account","attachment","date"]),El=(0,i.iH)(["Sno","registrar","attachment","date"]),Ll=(0,i.iH)([]),Ml=async e=>{Ll.value=[];try{const t=await u.get(`account-transactions?approval_id=${e}`);Ll.value=t.data.map(((e,t)=>({...e,Sno:t+1,attachment:"https://bushman.ink/api/v1/../../"+e.attachment,amount:Un(e.amount),date:Tn(e.date),ref_no:e.reference_number,issuer:e?.issuer?.name,target_account:(e?.transaction_point?.name??"")+" "+(e?.transaction_point?.mobile_money?.name??"")+" "+(e?.transaction_point?.mobile_money?.category??"CASH")})))}catch(t){On(t.message),console.log(t)}jl(e)},Pl=(0,i.iH)([]),jl=async e=>{Pl.value=[];try{const t=await u.get(`purchase-order-receipts?approval_id=${e}`);Pl.value=t.data.map(((e,t)=>({...e,Sno:t+1,attachment:"https://bushman.ink/api/v1/../../"+e.attachment,date:e.date,registrar:e?.registrar?.name})))}catch(t){On(t.message),console.log(t)}};return(0,n.bv)((()=>{JSON.parse(localStorage.getItem("user")).name;Ul(),pl(),Qn(),Yn.value&&(Wn=()=>{Fn.value=!1,xn.value=!1},Yn.value.addEventListener("hidden.bs.modal",Wn))})),(0,n.Jd)((()=>{Yn.value&&Wn&&Yn.value.removeEventListener("hidden.bs.modal",Wn)})),(e,a)=>{const o=(0,n.up)("router-link"),r=(0,n.up)("v-client-table");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",b,[(0,n._)("ul",h,[(0,n._)("li",null,[(0,n._)("div",y,[(0,n._)("nav",w,[(0,n._)("ol",x,[(0,n._)("li",f,[(0,n._)("a",k,(0,l.zw)(ul.value.group),1)]),q])])])])]),(0,n.Wm)(d.Z,{filterValue:t.value,"onUpdate:filterValue":a[0]||(a[0]=e=>t.value=e)},null,8,["filterValue"]),(0,n._)("div",C,[(0,i.SU)(ra).includes("can_view_requisitions")?((0,n.wg)(),(0,n.j4)(o,{key:0,to:"/requisitions/all",class:"btn btn-primary"},{default:(0,n.w5)((()=>[S,D])),_:1})):(0,n.kq)("",!0),Ol.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("h3",$,(0,l.zw)(Cl.value.toUpperCase())+" "+(0,l.zw)(ul.value?.group?.toLowerCase().includes("labour")?"LABOUR REQUEST":ul.value?.group?.toLowerCase().includes("voucher")?"PAYMENT VOUCHERS":"LOCAL PURCHASE ORDERS"),1)),(0,n.Wm)(o,{to:"/good-received-notes/dashboard",class:"btn btn-secondary"},{default:(0,n.w5)((()=>[R,H])),_:1})]),(0,n._)("div",z,[(0,n._)("div",A,[(0,n.Wm)((0,i.SU)(p()),{modelValue:Bn.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Bn.value=e),options:j.value,placeholder:"Select Status",label:"name",searchable:!0,multiple:!1,required:!0,"allow-empty":!0},null,8,["modelValue","options"])]),(0,n.wy)((0,n._)("input",{type:"date",class:"form-control w-auto","onUpdate:modelValue":a[2]||(a[2]=e=>Cl.value=e)},null,512),[[s.nr,Cl.value]])]),(0,n._)("div",N,[(0,n._)("button",{class:"btn btn-success",onClick:a[3]||(a[3]=e=>zl())},U),(0,n._)("button",{class:"btn btn-dark",onClick:a[4]||(a[4]=e=>(Cl.value="all",Qn()))},"Fetch "+(0,l.zw)(Bn.value?.name??"All")+" Data",1),(0,n._)("button",{class:"btn btn-primary",onClick:a[5]||(a[5]=e=>Qn())}," Refresh ")]),(0,n._)("div",V,[Jn.value?((0,n.wg)(),(0,n.iD)("div",{key:0,innerHTML:(0,i.SU)(Vn)()},null,8,T)):((0,n.wg)(),(0,n.iD)("div",E,[(0,n._)("div",L,[(0,n._)("div",M,[(0,n.Wm)(r,{data:(0,i.SU)(Xn),columns:Cn.value,options:Rn.value},{status:(0,n.w5)((e=>[(0,n._)("span",{class:(0,l.C_)(["badge inv-status","badge-"+e.row.status.color])},(0,l.zw)(e.row.status.name),3)])),requisition:(0,n.w5)((e=>["Labour Request"===e.row.type?((0,n.wg)(),(0,n.j4)(o,{key:0,class:"text-primary",to:`/approval/${e.row.requisition}`,title:"Click to see requisition"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.row.requisition),1)])),_:2},1032,["to"])):((0,n.wg)(),(0,n.j4)(o,{key:1,class:"text-primary",to:`/requisition/${e.row.requisition}`,title:"Click to see requisition"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.row.requisition),1)])),_:2},1032,["to"]))])),actions:(0,n.w5)((e=>[(0,n._)("a",{onClick:t=>ll(e.row),"data-bs-toggle":"modal","data-bs-target":"#approval",href:"javascript:void(0);",class:"text-primary"},I,8,P),(0,i.SU)(ra).includes("can_print_lpo")&&("approved"===e.row?.status?.name||"paid"===e.row?.status?.name||(0,i.SU)(ra).includes("is_programmer"))?((0,n.wg)(),(0,n.iD)("a",{key:0,href:"javascript:void(0);",onClick:t=>cl(e.row,e.row.vendor_data),class:"text-success me-2"},Y,8,B)):(0,n.kq)("",!0),!(0,i.SU)(ra).includes("can_print_lpo")||"approved"!==e.row?.status?.name&&"paid"!==e.row?.status?.name?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("a",{key:1,href:"javascript:void(0);",onClick:t=>rl(e.row,e.row.vendor_data),class:"text-dark"},Q,8,W)),(0,i.SU)(ra).includes("can_delete_lpo")?((0,n.wg)(),(0,n.iD)("a",{key:2,href:"javascript:void(0);",onClick:t=>Al(e.row),class:"text-danger"},Z,8,X)):(0,n.kq)("",!0)])),_:1},8,["data","columns","options"])])])]))])]),(0,n._)("div",{class:"modal fade mymodal",id:"approval",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-backdrop":"false",ref_key:"approvalModal",ref:Yn},[(0,n._)("div",K,[(0,n._)("div",ee,[(0,n._)("div",te,[ae,(0,n._)("button",{type:"button","data-dismiss":"modal","data-bs-dismiss":"modal","aria-label":"Close",class:"btn-close",onClick:a[6]||(a[6]=e=>An()),id:"close-approval-modal"})]),(0,n._)("div",ne,[(0,n._)("div",le,[(0,n._)("div",ie,[(0,n._)("table",se,[(0,n._)("thead",null,[(0,n._)("tr",null,[oe,re,de,ce,ue,tl.value.project?((0,n.wg)(),(0,n.iD)("th",pe,"Project")):(0,n.kq)("",!0),tl.value.vendor?((0,n.wg)(),(0,n.iD)("th",me,[tl.value?.type?.toLowerCase().includes("voucher")?((0,n.wg)(),(0,n.iD)("span",ve," Beneficiary ")):((0,n.wg)(),(0,n.iD)("span",ge," Vendor "))])):(0,n.kq)("",!0),_e,be,(0,i.SU)(ra).includes("can_print_lpo")?((0,n.wg)(),(0,n.iD)("th",he,"Action")):(0,n.kq)("",!0)])]),(0,n._)("tbody",null,[(0,n._)("tr",null,[(0,n._)("td",null,(0,l.zw)(tl.value?.order),1),(0,n._)("td",null,(0,l.zw)(tl.value.requester),1),(0,n._)("td",null,(0,l.zw)(tl.value?.date),1),(0,n._)("td",null,(0,l.zw)(tl.value?.type),1),(0,n._)("td",null,(0,l.zw)(tl.value?.purpose),1),tl.value.project?((0,n.wg)(),(0,n.iD)("td",ye,(0,l.zw)(tl.value.project),1)):(0,n.kq)("",!0),tl.value.vendor?((0,n.wg)(),(0,n.iD)("td",we,(0,l.zw)(tl.value.vendor),1)):(0,n.kq)("",!0),(0,n._)("td",null,(0,l.zw)(tl.value?.awaits),1),(0,n._)("td",null,(0,l.zw)(tl.value?.cost),1),(0,n._)("td",null,[(0,i.SU)(ra).includes("can_print_lpo")&&("approved"===tl.value?.status?.name||"paid"===tl.value?.status?.name||(0,i.SU)(ra).includes("is_programmer"))?((0,n.wg)(),(0,n.iD)("a",{key:0,href:"javascript:void(0);",onClick:a[7]||(a[7]=e=>cl(tl.value,tl.value.vendor_data)),class:"text-success me-2"},fe)):(0,n.kq)("",!0),"Labour Request"===tl.value.purpose&&(0,i.SU)(ra).includes("can_create_labour_voucher")?((0,n.wg)(),(0,n.iD)("button",{key:1,onClick:a[8]||(a[8]=e=>xe()),class:"btn btn-outline-primary"},"Create Voucher")):(0,n.kq)("",!0),"Labour Request"===tl.value.purpose?((0,n.wg)(),(0,n.j4)(o,{key:2,to:`/report/labour-payments/${tl.value.id}`,class:"text-primary"},{default:(0,n.w5)((()=>[ke])),_:1},8,["to"])):(0,n.kq)("",!0)])]),tl.value.description?((0,n.wg)(),(0,n.iD)("tr",qe,[(0,n._)("td",Ce,[Se,(0,n.Uk)(" "+(0,l.zw)(tl.value.description)+" ",1),al.value?((0,n.wg)(),(0,n.iD)("span",De," ( "+(0,l.zw)(al.value)+" )",1)):(0,n.kq)("",!0)])])):(0,n.kq)("",!0),tl.value.remark?((0,n.wg)(),(0,n.iD)("tr",$e,[(0,n._)("td",Re,[He,(0,n.Uk)(" "+(0,l.zw)(tl.value.remark),1)])])):(0,n.kq)("",!0)])])])])]),"approved"===tl.value.status?.name&&(0,i.SU)(ra).includes("can_complete_transaction")?((0,n.wg)(),(0,n.iD)("div",ze,[(0,n._)("button",{class:"btn btn-primary",type:"button",disabled:Jn.value,onClick:a[9]||(a[9]=e=>F.value=!F.value)},[Jn.value?((0,n.wg)(),(0,n.iD)("span",{key:0,innerHTML:(0,i.SU)(En)()},null,8,Ne)):((0,n.wg)(),(0,n.iD)("span",Oe,"Paid"))],8,Ae)])):(0,n.kq)("",!0),F.value?((0,n.wg)(),(0,n.iD)("form",{key:1,onSubmit:a[11]||(a[11]=(0,s.iM)((e=>J(tl.value.id)),["prevent"]))},[(0,n._)("div",Ue,[(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",placeholder:"Enter Any remark ","onUpdate:modelValue":a[10]||(a[10]=e=>il.value=e)},null,512),[[s.nr,il.value]]),(0,n._)("button",{class:"btn btn-primary me-2",type:"submit",disabled:Jn.value},[Jn.value?((0,n.wg)(),(0,n.iD)("span",{key:0,innerHTML:(0,i.SU)(En)()},null,8,Te)):((0,n.wg)(),(0,n.iD)("span",Ee,"Save"))],8,Ve)])],32)):(0,n.kq)("",!0),(0,n._)("div",Le,[(0,n._)("div",Me,[(0,n._)("div",Pe,[(0,i.SU)(ra).includes("is_programmer")&&"paid"===tl.value.status?.name?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-secondary me-2",onClick:a[12]||(a[12]=e=>Vl(tl.value.id,3)),disabled:xn.value}," Mark Approved ",8,je)):(0,n.kq)("",!0),(0,i.SU)(ra).includes("can_complete_transaction")&&"paid"===tl.value.status?.name?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-success",onClick:a[13]||(a[13]=e=>Hn.value=!Hn.value),disabled:xn.value}," Attach Receipt ",8,Ie)):(0,n.kq)("",!0)]),Hn.value?((0,n.wg)(),(0,n.iD)("div",Be,[(0,n._)("input",{class:"form-control w-25",type:"file",onChange:fl,accept:"application/pdf",required:""},null,32),(0,n.wy)((0,n._)("input",{type:"date","onUpdate:modelValue":a[14]||(a[14]=e=>kl.value=e),class:"form-control w-25"},null,512),[[s.nr,kl.value]]),(0,n._)("button",{class:"btn btn-primary",onClick:ql,disabled:xn.value},[xn.value?((0,n.wg)(),(0,n.iD)("span",{key:0,innerHTML:(0,i.SU)(En)()},null,8,Ye)):((0,n.wg)(),(0,n.iD)("span",We,"Submit"))],8,Fe)])):(0,n.kq)("",!0)]),qn.value==Pn.value.role_id&&"no one"!==el.value||(0,i.SU)(ra).includes("is_md")&&"paid"!==tl.value.status?.name||qn.value==tl.value.last_checker_id&&"no one"===el.value?((0,n.wg)(),(0,n.iD)("div",Je,[(0,n._)("div",Qe,[((0,i.SU)(ra).includes("is_md")||(0,i.SU)(ra).includes("is_programmer"))&&"approved"===tl.value.status?.name?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-secondary me-2",onClick:a[15]||(a[15]=e=>Vl(tl.value.id,2)),disabled:xn.value}," Unapprove ",8,Xe)):(0,n.kq)("",!0),(0,n._)("button",{class:"btn btn-primary me-2",onClick:a[16]||(a[16]=e=>O.value=3),disabled:xn.value}," Check ",8,Ge),(0,n._)("button",{class:"btn btn-danger me-2",onClick:a[17]||(a[17]=e=>O.value=4),disabled:xn.value}," Reject ",8,Ze),(0,n._)("button",{class:"btn btn-info me-2",onClick:a[18]||(a[18]=e=>O.value=14),disabled:xn.value}," Remark ",8,Ke),(0,n._)("button",{class:"btn btn-warning",onClick:a[19]||(a[19]=e=>O.value=17),disabled:xn.value}," On Hold ",8,et)])])):(0,n.kq)("",!0),O.value?((0,n.wg)(),(0,n.iD)("div",tt,[(0,n._)("span",{class:(0,l.C_)(["badge rounded-pill",{"bg-danger":4==O.value,"bg-success":3==O.value,"bg-info":14==O.value,"bg-warning":17==O.value}]),style:{"font-size":"1rem"}},(0,l.zw)(3==O.value?"Check / Approve Request":4==O.value?"Reject Request":"Fill Remark"),3)])):(0,n.kq)("",!0),O.value?((0,n.wg)(),(0,n.iD)("div",at,[(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",placeholder:3==O.value?"Enter Approval Remark":4==O.value?"Enter Rejection Remark":"Enter Remark","onUpdate:modelValue":a[20]||(a[20]=e=>il.value=e)},null,8,nt),[[s.nr,il.value]]),(0,n._)("button",{onClick:a[21]||(a[21]=e=>ol()),class:"btn btn-primary me-2",type:"button",disabled:xn.value},[xn.value?((0,n.wg)(),(0,n.iD)("span",{key:0,innerHTML:(0,i.SU)(En)()},null,8,it)):((0,n.wg)(),(0,n.iD)("span",st,"Save"))],8,lt)])):(0,n.kq)("",!0),(0,n._)("div",ot,[(0,n._)("table",rt,[(0,n._)("thead",null,[(0,n._)("tr",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Mn.value,(e=>((0,n.wg)(),(0,n.iD)("th",{key:e.role_id||e.position||e.name},[(0,n.Uk)((0,l.zw)(e.name)+" ",1),dt])))),128))])]),(0,n._)("tbody",null,[(0,n._)("tr",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Mn.value,((e,t)=>((0,n.wg)(),(0,n.iD)("td",{key:e.role_id||e.position||t,class:(0,l.C_)(e?.status?.color?"text-"+e.status.color:"text-danger")},[(0,n._)("span",null,(0,l.zw)(e?.status?.name??"Unchecked"),1),ct,e.approved_at?((0,n.wg)(),(0,n.iD)("span",ut,"Checked At :"+(0,l.zw)((0,i.SU)(Tn)(e.approved_at)),1)):(0,n.kq)("",!0),pt,mt,e.remark?((0,n.wg)(),(0,n.iD)("span",vt,"Remark : "+(0,l.zw)(e.remark),1)):(0,n.kq)("",!0)],2)))),128))])])])]),gt,(0,n._)("div",_t,[G.value?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:0,type:"text",class:"form-control",style:{"max-width":"350px","font-size":"1rem"},placeholder:"Enter Brief Description ","onUpdate:modelValue":a[22]||(a[22]=e=>Jt.value=e)},null,512)),[[s.nr,Jt.value]]):(0,n.kq)("",!0)]),(0,n._)("div",bt,[(0,n._)("div",ht,[(0,n._)("div",yt,[(0,n._)("table",wt,[(0,n._)("thead",null,[(0,n._)("tr",null,[xt,ft,kt,qt,Ct,St,Dt,$t,G.value?((0,n.wg)(),(0,n.iD)("th",Rt,"select")):(0,n.kq)("",!0),Ht])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)($n.value,(e=>((0,n.wg)(),(0,n.iD)("tr",null,[(0,n._)("td",null,(0,l.zw)(e.order_item_id),1),(0,n._)("td",null,(0,l.zw)(e.item),1),(0,n._)("td",null,["budget"!==tl.value.requisition_type||e.requisition_items.asset_id?((0,n.wg)(),(0,n.iD)("span",zt,[e.selected?((0,n.wg)(),(0,n.iD)("span",At,(0,l.zw)(e.description)+" ( "+(0,l.zw)(e.request_description)+" ) ",1)):((0,n.wg)(),(0,n.iD)("span",Nt,(0,l.zw)(e.description),1))])):((0,n.wg)(),(0,n.j4)(o,{key:0,class:"btn btn-outline-primary",to:`/requisition-budget/${e.requisition_items.item_id}`},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.description),1)])),_:2},1032,["to"]))]),(0,n._)("td",{onClick:t=>gl(e.id)},[(0,n.Uk)((0,l.zw)(e.quantity)+" ",1),e?.requested_sum?((0,n.wg)(),(0,n.iD)("span",Ut,[Vt,(0,n.Uk)(" Requested : "+(0,l.zw)(e?.requested_sum)+" ",1),Tt,(0,n.Uk)(" Balance :"+(0,l.zw)((e.quantity-e?.requested_sum).toFixed(2)),1)])):(0,n.kq)("",!0),e.selected?((0,n.wg)(),(0,n.iD)("span",Et,[Lt,(0,n.Uk)("Requesting : "+(0,l.zw)(e.requesting_quantity),1)])):(0,n.kq)("",!0),vl.value==e.id?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:2,type:"number",class:"form-control",placeholder:"Quantity",step:"any","onUpdate:modelValue":t=>e.quantity=t},null,8,Mt)),[[s.nr,e.quantity]]):(0,n.kq)("",!0)],8,Ot),(0,n._)("td",null,(0,l.zw)(e.requisition_items.units),1),(0,n._)("td",{onClick:t=>gl(e.id)},[(0,n.Uk)((0,l.zw)(e.rate)+" ",1),vl.value==e.id?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:0,type:"number",class:"form-control",placeholder:"Quantity",step:"any","onUpdate:modelValue":t=>e.rate_original=t},null,8,jt)),[[s.nr,e.rate_original]]):(0,n.kq)("",!0)],8,Pt),(0,n._)("td",null,[(0,n._)("span",null,[(0,n.Uk)((0,l.zw)((0,i.SU)(Un)(e.quantity*e.rate_original)),1),It]),e.selected?((0,n.wg)(),(0,n.iD)("span",Bt," Requesting : "+(0,l.zw)((0,i.SU)(Un)(e.requesting_quantity*e.rate_original)),1)):(0,n.kq)("",!0)]),(0,n._)("td",null,(0,l.zw)(e.receiver??e.beneficiary),1),G.value?((0,n.wg)(),(0,n.iD)("td",Ft,[e.selected?((0,n.wg)(),(0,n.iD)("svg",{key:0,onClick:t=>e.selected=!e.selected,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-check2-circle",viewBox:"0 0 16 16"},Qt,8,Yt)):((0,n.wg)(),(0,n.iD)("svg",{key:1,onClick:t=>e.selected=!e.selected,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-circle",viewBox:"0 0 16 16"},Zt,8,Xt)),e.selected?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:2,type:"number",placeholder:"enter quantity",class:"form-control w-75",step:"any","onUpdate:modelValue":t=>e.requesting_quantity=t,onInput:t=>e.requesting_quantity=(0,i.SU)(Ln)(e.requesting_quantity,(e.quantity-e?.requested_sum).toFixed(2))},null,40,Kt)),[[s.nr,e.requesting_quantity]]):(0,n.kq)("",!0),e.selected?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:3,type:"text",placeholder:"enter Description",class:"form-control w-75 mt-1","onUpdate:modelValue":t=>e.request_description=t},null,8,ea)),[[s.nr,e.request_description]]):(0,n.kq)("",!0),e.selected?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:4,type:"text",placeholder:"enter Beneficiary",class:"form-control w-75 mt-1","onUpdate:modelValue":t=>e.receiver=t},null,8,ta)),[[s.nr,e.receiver]]):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,n._)("td",null,[e.requisition_items.asset_id?((0,n.wg)(),(0,n.j4)(o,{key:0,to:`/assets/fuel-statement/${e.requisition_items.asset_id}`,class:"me-2"},{default:(0,n.w5)((()=>[aa])),_:2},1032,["to"])):(0,n.kq)("",!0),"budget"===tl.value.requisition_type?((0,n.wg)(),(0,n.j4)(o,{key:1,to:`/requisition-budget/${e.requisition_items.item_id}`},{default:(0,n.w5)((()=>[na])),_:2},1032,["to"])):(0,n.kq)("",!0),"jobcard"===tl.value.requisition_type?((0,n.wg)(),(0,n.j4)(o,{key:2,to:`/jobcard/${tl.value.source_id}/${e.requisition_items.asset_id}`,class:"me-2"},{default:(0,n.w5)((()=>[la])),_:2},1032,["to"])):(0,n.kq)("",!0),nl.value.subcontractor_agreement_id?((0,n.wg)(),(0,n.j4)(o,{key:3,to:`/subcontractor/${nl.value.subcontractor_agreement_id}`},{default:(0,n.w5)((()=>[ia])),_:1},8,["to"])):(0,n.kq)("",!0),e.requisition_items.asset_bincards_total>0?((0,n.wg)(),(0,n.j4)(o,{key:4,to:`/asset/bincards/${e.requisition_items.asset_id}`},{default:(0,n.w5)((()=>[(0,n._)("button",sa,"Fuel Manager ("+(0,l.zw)(e.requisition_items.asset_bincards_total)+")",1)])),_:2},1032,["to"])):(0,n.kq)("",!0),(0,i.SU)(ra).includes("can_print_lpo")&&("approved"===tl.value.status.name||"paid"===tl.value.status.name||(0,i.SU)(ra).includes("is_programmer"))?((0,n.wg)(),(0,n.iD)("button",{key:5,class:"btn btn-outline-success me-2",onClick:t=>dl(e,tl.value)},da,8,oa)):(0,n.kq)("",!0),"approved"===tl.value.status?.name&&(0,i.SU)(ra).includes("can_complete_transaction")?((0,n.wg)(),(0,n.iD)("button",{key:6,class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#payment-proof",onClick:t=>hl(e,tl.value)},"Paid",8,ca)):(0,n.kq)("",!0)])])))),256))])])])])]),tl.value?.items?.[0]?.requisition_items?.requisition_type?.requisition?.attachment?((0,n.wg)(),(0,n.iD)("div",ua,[pa,(0,n._)("a",{href:`https://bushman.ink/${tl.value.items[0].requisition_items.requisition_type.requisition.attachment}`,target:"_blank",style:{display:"block"}},[(0,n._)("iframe",{src:`https://bushman.ink/${tl.value.items[0].requisition_items.requisition_type.requisition.attachment}`,width:"100%",height:"1000",style:{border:"none","pointer-events":"none"}},null,8,va)],8,ma)])):(0,n.kq)("",!0),Ll.value.length>0?((0,n.wg)(),(0,n.iD)("div",ga,[_a,(0,n._)("div",ba,[(0,n._)("div",ha,[(0,n._)("div",ya,[(0,n.Wm)(r,{data:Ll.value,columns:Tl.value,options:Rn.value},{attachment:(0,n.w5)((t=>[(0,n._)("a",{href:t.row.attachment,target:"_blank",class:"badge badge-primary text-white",style:{cursor:"pointer"},onClick:a=>e.fillTransaction(t.row)}," Open Attachment ",8,wa)])),_:1},8,["data","columns","options"])])])])])):(0,n.kq)("",!0),Pl.value.length>0?((0,n.wg)(),(0,n.iD)("div",xa,[fa,(0,n._)("div",ka,[(0,n._)("div",qa,[(0,n._)("div",Ca,[(0,n.Wm)(r,{data:Pl.value,columns:El.value,options:Rn.value},{attachment:(0,n.w5)((t=>[(0,n._)("a",{href:t.row.attachment,target:"_blank",class:"badge badge-primary text-white",style:{cursor:"pointer"},onClick:a=>e.fillTransaction(t.row)}," Open Attachment ",8,Sa)])),_:1},8,["data","columns","options"])])])])])):(0,n.kq)("",!0)]),(0,n._)("div",Da,[(0,n._)("button",{type:"button",class:"btn btn-primary","data-dismiss":"modal","data-bs-dismiss":"modal",onClick:a[23]||(a[23]=e=>An())},"close"),G.value?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-success",onClick:a[24]||(a[24]=e=>Gt()),disabled:Jn.value},[Jn.value?((0,n.wg)(),(0,n.iD)("span",{key:0,innerHTML:(0,i.SU)(En)()},null,8,Ra)):((0,n.wg)(),(0,n.iD)("span",Ha,"Submit"))],8,$a)):(0,n.kq)("",!0)])])])],512),(0,n._)("div",za,[(0,n._)("div",Aa,[(0,n._)("div",Na,[Oa,(0,n._)("div",Ua,[(0,n._)("div",Va,[(0,n._)("table",Ta,[(0,n._)("thead",null,[(0,n._)("tr",null,[Ea,La,Ma,Pa,ja,Ia,tl.value.project?((0,n.wg)(),(0,n.iD)("th",Ba,"Project")):(0,n.kq)("",!0),Fa])]),(0,n._)("tbody",null,[(0,n._)("tr",null,[(0,n._)("td",null,(0,l.zw)(bl.value?.order),1),(0,n._)("td",null,(0,l.zw)(_l.value?.id),1),(0,n._)("td",null,(0,l.zw)(bl.value.requester),1),(0,n._)("td",null,(0,l.zw)(bl.value?.date),1),(0,n._)("td",null,(0,l.zw)(bl.value?.type),1),(0,n._)("td",null,(0,l.zw)(bl.value?.purpose),1),bl.value.project?((0,n.wg)(),(0,n.iD)("td",Ya,(0,l.zw)(bl.value.project),1)):(0,n.kq)("",!0),(0,n._)("td",null,(0,l.zw)((0,i.SU)(Un)(_l.value?.quantity*_l.value.rate_original)),1)]),_l.value.item?((0,n.wg)(),(0,n.iD)("tr",Wa,[(0,n._)("td",Ja," Item : "+(0,l.zw)(_l.value.item),1)])):(0,n.kq)("",!0),_l.value.description?((0,n.wg)(),(0,n.iD)("tr",Qa,[(0,n._)("td",Xa," Description : "+(0,l.zw)(_l.value.description),1)])):(0,n.kq)("",!0),bl.value.remark?((0,n.wg)(),(0,n.iD)("tr",Ga,[(0,n._)("td",Za," Briefing : "+(0,l.zw)(bl.value.remark),1)])):(0,n.kq)("",!0)])])]),(0,n._)("div",Ka,[(0,n._)("div",en,[(0,n._)("div",tn,[(0,n._)("div",an,[(0,n._)("div",nn,[(0,n._)("div",ln,[sn,(0,n.wy)((0,n._)("input",{class:"form-control",type:"text",placeholder:"Enter Reference Number","onUpdate:modelValue":a[25]||(a[25]=e=>$l.value=e)},null,512),[[s.nr,$l.value]])]),(0,n._)("div",on,[rn,(0,n.Wm)((0,i.SU)(p()),{modelValue:wl.value,"onUpdate:modelValue":a[26]||(a[26]=e=>wl.value=e),options:yl.value,placeholder:"Select Account",label:"name",searchable:!0,multple:"false",required:!0,"allow-empty":!1},null,8,["modelValue","options"])]),(0,n._)("div",dn,[cn,(0,n.wy)((0,n._)("input",{class:"form-control",type:"number",step:"any",placeholder:"Enter Amount","onUpdate:modelValue":a[27]||(a[27]=e=>Dl.value=e)},null,512),[[s.nr,Dl.value]])]),(0,n._)("div",un,[pn,(0,n.wy)((0,n._)("input",{class:"form-control",type:"text",placeholder:"Enter Receiver","onUpdate:modelValue":a[28]||(a[28]=e=>Sl.value=e)},null,512),[[s.nr,Sl.value]])]),(0,n._)("div",mn,[vn,(0,n.wy)((0,n._)("input",{class:"form-control",type:"date","onUpdate:modelValue":a[29]||(a[29]=e=>Cl.value=e)},null,512),[[s.nr,Cl.value]])]),(0,n._)("div",gn,[_n,(0,n._)("input",{class:"form-control",type:"file",onChange:fl,accept:"application/pdf"},null,32)]),(0,n._)("div",bn,[hn,(0,n.wy)((0,n._)("input",{class:"form-control",type:"text",placeholder:"Enter Remark","onUpdate:modelValue":a[30]||(a[30]=e=>Jt.value=e)},null,512),[[s.nr,Jt.value]])])])])])])])]),(0,n._)("div",yn,[wn,(0,n._)("button",{type:"button",class:"btn btn-success",onClick:a[31]||(a[31]=e=>Hl())},"Save")])])])])],64)}}};const fn=xn;var kn=fn}}]);
//# sourceMappingURL=1138.37819dfb.js.map