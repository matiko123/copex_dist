"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[4325],{84325:function(e,a,t){t.r(a),t.d(a,{default:function(){return F}});t(26699);var s=t(66252),i=t(2262),l=t(3577),o=t(49963),r=t(87066),n=t(56296),d=t(26212),u=t.n(d);const c={class:"layout-px-spacing"},m=(0,s.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Shortage Statement</span></li></ol></nav></div></li></ul><h3 class="text-center text-uppercase">Goods Received Notes Shortage Statement</h3>',2),p=["innerHTML"],v={key:1,class:"row layout-top-spacing"},b={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},_={class:"panel p-0"},g={class:"custom-table table3"},h=["onClick"],f=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"text-primary"},[(0,s._)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,s._)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),y=[f],w={class:"modal fade mymodal",id:"edit-statement-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"editStatementModalLabel","aria-hidden":"true"},k={class:"modal-dialog modal-xl"},S={class:"modal-content"},q={class:"modal-header"},x=(0,s._)("h1",{class:"modal-title fs-5",id:"editStatementModalLabel"},"Edit Shortage Statement",-1),H={class:"modal-body"},C={class:"row mb-3"},M={class:"col-md-6"},E=(0,s._)("label",{for:"status"},"Status",-1),N={class:"col-md-6"},U=(0,s._)("label",{for:"quantity"},"Quantity",-1),D={class:"col-md-12"},L=(0,s._)("label",{for:"briefing"},"briefing",-1),V={class:"modal-footer"},j={type:"submit",class:"btn btn-primary"},I={key:0,class:"spinner-border spinner-border-sm text-white me-2",role:"status"},R=(0,s.Uk)(" Edit ");var z={setup(e){(0,n.j)({title:"Good Issue Note"});const a=r.Z.create({baseURL:"https://bushman.ink/api/v1/"}),t=JSON.parse(localStorage.getItem("user")).permissions,d=(0,s.f3)("formatDate"),f=(0,s.f3)("formatNumber"),z=(0,s.f3)("tableShimmer"),B=(0,i.iH)(""),F=(0,i.iH)(""),G=(0,i.iH)(null),P=(0,i.iH)(!1),Q=(0,i.iH)(["SNo","item","description","units","receiver","date","approved","received","shortage","briefing","remark","cost","id","status","actions"]),T=(0,i.iH)([]),W=((0,i.iH)([]),(0,i.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["SNo","name","short_name","status"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1})),J=((0,i.iH)(!1),(0,i.iH)("")),O=()=>{P.value=!0,a.get("/grn-items").then((e=>{T.value=e.data.map(((e,a)=>({...e,SNo:a+1,id:e.id,receiver:e?.receiver?.name,grn:e.grn_id,remark:e.remark,date:d(e.created_at),item:e.approval_item.requisition_item.remark,description:e.approval_item.requisition_item.description,units:e.approval_item.requisition_item.units,rate:e.approval_item.requisition_item.rate,received:e.quantity,approved:e.approval_item.quantity,shortage:(e.approval_item.quantity-e.quantity).toFixed(2),briefing:e.description,cost:f(e.approval_item.requisition_item.rate*(e.approval_item.quantity-e.quantity)),rate:e.approval_item.requisition_item.rate}))),P.value=!1})).catch((e=>{ee(e.message||"Failed to fetch units"),P.value=!1}))},Z=(0,i.iH)([]),$=async()=>{const e=await a.get("statuses");Z.value=e.data},A=e=>{J.value=e,B.value=e.briefing||"",F.value=e.quantity||0,G.value=Z.value.find((a=>a.id===e.status_id))||null},K=async()=>{P.value=!0;const e=J.value,t={description:B.value,status_id:G.value.id,quantity:F.value};try{await a.put(`grn-items/${e.id}`,t);Y("Statement updated successfully"),document.getElementById("close_editing").click(),O()}catch(s){console.error("Error updating GRN item:",s),ee(s.response?.data?.message||"Failed to update statement")}finally{P.value=!1}},X=()=>{B.value="",F.value="",G.value=null},Y=(0,s.f3)("showMessage"),ee=(0,s.f3)("showError");return(0,s.bv)((()=>{O(),$()})),(e,a)=>{const r=(0,s.up)("v-client-table");return(0,s.wg)(),(0,s.iD)("div",c,[m,P.value?((0,s.wg)(),(0,s.iD)("div",{key:0,innerHTML:(0,i.SU)(z)()},null,8,p)):((0,s.wg)(),(0,s.iD)("div",v,[(0,s._)("div",b,[(0,s._)("div",_,[(0,s._)("div",g,[(0,s.Wm)(r,{data:T.value,columns:Q.value,options:W.value},{status:(0,s.w5)((e=>[(0,s._)("span",{class:(0,l.C_)(["badge inv-status","badge-"+e.row.status.color])},(0,l.zw)(e.row.status.name),3)])),actions:(0,s.w5)((e=>[(0,i.SU)(t).includes("can_edit_shortage_statement")?((0,s.wg)(),(0,s.iD)("a",{key:0,href:"javascript:;",class:"edit me-3",onClick:a=>A(e.row),"data-bs-toggle":"modal","data-bs-target":"#edit-statement-modal"},y,8,h)):(0,s.kq)("",!0)])),_:1},8,["data","columns","options"])])])])])),(0,s._)("div",w,[(0,s._)("div",k,[(0,s._)("div",S,[(0,s._)("div",q,[x,(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:a[0]||(a[0]=e=>X())})]),(0,s._)("form",{onSubmit:a[5]||(a[5]=(0,o.iM)((e=>K()),["prevent"]))},[(0,s._)("div",H,[(0,s._)("div",C,[(0,s._)("div",M,[E,(0,s.Wm)((0,i.SU)(u()),{modelValue:G.value,"onUpdate:modelValue":a[1]||(a[1]=e=>G.value=e),options:Z.value,label:"name",placeholder:"Select Status",searchable:!0,"allow-empty":!1},null,8,["modelValue","options"])]),(0,s._)("div",N,[U,(0,s.wy)((0,s._)("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>F.value=e),class:"form-control",placeholder:"Enter Quantity",step:"0.01"},null,512),[[o.nr,F.value]])]),(0,s._)("div",D,[L,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>B.value=e),class:"form-control",placeholder:"Enter Briefing"},null,512),[[o.nr,B.value]])])])]),(0,s._)("div",V,[(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:a[4]||(a[4]=e=>X()),id:"close_editing"},"Close"),(0,s._)("button",j,[P.value?((0,s.wg)(),(0,s.iD)("span",I)):(0,s.kq)("",!0),R])])],32)])])])])}}};const B=z;var F=B}}]);
//# sourceMappingURL=4325.920a76da.js.map