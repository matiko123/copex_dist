"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[1866],{41866:function(e,a,l){l.r(a),l.d(a,{default:function(){return Se}});l(26699);var t=l(66252),s=l(3577),n=l(2262),i=l(49963),r=l(87066),o=l(56296),d=l(26212),c=l.n(d),u=l(42119);const v={class:"layout-px-spacing"},_=(0,t.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Assets</a></li><li class="breadcrumb-item active" aria-current="page"><span>Fuel Cards </span></li></ol></nav></div></li></ul>',1),p={key:0,class:"text-center"},m={class:"d-flex me-4 mt-2"},b={class:"ms-auto"},g=["disabled"],h=["innerHTML"],w=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-clockwise",viewBox:"0 0 16 16"},[(0,t._)("path",{"fill-rule":"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),(0,t._)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})],-1),y=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,t._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),f=[y],k=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,t._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),H=[k],x=(0,t._)("h4",{class:"text-center"},"REGISTER NEW RECORD",-1),E={class:"row mb-2"},C={class:"col-md-2"},R=(0,t._)("label",{class:"form-label"},"Date",-1),z={class:"col-md-2"},S=(0,t._)("label",{class:"form-label"},"Operation",-1),U={class:"col-md-2"},M={class:"form-label"},q={class:"col-md-2"},V=(0,t._)("label",{class:"form-label"}," Rate (Tsh)",-1),T={class:"col-md-2"},D=(0,t._)("label",{class:"form-label"},"Initial Odometer Reading",-1),I={class:"col-md-2"},L=(0,t._)("label",{class:"form-label"},"Expected Ratio",-1),A={class:"col-md-3"},N=(0,t._)("label",{class:"form-label"},"Work Target ",-1),W={class:"col-md-3"},F=(0,t._)("label",{class:"form-label"},"Work Unit",-1),O={class:"col-md-6"},B=(0,t._)("label",{class:"form-label"},"Task",-1),j={class:"col-md-12"},J=(0,t._)("label",{class:"form-label"},"Enter Remark",-1),P={class:"text-center gap-2 justify-content-end"},G=["disabled"],K={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Y={key:1},$=["innerHTML"],Q={key:3,class:"row layout-top-spacing"},Z={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},X={class:"panel p-0"},ee={class:"custom-table table3"},ae={class:"table-responsive"},le={class:"table table-striped table-hover align-middle"},te=(0,t._)("thead",{class:"table-dark"},[(0,t._)("tr",null,[(0,t._)("th",null,"Sno"),(0,t._)("th",null,"Date"),(0,t._)("th",null,"Action"),(0,t._)("th",null,"Quantity"),(0,t._)("th",null,"Task"),(0,t._)("th",null,"Initial Reading"),(0,t._)("th",null,"Final Reading"),(0,t._)("th",null,"Expected Ratio"),(0,t._)("th",null,"Work Target"),(0,t._)("th",null,"Work Covered"),(0,t._)("th",null,"Balance"),(0,t._)("th",null,"Cost"),(0,t._)("th",{class:"text-center"},"Actions")])],-1),se={class:"text-center"},ne=["onClick"],ie=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"text-success"},[(0,t._)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t._)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),re=[ie],oe={key:0},de=(0,t._)("td",{colspan:"1"},null,-1),ce={colspan:"11",class:"bg-white text-danger"},ue=(0,t._)("strong",null,"Remark:",-1),ve=(0,t.Uk)(),_e={class:"modal fade mymodal",id:"bincardTransactions-edit-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"bincardTransactionsEditModalLabel","aria-hidden":"true"},pe={class:"modal-dialog modal-md"},me={class:"modal-content"},be=(0,t._)("div",{class:"modal-header"},[(0,t._)("h1",{class:"modal-title fs-5",id:"bincardTransactionsEditModalLabel"},"Update Work Covered"),(0,t._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close_editing"})],-1),ge={class:"modal-body"},he={class:"row mb-3"},we={class:"col-md-6"},ye=(0,t._)("label",{class:"form-label"},"Final Reading",-1),fe={class:"col-md-6"},ke=(0,t._)("label",{class:"form-label"},"Work Covered (KM)",-1),He={class:"modal-footer"},xe=["disabled"],Ee={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Ce={key:1};var Re={setup(e){(0,o.j)({title:"Asset Fuel Manager"});const a=(0,u.yj)(),l=(0,t.f3)("showMessage"),d=(0,t.f3)("showError"),y=JSON.parse(localStorage.getItem("user")).permissions,k=(0,t.f3)("tableShimmer");JSON.parse(localStorage.getItem("user"));const ie=(0,t.f3)("loadingSpinner"),Re=(0,t.f3)("formatNumber"),ze=(0,n.iH)(!1),Se=(0,t.f3)("printBinCard"),Ue=((0,n.iH)(["Sno","date","action","quantity","task","initial_reading","final_reading","expected_ratio","work_target","work_covered","balance","cost","actions"]),(0,n.iH)([])),Me=((0,n.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","date","fuel_required","distance_cover","expected_ratio","expected_trips","trips_covered","fuel_balance"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),r.Z.create({baseURL:"https://bushman.ink/api/v1/"})),qe=(0,n.iH)(""),Ve=async()=>{Le.value=!0;try{const e=await Me.get(`asset-bincards?asset_id=${a.params.asset_id}`);qe.value=e.data,Ue.value=e.data.transactions.map(((a,l)=>({Sno:l+1,...a,quantity:a.quantity+" Ltr",balance:a.balance+" Ltr",cost:Re(a.quantity*a.rate),expected_ratio:a.ratio+" "+e.data.asset.consuption_type,reading_difference:a.final_reading-a.initial_reading>=0?a.final_reading-a.initial_reading+" "+e.data.asset.consuption_type:"---"})))}catch(e){d(e.message)}finally{Le.value=!1}},Te=(0,n.iH)([]),De=(0,n.iH)(""),Ie=async()=>{Le.value=!0;const e=await Me.get("units");Te.value=e.data},Le=(0,n.iH)(!1),Ae=(0,n.iH)(""),Ne=(0,n.iH)(""),We=(0,n.iH)(""),Fe=(0,n.iH)(""),Oe=(0,n.iH)(""),Be=(0,n.iH)(""),je=(0,n.iH)(""),Je=(0,n.iH)(""),Pe=async()=>{Le.value=!0;const e={asset_bincard_id:qe.value.id,registrar_id:JSON.parse(localStorage.getItem("user")).id,direction:Xe.value.id,unit:De.value.short_name,action:""+("INCREMENT"===Xe.value.id?"Received":"Issued"),description:Ae.value,task:Je.value,quantity:je.value,date:Oe.value,ratio:We.value,rate:Fe.value,work_target:Be.value,initial_reading:Ne.value};try{await Me.post("asset-bincard-transactions",e);Ve(),l("Record registered successfully!"),Ge()}catch(a){console.log(a),d(a.message)}finally{Le.value=!1}},Ge=()=>{ze.value=!1,Xe.value="",Je.value="",je.value="",Oe.value="",We.value="",Be.value="",Ae.value="",Ne.value=""},Ke=(0,n.iH)(null),Ye=(0,n.iH)(""),$e=e=>{Qe.value=e.work_covered,Ke.value=e.id,null===e.final_reading?Ye.value=e.initial_reading:Ye.value=e.final_reading,console.log(e.final_reading)},Qe=(0,n.iH)(""),Ze=async()=>{Le.value=!0;const e={work_covered:Qe.value,final_reading:Ye.value};try{await Me.put(`asset-bincard-transactions/${Ke.value}`,e);Ve(),l("Record updated successfully!"),document.getElementById("close_editing").click()}catch(a){console.log(a),d(a.message)}finally{Le.value=!1}},Xe=(0,n.iH)(""),ea=(0,n.iH)([{id:"INCREMENT",name:"Received"},{id:"DECREMENT",name:"Issuing"}]);(0,n.iH)(!1);return(0,t.bv)((()=>{Ve(),Ie()})),(e,l)=>((0,t.wg)(),(0,t.iD)("div",v,[_,qe.value?((0,t.wg)(),(0,t.iD)("h5",p,"FUEL MANAGEMENT FILE FOR "+(0,s.zw)(qe.value.asset.name)+" "+(0,s.zw)(qe.value.asset.type_name),1)):(0,t.kq)("",!0),(0,t._)("div",m,[(0,t._)("div",b,[(0,t._)("button",{class:(0,s.C_)(["btn btn-primary refresh-btn rounded-circle p-2 me-2",{"spin-animation":Le.value}]),onClick:l[0]||(l[0]=e=>Ve()),title:"Refresh page",disabled:Le.value,style:{width:"2.5rem",height:"2.5rem"}},[Le.value?((0,t.wg)(),(0,t.iD)("span",{key:0,innerHTML:(0,n.SU)(ie)()},null,8,h)):(0,t.kq)("",!0),w],10,g),(0,n.SU)(y).includes("can_register_asset_bincard")?((0,t.wg)(),(0,t.iD)("button",{key:0,class:"btn btn-primary me-2",onClick:l[1]||(l[1]=e=>ze.value=!ze.value)},f)):(0,t.kq)("",!0),(0,n.SU)(y).includes("can_print_asset_bincard")?((0,t.wg)(),(0,t.iD)("button",{key:1,class:"btn btn-success",onClick:l[2]||(l[2]=e=>(0,n.SU)(Se)((0,n.SU)(a).params.asset_id))},H)):(0,t.kq)("",!0)])]),ze.value?((0,t.wg)(),(0,t.iD)("form",{key:1,class:"mt-3 p-3 border rounded bg-white shadow",onSubmit:l[14]||(l[14]=(0,i.iM)((e=>Pe()),["prevent"]))},[x,(0,t._)("div",E,[(0,t._)("div",C,[R,(0,t.wy)((0,t._)("input",{type:"date",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=e=>Oe.value=e),required:""},null,512),[[i.nr,Oe.value]])]),(0,t._)("div",z,[S,(0,t.Wm)((0,n.SU)(c()),{modelValue:Xe.value,"onUpdate:modelValue":l[4]||(l[4]=e=>Xe.value=e),options:ea.value,label:"name",placeholder:"Select An Operation",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])]),(0,t._)("div",U,[(0,t._)("label",M,(0,s.zw)(Xe.value.name)+" Amount (LTs)",1),(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Amount","onUpdate:modelValue":l[5]||(l[5]=e=>je.value=e),required:"",step:"any"},null,512),[[i.nr,je.value]])]),(0,t._)("div",q,[V,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Rate","onUpdate:modelValue":l[6]||(l[6]=e=>Fe.value=e),required:"",step:"any"},null,512),[[i.nr,Fe.value]])]),(0,t._)("div",T,[D,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Initial Reading","onUpdate:modelValue":l[7]||(l[7]=e=>Ne.value=e),required:"",step:"any"},null,512),[[i.nr,Ne.value]])]),(0,t._)("div",I,[L,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Expected Ratio","onUpdate:modelValue":l[8]||(l[8]=e=>We.value=e),required:"",step:"any"},null,512),[[i.nr,We.value]])]),(0,t._)("div",A,[N,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Work Target","onUpdate:modelValue":l[9]||(l[9]=e=>Be.value=e),required:""},null,512),[[i.nr,Be.value]])]),(0,t._)("div",W,[F,(0,t.Wm)((0,n.SU)(c()),{modelValue:De.value,"onUpdate:modelValue":l[10]||(l[10]=e=>De.value=e),options:Te.value,label:"short_name",placeholder:"Select Unit",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])]),(0,t._)("div",O,[B,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Enter Task","onUpdate:modelValue":l[11]||(l[11]=e=>Je.value=e),step:"any",required:""},null,512),[[i.nr,Je.value]])]),(0,t._)("div",j,[J,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Enter Any Remark Concerning work or ratio variation","onUpdate:modelValue":l[12]||(l[12]=e=>Ae.value=e)},null,512),[[i.nr,Ae.value]])])]),(0,t._)("div",P,[(0,t._)("button",{type:"button",class:"btn btn-danger me-3",onClick:l[13]||(l[13]=e=>{ze.value=!1,Ge()})},"Cancel"),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:Le.value},[Le.value?((0,t.wg)(),(0,t.iD)("span",K)):((0,t.wg)(),(0,t.iD)("span",Y,"Register"))],8,G)])],32)):(0,t.kq)("",!0),Le.value?((0,t.wg)(),(0,t.iD)("div",{key:2,innerHTML:(0,n.SU)(k)()},null,8,$)):((0,t.wg)(),(0,t.iD)("div",Q,[(0,t._)("div",Z,[(0,t._)("div",X,[(0,t._)("div",ee,[(0,t._)("div",ae,[(0,t._)("table",le,[te,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Ue.value,((e,a)=>((0,t.wg)(),(0,t.iD)(t.HY,{key:e.id},[(0,t._)("tr",null,[(0,t._)("td",null,(0,s.zw)(a+1),1),(0,t._)("td",null,(0,s.zw)(e.date),1),(0,t._)("td",null,(0,s.zw)(e.action),1),(0,t._)("td",null,(0,s.zw)(e.quantity),1),(0,t._)("td",null,(0,s.zw)(e.task),1),(0,t._)("td",null,(0,s.zw)(e.initial_reading),1),(0,t._)("td",null,(0,s.zw)(e.final_reading),1),(0,t._)("td",null,(0,s.zw)(e.expected_ratio),1),(0,t._)("td",null,(0,s.zw)(e.work_target)+" "+(0,s.zw)(e.unit),1),(0,t._)("td",null,(0,s.zw)(e.work_covered??0)+" "+(0,s.zw)(e.unit),1),(0,t._)("td",null,(0,s.zw)(e.balance),1),(0,t._)("td",null,(0,s.zw)(e.cost),1),(0,t._)("td",se,[(0,t._)("a",{href:"javascript:;",class:"edit me-2",onClick:a=>$e(e),"data-bs-toggle":"modal","data-bs-target":"#bincardTransactions-edit-modal"},re,8,ne)])]),e.description?((0,t.wg)(),(0,t.iD)("tr",oe,[de,(0,t._)("td",ce,[ue,ve,(0,t._)("i",null,(0,s.zw)(e.description),1)])])):(0,t.kq)("",!0)],64)))),128))])])])])])])])),(0,t._)("div",_e,[(0,t._)("div",pe,[(0,t._)("div",me,[be,(0,t._)("form",{onSubmit:l[18]||(l[18]=(0,i.iM)((e=>Ze()),["prevent"]))},[(0,t._)("div",ge,[(0,t._)("div",he,[(0,t._)("div",we,[ye,(0,t.wy)((0,t._)("input",{type:"text",placeholder:"Enter FInal Reading",class:"form-control","onUpdate:modelValue":l[15]||(l[15]=e=>Ye.value=e),required:""},null,512),[[i.nr,Ye.value]])]),(0,t._)("div",fe,[ke,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Work Covered","onUpdate:modelValue":l[16]||(l[16]=e=>Qe.value=e),step:"any",required:""},null,512),[[i.nr,Qe.value]])])])]),(0,t._)("div",He,[(0,t._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:l[17]||(l[17]=e=>Ge()),id:"close_editing"},"Close"),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:Le.value},[Le.value?((0,t.wg)(),(0,t.iD)("span",Ee)):((0,t.wg)(),(0,t.iD)("span",Ce,"Update"))],8,xe)])],32)])])])]))}};const ze=Re;var Se=ze}}]);
//# sourceMappingURL=1866.27a7257e.js.map