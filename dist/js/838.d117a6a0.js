"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[838],{40838:function(t,n,e){e.r(n),e.d(n,{default:function(){return K}});e(26699);var a=e(66252),i=e(2262),s=e(3577),r=e(87066),o=e(56296),l=(e(26212),e(42119));const d={class:"layout-px-spacing"},c=(0,a.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Subcontractors</span></li></ol></nav></div></li></ul>',1),p={class:"border p-3 my-4",style:{"border-width":"2px","border-style":"solid","border-color":"#d3d3d3","font-size":"1.1rem"}},g={class:"card-header d-flex justify-content-between align-items-center"},m=(0,a._)("h4",{class:"mb-0 text-center w-100"},"Subcontractor Agreement Details",-1),u=["href"],v={class:"card-body"},b={class:"row"},h={class:"col-md-4 text-start"},y={class:"mb-3"},x=(0,a._)("strong",null,"Project:",-1),f={class:"mb-3"},$=(0,a._)("strong",null,"Quantity:",-1),_={class:"mb-3"},w=(0,a._)("strong",null,"Archived Quantity:",-1),S={class:"mb-3"},T=(0,a._)("strong",null,"Payment Term:",-1),C={class:"col-md-4 text-start"},O={class:"mb-3"},D=(0,a._)("strong",null,"Sub Contracted To:",-1),N={class:"mb-3"},A=(0,a._)("strong",null,"Rate:",-1),k={class:"mb-3"},R=(0,a._)("strong",null,"Archived Amount:",-1),z={class:"mb-3"},P=(0,a._)("strong",null,"Payment Details:",-1),M={class:"col-md-4 text-start"},j={class:"mb-3"},U=(0,a._)("strong",null,"Item Description:",-1),E={class:"mb-3"},q=(0,a._)("strong",null,"Total Cost:",-1),F={class:"mb-3"},I=(0,a._)("strong",null,"Pending Amount:",-1),H={class:"row layout-top-spacing"},Y={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},B=(0,a._)("h4",{class:"mb-3"},"Payments",-1),L={class:"panel p-0"},V={class:"custom-table table3"},X={class:"d-flex justify-content-center align-items-center"},W=["onClick"],Q=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,a._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,a._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),Z=[Q];var G={setup(t){(0,o.j)({title:"Subcontractors Agreements"});const n=(0,l.yj)(),e=r.Z.create({baseURL:"https://bushman.ink/api/v1/"}),Q=((0,a.f3)("tableShimmer"),(0,a.f3)("formatNumber")),G=(0,a.f3)("formatDate");(0,i.iH)({}),(0,i.iH)(""),(0,i.iH)(""),(0,i.iH)("");const J=(0,i.iH)(!1),K=((0,i.iH)([]),(0,i.iH)(!1),(0,i.iH)(["sno","invoice_ref","description","amount","payment","balance","date","actions"])),tt=(0,i.iH)({perPage:10,perPageValues:[10,20,50],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["SNo","name","short_name","status"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),nt=(0,i.iH)({}),et=async()=>{J.value=!0;try{const t=await e.get(`/subcontractor-agreements/${n.params.agreement_id}`),a=t.data,i=parseFloat(a.quantity)*parseFloat(a.rate);let s=0;const r=(a.payments||[]).map(((t,n)=>{s+=t.quantity;const e=i-s,r=Number(t.quantity)/Number(a.rate);return{...t,sno:n+1,invoice_ref:"00"+t.id,payment:Q(t.quantity),date:new Date(t.created_at).toLocaleDateString(),balance:Q(0===e?t.quantity:e),description:t.description||" ",amount:r.toFixed(2)||" "}})),o=(a.payments||[]).reduce(((t,n)=>t+n.quantity),0),l=i-o,d=i-l,c=0===d?l:d,p=(a.payments||[]).reduce(((t,n)=>{const e=Number(n.quantity)/Number(a.rate);return t+e}),0),g=parseFloat(a.quantity)-p;nt.value={...a,date:G(a.created_at),project:a.project?.short_name,attachment:"https://copex.trustdigital.space/"+a.attachment,payment_term:a?.payment_term?.name,rate:Q(a.rate),cost:Q(i),payable:Q(l),balance:Q(c),payments:r,archived_quantity:p.toFixed(2),pending_archived:Q(g*parseFloat(a.rate)),address:a.address,tin_no:a.tin_no}}catch(t){console.log(t),it(t.message)}finally{J.value=!1}},at=JSON.parse(localStorage.getItem("user")).permissions,it=((0,a.f3)("showMessage"),(0,a.f3)("showError")),st=async(t,n)=>{try{const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const a=new Date,i=String(a.getDate()).padStart(2,"0"),s=String(a.getMonth()+1).padStart(2,"0"),r=a.getFullYear(),o=`${i}/${s}`,l=`${i}/${s}/${r}`,d=`${i}.${s}.${r}`,c=`${l}, ${a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,p=n?n.id:t.id,g=`${p}/${r}`,m=`${String(p).padStart(3,"0")}/${o}`,u=n?Q(n.quantity):t.payments&&t.payments.length>0?Q(t.payments.reduce(((t,n)=>t+Number(n.quantity)),0)):t.payable,v=t.payments.reduce(((t,n)=>t+Number(n.quantity)),0),b=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Subcontractor Agreement Details</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\n  .logo { width: 160px; height: auto; }\n  .agreement-box { border: 1px solid #000; padding: 5px 10px; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\n  .title { text-align: center; font-weight: bold; margin: 20px 0 10px 0; }\n  .details-list { margin-top: 15px; line-height: 1.6; }\n  .details-list div { margin-bottom: 4px; }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n  table.items th, table.items td { border: 1px solid #000; padding: 6px; font-weight: normal; }\n  table.items thead tr th { background-color: #f8f8f8; border: 1px solid #000; }\n  .text-right { text-align: right; }\n   .text-end { text-align: end; }\n  .text-center { text-align: center; }\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\n</style>\n</head>\n<body>\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="agreement-box">\n    Agreement ID:<br>\n    <span style="color:red;">${m}</span>\n  </div>\n</div>\n\n<div class="reg-info">\n  TIN: 103-826-519<br>\n  VRN: 20-01-017530R\n</div>\n\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\n</div>\n\n<div class="section-title">SUBCONTRACTOR AGREEMENT DETAILS</div>\n<div class="title"> ${t.project.toUpperCase()} - ${t.item.toUpperCase()}</div>\n\n<div style="display: flex; justify-content: space-between; align-items: center;">\n  <div class = 'text-start'><strong>NOTICE NO. 00${g}</strong></div>\n  <div class = 'text-end'><strong>Date: ${d}</strong></div>\n</div>\n\n<div class="text-center"> <strong> REF: SUBCONTRACTING NOTICE No. ${p}</strong></div>\n\n<div class = 'text-start'><P> Refer the subject matter above </p> </div>\n\n<div class = 'text-start'><P> This form as internal notice on subcontracting piece work on <strong>${t.item.toUpperCase()}</strong> </p> </div>\n\n<div class="details-list">\n  <div><strong>Subcontracted :${t.subcontracted_to}</strong> </div><br>\n  <div>Item Description:</strong> ${t.item}</div><br>\n  <div><strong>Contracted Quantity: ${t.quantity} ${t.unit}</strong></div><br>\n    <div><strong>Archived Qty To Date: ${t.archived_quantity} ${t.unit}</div><br> \n  <div>This payment certificate : ${t.payment_term}</div><br>\n  <div>Subcontracted To : ${t.subcontracted_to}</div><br>\n  <div><strong>Payment Details :</strong> ${t.payment_number}</div><br>\n  <div>Subcontracting Unit Price is:<strong> TZS ${t.rate} per ${t.unit}</strong></div><br>\n  <div><strong>Total Amount of Contract : TZS ${t.cost}</strong></div><br>\n  <div><strong>Pending Contract Amount :</strong> ${t.balance}</div><br>\n  <div><strong>Total Amount Archived :</strong> TZS ${Q(v)}</div><br>\n  <div> This Certificate Payable Amount:<strong> TZS ${u}</strong></div>\n</div>\n\n${t.payments&&t.payments.length>0?`\n<div class="section-title">PAYMENT HISTORY</div>\n<table class="items">\n  <thead>\n    <tr>\n      <th style="width: 30px;"><strong>Sno.</strong></th>\n      <th><strong>Date</strong></th>\n      <th><strong>Description</strong></th>\n      <th><strong>Amount</strong></th>\n    </tr>\n  </thead>\n  <tbody>\n    ${t.payments.map(((t,n)=>{const e=new Date(t.created_at),a=`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`;return`\n    <tr>\n      <td class="text-center">${n+1}</td>\n      <td class="text-center">${a}</td>\n      <td class="text-start">${t.description||" "}</td>\n      <td class="text-end">${t.amount}</td>\n    </tr>\n    `})).join("")}\n  </tbody>\n</table>\n`:""}\n\n<div style="margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;">\n  <p>© ${(new Date).getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 135-489-247 | VRN: 40-032826C</p>\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\n</div>\n\n<div style="margin-top: 10px; font-size: 11px; text-align: left;">\n  ${c}\n</div>\n\n</body>\n</html>\n`,h=e.contentWindow.document;h.open(),h.write(b),h.close(),e.onload=()=>{e.contentWindow.focus(),e.contentWindow.print(),setTimeout((()=>{document.body.removeChild(e)}),1e3)}}catch(e){it(`Failed to print agreement details: ${e.message}`)}},rt=async t=>{try{const n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);const e=`${t.id}`,a=new Date,i=String(a.getDate()).padStart(2,"0"),s=String(a.getMonth()+1).padStart(2,"0"),r=a.getFullYear(),o=`${i}/${s}/${r}`,l=`${o}, ${a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,d=t.payments.reduce(((t,n)=>t+Number(n.quantity)),0),c=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Subcontractor Statement</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\n  .logo { width: 160px; height: auto; }\n  .agreement-box { border: 1px solid #000; padding: 4px 8px; font-size: 11px; text-align: center; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\n  .section-title { display: flex; justify-content: space-between; align-items: flex-start; my-3; }\n  .title { text-align: center; font-weight: bold; margin: 20px 0 10px 0; }\n  .details-list { margin-top: 15px; line-height: 1.6; }\n  .details-list div { margin-bottom: 4px; }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n  table.items th, table.items td { border: 1px solid #000; padding: 6px; font-weight: normal; }\n  table.items thead tr th { background-color: #f8f8f8; border: 1px solid #000; }\n  .text-right { text-align: right; }\n  .text-end { text-align: end; }\n  .text-center { text-align: center; }\n  .text-start { text-align: start; }\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\n</style>\n</head>\n<body>\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="agreement-box">\n    NOTICE NO. <br>\n    <span style="color:red;">00${e}</span>\n  </div>\n</div>\n\n<div class="reg-info">\n  TIN: 103-826-519<br>\n  VRN: 20-01-017530R\n</div>\n\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\n</div>\n\n<div class="title"> SUBCONTRACTOR STATEMENT FOR ${t.project.toUpperCase()} - ${t.item.toUpperCase()}</div>\n\n<div style="display: flex; justify-content: center; align-items: center;">\n  <div class='text-center'><strong>Subcontracted To: ${t.subcontracted_to}</strong></div>\n</div>\n\n<table class="items" style="margin-top: 20px;">\n  <thead>\n                      <tr>\n                        <td><strong>Archived Quantity:</strong></td>\n                        <td><strong>Rate:</strong></td>\n                        <td><strong>Amount Archived:</strong></td>\n                        <td><strong>Pending Amount:</strong></td>\n                        <td><strong>Payment Details:</strong></td>\n                      </tr>\n                  </thead>\n  <tbody>\n    <tr>\n      <td>${t.archived_quantity} ${t.unit}</td>\n      <td>${t.rate}</td>\n      <td>${Q(d)}</td>\n      <td>${t.pending_archived}</td>\n      <td>${t.payment_number}</td>\n    </tr>\n  </tbody>\n</table>\n\n${t.payments&&t.payments.length>0?`\n<h3 class="section-title"> payments </h3>\n<table class="items">\n  <thead>\n    <tr>\n      <th style="width: 30px;"><strong>Sno.</strong></th>\n      <th><strong>Invoice Ref</strong></th>\n      <th><strong>Date</strong></th>\n      <th><strong>Description</strong></th>\n      <th><strong>Quantity</strong></th>\n      <th><strong>Amount</strong></th>\n      <th><strong>Balance</strong></th>\n    </tr>\n  </thead>\n  <tbody>\n    ${t.payments.map(((t,n)=>{const e=new Date(t.created_at),a=`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`;return`\n    <tr>\n      <td class="text-center">${n+1}</td>\n      <td class="text-center">${t.invoice_ref}</td>\n      <td class="text-center">${a}</td>\n      <td class="text-start">${t.description||" "}</td>\n      <td class="text-end">${t.amount}</td>\n      <td class="text-end">${t.payment}</td>\n      <td class="text-end">${t.balance}</td>\n    </tr>\n    `})).join("")}\n  </tbody>\n</table>\n`:""}\n\n<div style="margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;">\n  <p>© ${(new Date).getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 103-826-519 | VRN: 20-01-017530R</p>\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\n</div>\n\n<div style="margin-top: 10px; font-size: 11px; text-align: left;">\n  ${l}\n</div>\n\n</body>\n</html>\n`,p=n.contentWindow.document;p.open(),p.write(c),p.close(),n.onload=()=>{n.contentWindow.focus(),n.contentWindow.print(),setTimeout((()=>{document.body.removeChild(n)}),1e3)}}catch(n){it(`Failed to print statement: ${n.message}`)}};return(0,a.bv)((()=>{et()})),(t,n)=>{const e=(0,a.up)("v-client-table");return(0,a.wg)(),(0,a.iD)("div",d,[c,(0,a._)("div",p,[(0,a._)("div",g,[m,(0,i.SU)(at).includes("is_programmer")?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-success me-2",onClick:n[0]||(n[0]=t=>rt(nt.value))}," Print ")):(0,a.kq)("",!0),(0,a._)("a",{href:nt.value.attachment,target:"_blank",class:"btn btn-primary"},"Attachment",8,u)]),(0,a._)("div",v,[(0,a._)("div",b,[(0,a._)("div",h,[(0,a._)("p",y,[x,(0,a.Uk)(" "+(0,s.zw)(nt.value?.project),1)]),(0,a._)("p",f,[$,(0,a.Uk)(" "+(0,s.zw)(nt.value?.quantity)+" "+(0,s.zw)(nt.value?.unit),1)]),(0,a._)("p",_,[w,(0,a.Uk)(" "+(0,s.zw)(nt.value?.archived_quantity)+" "+(0,s.zw)(nt.value?.unit),1)]),(0,a._)("p",S,[T,(0,a.Uk)(" "+(0,s.zw)(nt.value?.payment_term),1)])]),(0,a._)("div",C,[(0,a._)("p",O,[D,(0,a.Uk)(" "+(0,s.zw)(nt.value?.subcontracted_to),1)]),(0,a._)("p",N,[A,(0,a.Uk)(" "+(0,s.zw)(nt.value?.rate),1)]),(0,a._)("p",k,[R,(0,a.Uk)(" "+(0,s.zw)(nt.value?.balance),1)]),(0,a._)("p",z,[P,(0,a.Uk)(" "+(0,s.zw)(nt.value?.payment_number),1)])]),(0,a._)("div",M,[(0,a._)("p",j,[U,(0,a.Uk)(" "+(0,s.zw)(nt.value?.item),1)]),(0,a._)("p",E,[q,(0,a.Uk)(" "+(0,s.zw)(nt.value?.cost),1)]),(0,a._)("p",F,[I,(0,a.Uk)(" "+(0,s.zw)(nt.value?.pending_archived),1)])])])])]),(0,a._)("div",H,[(0,a._)("div",Y,[B,(0,a._)("div",L,[(0,a._)("div",V,[(0,a.Wm)(e,{data:nt.value.payments||[],columns:K.value,options:tt.value},{actions:(0,a.w5)((t=>[(0,a._)("div",X,[(0,a._)("a",{href:"javascript:void(0);",class:"text-primary me-2",onClick:n=>st(nt.value,t.row)},Z,8,W)])])),_:1},8,["data","columns","options"])])])])])])}}};const J=G;var K=J}}]);
//# sourceMappingURL=838.d117a6a0.js.map