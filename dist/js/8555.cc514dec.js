"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[8555],{78555:function(a,e,l){l.r(e),l.d(e,{default:function(){return Ja}});l(26699);var t=l(66252),s=l(3577),o=l(2262),n=l(49963),i=l(87066),r=l(56296),u=l(26212),c=l.n(u);const d={class:"layout-px-spacing"},m=(0,t.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Services</span></li></ol></nav></div></li></ul>',1),v={class:"navbar-nav flex-row ms-auto"},b={class:"nav-item more-dropdown"},p={class:"dropdown custom-dropdown-icon"},_=(0,t._)("a",{href:"javascript:;",class:"nav-link dropdown-toggle",id:"ddlSettings","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,t._)("span",null,"Select a company"),(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},[(0,t._)("polyline",{points:"6 9 12 15 18 9"})])],-1),h={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"ddlSettings"},w=(0,t._)("a",{class:"dropdown-item","data-value":"Mail",href:"javascript:void(0);"},"BUSHMAN SAFARI",-1),g=[w],y=(0,t._)("a",{class:"dropdown-item","data-value":"Settings",href:"javascript:void(0);"},"COPEX CONTRACTORS",-1),f=[y],S={class:"text-center"},k={class:"d-flex me-4 mt-2"},C={class:"ms-auto"},H=["disabled"],x=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,t._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),M=[x],D=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,t._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),A=[D],V={key:0,class:"row"},U={class:"col-md-3"},q={class:"form-group"},z=(0,t._)("label",{class:"form-label"},"Select Labour",-1),T={class:"col-md-2"},E={class:"form-group"},R=(0,t._)("label",{class:"form-label"},"Date Debted",-1),L={class:"col-md-3"},B={class:"form-group"},O=(0,t._)("label",{class:"form-label"},"Amount ",-1),N={class:"col-md-10"},j={class:"form-group"},P=(0,t._)("label",{class:"form-label"},"Any Description",-1),I={class:"col-md-2"},F={class:"form-group"},W=(0,t._)("label",{class:"form-label invisible"},"Submit",-1),$=["disabled"],X={class:"row layout-top-spacing"},J={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},K={class:"panel p-0"},Y=["innerHTML"],Z={key:1,class:"custom-table table3"},G=["onClick"],Q=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,t._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})],-1),aa=[Q],ea={class:"modal fade mymodal",id:"labour-view-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"labourViewModalLabel","aria-hidden":"true"},la={class:"modal-dialog modal-xl"},ta={class:"modal-content"},sa={class:"modal-header"},oa={class:"modal-title fs-5",id:"labourViewModalLabel"},na=(0,t._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ia={class:"modal-body"},ra={key:0,class:"row mb-3"},ua={class:"col-md-12"},ca={class:"panel p-0"},da={class:"custom-table table3 table-responsive"},ma={class:"table table-hover table-striped"},va=(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",null,"labour Name"),(0,t._)("th",null,"Amount"),(0,t._)("th",null,"Status")])],-1),ba={class:"d-flex justify-content-between align-items-center mb-3"},pa=(0,t._)("h5",{class:"mb-0"},null,-1),_a={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-paperclip me-1",viewBox:"0 0 16 16"},ha=(0,t._)("path",{d:"M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0z"},null,-1),wa=[ha],ga={key:1},ya={key:1,class:"row mb-3"},fa={class:"col-md-12"},Sa={class:"row"},ka={class:"col-md-2"},Ca=(0,t._)("label",{class:"form-label"},"Enter Amount",-1),Ha={class:"col-md-4"},xa=(0,t._)("label",{class:"form-label"},"Paid To",-1),Ma={class:"col-md-3"},Da=(0,t._)("label",{class:"form-label"},"Date",-1),Aa={class:"col-md-3"},Va=(0,t._)("label",{class:"form-label"},"Attachment (PDF only)",-1),Ua={class:"row mt-3"},qa={class:"col-md-12 text-end"},za=["disabled"],Ta={key:0,class:"spinner-border spinner-border-sm text-white me-2",role:"status"},Ea=(0,t.Uk)(" Save "),Ra=(0,t._)("h5",{class:"mb-3"},"labour Debt Payments",-1),La={class:"row mb-3"},Ba={class:"col-md-12"},Oa={class:"panel p-0"},Na=["innerHTML"],ja={key:1,class:"custom-table table3"},Pa=["href"],Ia=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-file-earmark-pdf text-primary",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),(0,t._)("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"})],-1),Fa=[Ia],Wa=(0,t._)("div",{class:"modal-footer"},[(0,t._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1);var $a={setup(a){(0,r.j)({title:"Custom Table"});const e=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),l=JSON.parse(localStorage.getItem("user")).permissions,u=(0,t.f3)("showMessage"),w=(0,t.f3)("showError"),y=(0,t.f3)("formatNumber"),x=(0,t.f3)("formatDate"),D=(0,t.f3)("printlabourList"),Q=(0,t.f3)("tableShimmer"),ha=(0,o.iH)(!1),Ia=(0,o.iH)(["Sno","labour","amount","repaid","balance","description","debt_date","status","actions"]),$a=(0,o.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","service_name"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),Xa=(0,o.iH)(""),Ja=(0,o.iH)(!1),Ka=(0,o.iH)(""),Ya=(0,o.iH)([]),Za=async()=>{ha.value=!0;try{const a=await e.get(`labour-debts?company_id=${Xa.value}`);Ya.value=a.data.map(((a,e)=>({...a,Sno:e+1,amount:y(a.amount),labour:a.labour.name,debt_date:a.date,monthly_payable_original:a.monthly_payable,monthly_payable:y(a.monthly_payable),amount_original:a.amount,repaid:y(a.repayments_sum_amount),balance:y(a.amount-a.repayments_sum_amount)})))}catch(a){console.log(a),w(a.message)}finally{ha.value=!1}},Ga=((0,o.iH)(""),(0,o.iH)("")),Qa=(0,o.iH)(""),ae=(0,o.iH)(""),ee=(0,o.iH)(""),le=((0,o.iH)(""),async()=>{ha.value=!0;const a={labour_id:Ka.value.id,amount:Qa.value,date:Ga.value,description:ae.value};try{await e.post("labour-debts",a);u("Debt Saved"),Ja.value=!Ja.value,await Za(),Ka.value="",Qa.value="",Ga.value=""}catch(l){w(l.message),console.log(l)}}),te=(0,o.iH)(null),se=async a=>{te.value=a,Qa.value=te.value.monthly_payable_original,await pe(a.id)},oe=(0,o.iH)(!1),ne=(0,o.iH)(""),ie=(0,o.iH)(null),re=(0,o.iH)(!1),ue=a=>{ie.value=a.target.files[0]},ce=async()=>{re.value=!0;const a=new FormData;a.append("labour_id",te.value.labour_id),a.append("host_id",te.value.labour_id),a.append("host",te.value.labour),a.append("reference_number","salary on "+ee.value),a.append("labour_debt_id",te.value.id),a.append("amount",Qa.value),a.append("date",ee.value),a.append("direction","INCREMENT"),a.append("account_transaction_point_id",fe.value.id),a.append("opening_balance",fe.value.transactions_sum),a.append("issuer_id",JSON.parse(localStorage.getItem("user")).id),a.append("attachment",ie.value);try{await e.post("labour-debt-repayments",a,{headers:{"Content-Type":"multipart/form-data"}});u("Debt Updated!"),await _e(te.value.id),Za(),de()}catch(l){w(l.message),console.log(l)}finally{re.value=!1}},de=()=>{oe.value=!1,ne.value="",ie.value=null;const a=document.querySelector('input[type="file"]');a&&(a.value="")},me=(0,o.iH)([]),ve=(0,o.iH)(["Sno","date","amount","actions"]),be=(0,o.iH)(!1),pe=async a=>{be.value=!0;try{const l=await e.get(`labour-debt-repayments?labour_debt_id=${a}`);me.value=l.data.map(((a,e)=>({...a,Sno:e+1,attachment:"https://bushman.ink/api/v1/../../"+a.transaction.attachment,date:x(a.created_at),amount:y(a.amount),description:a.remark})))}catch(l){w(l.message),console.log(l)}finally{be.value=!1}},_e=async a=>{const l=await e.get(`labour-debt-repayments?labour_debt_id=${a}`);me.value=l.data.map(((a,e)=>({...a,Sno:e+1,attachment:"https://bushman.ink/api/v1/../../"+a.attachment,date:x(a.created_at),description:a.remark,amount:y(a.amount)})))},he=(0,o.iH)([""]),we=async()=>{const a=await e.get(`labours?company_id=${Xa.value}`);he.value=a.data},ge=a=>{Xa.value=a,Za(),we()},ye=(0,o.iH)([]),fe=(0,o.iH)(""),Se=async()=>{try{const a=await e.get("account-transaction-points");ye.value=a.data.map(((a,e)=>({...a,name:(a?.name??"")+" "+(a?.mobile_money?.name??"")+" "+(a?.mobile_money?.category??"CASH")})))}catch(a){w(a.message)}};return(0,t.bv)((async()=>{Se()})),(a,e)=>{const i=(0,t.up)("v-client-table");return(0,t.wg)(),(0,t.iD)("div",d,[m,((0,t.wg)(),(0,t.j4)(t.lR,{to:"#breadcrumb"},[(0,t._)("ul",v,[(0,t._)("li",b,[(0,t._)("div",p,[_,(0,t._)("ul",h,[(0,t._)("li",{onClick:e[0]||(e[0]=a=>ge(5))},g),(0,t._)("li",{onClick:e[1]||(e[1]=a=>ge(6))},f)])])])])])),(0,t._)("h3",S,(0,s.zw)(5==Xa.value?"BUSHMAN SAFARI TRACKERS LABOURS DEBTS":6==Xa.value?"COPEX CONTRACTORS LABOURS DEBTS":"SELECT A COMPANY"),1),(0,t._)("div",k,[(0,t._)("div",C,[(0,o.SU)(l).includes("can_register_labours")?((0,t.wg)(),(0,t.iD)("button",{key:0,class:"btn btn-primary me-2",disabled:!Xa.value,onClick:e[2]||(e[2]=a=>Ja.value=!Ja.value)},M,8,H)):(0,t.kq)("",!0),(0,o.SU)(l).includes("can_register_print")?((0,t.wg)(),(0,t.iD)("button",{key:1,class:"btn btn-success",onClick:e[3]||(e[3]=a=>(0,o.SU)(D)())},A)):(0,t.kq)("",!0)])]),(0,t._)("form",{onSubmit:e[8]||(e[8]=(0,n.iM)((a=>le()),["prevent"]))},[Ja.value?((0,t.wg)(),(0,t.iD)("div",V,[(0,t._)("div",U,[(0,t._)("div",q,[z,(0,t.Wm)((0,o.SU)(c()),{modelValue:Ka.value,"onUpdate:modelValue":e[4]||(e[4]=a=>Ka.value=a),options:he.value,label:"name",placeholder:"Select Labour",searchable:!0,"allow-empty":!1},null,8,["modelValue","options"])])]),(0,t._)("div",T,[(0,t._)("div",E,[R,(0,t.wy)((0,t._)("input",{type:"date",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=a=>Ga.value=a),required:""},null,512),[[n.nr,Ga.value]])])]),(0,t._)("div",L,[(0,t._)("div",B,[O,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=a=>Qa.value=a),required:"",step:"any",placeholder:"Enter Amount"},null,512),[[n.nr,Qa.value]])])]),(0,t._)("div",N,[(0,t._)("div",j,[P,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=a=>ae.value=a),placeholder:"Enter Description"},null,512),[[n.nr,ae.value]])])]),(0,t._)("div",I,[(0,t._)("div",F,[W,(0,t._)("button",{type:"submit",class:"btn btn-primary w-100",disabled:!Ka.value||ha.value}," Submit ",8,$)])])])):(0,t.kq)("",!0)],32),(0,t._)("div",X,[(0,t._)("div",J,[(0,t._)("div",K,[ha.value?((0,t.wg)(),(0,t.iD)("div",{key:0,innerHTML:(0,o.SU)(Q)()},null,8,Y)):((0,t.wg)(),(0,t.iD)("div",Z,[(0,t.Wm)(i,{data:Ya.value,columns:Ia.value,options:$a.value},{status:(0,t.w5)((a=>[(0,t._)("span",{class:(0,s.C_)(["badge inv-status","badge-"+a.row?.status?.color])},(0,s.zw)(a.row?.status?.name),3)])),actions:(0,t.w5)((a=>[(0,t._)("a",{href:"javascript:void(0);",class:"text-primary",onClick:e=>se(a.row),"data-bs-toggle":"modal","data-bs-target":"#labour-view-modal"},aa,8,G)])),_:1},8,["data","columns","options"])]))])])]),(0,t._)("div",ea,[(0,t._)("div",la,[(0,t._)("div",ta,[(0,t._)("div",sa,[(0,t._)("h1",oa,"labour DEBT FOR "+(0,s.zw)(te.value?.labour),1),na]),(0,t._)("div",ia,[te.value?((0,t.wg)(),(0,t.iD)("div",ra,[(0,t._)("div",ua,[(0,t._)("div",ca,[(0,t._)("div",da,[(0,t._)("table",ma,[va,(0,t._)("tbody",null,[(0,t._)("tr",null,[(0,t._)("td",null,(0,s.zw)(te.value.labour),1),(0,t._)("td",null,(0,s.zw)(te.value.amount),1),(0,t._)("td",null,[(0,t._)("span",{class:(0,s.C_)(["badge inv-status","badge-"+te.value?.status?.color])},(0,s.zw)(te.value?.status?.name),3)])])])])])])])])):(0,t.kq)("",!0),(0,t._)("div",ba,[pa,(0,t._)("button",{type:"button",class:(0,s.C_)(["btn btn-sm mx-2",oe.value?"btn-danger":"btn-primary"]),onClick:e[9]||(e[9]=a=>oe.value=!oe.value)},[oe.value?((0,t.wg)(),(0,t.iD)("span",ga,"X")):((0,t.wg)(),(0,t.iD)("svg",_a,wa))],2)]),oe.value?((0,t.wg)(),(0,t.iD)("div",ya,[(0,t._)("div",fa,[(0,t._)("form",{onSubmit:e[14]||(e[14]=(0,n.iM)((a=>ce()),["prevent"]))},[(0,t._)("div",Sa,[(0,t._)("div",ka,[Ca,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[10]||(e[10]=a=>Qa.value=a),placeholder:"Enter Amount"},null,512),[[n.nr,Qa.value]])]),(0,t._)("div",Ha,[xa,(0,t.Wm)((0,o.SU)(c()),{modelValue:fe.value,"onUpdate:modelValue":e[11]||(e[11]=a=>fe.value=a),options:ye.value,placeholder:"Select Account",label:"name",searchable:!0,multple:"false",required:!0,"allow-empty":!1},null,8,["modelValue","options"])]),(0,t._)("div",Ma,[Da,(0,t.wy)((0,t._)("input",{type:"date",class:"form-control","onUpdate:modelValue":e[12]||(e[12]=a=>ee.value=a)},null,512),[[n.nr,ee.value]])]),(0,t._)("div",Aa,[Va,(0,t._)("input",{type:"file",class:"form-control",onChange:ue,accept:"application/pdf",required:""},null,32)])]),(0,t._)("div",Ua,[(0,t._)("div",qa,[(0,t._)("button",{type:"button",class:"btn btn-secondary me-2",onClick:e[13]||(e[13]=a=>de())}," Cancel "),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:re.value},[re.value?((0,t.wg)(),(0,t.iD)("span",Ta)):(0,t.kq)("",!0),Ea],8,za)])])],32)])])):(0,t.kq)("",!0),Ra,(0,t._)("div",La,[(0,t._)("div",Ba,[(0,t._)("div",Oa,[be.value?((0,t.wg)(),(0,t.iD)("div",{key:0,innerHTML:(0,o.SU)(Q)()},null,8,Na)):((0,t.wg)(),(0,t.iD)("div",ja,[(0,t.Wm)(i,{data:me.value,columns:ve.value,options:$a.value},{actions:(0,t.w5)((a=>[(0,t._)("a",{href:a.row.attachment,target:"_blank",rel:"noopener noreferrer"},Fa,8,Pa)])),_:1},8,["data","columns","options"])]))])])])]),Wa])])])])}}};const Xa=$a;var Ja=Xa}}]);
//# sourceMappingURL=8555.cc514dec.js.map