{"version":3,"file":"js/838.d117a6a0.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/subcontractors/individual.vue","webpack://cork-vue3/./src/views/subcontractors/individual.vue?105e"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Subcontractors</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n\r\n              \r\n    \r\n       \r\n<div class=\"border p-3 my-4\" style=\"border-width:2px; border-style:solid; border-color:#d3d3d3; font-size:1.1rem;\">\r\n       <div class=\"card-header d-flex justify-content-between align-items-center\">\r\n    <h4 class=\"mb-0 text-center w-100\">Subcontractor Agreement Details</h4>\r\n    <button v-if=\"user_permissions.includes('is_programmer')\" type=\"button\" class=\"btn btn-success me-2\" @click=\"printStatement(agreements)\">\r\n      Print\r\n    </button>\r\n    <a :href=\"agreements.attachment\" target=\"_blank\" class=\"btn btn-primary\">Attachment</a>\r\n  </div>\r\n  <div class=\"card-body\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-4 text-start\">\r\n        <p class=\"mb-3\"><strong>Project:</strong> {{ agreements?.project }}</p> \r\n        <p class=\"mb-3\"><strong>Quantity:</strong> {{ agreements?.quantity }} {{ agreements?.unit }}</p>\r\n       <p class=\"mb-3\"><strong>Archived Quantity:</strong> {{ agreements?.archived_quantity }} {{ agreements?.unit }}</p>\r\n       <p class=\"mb-3\"><strong>Payment Term:</strong> {{ agreements?.payment_term }}</p>\r\n        \r\n      </div>\r\n      <div class=\"col-md-4 text-start\">\r\n         <p class=\"mb-3\"><strong>Sub Contracted To:</strong> {{ agreements?.subcontracted_to }}</p>\r\n        <p class=\"mb-3\"><strong>Rate:</strong> {{ agreements?.rate }}</p>\r\n        <p class=\"mb-3\"><strong>Archived Amount:</strong> {{ agreements?.balance }}</p>\r\n        <p class=\"mb-3\"><strong>Payment Details:</strong> {{ agreements?.payment_number }}</p>\r\n\r\n      </div>\r\n      <div class=\"col-md-4 text-start\">\r\n         <p class=\"mb-3\"><strong>Item Description:</strong> {{ agreements?.item }}</p>\r\n        <p class=\"mb-3\"><strong>Total Cost:</strong> {{ agreements?.cost }}</p>\r\n        <p class=\"mb-3\"><strong>Pending Amount:</strong> {{ agreements?.pending_archived }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n        <!-- Payments Table Section -->\r\n        <div class=\"row layout-top-spacing\">\r\n          <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n            <h4 class=\"mb-3\">Payments</h4>\r\n            <div class=\"panel p-0\">\r\n              <div class=\"custom-table table3\">\r\n                <v-client-table\r\n                  :data=\"agreements.payments || []\"\r\n                  :columns=\"paymentColumns\"\r\n                  :options=\"table_option\"\r\n                >\r\n\r\n                               <template #actions=\"props\">\r\n                                \r\n<div class=\"d-flex justify-content-center align-items-center\">\r\n<a href=\"javascript:void(0);\" class=\"text-primary me-2\" @click=\"printDetails(agreements, props.row)\">\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n        <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n    </svg>\r\n</a>\r\n\r\n\r\n</div>\r\n                                      \r\n                \r\n                            </template>\r\n                </v-client-table>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n  \r\n   \r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref,inject,watch } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    useMeta({ title: 'Subcontractors Agreements' });\r\n    import { useRoute } from 'vue-router'\r\n   const route = useRoute();\r\n    \r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const tableShimmer = inject('tableShimmer');\r\n    const formatNumber = inject('formatNumber');\r\n    const formatDate = inject('formatDate');\r\n    \r\n    let editModal = null;\r\n    const editingRow = ref({});\r\n    const name = ref('');\r\n    const short_name = ref('');\r\n    const status = ref('');\r\n    const loading_spinner = ref(false);\r\n    const units = ref([]);\r\n    const unit_registration = ref(false);\r\n    const paymentColumns = ref(['sno','invoice_ref','description','amount', 'payment','balance', 'date','actions' ]);\r\n  \r\n\r\n    const table_option = ref({\r\n        perPage: 10,\r\n        perPageValues: [10, 20, 50],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const agreements = ref({})\r\nconst getAgreements = async () => {\r\n  loading_spinner.value = true;\r\n  try {\r\n    const response = await axiosInstance.get(`/subcontractor-agreements/${route.params.agreement_id}`);\r\n    const item = response.data; // single object\r\n\r\n    const totalCost = parseFloat(item.quantity) * parseFloat(item.rate);\r\n    let cumulativePaid = 0;\r\n\r\n    // enrich payments with remaining balance\r\n    const paymentsWithRemaining = (item.payments || []).map((p, idx) => {\r\n      cumulativePaid += p.quantity;\r\n      const remaining = totalCost - cumulativePaid;\r\n       // compute work quantity (raw number)\r\n     const workQty = Number(p.quantity) / Number(item.rate);\r\n      return {\r\n        ...p,\r\n        sno: idx + 1,\r\n        invoice_ref:'00' + p.id,\r\n        payment: formatNumber(p.quantity),\r\n        date: new Date(p.created_at).toLocaleDateString(),\r\n        balance: formatNumber(remaining === 0 ? p.quantity : remaining),\r\n        description: p.description || ' ',\r\n        amount: workQty.toFixed(2)|| ' '\r\n      };\r\n    });\r\n\r\n    const totalPaid = (item.payments || []).reduce((sum, p) => sum + p.quantity, 0);\r\n    const payable = totalCost - totalPaid;\r\n\r\n    // remaining amount / balance logic\r\n    const remainingAmount = totalCost - payable;\r\n    const balance = remainingAmount === 0 ? payable : remainingAmount;\r\n\r\n    // Calculate pending archived amount\r\n    const totalArchivedQty = (item.payments || []).reduce((sum, p) => {\r\n      const workQty = Number(p.quantity) / Number(item.rate);\r\n      return sum + workQty;\r\n    }, 0);\r\n    const pendingArchivedQty = parseFloat(item.quantity) - totalArchivedQty;\r\n\r\n    agreements.value = {\r\n      ...item,\r\n      date: formatDate(item.created_at),\r\n      project: item.project?.short_name,\r\n      attachment: 'https://copex.trustdigital.space/' + item.attachment,\r\n      payment_term: item?.payment_term?.name,\r\n      rate: formatNumber(item.rate),\r\n      cost: formatNumber(totalCost),\r\n      payable: formatNumber(payable),\r\n      balance: formatNumber(balance),\r\n      payments: paymentsWithRemaining,\r\n      archived_quantity: totalArchivedQty.toFixed(2),\r\n      pending_archived: formatNumber(pendingArchivedQty * parseFloat(item.rate)),\r\n      address: item.address,\r\n      tin_no: item.tin_no,\r\n    };\r\n  } catch (error) {\r\n    console.log(error);\r\n    showError(error.message);\r\n  } finally {\r\n    loading_spinner.value = false;\r\n  }\r\n};\r\n\r\n\r\nconst user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n\r\n\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n\r\n\r\n\r\nconst printDetails = async (agreement, payment) => {\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n\r\n    // Date formatting\r\n    const now = new Date();\r\n    const day = String(now.getDate()).padStart(2, '0');\r\n    const month = String(now.getMonth() + 1).padStart(2, '0');\r\n    const year = now.getFullYear();\r\n    const dateString = `${day}/${month}`;\r\n    const formattedDate = `${day}/${month}/${year}`;\r\n    const formatDate = `${day}.${month}.${year}`;\r\n    const formattedDateTime = `${formattedDate}, ${now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}`;\r\n\r\n    // Use specific payment ID if provided, otherwise use the main row ID (not last payment)\r\n    const paymentId = payment ? payment.id : agreement.id;\r\n    const noticeNo = `${paymentId}/${year}`;\r\n    const agreementId = `${String(paymentId).padStart(3, '0')}/${dateString}`;\r\n    // Calculate the specific payment amount or total payable\r\n    const specificPaymentAmount = payment ? \r\n      formatNumber(payment.quantity) : \r\n      (agreement.payments && agreement.payments.length > 0 ? \r\n        formatNumber(agreement.payments.reduce((sum, p) => sum + Number(p.quantity), 0)) : \r\n        agreement.payable);\r\n        const totalArchived = agreement.payments.reduce((sum, p) => sum + Number(p.quantity), 0);\r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Subcontractor Agreement Details</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n  .logo { width: 160px; height: auto; }\r\n  .agreement-box { border: 1px solid #000; padding: 5px 10px; font-size: 13px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\r\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n  .title { text-align: center; font-weight: bold; margin: 20px 0 10px 0; }\r\n  .details-list { margin-top: 15px; line-height: 1.6; }\r\n  .details-list div { margin-bottom: 4px; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n  table.items th, table.items td { border: 1px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n   .text-end { text-align: end; }\r\n  .text-center { text-align: center; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"agreement-box\">\r\n    Agreement ID:<br>\r\n    <span style=\"color:red;\">${agreementId}</span>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"reg-info\">\r\n  TIN: 103-826-519<br>\r\n  VRN: 20-01-017530R\r\n</div>\r\n\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n\r\n<div class=\"section-title\">SUBCONTRACTOR AGREEMENT DETAILS</div>\r\n<div class=\"title\"> ${agreement.project.toUpperCase()} - ${agreement.item.toUpperCase()}</div>\r\n\r\n<div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n  <div class = 'text-start'><strong>NOTICE NO. 00${noticeNo}</strong></div>\r\n  <div class = 'text-end'><strong>Date: ${formatDate}</strong></div>\r\n</div>\r\n\r\n<div class=\"text-center\"> <strong> REF: SUBCONTRACTING NOTICE No. ${paymentId}</strong></div>\r\n\r\n<div class = 'text-start'><P> Refer the subject matter above </p> </div>\r\n\r\n<div class = 'text-start'><P> This form as internal notice on subcontracting piece work on <strong>${agreement.item.toUpperCase()}</strong> </p> </div>\r\n\r\n<div class=\"details-list\">\r\n  <div><strong>Subcontracted :${agreement.subcontracted_to}</strong> </div><br>\r\n  <div>Item Description:</strong> ${agreement.item}</div><br>\r\n  <div><strong>Contracted Quantity: ${agreement.quantity} ${agreement.unit}</strong></div><br>\r\n    <div><strong>Archived Qty To Date: ${agreement.archived_quantity} ${agreement.unit}</div><br> \r\n  <div>This payment certificate : ${agreement.payment_term}</div><br>\r\n  <div>Subcontracted To : ${agreement.subcontracted_to}</div><br>\r\n  <div><strong>Payment Details :</strong> ${agreement.payment_number}</div><br>\r\n  <div>Subcontracting Unit Price is:<strong> TZS ${agreement.rate} per ${agreement.unit}</strong></div><br>\r\n  <div><strong>Total Amount of Contract : TZS ${agreement.cost}</strong></div><br>\r\n  <div><strong>Pending Contract Amount :</strong> ${agreement.balance}</div><br>\r\n  <div><strong>Total Amount Archived :</strong> TZS ${formatNumber(totalArchived)}</div><br>\r\n  <div> This Certificate Payable Amount:<strong> TZS ${specificPaymentAmount}</strong></div>\r\n</div>\r\n\r\n${agreement.payments && agreement.payments.length > 0 ? `\r\n<div class=\"section-title\">PAYMENT HISTORY</div>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th style=\"width: 30px;\"><strong>Sno.</strong></th>\r\n      <th><strong>Date</strong></th>\r\n      <th><strong>Description</strong></th>\r\n      <th><strong>Amount</strong></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${agreement.payments.map((payment, index) => {\r\n      const date = new Date(payment.created_at);\r\n      const formattedPaidAt = `${String(date.getDate()).padStart(2, '0')}.${String(date.getMonth() + 1).padStart(2, '0')}.${date.getFullYear()}`;\r\n      return `\r\n    <tr>\r\n      <td class=\"text-center\">${index + 1}</td>\r\n      <td class=\"text-center\">${formattedPaidAt}</td>\r\n      <td class=\"text-start\">${payment.description || ' '}</td>\r\n      <td class=\"text-end\">${payment.amount}</td>\r\n    </tr>\r\n    `}).join('')}\r\n  </tbody>\r\n</table>\r\n` : ''}\r\n\r\n<div style=\"margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;\">\r\n  <p>© ${new Date().getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 135-489-247 | VRN: 40-032826C</p>\r\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\r\n</div>\r\n\r\n<div style=\"margin-top: 10px; font-size: 11px; text-align: left;\">\r\n  ${formattedDateTime}\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print agreement details: ${error.message}`);\r\n  }\r\n};\r\n\r\nconst printStatement = async (agreement) => {\r\n  try {\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = \"none\";\r\n    document.body.appendChild(iframe);\r\n    const noticeNo = `${agreement.id}`\r\n\r\n    // Date formatting\r\n    const now = new Date();\r\n    const day = String(now.getDate()).padStart(2, '0');\r\n    const month = String(now.getMonth() + 1).padStart(2, '0');\r\n    const year = now.getFullYear();\r\n    const formattedDate = `${day}/${month}/${year}`;\r\n    const formatDate = `${day}.${month}.${year}`;\r\n    const currentFormattedDate = `${day}/${month}/${year}`; // Current date in dd/mm/yyyy format\r\n    const formattedDateTime = `${formattedDate}, ${now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}`;\r\n\r\n    const totalArchived = agreement.payments.reduce((sum, p) => sum + Number(p.quantity), 0);\r\n    \r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<title>Subcontractor Statement</title>\r\n<style>\r\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 13px; }\r\n  .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n  .logo { width: 160px; height: auto; }\r\n  .agreement-box { border: 1px solid #000; padding: 4px 8px; font-size: 11px; text-align: center; margin-left: auto; border-radius: 5px; }\r\n  .company-title { text-align: center; margin-top: 10px; }\r\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 10px; line-height: 1.4; }\r\n  .section-title { display: flex; justify-content: space-between; align-items: flex-start; my-3; }\r\n  .title { text-align: center; font-weight: bold; margin: 20px 0 10px 0; }\r\n  .details-list { margin-top: 15px; line-height: 1.6; }\r\n  .details-list div { margin-bottom: 4px; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\r\n  table.items th, table.items td { border: 1px solid #000; padding: 6px; font-weight: normal; }\r\n  table.items thead tr th { background-color: #f8f8f8; border: 1px solid #000; }\r\n  .text-right { text-align: right; }\r\n  .text-end { text-align: end; }\r\n  .text-center { text-align: center; }\r\n  .text-start { text-align: start; }\r\n  @media print { body { margin: 10mm; } .no-print { display: none; } }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"header\">\r\n  <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n  <div class=\"agreement-box\">\r\n    NOTICE NO. <br>\r\n    <span style=\"color:red;\">00${noticeNo}</span>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"reg-info\">\r\n  TIN: 103-826-519<br>\r\n  VRN: 20-01-017530R\r\n</div>\r\n\r\n<div class=\"company-title\">\r\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n</div>\r\n\r\n<div class=\"title\"> SUBCONTRACTOR STATEMENT FOR ${agreement.project.toUpperCase()} - ${agreement.item.toUpperCase()}</div>\r\n\r\n<div style=\"display: flex; justify-content: center; align-items: center;\">\r\n  <div class='text-center'><strong>Subcontracted To: ${agreement.subcontracted_to}</strong></div>\r\n</div>\r\n\r\n<table class=\"items\" style=\"margin-top: 20px;\">\r\n  <thead>\r\n                      <tr>\r\n                        <td><strong>Archived Quantity:</strong></td>\r\n                        <td><strong>Rate:</strong></td>\r\n                        <td><strong>Amount Archived:</strong></td>\r\n                        <td><strong>Pending Amount:</strong></td>\r\n                        <td><strong>Payment Details:</strong></td>\r\n                      </tr>\r\n                  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td>${agreement.archived_quantity} ${agreement.unit}</td>\r\n      <td>${agreement.rate}</td>\r\n      <td>${formatNumber(totalArchived)}</td>\r\n      <td>${agreement.pending_archived}</td>\r\n      <td>${agreement.payment_number}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n${agreement.payments && agreement.payments.length > 0 ? `\r\n<h3 class=\"section-title\"> payments </h3>\r\n<table class=\"items\">\r\n  <thead>\r\n    <tr>\r\n      <th style=\"width: 30px;\"><strong>Sno.</strong></th>\r\n      <th><strong>Invoice Ref</strong></th>\r\n      <th><strong>Date</strong></th>\r\n      <th><strong>Description</strong></th>\r\n      <th><strong>Quantity</strong></th>\r\n      <th><strong>Amount</strong></th>\r\n      <th><strong>Balance</strong></th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${agreement.payments.map((payment, index) => {\r\n      const date = new Date(payment.created_at);\r\n      const formattedPaidAt = `${String(date.getDate()).padStart(2, '0')}.${String(date.getMonth() + 1).padStart(2, '0')}.${date.getFullYear()}`;\r\n      return `\r\n    <tr>\r\n      <td class=\"text-center\">${index + 1}</td>\r\n      <td class=\"text-center\">${payment.invoice_ref}</td>\r\n      <td class=\"text-center\">${formattedPaidAt}</td>\r\n      <td class=\"text-start\">${payment.description || ' '}</td>\r\n      <td class=\"text-end\">${payment.amount}</td>\r\n      <td class=\"text-end\">${payment.payment}</td>\r\n      <td class=\"text-end\">${payment.balance}</td>\r\n    </tr>\r\n    `}).join('')}\r\n  </tbody>\r\n</table>\r\n` : ''}\r\n\r\n<div style=\"margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;\">\r\n  <p>© ${new Date().getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 103-826-519 | VRN: 20-01-017530R</p>\r\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\r\n</div>\r\n\r\n<div style=\"margin-top: 10px; font-size: 11px; text-align: left;\">\r\n  ${formattedDateTime}\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print statement: ${error.message}`);\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n        getAgreements();\r\n    });\r\n</script>\r\n\r\n","import script from \"./individual.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./individual.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./individual.vue?vue&type=style&index=0&id=55d93984&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","route","useRoute","axiosInstance","axios","baseURL","process","formatNumber","inject","formatDate","ref","loading_spinner","paymentColumns","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","agreements","getAgreements","async","value","response","get","params","agreement_id","item","data","totalCost","parseFloat","quantity","rate","cumulativePaid","paymentsWithRemaining","payments","map","p","idx","remaining","workQty","Number","sno","invoice_ref","id","payment","date","Date","created_at","toLocaleDateString","balance","description","amount","toFixed","totalPaid","reduce","sum","payable","remainingAmount","totalArchivedQty","pendingArchivedQty","project","short_name","attachment","payment_term","name","cost","archived_quantity","pending_archived","address","tin_no","error","console","log","showError","message","user_permissions","JSON","parse","localStorage","getItem","permissions","printDetails","agreement","iframe","document","createElement","style","display","body","appendChild","now","day","String","getDate","padStart","month","getMonth","year","getFullYear","dateString","formattedDate","formattedDateTime","toLocaleTimeString","hour","minute","paymentId","noticeNo","agreementId","specificPaymentAmount","length","totalArchived","printContent","toUpperCase","subcontracted_to","unit","payment_number","index","formattedPaidAt","join","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","printStatement","onMounted","__exports__"],"sourceRoot":""}