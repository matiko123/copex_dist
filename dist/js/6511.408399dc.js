"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[6511],{56511:function(e,a,l){l.r(a),l.d(a,{default:function(){return Fe}});l(26699);var t=l(66252),s=l(2262),o=l(3577),i=l(49963),c=l(26212),d=l.n(c),n=l(56296),r=l(87066);const u=e=>((0,t.dD)("data-v-0ecddadf"),e=e(),(0,t.Cn)(),e),v={class:"layout-px-spacing"},m=(0,t.uE)('<ul class="navbar-nav flex-row" data-v-0ecddadf><li data-v-0ecddadf><div class="page-header" data-v-0ecddadf><nav class="breadcrumb-one" aria-label="breadcrumb" data-v-0ecddadf><ol class="breadcrumb" data-v-0ecddadf><li class="breadcrumb-item" data-v-0ecddadf><a href="javascript:;" data-v-0ecddadf>Masters</a></li><li class="breadcrumb-item active" aria-current="page" data-v-0ecddadf><span data-v-0ecddadf>Assets</span></li></ol></nav></div></li></ul>',1),p=["innerHTML"],b={key:1,class:"seperator-header layout-top-spacing"},_={class:"d-flex"},y={class:"d-flex justify-content-between align-items-center mb-4 mt-3"},g={class:"d-flex align-items-center gap-3"},w=u((()=>(0,t._)("i",{class:"bi bi-plus me-2"},null,-1))),f=(0,t.Uk)("Add New "),h=[w,f],k={class:"ms-auto col-xl-5 col-lg-6 col-md-8 col-sm-10"},x={class:"widget-content p-4"},C={class:"row"},S={class:"col-md-3 col-sm-6 col-6"},U={class:"widget widget-statistics h-100 shadow card"},H=u((()=>(0,t._)("p",{class:"w-title mb-2 text-muted"},"All",-1))),V={class:"w-stats text-info fs-3 fw-bold"},M={class:"col-md-3 col-sm-6 col-6"},q={class:"widget widget-statistics h-100 shadow card"},T=u((()=>(0,t._)("p",{class:"w-title mb-2 text-muted"},"Total Machines",-1))),A={class:"w-stats text-primary fs-3 fw-bold"},E={class:"col-md-3 col-sm-6 col-6"},R={class:"widget widget-statistics h-100 shadow card"},D=u((()=>(0,t._)("p",{class:"w-title mb-2 text-muted"},"Total Vehicles",-1))),j={class:"w-stats text-success fs-3 fw-bold"},L={class:"col-md-3 col-sm-6 col-6"},z={class:"widget widget-statistics h-100 shadow card"},I=u((()=>(0,t._)("p",{class:"w-title mb-2 text-muted"},"Total Supervision",-1))),N={class:"w-stats text-dark fs-3 fw-bold"},W={class:"mt-3 mx-2"},B=["onSubmit"],O=u((()=>(0,t._)("h3",{class:"text-center"},"MACHINE REGISTRATION ",-1))),$={class:"row mb-2"},P={class:"col-md-4"},F=u((()=>(0,t._)("label",{class:"form-label"},"Registration No",-1))),J={class:"col-md-4"},Z=u((()=>(0,t._)("label",{class:"form-label"},"Category ",-1))),G={class:"col-md-4"},K=u((()=>(0,t._)("label",{class:"form-label"},"Select Type ",-1))),Q={class:"row mb-2"},X={class:"col-md-4"},Y=u((()=>(0,t._)("label",{class:"form-label"},"Average Ratio",-1))),ee={class:"col-md-4"},ae=u((()=>(0,t._)("label",{class:"form-label"},"Capacity",-1))),le={class:"col-md-4"},te=u((()=>(0,t._)("label",{class:"form-label"},"Reserve Litre",-1))),se=u((()=>(0,t._)("div",{class:"d-flex gap-2 justify-content-end"},[(0,t._)("button",{type:"submit",class:"btn btn-primary"},"Register"),(0,t._)("button",{type:"button",class:"btn btn-danger",onclick:"document.getElementById('consumer').style.display='none'"},"Cancel")],-1))),oe={class:"toast-container position-fixed top-0 end-0 p-3",style:{"z-index":"11"}},ie={class:"toast align-items-center text-dark border-0",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast",style:{"background-color":"#afe8fa"}},ce=u((()=>(0,t._)("div",{class:"d-flex"},[(0,t._)("div",{class:"toast-body"}," Registration successful! Redirecting to user/home... "),(0,t._)("button",{type:"button",class:"btn-close btn-close-dark me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"})],-1))),de=[ce],ne={key:2,class:"row layout-top-spacing"},re={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},ue={class:"panel br-6 p-0"},ve={class:"custom-table"},me={class:"actions text-center"},pe={class:"btn-group",role:"group"},be=["onClick"],_e=u((()=>(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},[(0,t._)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t._)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1))),ye=[_e],ge={class:"modal fade mymodal",id:"asset-edit-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"editAssetModalLabel","aria-hidden":"true"},we={class:"modal-dialog modal-xl"},fe={class:"modal-content"},he={class:"modal-header"},ke=u((()=>(0,t._)("h1",{class:"modal-title fs-5",id:"editAssetModalLabel"},"Edit Asset",-1))),xe={class:"modal-body"},Ce={class:"row mb-3"},Se={class:"col-md-3"},Ue=u((()=>(0,t._)("label",{class:"form-label"},"Name",-1))),He={class:"col-md-3"},Ve=u((()=>(0,t._)("label",{class:"form-label"},"Category",-1))),Me={class:"col-md-3"},qe=u((()=>(0,t._)("label",{class:"form-label"},"Type",-1))),Te={class:"col-md-3"},Ae=u((()=>(0,t._)("label",{class:"form-label"},"Ratio",-1))),Ee={class:"col-md-4"},Re=u((()=>(0,t._)("label",{class:"form-label"},"Capacity",-1))),De={class:"col-md-4"},je=u((()=>(0,t._)("label",{class:"form-label"},"Reserve Litre",-1))),Le={class:"col-md-4"},ze=u((()=>(0,t._)("label",{class:"form-label"},"Consuption Type",-1))),Ie={class:"modal-footer"},Ne=["disabled"],We={key:0,class:"spinner-border spinner-border-sm text-white me-2",role:"status"},Be={key:1};var Oe={setup(e){(0,n.j)({title:"Default Order Sorting Table"});const a=(0,s.iH)(""),l=(0,s.iH)(null),c=(0,s.iH)(!1),u=(0,s.iH)([]),w=(0,s.iH)([]),f=JSON.parse(localStorage.getItem("user")).permissions,ce=(0,s.iH)(["SNo","id","name","type","consuption","capacity","ratio","reserve_litre","actions"]),_e=(0,s.iH)([]),Oe=(0,s.iH)(!1),$e=(0,s.iH)(!1),Pe=(0,s.iH)(""),Fe=(0,t.f3)("loadingIndicator"),Je=(0,t.f3)("showMessage"),Ze=(0,t.f3)("showError"),Ge=(0,s.iH)({perPage:100,perPageValues:[100,200,500],skin:"table table-hover",columnsClasses:{actions:"actions text-center"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},sortable:["SNo","name","type","ratio","capacity","reserve_litre"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},resizableColumns:!1}),Ke=r.Z.create({baseURL:"https://bushman.ink/api/v1/"}),Qe=async()=>{Oe.value=!0,Ke.get("/machines").then((e=>{da.value=e.data.filter((e=>1===e.category_id)).length,ca.value=e.data.filter((e=>2===e.category_id)).length,na.value=e.data.filter((e=>3===e.category_id)).length,ra.value=e.data.length,Array.isArray(e.data)&&(w.value=e.data.map(((e,a)=>({...e,SNo:a+1,id:e.id,name:e.name,type:e.type_name,make:e.make,fuel_type:e.fuel_type,model:e.model,type_id:e.type_id,ratio:e.ratio,category:1===e.category_id?"machine":2===e.category_id?"vehicle":3===e.category_id?"supervision":"no category",capacity:e.capacity,category_id:e.category_id,reserve_litre:e.reserve_litre,consuption:e.consuption_type}))),u.value=[...w.value])})).catch((e=>{console.error("Error fetching machine data:",e.message)})).finally((()=>{Oe.value=!1}))},Xe=()=>{l.value=null,u.value=[...w.value],c.value=!1},Ye=(e,t)=>{l.value===e?(l.value=null,u.value=[...w.value],c.value=!1):(l.value=e,u.value=w.value.filter((a=>a.category_id===e)),c.value=!0,a.value=t)},ea=()=>{Oe.value=!0,Ke.get("/machine-types").then((e=>{Array.isArray(e.data)?_e.value=e.data:console.error("Invalid response format")})).catch((e=>{console.error("Error fetching machine types:",e.message)})).finally((()=>{Oe.value=!1}))},aa=(0,s.iH)(""),la=(0,s.iH)(""),ta=(0,s.iH)(""),sa=(0,s.iH)(""),oa=(0,s.iH)(""),ia=(0,s.iH)(""),ca=(0,s.iH)(0),da=(0,s.iH)(0),na=(0,s.iH)(0),ra=(0,s.iH)(0),ua=()=>{$e.value=!1,Oe.value=!0;const e={name:aa.value,type_name:la.value.name,type_id:la.value.id,category_id:ia.value.id,ratio:ta.value,capacity:sa.value,reserve_litre:oa.value};Ke.post("/machines",e).then((e=>{ma(),Qe(),Oe.value=!1,console.log("type name",la.value.name)})).catch((e=>{console.error("Error registering machine",e)}))},va=async()=>{Oe.value=!0;const e={name:aa.value,type_name:la.value.name,type_id:la.value.id,category_id:ia.value,ratio:ta.value,capacity:sa.value,reserve_litre:oa.value,consuption_type:Pe.value.name};try{await Ke.put(`/machines/${pa.value}`,e);ma(),Qe(),document.getElementById("close_editing").click(),Je("Updated successfully")}catch(a){console.error(a),Ze(a.message)}finally{Oe.value=!1}},ma=()=>{aa.value="",ia.value="",la.value="",ta.value="",sa.value="",oa.value=""},pa=(0,s.iH)(null),ba=e=>{pa.value=e.id,aa.value=e.name,ia.value=e.category_id;const a=_e.value.find((a=>a.id===e.type_id));la.value=a||"",ta.value=e.ratio,sa.value=e.capacity,oa.value=e.reserve_litre};(0,t.bv)((()=>{Qe(),ea()}));(0,s.iH)(null);return(e,a)=>{const c=(0,t.up)("router-link"),n=(0,t.up)("v-client-table");return(0,t.wg)(),(0,t.iD)("div",v,[m,Oe.value?((0,t.wg)(),(0,t.iD)("div",{key:0,class:"mt-5",innerHTML:(0,s.SU)(Fe)()},null,8,p)):(0,t.kq)("",!0),Oe.value?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",b,[(0,t._)("div",_,[(0,t._)("div",y,[(0,t._)("div",g,[(0,s.SU)(f).includes("can_register_asset")?((0,t.wg)(),(0,t.iD)("button",{key:0,class:"btn btn-primary px-4 py-2",onClick:a[0]||(a[0]=e=>$e.value=!$e.value)},h)):(0,t.kq)("",!0)])]),(0,t._)("div",k,[(0,t._)("div",{class:"widget widget-statistics h-100 shadow card",onClick:a[4]||(a[4]=(...a)=>e.navigateToMachines&&e.navigateToMachines(...a)),style:{cursor:"pointer"}},[(0,t._)("div",x,[(0,t._)("div",C,[(0,t._)("div",S,[(0,t._)("div",U,[(0,t._)("div",{class:(0,o.C_)(["w-detail",{"active-filter":null===l.value}]),onClick:Xe},[H,(0,t._)("p",V,(0,o.zw)(ra.value),1)],2)])]),(0,t._)("div",M,[(0,t._)("div",q,[(0,t._)("div",{class:(0,o.C_)(["w-detail",{"active-filter":1===l.value}]),onClick:a[1]||(a[1]=e=>Ye(1,"machine"))},[T,(0,t._)("p",A,(0,o.zw)(da.value),1)],2)])]),(0,t._)("div",E,[(0,t._)("div",R,[(0,t._)("div",{class:(0,o.C_)(["w-detail",{"active-filter":2===l.value}]),onClick:a[2]||(a[2]=e=>Ye(2,"vehicle"))},[D,(0,t._)("p",j,(0,o.zw)(ca.value),1)],2)])]),(0,t._)("div",L,[(0,t._)("div",z,[(0,t._)("div",{class:(0,o.C_)(["w-detail",{"active-filter":3===l.value}]),onClick:a[3]||(a[3]=e=>Ye(3,"supervision"))},[I,(0,t._)("p",N,(0,o.zw)(na.value),1)],2)])])])])])])])])),(0,t._)("div",W,[$e.value?((0,t.wg)(),(0,t.iD)("form",{key:0,class:"p-3 border rounded bg-white shadow",id:"consumer",onSubmit:(0,i.iM)(ua,["prevent"])},[O,(0,t._)("div",$,[(0,t._)("div",P,[F,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[5]||(a[5]=e=>aa.value=e),name:"Machine_name",required:""},null,512),[[i.nr,aa.value]])]),(0,t._)("div",J,[Z,(0,t.Wm)((0,s.SU)(d()),{modelValue:ia.value,"onUpdate:modelValue":a[6]||(a[6]=e=>ia.value=e),options:[{id:"1",name:"Machine"},{id:"2",name:"Vehicle"},{id:"3",name:"Supervision"}],label:"name","track-by":"id",placeholder:"Select Category",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue"])]),(0,t._)("div",G,[K,(0,t.Wm)((0,s.SU)(d()),{modelValue:la.value,"onUpdate:modelValue":a[7]||(a[7]=e=>la.value=e),options:_e.value,label:"name","track-by":"id",placeholder:"Select Type",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])])]),(0,t._)("div",Q,[(0,t._)("div",X,[Y,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control","onUpdate:modelValue":a[8]||(a[8]=e=>ta.value=e),name:"ratio",step:"any"},null,512),[[i.nr,ta.value]])]),(0,t._)("div",ee,[ae,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control","onUpdate:modelValue":a[9]||(a[9]=e=>sa.value=e),name:"capacity",required:"",step:"any"},null,512),[[i.nr,sa.value]])]),(0,t._)("div",le,[te,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control","onUpdate:modelValue":a[10]||(a[10]=e=>oa.value=e),name:"reserve_litre",required:"",step:"any"},null,512),[[i.nr,oa.value]])])]),se],40,B)):(0,t.kq)("",!0)]),(0,t._)("div",oe,[(0,t._)("div",ie,de,512)]),Oe.value?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",ne,[(0,t._)("div",re,[(0,t._)("div",ue,[(0,t._)("div",ve,[(0,t.Wm)(n,{data:u.value,columns:ce.value,options:Ge.value},{actions:(0,t.w5)((e=>[(0,t._)("div",me,[(0,t._)("div",pe,[(0,s.SU)(f).includes("is_programmer")?((0,t.wg)(),(0,t.iD)("button",{key:0,type:"button",class:"btn btn-sm btn-outline-success me-1",onClick:a=>ba(e.row),"data-bs-toggle":"modal","data-bs-target":"#asset-edit-modal",title:"Edit"},ye,8,be)):(0,t.kq)("",!0),e.row.consumptions_count?((0,t.wg)(),(0,t.j4)(c,{key:1,to:`/assets/fuel-statement/${e.row.id}`,class:"btn btn-sm btn-primary me-1 text-nowrap"},{default:(0,t.w5)((()=>[(0,t.Uk)(" FUEL ("+(0,o.zw)(e.row.consumptions_count)+") ",1)])),_:2},1032,["to"])):(0,t.kq)("",!0),e.row.job_cards_count?((0,t.wg)(),(0,t.j4)(c,{key:2,to:`/asset/jobcards/${e.row.id}`,class:"btn btn-sm btn-secondary me-1 text-nowrap"},{default:(0,t.w5)((()=>[(0,t.Uk)(" JOBCARDS ("+(0,o.zw)(e.row.job_cards_count)+") ",1)])),_:2},1032,["to"])):(0,t.kq)("",!0),e.row.bincards_count?((0,t.wg)(),(0,t.j4)(c,{key:3,to:`/asset/bincards/${e.row.id}`,class:"btn btn-sm btn-dark text-nowrap"},{default:(0,t.w5)((()=>[(0,t.Uk)(" Fuel Manager ("+(0,o.zw)(e.row.bincards_count)+") ",1)])),_:2},1032,["to"])):(0,t.kq)("",!0)])])])),_:1},8,["data","columns","options"])])])])])),(0,t._)("div",ge,[(0,t._)("div",we,[(0,t._)("div",fe,[(0,t._)("div",he,[ke,(0,t._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:a[11]||(a[11]=e=>ma())})]),(0,t._)("form",{onSubmit:a[20]||(a[20]=(0,i.iM)((e=>va()),["prevent"]))},[(0,t._)("div",xe,[(0,t._)("div",Ce,[(0,t._)("div",Se,[Ue,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[12]||(a[12]=e=>aa.value=e)},null,512),[[i.nr,aa.value]])]),(0,t._)("div",He,[Ve,(0,t.Wm)((0,s.SU)(d()),{modelValue:ia.value,"onUpdate:modelValue":a[13]||(a[13]=e=>ia.value=e),options:[{id:"1",name:"Machine"},{id:"2",name:"Vehicle"},{id:"3",name:"Supervision"}],label:"name","track-by":"id",placeholder:"Select Category",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue"])]),(0,t._)("div",Me,[qe,(0,t.Wm)((0,s.SU)(d()),{modelValue:la.value,"onUpdate:modelValue":a[14]||(a[14]=e=>la.value=e),options:_e.value,label:"name","track-by":"id",placeholder:"Select Type",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])]),(0,t._)("div",Te,[Ae,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control bg-white",step:"any","onUpdate:modelValue":a[15]||(a[15]=e=>ta.value=e)},null,512),[[i.nr,ta.value]])]),(0,t._)("div",Ee,[Re,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control bg-white",step:"any","onUpdate:modelValue":a[16]||(a[16]=e=>sa.value=e)},null,512),[[i.nr,sa.value]])]),(0,t._)("div",De,[je,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control bg-white","onUpdate:modelValue":a[17]||(a[17]=e=>oa.value=e)},null,512),[[i.nr,oa.value]])]),(0,t._)("div",Le,[ze,(0,t.Wm)((0,s.SU)(d()),{modelValue:Pe.value,"onUpdate:modelValue":a[18]||(a[18]=e=>Pe.value=e),options:[{id:"1",name:"Km/Litre"},{id:"2",name:"Litre/hr"}],label:"name","track-by":"id",placeholder:"Select Consumption Type",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue"])])])]),(0,t._)("div",Ie,[(0,t._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:a[19]||(a[19]=e=>ma()),id:"close_editing"},"Close"),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:Oe.value},[Oe.value?((0,t.wg)(),(0,t.iD)("span",We)):((0,t.wg)(),(0,t.iD)("span",Be,"Edit"))],8,Ne)])],32)])])])])}}},$e=l(83744);const Pe=(0,$e.Z)(Oe,[["__scopeId","data-v-0ecddadf"]]);var Fe=Pe}}]);
//# sourceMappingURL=6511.408399dc.js.map