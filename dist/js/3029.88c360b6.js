"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[3029],{13029:function(e,a,l){l.r(a),l.d(a,{default:function(){return ge}});l(26699);var t=l(66252),s=l(3577),i=l(2262),n=l(49963),r=l(87066),o=l(56296),d=l(26212),c=l.n(d),u=l(42119);const v={class:"layout-px-spacing"},m=(0,t.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Assets</a></li><li class="breadcrumb-item active" aria-current="page"><span>Fuel Cards </span></li></ol></nav></div></li></ul>',1),p={key:0,class:"text-center"},b={class:"d-flex me-4 mt-2"},_={class:"ms-auto"},g=["disabled"],w=["innerHTML"],h=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-clockwise",viewBox:"0 0 16 16"},[(0,t._)("path",{"fill-rule":"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),(0,t._)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})],-1),f=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,t._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),y=[f],k=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,t._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,t._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),H=[k],E=(0,t._)("h4",{class:"text-center"},"REGISTER NEW RECORD",-1),x={class:"row mb-2"},C={class:"col-md-2"},M=(0,t._)("label",{class:"form-label"},"Date",-1),S={class:"col-md-2"},U=(0,t._)("label",{class:"form-label"},"Operation",-1),R={class:"col-md-3"},V={class:"form-label"},q={class:"col-md-3"},T=(0,t._)("label",{class:"form-label"},"Initial Odometer Reading",-1),z={class:"col-md-2"},D=(0,t._)("label",{class:"form-label"},"Expected Ratio",-1),I={class:"col-md-3"},L=(0,t._)("label",{class:"form-label"},"Work Target ",-1),N={class:"col-md-3"},A=(0,t._)("label",{class:"form-label"},"Work Unit",-1),W={class:"col-md-6"},O=(0,t._)("label",{class:"form-label"},"Task",-1),F={class:"text-center gap-2 justify-content-end"},j=["disabled"],B={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},$={key:1},J=["innerHTML"],P={key:3,class:"row layout-top-spacing"},G={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},K={class:"panel p-0"},Z={class:"custom-table table3"},Q={class:"actions text-center"},X=["onClick"],Y=(0,t._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"text-success"},[(0,t._)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t._)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),ee=[Y],ae={class:"modal fade mymodal",id:"bincardTransactions-edit-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"bincardTransactionsEditModalLabel","aria-hidden":"true"},le={class:"modal-dialog modal-md"},te={class:"modal-content"},se=(0,t._)("div",{class:"modal-header"},[(0,t._)("h1",{class:"modal-title fs-5",id:"bincardTransactionsEditModalLabel"},"Update Work Covered"),(0,t._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close_editing"})],-1),ie={class:"modal-body"},ne={class:"row mb-3"},re={class:"col-md-6"},oe=(0,t._)("label",{class:"form-label"},"Final Reading",-1),de={class:"col-md-6"},ce=(0,t._)("label",{class:"form-label"},"Work Covered (KM)",-1),ue={class:"modal-footer"},ve=["disabled"],me={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},pe={key:1};var be={setup(e){(0,o.j)({title:"Asset Fuel Manager"});const a=(0,u.yj)(),l=(0,t.f3)("showMessage"),d=(0,t.f3)("showError"),f=JSON.parse(localStorage.getItem("user")).permissions,k=(0,t.f3)("tableShimmer");JSON.parse(localStorage.getItem("user"));const Y=(0,t.f3)("loadingSpinner"),be=(0,i.iH)(!1),_e=(0,t.f3)("printBinCard"),ge=(0,i.iH)(["Sno","date","action","quantity","task","initial_reading","final_reading","reading_difference","expected_ratio","work_target","work_covered","balance","actions"]),we=(0,i.iH)([]),he=(0,i.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","date","fuel_required","distance_cover","expected_ratio","expected_trips","trips_covered","fuel_balance"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),fe=r.Z.create({baseURL:"https://bushman.ink/api/v1/"}),ye=(0,i.iH)(""),ke=async()=>{Ce.value=!0;try{const e=await fe.get(`asset-bincards?asset_id=${a.params.asset_id}`);ye.value=e.data,we.value=e.data.transactions.map(((a,l)=>({Sno:l+1,...a,action:a.description,expected_ratio:a.ratio,reading_difference:a.final_reading-a.initial_reading>=0?a.final_reading-a.initial_reading+" "+e.data.asset.consuption_type:"---"})))}catch(e){d(e.message)}finally{Ce.value=!1}},He=(0,i.iH)([]),Ee=(0,i.iH)(""),xe=async()=>{Ce.value=!0;const e=await fe.get("units");He.value=e.data},Ce=(0,i.iH)(!1),Me=((0,i.iH)(""),(0,i.iH)("")),Se=(0,i.iH)(""),Ue=(0,i.iH)(""),Re=((0,i.iH)(""),(0,i.iH)(""),(0,i.iH)("")),Ve=(0,i.iH)(""),qe=((0,i.iH)(""),(0,i.iH)("")),Te=(0,i.iH)(""),ze=async()=>{Ce.value=!0;const e={asset_bincard_id:ye.value.id,registrar_id:JSON.parse(localStorage.getItem("user")).id,direction:Oe.value.id,unit:Ee.value.short_name,description:`${"INCREMENT"===Oe.value.id?"Received":"Issued"}${Me.value?" - "+Me.value:""}`,task:Te.value,quantity:qe.value,date:Re.value,ratio:Ue.value,work_target:Ve.value,initial_reading:Se.value};try{await fe.post("asset-bincard-transactions",e);ke(),l("Record registered successfully!"),De()}catch(a){console.log(a),d(a.message)}finally{Ce.value=!1}},De=()=>{be.value=!1,Oe.value="",Te.value="",qe.value="",Re.value="",Ue.value="",Ve.value="",Me.value="",Se.value=""},Ie=(0,i.iH)(null),Le=(0,i.iH)(""),Ne=e=>{Ae.value=e.work_covered,Ie.value=e.id,null===e.final_reading?Le.value=e.initial_reading:Le.value=e.final_reading,console.log(e.final_reading)},Ae=(0,i.iH)(""),We=async()=>{Ce.value=!0;const e={work_covered:Ae.value,final_reading:Le.value};try{await fe.put(`asset-bincard-transactions/${Ie.value}`,e);ke(),l("Record updated successfully!"),document.getElementById("close_editing").click()}catch(a){console.log(a),d(a.message)}finally{Ce.value=!1}},Oe=(0,i.iH)(""),Fe=(0,i.iH)([{id:"INCREMENT",name:"Received"},{id:"DECREMENT",name:"Issuing"}]);(0,i.iH)(!1);return(0,t.bv)((()=>{ke(),xe()})),(e,l)=>{const r=(0,t.up)("v-client-table");return(0,t.wg)(),(0,t.iD)("div",v,[m,ye.value?((0,t.wg)(),(0,t.iD)("h3",p,"FUEL MANAGEMENT FILE FOR "+(0,s.zw)(ye.value.asset.name)+" "+(0,s.zw)(ye.value.asset.type_name),1)):(0,t.kq)("",!0),(0,t._)("div",b,[(0,t._)("div",_,[(0,t._)("button",{class:(0,s.C_)(["btn btn-primary refresh-btn rounded-circle p-2 me-2",{"spin-animation":Ce.value}]),onClick:l[0]||(l[0]=e=>ke()),title:"Refresh page",disabled:Ce.value,style:{width:"2.5rem",height:"2.5rem"}},[Ce.value?((0,t.wg)(),(0,t.iD)("span",{key:0,innerHTML:(0,i.SU)(Y)()},null,8,w)):(0,t.kq)("",!0),h],10,g),(0,i.SU)(f).includes("can_register_asset_bincard")?((0,t.wg)(),(0,t.iD)("button",{key:0,class:"btn btn-primary me-2",onClick:l[1]||(l[1]=e=>be.value=!be.value)},y)):(0,t.kq)("",!0),(0,i.SU)(f).includes("can_print_asset_bincard")?((0,t.wg)(),(0,t.iD)("button",{key:1,class:"btn btn-success",onClick:l[2]||(l[2]=e=>(0,i.SU)(_e)((0,i.SU)(a).params.asset_id))},H)):(0,t.kq)("",!0)])]),be.value?((0,t.wg)(),(0,t.iD)("form",{key:1,class:"mt-3 p-3 border rounded bg-white shadow",onSubmit:l[12]||(l[12]=(0,n.iM)((e=>ze()),["prevent"]))},[E,(0,t._)("div",x,[(0,t._)("div",C,[M,(0,t.wy)((0,t._)("input",{type:"date",class:"form-control","onUpdate:modelValue":l[3]||(l[3]=e=>Re.value=e),required:""},null,512),[[n.nr,Re.value]])]),(0,t._)("div",S,[U,(0,t.Wm)((0,i.SU)(c()),{modelValue:Oe.value,"onUpdate:modelValue":l[4]||(l[4]=e=>Oe.value=e),options:Fe.value,label:"name",placeholder:"Select An Operation",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])]),(0,t._)("div",R,[(0,t._)("label",V,(0,s.zw)(Oe.value.name)+" Amount (LTs)",1),(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Amount","onUpdate:modelValue":l[5]||(l[5]=e=>qe.value=e),required:"",step:"any"},null,512),[[n.nr,qe.value]])]),(0,t._)("div",q,[T,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Initial Reading","onUpdate:modelValue":l[6]||(l[6]=e=>Se.value=e),required:""},null,512),[[n.nr,Se.value]])]),(0,t._)("div",z,[D,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Expected Ratio","onUpdate:modelValue":l[7]||(l[7]=e=>Ue.value=e),required:"",step:"any"},null,512),[[n.nr,Ue.value]])]),(0,t._)("div",I,[L,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Work Target","onUpdate:modelValue":l[8]||(l[8]=e=>Ve.value=e),required:""},null,512),[[n.nr,Ve.value]])]),(0,t._)("div",N,[A,(0,t.Wm)((0,i.SU)(c()),{modelValue:Ee.value,"onUpdate:modelValue":l[9]||(l[9]=e=>Ee.value=e),options:He.value,label:"short_name",placeholder:"Select Unit",searchable:!0,"close-on-select":!0,required:""},null,8,["modelValue","options"])]),(0,t._)("div",W,[O,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Enter Task","onUpdate:modelValue":l[10]||(l[10]=e=>Te.value=e),step:"any",required:""},null,512),[[n.nr,Te.value]])])]),(0,t._)("div",F,[(0,t._)("button",{type:"button",class:"btn btn-danger me-3",onClick:l[11]||(l[11]=e=>{be.value=!1,De()})},"Cancel"),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:Ce.value},[Ce.value?((0,t.wg)(),(0,t.iD)("span",B)):((0,t.wg)(),(0,t.iD)("span",$,"Register"))],8,j)])],32)):(0,t.kq)("",!0),Ce.value?((0,t.wg)(),(0,t.iD)("div",{key:2,innerHTML:(0,i.SU)(k)()},null,8,J)):((0,t.wg)(),(0,t.iD)("div",P,[(0,t._)("div",G,[(0,t._)("div",K,[(0,t._)("div",Z,[(0,t.Wm)(r,{data:we.value,columns:ge.value,options:he.value},{actions:(0,t.w5)((e=>[(0,t._)("div",Q,[(0,t._)("a",{href:"javascript:;",class:"edit me-3",onClick:a=>Ne(e.row),"data-bs-toggle":"modal","data-bs-target":"#bincardTransactions-edit-modal"},ee,8,X)])])),work_target:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(e.row.work_target)+" "+(0,s.zw)(e.row.unit),1)])),work_covered:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(e.row.work_covered??0)+" "+(0,s.zw)(e.row.unit),1)])),_:1},8,["data","columns","options"])])])])])),(0,t._)("div",ae,[(0,t._)("div",le,[(0,t._)("div",te,[se,(0,t._)("form",{onSubmit:l[16]||(l[16]=(0,n.iM)((e=>We()),["prevent"]))},[(0,t._)("div",ie,[(0,t._)("div",ne,[(0,t._)("div",re,[oe,(0,t.wy)((0,t._)("input",{type:"text",placeholder:"Enter FInal Reading",class:"form-control","onUpdate:modelValue":l[13]||(l[13]=e=>Le.value=e),required:""},null,512),[[n.nr,Le.value]])]),(0,t._)("div",de,[ce,(0,t.wy)((0,t._)("input",{type:"number",class:"form-control",placeholder:"Enter Work Covered","onUpdate:modelValue":l[14]||(l[14]=e=>Ae.value=e),step:"any",required:""},null,512),[[n.nr,Ae.value]])])])]),(0,t._)("div",ue,[(0,t._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:l[15]||(l[15]=e=>De()),id:"close_editing"},"Close"),(0,t._)("button",{type:"submit",class:"btn btn-primary",disabled:Ce.value},[Ce.value?((0,t.wg)(),(0,t.iD)("span",me)):((0,t.wg)(),(0,t.iD)("span",pe,"Update"))],8,ve)])],32)])])])])}}};const _e=be;var ge=_e}}]);
//# sourceMappingURL=3029.88c360b6.js.map