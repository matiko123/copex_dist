{"version":3,"file":"js/5138.8f6cb3ff.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/hr/employees/payroll.vue","webpack://cork-vue3/./src/views/hr/employees/payroll.vue?2875"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">HR</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Employees Absence</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n<!-- compamy settings starts -->\r\n    <teleport to=\"#breadcrumb\">\r\n         <ul class=\"navbar-nav flex-row ms-auto\">\r\n                <li class=\"nav-item more-dropdown\">\r\n                    <div class=\"dropdown custom-dropdown-icon\">\r\n                        <a href=\"javascript:;\" class=\"nav-link dropdown-toggle\" id=\"ddlSettings\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                            <span>Select a company</span>\r\n                            <svg\r\n                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                width=\"24\"\r\n                                height=\"24\"\r\n                                viewBox=\"0 0 24 24\"\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                stroke-width=\"2\"\r\n                                stroke-linecap=\"round\"\r\n                                stroke-linejoin=\"round\"\r\n                                class=\"feather feather-chevron-down\"\r\n                            >\r\n                                <polyline points=\"6 9 12 15 18 9\"></polyline>\r\n                            </svg>\r\n                        </a>\r\n                        <ul class=\"dropdown-menu dropdown-menu-end\" aria-labelledby=\"ddlSettings\">\r\n                            <li v-for=\"company in companies\" @click=\"getData(company)\"><a class=\"dropdown-item\" data-value=\"Mail\" href=\"javascript:void(0);\">{{ company.name }}</a></li>\r\n                        </ul>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n    </teleport>\r\n\r\n <h4 class=\"text-center\" v-if=\"company\">\r\n  {{ title }} {{ selectedMonth ? ' FOR ' + selectedMonth :'' }}\r\n\r\n    <div class=\"d-flex justify-content-center mb-3 mt-3\">\r\n\r\n    <div class=\"btn-group\" v-if=\"user_permissions.includes('can_approve_payroll') && (payroll?.status?.name  !== 'approved' || payroll === null) && !loading_spinner\">\r\n      <button v-if=\"selectedEmployee?.status?.name !=='approved'\" class=\"btn btn-primary me-2\" @click=\"status = 3\" :disabled=\"spinner\">Approve </button>\r\n      <button class=\"btn btn-danger me-2\" @click=\"status = 4\" :disabled=\"spinner\">Reject</button>\r\n      <button class=\"btn btn-warning me-2\" @click=\"status = 17\" :disabled=\"spinner\">Hold </button>\r\n      <button class=\"btn btn-info me-2\" @click=\"status = 14\" :disabled=\"spinner\">Remark</button>\r\n    </div>\r\n  </div>\r\n\r\n  <div v-if=\"status\" class=\"mb-2 text-center\">\r\n    <span\r\n      class=\"badge rounded-pill\"\r\n      :class=\"{\r\n        'bg-danger': status == 4,\r\n        'bg-success': status == 3,\r\n        'bg-warning': status == 17,\r\n        'bg-info': status != 3 && status != 4\r\n      }\"\r\n      style=\"font-size: 1rem;\"\r\n    >\r\n      {{\r\n        status == 3\r\n          ? 'Approve Payroll'\r\n          : status == 17\r\n            ? 'Hold Payroll'\r\n          : status == 4\r\n          ? 'Reject Payroll'\r\n          : 'Fill Remark'\r\n      }}\r\n    </span>\r\n  </div>\r\n    <div class=\"text-start\" v-if=\"payroll && payroll?.remark\">\r\n      {{payroll.remarker.name }}'s Remark  {{ payroll.remark }}\r\n    </div>\r\n  <div class=\"input-group\" v-if=\"status\">\r\n\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control\"\r\n      :placeholder=\"status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark'\"\r\n      v-model=\"remark\"\r\n    >\r\n    <button class=\"btn btn-primary\" type=\"button\" :disabled=\"spinner\" @click=\"updatePayroll()\">\r\n      <span v-if=\"spinner\" v-html=\"loadingSpinner()\"></span>\r\n      <span v-else>Save</span>\r\n    </button>\r\n  </div>\r\n</h4>\r\n<h4 class=\"text-center\" v-else>SELECT A COMPANY</h4>\r\n\r\n\r\n <!-- company settings ends -->\r\n            <div class=\"d-flex me-4 mt-2 \">\r\n                        <div class=\"ms-auto\">\r\n                            <div class=\"input-group\">\r\n                            <input type=\"month\" class=\"form-control me-2\" v-model=\"selectedMonth\">\r\n                           <button class=\"btn btn-success \"\r\n                           v-if=\"payroll && user_permissions.includes('can_print_payroll')\"\r\n                             @click=\"printPayroll(employeesList)\" \r\n                            >                           \r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n  <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n</svg>\r\n</button>\r\n \r\n                            </div>\r\n\r\n                        </div>\r\n                    </div>  \r\n\r\n        <div class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n                    <div v-else class=\"custom-table table3\">\r\n                        <v-client-table :data=\"employeesList\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge inv-status\" :class=\"'badge-' + props.row?.status?.color\">\r\n                                    {{ props.row?.status?.name }}\r\n                                </span>\r\n                            </template>\r\n                            <template #actions=\"props\">\r\n                                <a href=\"javascript:void(0);\" class=\"text-primary\" @click=\"OpenEmployeeViewModal(props.row)\"  data-bs-toggle=\"modal\" data-bs-target=\"#employee-view-modal\" >\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\r\n                                      <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z\"/>\r\n                                      <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0\"/>\r\n                                    </svg>\r\n                                </a>\r\n                            </template>\r\n                           \r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n<!-- Employee View modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"employee-view-modal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"employeeViewModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"employeeViewModalLabel\">Employee Salary Details For {{ selectedEmployee?.name }}</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"clearForm()\" id=\"employee-status-close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <!-- Employee Information -->\r\n        <div class=\"row mb-3\" v-if=\"selectedEmployee\">\r\n          <div class=\"col-md-12\">\r\n             <div class=\"panel p-0\">\r\n            <div class=\"custom-table table3 table-responsive\">\r\n              <table class=\"table table-hover table-striped\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Employee Name</th>\r\n                    <th>Position</th>\r\n                    <th>Salary</th>\r\n                    <th>Debt</th>\r\n                    <th>Absent</th>\r\n                    <th>Payable</th>\r\n                    <th>Status</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr>\r\n                    <td>{{ selectedEmployee.name }}</td>\r\n                     <td>{{ selectedEmployee.position }}</td>\r\n                    <td>{{ selectedEmployee.salary }}</td>\r\n                     <td>{{ selectedEmployee.debt }}</td>\r\n                    <td>{{ selectedEmployee.absence }}</td>\r\n                     <td>{{ selectedEmployee.balance }}</td>\r\n                    <td>\r\n                      <span class=\"badge inv-status\" :class=\"'badge-' + selectedEmployee?.status?.color\">\r\n                        {{ selectedEmployee?.status?.name }}\r\n                      </span>\r\n                    </td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td colspan=\"7\" v-if=\"selectedEmployee?.remark\">\r\n                      Remark : {{ selectedEmployee.remark }}\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n\r\n\r\n\r\n\r\n        <!-- Employee Attachments Table -->\r\n\r\n<div v-if=\"user_permissions.includes('can_approve_payroll')  && selectedEmployee?.status?.name !=='paid'\">\r\n          <h5 class=\"mb-3 text-center\">Employee Salary Decision</h5><br>\r\n  <div class=\"d-flex justify-content-center mb-3\" >\r\n\r\n    <div class=\"btn-group\" >\r\n      <button v-if=\"selectedEmployee?.status?.name !=='approved'\" class=\"btn btn-primary me-2\" @click=\"status = 3\" :disabled=\"spinner\">Release </button>\r\n      <button class=\"btn btn-danger me-2\" @click=\"status = 4\" :disabled=\"spinner\">Reject</button>\r\n      <button class=\"btn btn-warning me-2\" @click=\"status = 17\" :disabled=\"spinner\">Hold Salary</button>\r\n      <button class=\"btn btn-info me-2\" @click=\"status = 14\" :disabled=\"spinner\">Remark</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n  <div v-if=\"status\" class=\"mb-2 text-center\">\r\n    <span\r\n      class=\"badge rounded-pill\"\r\n      :class=\"{\r\n        'bg-danger': status == 4,\r\n        'bg-success': status == 3,\r\n        'bg-warning': status == 17,\r\n        'bg-info': status != 3 && status != 4\r\n      }\"\r\n      style=\"font-size: 1rem;\"\r\n    >\r\n      {{\r\n        status == 3\r\n          ? 'Release Salary'\r\n          : status == 17\r\n            ? 'Hold Salary'\r\n          : status == 4\r\n          ? 'Reject Salary'\r\n          : 'Fill Remark'\r\n      }}\r\n    </span>\r\n  </div>\r\n\r\n  <div class=\"input-group\" v-if=\"status\">\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control\"\r\n      :placeholder=\"status == 3 ? 'Enter Approval Remark' : status == 4 ? 'Enter Rejection Remark' : 'Enter Remark'\"\r\n      v-model=\"remark\"\r\n    >\r\n    <button class=\"btn btn-primary\" type=\"button\" :disabled=\"spinner\" @click=\"updateSalaryStatus()\">\r\n      <span v-if=\"spinner\" v-html=\"loadingSpinner()\"></span>\r\n      <span v-else>Save</span>\r\n    </button>\r\n  </div>\r\n\r\n        \r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"clearForm()\">Close</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- Employee View modal ends -->\r\n\r\n\r\n\r\n\r\n\r\n <button style=\"display: none;\" id=\"biometric\" data-bs-toggle=\"modal\" data-bs-target=\"#biometric-update-modal\"></button>\r\n\r\n\r\n    </div>\r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref ,inject,watch } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    useMeta({ title: 'Custom Table' });\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n     const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const showMessage = inject('showMessage')\r\n    const showError = inject('showError')\r\n    const formatNumber = inject('formatNumber')\r\n    const formatDate = inject('formatDate')\r\n    const loadingSpinner = inject('loadingSpinner')\r\n    const printEmployeeList = inject('printEmployeeList')\r\n    const selectedMonth = ref('')\r\n    const today = new Date();\r\n    const year = today.getFullYear();\r\n    const month = String(today.getMonth() + 1).padStart(2, '0');\r\n    selectedMonth.value = `${year}-${month}`;\r\n    const tableShimmer = inject('tableShimmer');\r\n    const loading_spinner = ref(false);\r\n    const columns = ref(['Sno', 'name','position','salary','debt','absence','days_absent','balance','status','actions']);\r\n    const table_option = ref({\r\n        perPage: 50,\r\n        perPageValues: [ 50 , 100 , 200],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['id', 'service_name'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const company_id = ref('')\r\n    const status = ref('')\r\n    const remark = ref('')\r\n    const employeesList = ref([])\r\n\r\n    const payroll = ref('')\r\n  const getEmployees = async () => {\r\n        loading_spinner.value = true;\r\n        try{\r\n        const response = await axiosInstance.get(`employee-payrolls?company_id=${company_id.value}&month=${selectedMonth.value}`)\r\n        employeesList.value = response.data.employees.map((item,index)=>({\r\n         ...item,\r\n         Sno : index + 1,\r\n         salary : formatNumber(item.salary),\r\n         absence : item.absent_days === 0 ? '---': formatNumber(Math.round(item.salary_deduction / 1000) * 1000),\r\n         employee_salary : item.salary,\r\n         balance : formatNumber(Math.round((item.salary - item.salary_deduction - item.debt) / 1000) * 1000),\r\n         name : item.name.toUpperCase(),\r\n         days_absent : item.absent_days === 0 ? '---' : item.absent_days + ' days',\r\n         debt : item.debt === 0 ? '---' : formatNumber(item.debt),\r\n         debt_original :item.debt,\r\n         salary_original : item.salary,\r\n         position : item.position,\r\n         remark : item?.salary_status?.remark ?? '',\r\n         status : item?.salary_status?.status ??\r\n        item?.salary_status?.status ?? (response.data.payroll ? response.data.payroll.status : (response.data.payroll ? {\r\n              name : 'approved',\r\n              color : 'success'\r\n             } : {\r\n              name : 'Unapproved',\r\n              color : 'secondary'\r\n             }))\r\n        }))\r\n\r\n        payroll.value = response.data.payroll\r\n\r\n        }catch(error){\r\n            console.log(error)\r\n            showError(error.message)\r\n        }finally{\r\n            loading_spinner.value = false;\r\n        }\r\n    };\r\n\r\n        watch(selectedMonth, (newVal) => {\r\n    if (newVal) {\r\n       getEmployees()\r\n    }\r\n});\r\n\r\nconst clearForm = ()=>{\r\n    status.value = '',\r\n    remark.value = ''\r\n}\r\n    const selectedEmployee = ref(null)\r\n    const OpenEmployeeViewModal = async (row) => {\r\n        selectedEmployee.value = row;\r\n    };\r\n\r\n\r\nconst title = ref('SELECT A COMPANY')\r\nconst spinner = ref(false)\r\n\r\n   const getData = (data)=>{\r\n        company.value = data\r\n        company_id.value = company.value.id\r\n        getEmployees(); \r\n        title.value = company.value.name + ' EMPLOYEES PAYROLL'\r\n   }\r\n\r\nconst updateSalaryStatus = async () =>{\r\n    spinner.value = true\r\n    const payload = {\r\n        remark : remark.value,\r\n        status_id : status.value,\r\n        employee_id : selectedEmployee.value.id,\r\n        remarker_id : JSON.parse(localStorage.getItem(\"user\")).id,\r\n        month :selectedMonth.value\r\n    }\r\n    \r\n    try{\r\n        const response = await axiosInstance.post('employee-salary-statuses',payload)\r\n        showMessage(response.data.message)\r\n        document.getElementById('employee-status-close').click()\r\n        getEmployees()\r\n    }catch(error){\r\n        console.log(error)\r\n        showError(error.message)\r\n    }finally{\r\n        spinner.value = false\r\n    }\r\n\r\n}\r\n\r\nconst updatePayroll = async () =>{\r\n    spinner.value = true\r\n    const payload = {\r\n        remark : remark.value,\r\n        company_id : company.value.id,\r\n        status_id : status.value,\r\n        remarker_id : JSON.parse(localStorage.getItem(\"user\")).id,\r\n        month :selectedMonth.value\r\n    }\r\n    \r\n    try{\r\n        const response = await axiosInstance.post('employee-payrolls',payload)\r\n        showMessage(\"Payroll Updated\")\r\n        document.getElementById('employee-status-close').click()\r\n        getEmployees()\r\n    }catch(error){\r\n        console.log(error)\r\n        showError(error.message)\r\n    }finally{\r\n        spinner.value = false\r\n    }\r\n\r\n}\r\n\r\n\r\n   const printPayroll = async (data) => {\r\n  try {\r\nconst items = data\r\n\r\nconst totalCost = items.reduce((sum, item) => {\r\n  return item?.status?.name === 'approved' \r\n    ? sum + Number((item.salary_original - item.salary_deduction - item.debt_original) || 0)\r\n    : sum\r\n}, 0)\r\n\r\n    const iframe = document.createElement('iframe')\r\n    iframe.style.display = 'none'\r\n    document.body.appendChild(iframe)\r\n    \r\n    const printContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n<style>\r\n  body { font-family: 'Courier New', monospace; margin: 20px; font-size: 8px; }\r\n  .text-style { font-family: 'Courier New', monospace; }\r\n  .company-title { text-align: center; font-size: 9px; }\r\n  .company-title h1 { font-size: 14px; margin: 5px 0; }\r\n  .title { text-align: center; font-size: 12px; margin: 8px 0; font-weight: bold; }\r\n  table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 9px; }\r\n  th, td { border: 1px solid #000; padding: 3px 4px; }\r\n  th { background-color: #f0f0f0; font-weight: bold; }\r\n  .text-right { text-align: right; }\r\n  .text-center { text-align: center; }\r\n  .badge { padding: 2px 5px; border-radius: 2px; font-size: 8px; display: inline-block; }\r\n  .badge-success { background-color: #28a745; color: white; }\r\n  .badge-warning { background-color: #ffc107; color: black; }\r\n  .badge-danger { background-color: #dc3545; color: white; }\r\n  .badge-info { background-color: #17a2b8; color: white; }\r\n  hr { border: 0; border-top: 1px solid #000; margin: 8px 0; }\r\n  @media print { \r\n    body { margin: 5mm; } \r\n    table { page-break-inside: auto; }\r\n    tr { page-break-inside: avoid; page-break-after: auto; }\r\n  }\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"company-title text-style\">\r\n  <i>\r\n  <h1>${company.value.name}</h1>\r\n  <div><b>Address:</b> ${company.value.address}</div>\r\n  <div><b>Tel:</b> ${company.value.phone}, ${company.value.phone_2 ?? ''}</div>\r\n  <div><b>Email:</b> ${company.value.email}</div>\r\n  <div><b>TIN:</b> ${company.value.tin_no} &nbsp;&nbsp; <b>VRN:</b> ${company.value.vrn_no}</div>\r\n  </i>\r\n</div>\r\n\r\n<hr>\r\n\r\n<div class=\"title text-style\">\r\n  ${title.value} ON ${selectedMonth.value}\r\n</div>\r\n\r\n\r\n<hr>\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>S/No.</th>\r\n      <th>Name</th>\r\n      <th>Position</th>\r\n      <th>Salary</th>\r\n      <th>Debt</th>\r\n      <th>Absence</th>\r\n      <th>Absence Deduction</th>\r\n      <th>Balance</th>\r\n      <th>Signature</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${items.map((item, index) => `\r\n    <tr>\r\n      <td style=\"font-weight:bold\">${index + 1}</td>\r\n      <td style=\"font-weight:bold\">${item.name || 'N/A'}</td>\r\n      <td style=\"font-weight:bold\">${item.position || 'N/A'}</td>\r\n      <td style=\"font-weight:bold;text-align:end\">${item.salary || 'N/A'}</td>\r\n      <td style=\"font-weight:bold;text-align:end\">${item.debt || 'N/A'}</td>\r\n      <td style=\"font-weight:bold\">${item.days_absent || 'N/A'}</td>\r\n      <td style=\"font-weight:bold;text-align:end\">${ formatNumber(item.salary_deduction) || 'N/A'}</td>\r\n      <td style=\"font-weight:bold ;width:120px;text-align:end${item?.status?.name !== 'approved' ? ';text-decoration:line-through' : ''}\">${item.balance || 'N/A'}</td>\r\n      <td style=\"font-weight:bold ;width:120px;text-align:center\">${item?.status?.name === 'approved' ? ' ' : item?.status?.name || 'N/A'}</td>\r\n    </tr>\r\n    `).join('')}\r\n    <tr style=\"font-weight: bold;\">\r\n      <td colspan=\"7\" class=\"text-right\"><strong>TOTAL COST :</strong></td>\r\n      <td class=\"text-right\"><strong>${formatNumber(totalCost)}</strong></td>\r\n    </tr>\r\n\r\n  </tbody>\r\n</table>\r\n\r\n\r\n\r\n<div style=\"margin-top: 15px; font-size: 7px;\">\r\n  <p><strong>Report Generated:</strong> ${new Date().toLocaleString()}</p>\r\n  <p><strong>Generated By:</strong> ${JSON.parse(localStorage.getItem('user')).name}</p>\r\n</div>\r\n\r\n</body>\r\n</html>\r\n`;\r\n\r\n    const iframeDoc = iframe.contentWindow.document;\r\n    iframeDoc.open();\r\n    iframeDoc.write(printContent);\r\n    iframeDoc.close();\r\n\r\n    iframe.onload = () => {\r\n      iframe.contentWindow.focus();\r\n      iframe.contentWindow.print();\r\n      setTimeout(() => {\r\n        document.body.removeChild(iframe);\r\n      }, 1000);\r\n    };\r\n  } catch (error) {\r\n    showError(`Failed to print report: ${error.message}`);\r\n  }\r\n};\r\n\r\n    const companies = ref([])\r\n    const company = ref('')\r\n    const getCompanies = async()=>{\r\n      const response = await axiosInstance.get('companies')\r\n      companies.value = response.data\r\n    }\r\n    onMounted(async () => {\r\n       getCompanies()\r\n    });\r\n\r\n\r\n</script>","import script from \"./payroll.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./payroll.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./payroll.vue?vue&type=style&index=0&id=1a9e473b&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","axiosInstance","axios","baseURL","process","user_permissions","JSON","parse","localStorage","getItem","permissions","showMessage","inject","showError","formatNumber","loadingSpinner","selectedMonth","ref","today","Date","year","getFullYear","month","String","getMonth","padStart","value","tableShimmer","loading_spinner","columns","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","company_id","status","remark","employeesList","payroll","getEmployees","async","response","get","data","employees","map","item","index","Sno","salary","absence","absent_days","Math","round","salary_deduction","employee_salary","balance","debt","name","toUpperCase","days_absent","debt_original","salary_original","position","salary_status","color","error","console","log","message","watch","newVal","clearForm","selectedEmployee","OpenEmployeeViewModal","row","spinner","getData","company","id","updateSalaryStatus","payload","status_id","employee_id","remarker_id","post","document","getElementById","click","updatePayroll","printPayroll","items","totalCost","reduce","sum","Number","iframe","createElement","style","display","body","appendChild","printContent","address","phone","phone_2","email","tin_no","vrn_no","join","toLocaleString","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","companies","getCompanies","onMounted","__exports__"],"sourceRoot":""}