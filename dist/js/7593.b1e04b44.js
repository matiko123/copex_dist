"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[7593],{47593:function(a,t,e){e.r(t),e.d(t,{default:function(){return nt}});e(26699);var l=e(66252),s=e(3577),o=e(2262),d=e(49963),i=e(87066),n=e(26212),c=e.n(n);const r=a=>((0,l.dD)("data-v-edecfa24"),a=a(),(0,l.Cn)(),a),u={class:"layout-px-spacing"},b={class:"d-flex justify-content-between align-items-center"},m={class:"flex-grow-1 text-center"},_={class:"d-flex align-items-center justify-content-between mb-3"},v={class:"w-25 ms-auto"},p={key:0,class:"d-flex justify-content-end mb-2"},y={key:1,class:"d-flex justify-content-end mb-2"},g={key:2,class:"accordion accordion-flush",id:"accordionFlushExample"},w={class:"bg-dark mt-2 mb-2"},h={class:"text-center text-white m-0"},f={class:"d-flex mb-2"},k={class:"ms-auto"},x={class:"accordion-item",style:{border:"1px solid green"}},S={class:"accordion-header"},z=["data-bs-target","aria-controls"],D=["id"],C={class:"accordion-body"},q={class:"d-flex mb-2"},H={class:"ms-auto"},B=["onClick"],L=["id"],E={class:"accordion-item",style:{border:"1px solid orange"}},Y={class:"accordion-header"},j=["data-bs-target","aria-controls"],U=["id","data-bs-parent"],$={class:"accordion-body"},A={class:"d-flex mb-2"},M={class:"ms-auto"},Q=["onClick"],I=["id"],V={class:"accordion-item",style:{border:"1px solid blue"}},K={class:"accordion-header"},N=["data-bs-target","aria-controls"],O=["id","data-bs-parent"],R={class:"accordion-body"},T={class:"d-flex mb-2"},F={class:"ms-auto"},P=["onClick"],Z={class:"table table-bordered table-sm"},J=r((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"SN"),(0,l._)("th",null,"Name"),(0,l._)("th",null,"Unit"),(0,l._)("th",null,"Quantity"),(0,l._)("th",null,"Rate"),(0,l._)("th",null,"Total")])],-1))),W={class:"text-center"},G={class:"text-start"},X={class:"text-end"},aa={class:"text-end"},ta={key:0,class:"table table-bordered mt-4"},ea=r((()=>(0,l._)("thead",{class:"thead-light"},[(0,l._)("tr",null,[(0,l._)("th",{scope:"col",class:"text-dark"},"Code/SN"),(0,l._)("th",{scope:"col",class:"text-dark"},"Description"),(0,l._)("th",{scope:"col",class:"text-dark"},"Unit"),(0,l._)("th",{scope:"col",class:"text-dark"},"Quantity"),(0,l._)("th",{scope:"col",class:"text-dark"},"Rate"),(0,l._)("th",{scope:"col",class:"text-dark"},"Total")])],-1))),la={colspan:"6",class:"bg-dark text-white"},sa={colspan:"1",class:"text-center"},oa={colspan:"5",class:"text-start"},da={colspan:"1",class:"text-center"},ia={colspan:"5",class:"text-start"},na={class:"text-center"},ca={class:"text-start"},ra={class:"text-end"},ua={class:"text-end"},ba={colspan:"1",class:"text-center"},ma={colspan:"5",class:"text-start"},_a={class:"text-center"},va={class:"text-start"},pa={class:"text-end"},ya={class:"text-end"},ga={key:0},wa={key:4,class:"text-center"},ha={key:5,class:"text-center"},fa={class:"modal fade",id:"seriesModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},ka={class:"modal-dialog modal-xl modal-dialog-centered"},xa={class:"modal-content"},Sa={class:"modal-header"},za={class:"modal-title fs-5",id:"staticBackdropLabel"},Da=r((()=>(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close"},null,-1))),Ca=["onSubmit"],qa={class:"modal-body"},Ha=r((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary"},"submit")],-1))),Ba={class:"modal fade",id:"sectionModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},La={class:"modal-dialog modal-xl modal-dialog-centered"},Ea={class:"modal-content"},Ya={class:"modal-header"},ja={class:"modal-title fs-5",id:"staticBackdropLabel"},Ua=r((()=>(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeSection"},null,-1))),$a={class:"modal-body"},Aa=r((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary"},"submit")],-1))),Ma={class:"modal fade",id:"subSectionModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Qa={class:"modal-dialog modal-xl modal-dialog-centered"},Ia={class:"modal-content"},Va={class:"modal-header"},Ka={class:"modal-title fs-5",id:"staticBackdropLabel"},Na=r((()=>(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeSubSection"},null,-1))),Oa={class:"modal-body"},Ra=r((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary"},"submit")],-1))),Ta={class:"modal fade",id:"lineModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Fa={class:"modal-dialog modal-xl modal-dialog-centered"},Pa={class:"modal-content"},Za={class:"modal-header"},Ja={class:"modal-title fs-5",id:"staticBackdropLabel"},Wa=r((()=>(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeLine"},null,-1))),Ga={class:"modal-body"},Xa={class:"row"},at={class:"col-md-3"},tt={class:"col-md-3"},et={class:"col-md-3"},lt={class:"col-md-3"},st=r((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary"},"submit")],-1)));var ot={setup(a){const t=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),e=(0,l.f3)("showMessage"),n=(0,l.f3)("showError"),r=JSON.parse(localStorage.getItem("user")).permissions,ot=(0,o.iH)(!1),dt=(0,o.iH)(""),it=(0,o.iH)([]),nt=async()=>{try{const a=await t.get("/projects");if(a.data&&Array.isArray(a.data)){let t=a.data;r.includes("can_view_copex_lpo")&&r.includes("can_view_bushman_lpo")||(r.includes("can_view_copex_lpo")?t=t.filter((a=>6==a.company_id)):r.includes("can_view_bushman_lpo")&&(t=t.filter((a=>5==a.company_id)))),it.value=t}else console.error("Invalid response format")}catch(a){}};(0,l.YP)(dt,(a=>{rt(a.id)}));const ct=(0,o.iH)([]),rt=async a=>{try{const e=await t.get(`/boq?project_id=${a}`);ct.value=e.data.data}catch(e){}},ut=(0,o.iH)(""),bt=async()=>{try{const a={project_id:dt.value.id,name:ut.value},l=await t.post("/boq-series",a);ct.value.push({id:l.data.data?.id??Date.now(),name:a.name,sections:[]}),e("Series registered!"),document.getElementById("close").click(),ut.value=""}catch(a){n(a.message),console.log(a)}},mt=(0,o.iH)(""),_t=async()=>{try{const a={series_id:ut.value.id,name:mt.value},l=await t.post("/boq-sections",a),s=ct.value.find((a=>a.id===ut.value.id));s&&s.sections.push({id:l.data.id,name:a.name,sub_sections:[]}),e("Section Registered!"),document.getElementById("closeSection").click(),mt.value=""}catch(a){n(a.message),console.log(a)}},vt=(0,o.iH)(""),pt=async()=>{try{const a=await t.post("/boq-sub-sections",{name:vt.value,section_id:mt.value.id}),l=a.data;mt.value.sub_sections||(mt.value.sub_sections=[]),mt.value.sub_sections.push(l),vt.value="",document.getElementById("closeSubSection").click(),e("sub section added!")}catch(a){console.error("Error registering sub section:",a),n("Failed to add sub section.")}},yt=(0,o.iH)(""),gt=(0,o.iH)({name:"",unit:"",quantity:"",rate:""}),wt=async()=>{try{const a={name:gt.value.name,unit:gt.value.unit,quantity:gt.value.quantity,rate:gt.value.rate,sub_section_id:yt.value.id},l=await t.post("/boq-lines",a);ct.value.forEach((t=>{t.sections.forEach((t=>{t.sub_sections.forEach((t=>{t.id===a.sub_section_id&&(t.lines||(t.lines=[]),t.lines.push({id:l.data.id,name:a.name,unit:a.unit,quantity:a.quantity,rate:a.rate}))}))}))})),e("Line Registered!"),document.getElementById("closeLine").click(),gt.value={name:"",unit:"",quantity:"",rate:""}}catch(a){n(a.message),console.log(a)}};(0,l.bv)((()=>{nt()}));const ht=(0,o.iH)(0);function ft(){ht.value<10&&ht.value++}return(a,t)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",u,[(0,l._)("div",b,[(0,l._)("div",m,[(0,l._)("div",{class:"mt-5",style:(0,s.j5)({opacity:1-.1*ht.value,transition:"opacity 0.5s"})},[(0,l._)("div",_,[(0,l._)("h4",{class:"mb-0",onClick:ft,style:{cursor:"pointer"}}," BILL OF QUANTITY "),(0,l._)("div",v,[(0,l.Wm)((0,o.SU)(c()),{modelValue:dt.value,"onUpdate:modelValue":t[0]||(t[0]=a=>dt.value=a),"track-by":"id",options:it.value,label:"short_name",placeholder:"Select A Project",required:!0,searchable:!0,multple:"false"},null,8,["modelValue","options"])])]),ot.value?((0,l.wg)(),(0,l.iD)("div",p,[(0,l._)("button",{onClick:t[1]||(t[1]=a=>ot.value=!1),class:"btn btn-secondary"},"View BOQ")])):(0,l.kq)("",!0),dt.value&&!ot.value?((0,l.wg)(),(0,l.iD)("div",y,[(0,l._)("button",{onClick:t[2]||(t[2]=a=>ot.value=!0),class:"btn btn-primary"},"Add BOQ")])):(0,l.kq)("",!0),ot.value?((0,l.wg)(),(0,l.iD)("div",g,[(0,l._)("div",w,[(0,l._)("h6",h,(0,s.zw)(dt.value.project_name),1)]),(0,l._)("div",f,[(0,l._)("div",k,[(0,l._)("button",{class:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#seriesModal",onClick:t[3]||(t[3]=a=>ut.value="")}," Add Series ")])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ct.value,((a,t)=>((0,l.wg)(),(0,l.iD)("div",x,[(0,l._)("h2",S,[(0,l._)("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":`#accordion${a.id}`,"aria-expanded":"false","aria-controls":`accordion${a.id}`},(0,s.zw)(t+1)+". "+(0,s.zw)(a.name),9,z)]),(0,l._)("div",{id:`accordion${a.id}`,class:"accordion-collapse collapse"},[(0,l._)("div",C,[(0,l._)("div",q,[(0,l._)("div",H,[(0,l._)("button",{class:"btn btn-warning","data-bs-toggle":"modal","data-bs-target":"#sectionModal",onClick:t=>ut.value=a}," Add Section ",8,B)])]),(0,l._)("div",{id:`accordionSeries${a.id}`,class:"accordion"},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.sections,((t,e)=>((0,l.wg)(),(0,l.iD)("div",E,[(0,l._)("h2",Y,[(0,l._)("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":`#section${t.id}`,"aria-expanded":"false","aria-controls":`section${t.id}`},(0,s.zw)(e+1)+". "+(0,s.zw)(t.name),9,j)]),(0,l._)("div",{id:`section${t.id}`,class:"accordion-collapse collapse","data-bs-parent":`#accordionSeries${a.id}`},[(0,l._)("div",$,[(0,l._)("div",A,[(0,l._)("div",M,[(0,l._)("button",{class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#subSectionModal",onClick:a=>{mt.value=t,vt.value=""}}," Add Sub Section ",8,Q)])]),(0,l._)("div",{id:`accordionSub${t.id}`,class:"accordion"},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.sub_sections,((a,e)=>((0,l.wg)(),(0,l.iD)("div",V,[(0,l._)("h2",K,[(0,l._)("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":`#sub${a.id}`,"aria-expanded":"false","aria-controls":`sub${a.id}`},(0,s.zw)(e+1)+". "+(0,s.zw)(a.name),9,N)]),(0,l._)("div",{id:`sub${a.id}`,class:"accordion-collapse collapse","data-bs-parent":`#accordionSub${t.id}`},[(0,l._)("div",R,[(0,l._)("div",T,[(0,l._)("div",F,[(0,l._)("button",{class:"btn btn-secondary","data-bs-toggle":"modal","data-bs-target":"#lineModal",onClick:t=>yt.value=a}," Add Line ",8,P)])]),(0,l._)("table",Z,[J,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.lines,((a,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:a.id},[(0,l._)("td",W,(0,s.zw)(t+1),1),(0,l._)("td",G,(0,s.zw)(a.name),1),(0,l._)("td",null,(0,s.zw)(a.unit),1),(0,l._)("td",null,(0,s.zw)(a.quantity),1),(0,l._)("td",X,(0,s.zw)(a.rate.toLocaleString()),1),(0,l._)("td",aa,(0,s.zw)((a.quantity*a.rate).toLocaleString()),1)])))),128))])])])],8,O)])))),256))],8,I)])],8,U)])))),256))],8,L)])],8,D)])))),256))])):((0,l.wg)(),(0,l.iD)(l.HY,{key:3},[dt.value?((0,l.wg)(),(0,l.iD)("table",ta,[ea,(0,l._)("tbody",null,[(0,l._)("tr",null,[(0,l._)("td",la," Bill of Quantity "+(0,s.zw)(dt.value.project_name),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ct.value,((a,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:"series-"+t},[(0,l._)("tr",null,[(0,l._)("th",sa,"SERIES "+(0,s.zw)(t+1),1),(0,l._)("th",oa,(0,s.zw)(a.name),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.sections,((a,e)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:"section-"+e},[(0,l._)("tr",null,[(0,l._)("th",da,"Section "+(0,s.zw)(t+1)+"."+(0,s.zw)(e+1),1),(0,l._)("th",ia,(0,s.zw)(a.name),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.lines,((a,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:"line-"+t},[(0,l._)("td",na,(0,s.zw)(String.fromCharCode(97+t)),1),(0,l._)("td",ca,(0,s.zw)(a.name),1),(0,l._)("td",null,(0,s.zw)(a.unit),1),(0,l._)("td",null,(0,s.zw)(a.quantity),1),(0,l._)("td",ra,(0,s.zw)(a.rate.toLocaleString()),1),(0,l._)("td",ua,(0,s.zw)((a.rate*a.quantity).toLocaleString()),1)])))),128)),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.sub_sections,((a,o)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:"sub-"+o},[(0,l._)("tr",null,[(0,l._)("th",ba,(0,s.zw)(t+1)+"."+(0,s.zw)(e+1)+"."+(0,s.zw)(o+1),1),(0,l._)("th",ma,(0,s.zw)(a.name),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.lines,((a,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:"subline-"+t},[(0,l._)("td",_a,(0,s.zw)(String.fromCharCode(97+t)),1),(0,l._)("td",va,(0,s.zw)(a.name),1),(0,l._)("td",null,(0,s.zw)(a.unit),1),(0,l._)("td",null,(0,s.zw)(a.quantity),1),(0,l._)("td",pa,(0,s.zw)(a.rate.toLocaleString()),1),(0,l._)("td",ya,(0,s.zw)((a.rate*a.quantity).toLocaleString()),1)])))),128))],64)))),128))],64)))),128))],64)))),128)),0==ct.value.lenght?((0,l.wg)(),(0,l.iD)("div",ga,"No Series Set for this project")):(0,l.kq)("",!0)])])):(0,l.kq)("",!0)],64)),0===ct.value.length&&dt.value?((0,l.wg)(),(0,l.iD)("div",wa,"No BoQ set for this project")):dt.value?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",ha,"Select a project to see its BOQ"))],4)])])]),(0,l._)("div",fa,[(0,l._)("div",ka,[(0,l._)("div",xa,[(0,l._)("div",Sa,[(0,l._)("h1",za,"Add BOQ Items for "+(0,s.zw)(dt.value.short_name),1),Da]),(0,l._)("form",{onSubmit:(0,d.iM)(bt,["prevent"])},[(0,l._)("div",qa,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=a=>ut.value=a),placeholder:"Enter Series"},null,512),[[d.nr,ut.value]])]),Ha],40,Ca)])])]),(0,l._)("div",Ba,[(0,l._)("div",La,[(0,l._)("div",Ea,[(0,l._)("div",Ya,[(0,l._)("h1",ja,"Add BOQ section for "+(0,s.zw)(ut.value.name),1),Ua]),(0,l._)("form",{onSubmit:t[6]||(t[6]=(0,d.iM)((a=>_t()),["prevent"]))},[(0,l._)("div",$a,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=a=>mt.value=a),placeholder:"Enter Section Name"},null,512),[[d.nr,mt.value]])]),Aa],32)])])]),(0,l._)("div",Ma,[(0,l._)("div",Qa,[(0,l._)("div",Ia,[(0,l._)("div",Va,[(0,l._)("h1",Ka,"Add BOQ sub section for "+(0,s.zw)(mt.value.name),1),Na]),(0,l._)("form",{onSubmit:t[8]||(t[8]=(0,d.iM)((a=>pt()),["prevent"]))},[(0,l._)("div",Oa,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=a=>vt.value=a),placeholder:"Enter Sub Section Name"},null,512),[[d.nr,vt.value]])]),Ra],32)])])]),(0,l._)("div",Ta,[(0,l._)("div",Fa,[(0,l._)("div",Pa,[(0,l._)("div",Za,[(0,l._)("h1",Ja,"Add BOQ line for "+(0,s.zw)(yt.value.name),1),Wa]),(0,l._)("form",{onSubmit:t[13]||(t[13]=(0,d.iM)((a=>wt()),["prevent"]))},[(0,l._)("div",Ga,[(0,l._)("div",Xa,[(0,l._)("div",at,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Line Details","onUpdate:modelValue":t[9]||(t[9]=a=>gt.value.name=a)},null,512),[[d.nr,gt.value.name]])]),(0,l._)("div",tt,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Unit","onUpdate:modelValue":t[10]||(t[10]=a=>gt.value.unit=a)},null,512),[[d.nr,gt.value.unit]])]),(0,l._)("div",et,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Quantity","onUpdate:modelValue":t[11]||(t[11]=a=>gt.value.quantity=a)},null,512),[[d.nr,gt.value.quantity]])]),(0,l._)("div",lt,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Rate","onUpdate:modelValue":t[12]||(t[12]=a=>gt.value.rate=a)},null,512),[[d.nr,gt.value.rate]])])])]),st],32)])])])],64))}},dt=e(83744);const it=(0,dt.Z)(ot,[["__scopeId","data-v-edecfa24"]]);var nt=it}}]);
//# sourceMappingURL=7593.b1e04b44.js.map