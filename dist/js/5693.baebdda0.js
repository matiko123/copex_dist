"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[5693],{85693:function(e,a,t){t.r(a),t.d(a,{default:function(){return de}});t(26699);var l=t(66252),n=t(2262),s=t(49963),i=t(87066),o=t(56296),r=(t(26212),t(42119));const d={class:"layout-px-spacing"},c=(0,l.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Assets</a></li><li class="breadcrumb-item active" aria-current="page"><span>Fuel Cards </span></li></ol></nav></div></li></ul>',1),u={class:"d-flex me-4 mt-2"},p={class:"ms-auto"},v=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-plus-square",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),(0,l._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})],-1),m=[v],b=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,l._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),_=[b],h=["onSubmit"],g=(0,l._)("h4",{class:"text-center"},"REGISTER NEW RECORD",-1),y={class:"row mb-2"},f={class:"col-md-2"},w=(0,l._)("label",{class:"form-label"},"Date",-1),x={class:"col-md-3"},k=(0,l._)("label",{class:"form-label"},"Required Fuel (LTs)",-1),C={class:"col-md-3"},H=(0,l._)("label",{class:"form-label"},"Distance to cover (KM)",-1),E={class:"col-md-2"},R=(0,l._)("label",{class:"form-label"},"Expected Ratio",-1),M={class:"col-md-2"},T=(0,l._)("label",{class:"form-label"},"Expected Trips",-1),S={class:"col-md-3"},q=(0,l._)("label",{class:"form-label"},"Initial Odometer Reading",-1),D={class:"col-md-9"},V=(0,l._)("label",{class:"form-label"},"Description",-1),$={class:"text-center gap-2 justify-content-end"},U=["disabled"],N={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},O={key:1},F=["innerHTML"],L={key:2,class:"row layout-top-spacing"},z={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},I={class:"panel p-0"},j={class:"custom-table table3"},A={class:"actions text-center"},B=["onClick"],P=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"text-success"},[(0,l._)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,l._)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),W=[P],J={class:"modal fade mymodal",id:"vendor-edit-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"VendorEditModalLabel","aria-hidden":"true"},K={class:"modal-dialog modal-md"},G={class:"modal-content"},X=(0,l._)("div",{class:"modal-header"},[(0,l._)("h1",{class:"modal-title fs-5",id:"VendorEditModalLabel"},"Update Trips Covered"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close_editing"})],-1),Y={class:"modal-body"},Z={class:"row mb-3"},Q={class:"col-md-6"},ee=(0,l._)("label",{class:"form-label"},"Trips Covered",-1),ae={class:"col-md-6"},te=(0,l._)("label",{class:"form-label"},"Final Odometer Reading",-1),le={class:"modal-footer"},ne=["disabled"],se={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},ie={key:1};var oe={setup(e){(0,o.j)({title:"Asset Fuel Manager"});const a=(0,r.yj)(),t=(0,l.f3)("showMessage"),v=(0,l.f3)("showError"),b=JSON.parse(localStorage.getItem("user")).permissions,P=(0,l.f3)("tableShimmer");JSON.parse(localStorage.getItem("user"));(0,l.f3)("loadingSpinner");const oe=(0,n.iH)(!1),re=(0,n.iH)(!1),de=(0,n.iH)(["SNo","date","fuel_required","distance_cover","expected_ratio","expected_trips","trips_covered","fuel_balance","initial_reading","final_reading","actions"]),ce=((0,n.iH)(""),(0,n.iH)(""),(0,n.iH)(""),(0,n.iH)(""),(0,n.iH)(""),(0,n.iH)([])),ue=(0,n.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["SNo","date","fuel_required","distance_cover","expected_ratio","expected_trips","trips_covered","fuel_balance"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),pe=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),ve=async()=>{re.value=!0;try{const e=await pe.get(`asset-bincards?asset_id=${a.params.asset_id}`);ce.value=e.data.map(((e,a)=>({...e,SNo:a+1,fuel_required:e.amount+"LTs",distance_cover:e.distance_cover+"KM",fuel_balance:((e.expected_trips-e.trips_covered)/e.expected_trips*e.amount).toFixed(2)+"LTs",asset:e.asset.name+" "+e.asset.type_name,expected_trips:e.expected_trips+" ("+e.description+")"})))}catch(e){v(e.message)}finally{re.value=!1}},me=(0,n.iH)(!1),be=(0,n.iH)(""),_e=(0,n.iH)(""),he=(0,n.iH)(""),ge=(0,n.iH)(""),ye=(0,n.iH)(""),fe=(0,n.iH)(""),we=(0,n.iH)(""),xe=(0,n.iH)(""),ke=async()=>{me.value=!0;const e={asset_id:a.params.asset_id,registrar_id:JSON.parse(localStorage.getItem("user")).id,amount:fe.value,unit:"KM",date:we.value,expected_ratio:ge.value,distance_cover:be.value,description:_e.value,initial_reading:he.value,expected_trips:ye.value};try{await pe.post("asset-bincards",e);ve(),t("Record registered successfully!"),Ce()}catch(l){console.log(l),v(l.message)}finally{me.value=!1}},Ce=()=>{oe.value=!1,be.value="",_e.value="",he.value="",ge.value="",ye.value="",fe.value="",we.value=""},He=(0,n.iH)(null),Ee=(0,n.iH)(""),Re=e=>{xe.value=e.trips_covered,He.value=e.id,Ee.value=e.final_reading},Me=async()=>{me.value=!0;const e={trips_covered:xe.value,final_reading:Ee.value};try{await pe.put(`asset-bincards/${He.value}`,e);ve(),t("Record updated successfully!"),document.getElementById("close_editing").click()}catch(a){console.log(a),v(a.message)}finally{me.value=!1}},Te=async()=>{try{const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const a=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Vendors List</title>\n<style>\n  body { font-family: 'Courier New', monospace; margin: 40px; font-size: 11px; }\n  .text-style { font-family: 'Courier New', monospace; }\n  .company-title { text-align: center; }\n  .title { text-align: center; font-size: 18px; margin: 10px 0; }\n  table { width: 95%; border-collapse: collapse; margin: 10px auto; font-size: 11px; }\n  th, td { border: 0.5px solid #000; padding: 4px; }\n  th { background-color: #f8f8f8; font-weight: bold; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  hr { border: 0; border-top: 0.5px solid #000; margin: 0px 0; }\n  @media print { body { margin: 10mm; } }\n</style>\n</head>\n<body>\n\n<div class="company-title text-style">\n  <i>\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\n  </i>\n</div>\n\n<hr style="margin-top:20px">\n\n<div class="title text-style">\n  ${Se.value.name} ${Se.value.type_name} FUEL MANAGEMENT\n</div>\n\n<hr>\n\n<table>\n  <thead>\n    <tr>\n      <th>No.</th>\n      <th>Date</th>\n      <th>Fuel Required</th>\n      <th>Distance To Cover</th>\n      <th>Expected Ratio</th>\n      <th>Expected Trips</th>\n      <th>Trips Covered</th>\n      <th>Fuel Balance </th>\n      <th>Initial Reading </th>\n      <th>Final Reading </th>\n    </tr>\n  </thead>\n  <tbody>\n    ${ce.value.map(((e,a)=>`\n    <tr>\n      <td>${a+1}</td>\n      <td>${e.date||"-"}</td>\n      <td>${e.distance_cover||"-"}</td>\n      <td>${e.fuel_required||"-"}</td>\n      <td>${e.expected_ratio||"-"}</td>\n      <td>${e.expected_trips||"-"}</td>\n      <td>${e.trips_covered||"-"}</td>\n      <td>${e.fuel_balance||"-"}</td>\n      <td>${e.initial_reading||"-"}</td>\n      <td>${e.final_reading||"-"}</td>\n    </tr>\n    `)).join("")}\n  </tbody>\n</table>\n\n</body>\n</html>\n`,t=e.contentWindow.document;t.open(),t.write(a),t.close(),e.onload=()=>{e.contentWindow.focus(),e.contentWindow.print(),setTimeout((()=>{document.body.removeChild(e)}),1e3)}}catch(e){v(`Failed to print report: ${e.message}`)}},Se=(0,n.iH)(""),qe=async()=>{try{const e=await pe.get(`machines/${a.params.asset_id}`);Se.value=e.data}catch(e){v(e.message),console.log(e)}};return(0,l.bv)((()=>{ve(),qe()})),(e,a)=>{const t=(0,l.up)("v-client-table");return(0,l.wg)(),(0,l.iD)("div",d,[c,(0,l._)("div",u,[(0,l._)("div",p,[(0,n.SU)(b).includes("can_register_asset_bincard")?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-primary me-2",onClick:a[0]||(a[0]=e=>oe.value=!oe.value)},m)):(0,l.kq)("",!0),(0,n.SU)(b).includes("can_register_print_bincard")?((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn btn-success",onClick:a[1]||(a[1]=e=>Te())},_)):(0,l.kq)("",!0)])]),oe.value?((0,l.wg)(),(0,l.iD)("form",{key:0,class:"mt-3 p-3 border rounded bg-white shadow",onSubmit:(0,s.iM)(ke,["prevent"])},[g,(0,l._)("div",y,[(0,l._)("div",f,[w,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control","onUpdate:modelValue":a[2]||(a[2]=e=>we.value=e),required:""},null,512),[[s.nr,we.value]])]),(0,l._)("div",x,[k,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Fuel Required","onUpdate:modelValue":a[3]||(a[3]=e=>fe.value=e),required:"",step:"any"},null,512),[[s.nr,fe.value]])]),(0,l._)("div",C,[H,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Distance to cover","onUpdate:modelValue":a[4]||(a[4]=e=>be.value=e),step:"any",required:""},null,512),[[s.nr,be.value]])]),(0,l._)("div",E,[R,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Expected Ratio","onUpdate:modelValue":a[5]||(a[5]=e=>ge.value=e),required:"",step:"any"},null,512),[[s.nr,ge.value]])]),(0,l._)("div",M,[T,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Expected Trips","onUpdate:modelValue":a[6]||(a[6]=e=>ye.value=e),required:""},null,512),[[s.nr,ye.value]])]),(0,l._)("div",S,[q,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Enter Initial Reading","onUpdate:modelValue":a[7]||(a[7]=e=>he.value=e),required:""},null,512),[[s.nr,he.value]])]),(0,l._)("div",D,[V,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter any description","onUpdate:modelValue":a[8]||(a[8]=e=>_e.value=e),step:"any",required:""},null,512),[[s.nr,_e.value]])])]),(0,l._)("div",$,[(0,l._)("button",{type:"button",class:"btn btn-danger me-3",onClick:a[9]||(a[9]=e=>{oe.value=!1,Ce()})},"Cancel"),(0,l._)("button",{type:"submit",class:"btn btn-primary",disabled:me.value},[me.value?((0,l.wg)(),(0,l.iD)("span",N)):((0,l.wg)(),(0,l.iD)("span",O,"Register"))],8,U)])],40,h)):(0,l.kq)("",!0),re.value?((0,l.wg)(),(0,l.iD)("div",{key:1,innerHTML:(0,n.SU)(P)()},null,8,F)):((0,l.wg)(),(0,l.iD)("div",L,[(0,l._)("div",z,[(0,l._)("div",I,[(0,l._)("div",j,[(0,l.Wm)(t,{data:ce.value,columns:de.value,options:ue.value},{actions:(0,l.w5)((e=>[(0,l._)("div",A,[(0,l._)("a",{href:"javascript:;",class:"edit me-3",onClick:a=>Re(e.row),"data-bs-toggle":"modal","data-bs-target":"#vendor-edit-modal"},W,8,B)])])),_:1},8,["data","columns","options"])])])])])),(0,l._)("div",J,[(0,l._)("div",K,[(0,l._)("div",G,[X,(0,l._)("form",{onSubmit:a[13]||(a[13]=(0,s.iM)((e=>Me()),["prevent"]))},[(0,l._)("div",Y,[(0,l._)("div",Z,[(0,l._)("div",Q,[ee,(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Enter Trips Covered",class:"form-control","onUpdate:modelValue":a[10]||(a[10]=e=>xe.value=e),required:""},null,512),[[s.nr,xe.value]])]),(0,l._)("div",ae,[te,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Final Odometer Readings","onUpdate:modelValue":a[11]||(a[11]=e=>Ee.value=e)},null,512),[[s.nr,Ee.value]])])])]),(0,l._)("div",le,[(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:a[12]||(a[12]=e=>Ce()),id:"close_editing"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary",disabled:me.value},[me.value?((0,l.wg)(),(0,l.iD)("span",se)):((0,l.wg)(),(0,l.iD)("span",ie,"Update"))],8,ne)])],32)])])])])}}};const re=oe;var de=re}}]);
//# sourceMappingURL=5693.baebdda0.js.map