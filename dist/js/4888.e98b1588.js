"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[4888],{58483:function(t,e,a){a.d(e,{i:function(){return n}});a(26699);function n(t,e){const a=e.toLowerCase().trim();if(!a)return t;const n=t=>null!=t&&("string"===typeof t?t.toLowerCase().includes(a):Array.isArray(t)?t.some(n):"object"===typeof t&&Object.values(t).some(n));return t.filter((t=>n(t)))}},86500:function(t,e,a){a.d(e,{Z:function(){return c}});var n=a(66252),s=a(49963),o=a(2262);const i=(0,n._)("span",{class:"input-group-text bg-white border-start-0"},[(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.442.656a5 5 0 1 1 \r\n        0-10 5 5 0 0 1 0 10z"})])],-1);var l={props:{filterValue:String},emits:["update:filterValue"],setup(t,{emit:e}){const a=t,l=(0,o.iH)(a.filterValue||null);return(0,n.YP)(l,(t=>e("update:filterValue",t))),(t,e)=>((0,n.wg)(),(0,n.iD)("form",{onSubmit:e[1]||(e[1]=(0,s.iM)((()=>{}),["prevent"])),class:"input-group container"},[(0,n.wy)((0,n._)("input",{type:"text",class:"form-control border-end-0",placeholder:"Search a word...","onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t)},null,512),[[s.nr,l.value]]),i],32))}};const r=l;var c=r},64888:function(t,e,a){a.r(e),a.d(e,{default:function(){return tt}});var n=a(66252),s=a(3577),o=a(2262),i=a(87066),l=a(56296),r=(a(26212),a(86500)),c=a(58483);const d={class:"layout-px-spacing"},u=(0,n.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Account Ledger</span></li></ol></nav></div></li></ul>',1),m={class:"row"},h={class:"col-12"},v={class:"mb-3 text-center text-uppercase"},b={class:"offcanvas offcanvas-end","data-bs-scroll":"true",tabindex:"-1",id:"offcanvasWithBothOptions","aria-labelledby":"offcanvasWithBothOptionsLabel"},p=(0,n._)("div",{class:"offcanvas-header justify-content-between"},[(0,n._)("h5",{class:"offcanvas-title",id:"offcanvasWithBothOptionsLabel"},"ACCOUNTS LISTS"),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),f=["innerHTML"],g={key:1,class:"offcanvas-body"},w={class:"row"},y={class:"col-12"},x={class:"mb-3 d-flex gap-2 align-items-center"},_={class:"flex-grow-1"},C={class:"list-group text-center",id:"list-tab",role:"tablist"},k=["onClick"],H={key:0,class:"text-center mt-3 text-muted"},D={class:"d-flex justify-content-end mb-3"},E=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),N=[E],S={key:1,class:"btn","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},O=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-list-ul",viewBox:"0 0 16 16"},[(0,n._)("path",{"fill-rule":"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"})],-1),T=[O],M={key:2,class:"btn btn-outline-primary",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasWithBothOptions","aria-controls":"offcanvasWithBothOptions"},A={key:0,class:"text-center my-3 text-muted",style:{"font-size":"1.1rem"}},z={key:1},L=["innerHTML"],R={key:1,class:"row layout-top-spacing"},V={class:"panel p-0"},B={class:"custom-table"},W={class:"actions text-center"},$=["onClick"],P=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-file-earmark-pdf text-primary",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),(0,n._)("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"})],-1),I=[P],q={class:"modal fade mymodal",id:"attachment","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1"},U={class:"modal-dialog modal-fullscreen"},j={class:"modal-content h-100"},F={class:"modal-header"},Y={class:"modal-title fs-5"},Z=(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1),J={class:"modal-body p-0 flex-grow-1"},X=["src"],G=(0,n._)("div",{class:"modal-footer"},[(0,n._)("button",{type:"button",class:"btn btn-danger btn-sm","data-bs-dismiss":"modal"}," Close ")],-1);var K={setup(t){const e=(0,n.f3)("waitIndicator");(0,l.j)({title:"accounts"});(0,n.f3)("showMessage");const a=(0,n.f3)("showError"),E=(JSON.parse(localStorage.getItem("user")).permissions,JSON.parse(localStorage.getItem("user")),(0,n.f3)("formatDate")),O=(0,n.f3)("formatNumber"),P=(0,n.f3)("tableShimmer"),K=((0,n.f3)("loadingSpinner"),(0,o.iH)(!1),(0,o.iH)(!1)),Q=(0,o.iH)([]),tt=(0,o.iH)(["Sno","ref_no","issuer","host","Debit","Credit","date","actions"]),et=(0,o.iH)(null),at=(0,o.iH)(null),nt=(0,o.iH)(""),st=(0,o.iH)(window.innerWidth<768),ot=(0,o.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["Sno","reference_number","issuer","host","amount","source_account","date"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1});window.addEventListener("resize",(()=>{st.value=window.innerWidth<768}));const it=(0,n.Fl)((()=>(0,c.i)(Q.value,nt.value))),lt=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),rt=async()=>{K.value=!0;try{const t=await lt.get("account-transaction-points");Q.value=t.data}catch(t){console.log(t),a(t.message)}finally{K.value=!1}},ct=t=>{et.value=t,at.value=t.id};(0,n.YP)(at,(async(t,e)=>{t&&t!==e&&await mt(t)}));const dt=(0,o.iH)(!1),ut=(0,o.iH)([]),mt=async(t=null)=>{dt.value=!0;const e=t||at.value;if(e)try{const t=await lt.get(`account-transactions?account_transaction_point_id=${e}`);ut.value=t.data.map(((t,e)=>({...t,Sno:e+1,attachment:"https://bushman.ink/api/v1/../../"+t.attachment,Debit:"INCREMENT"===t.direction?O(t.amount):"--",Credit:"DECREMENT"===t.direction?O(t.amount):"--",issuer:t.issuer.name,proof:t.attachment,ref_no:t.reference_number,host:t.host,date:E(t.date),source_account:(t?.transaction_point?.name??"")+" "+(t?.transaction_point?.mobile_money?.name??"")+" "+(t?.transaction_point?.mobile_money?.category??"CASH")})))}catch(n){a(n.message),console.log(n)}finally{dt.value=!1}else dt.value=!1},ht=(0,o.iH)(""),vt=t=>{ht.value=t},bt=async()=>{try{const t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);let e=0;const a=ut.value.map((t=>{const a="INCREMENT"===t.direction?parseFloat(t.amount):0,n="DECREMENT"===t.direction?parseFloat(t.amount):0;return e+=a-n,{...t,balance:e}})),n=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Account Ledger Report</title>\n<style>\n  body { font-family: 'Courier New', monospace; margin: 40px; font-size: 13px; }\n  .text-style { font-family: 'Courier New', monospace; }\n  .company-title { text-align: center; }\n  .title { text-align: center; font-size: 20px; margin: 10px 0; }\n  .account-info { text-align: center; font-size: 16px; margin: 10px 0; font-weight: bold; }\n  table { width: 100%; border-collapse: collapse; margin-top: 10px; }\n  th, td { border: 0.5px solid #000; padding: 6px; }\n  th { background-color: #f8f8f8; font-weight: bold; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  hr { border: 0; border-top: 0.5px solid #000; margin: 0px 0; }\n  @media print { body { margin: 10mm; } }\n</style>\n</head>\n<body>\n\n<div class="company-title text-style">\n  <i>\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\n  </i>\n</div>\n\n<hr style="margin-top:20px">\n\n<div class="title text-style">\n ${(et.value?.name+" - "+(et.value?.mobile_money?.name??"CASH")).toUpperCase()||"N/A"} ACCOUNT LEDGER REPORT\n</div>\n\n<hr>\n\n<table>\n  <thead>\n    <tr>\n      <th>No.</th>\n      <th>Date</th>\n      <th>Reference</th>\n      <th>Issuer</th>\n      <th>Host</th>\n      <th class="text-right">Debit</th>\n      <th class="text-right">Credit</th>\n      <th class="text-right">Balance</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${a.map(((t,e)=>`\n    <tr>\n      <td>${e+1}</td>\n      <td>${t.date||"N/A"}</td>\n      <td>${t.ref_no||"N/A"}</td>\n      <td>${t.issuer||"N/A"}</td>\n      <td>${t.host||"N/A"}</td>\n      <td class="text-right">${"--"!==t.Debit?t.Debit:"--"}</td>\n      <td class="text-right">${"--"!==t.Credit?t.Credit:"--"}</td>\n      <td class="text-right">${O(t.balance)}</td>\n    </tr>\n    `)).join("")}\n    <tr>\n      <td colspan="5" class="text-right"><strong>TOTALS:</strong></td>\n      <td class="text-right"><strong>${O(ut.value.reduce(((t,e)=>{const a="INCREMENT"===e.direction?parseFloat(e.amount):0;return t+a}),0))}</strong></td>\n      <td class="text-right"><strong>${O(ut.value.reduce(((t,e)=>{const a="DECREMENT"===e.direction?parseFloat(e.amount):0;return t+a}),0))}</strong></td>\n      <td class="text-right"><strong>${O(e)}</strong></td>\n    </tr>\n  </tbody>\n</table>\n\n</body>\n</html>\n`,s=t.contentWindow.document;s.open(),s.write(n),s.close(),t.onload=()=>{t.contentWindow.focus(),t.contentWindow.print(),setTimeout((()=>{document.body.removeChild(t)}),1e3)}}catch(t){a(`Failed to print ledger: ${t.message}`)}};return(0,n.bv)((()=>{rt();const t=document.getElementById("offcanvasWithBothOptions");if(t){const e=new bootstrap.Offcanvas(t);e.show()}})),(t,a)=>{const i=(0,n.up)("v-client-table");return(0,n.wg)(),(0,n.iD)("div",d,[u,(0,n._)("div",m,[(0,n._)("div",h,[(0,n._)("h3",v,(0,s.zw)(et.value?.name?et.value.name+" - "+(et.value?.mobile_money?.name??"CASH"):"")+" Account Ledger",1)])]),(0,n._)("div",b,[p,K.value?((0,n.wg)(),(0,n.iD)("div",{key:0,innerHTML:(0,o.SU)(e)()},null,8,f)):((0,n.wg)(),(0,n.iD)("div",g,[(0,n._)("div",w,[(0,n._)("div",y,[(0,n._)("div",x,[(0,n._)("div",_,[(0,n.Wm)(r.Z,{filterValue:nt.value,"onUpdate:filterValue":a[0]||(a[0]=t=>nt.value=t)},null,8,["filterValue"])])]),(0,n._)("div",C,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(it),(t=>((0,n.wg)(),(0,n.iD)("a",{key:t.id,onClick:e=>ct(t),class:(0,s.C_)(["list-group-item list-group-item-action",{active:at.value===t.id}]),"data-bs-dismiss":"offcanvas",href:"javascript:void(0);"},(0,s.zw)(t.name)+" - "+(0,s.zw)(t?.mobile_money?.name??"CASH"),11,k)))),128))]),0===(0,o.SU)(it).length&&nt.value?((0,n.wg)(),(0,n.iD)("div",H,' No accounts found matching "'+(0,s.zw)(nt.value)+'" ',1)):(0,n.kq)("",!0)])])]))]),(0,n._)("div",D,[at.value?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-success me-2",onClick:a[1]||(a[1]=t=>bt())},N)):(0,n.kq)("",!0),st.value?((0,n.wg)(),(0,n.iD)("button",S,T)):((0,n.wg)(),(0,n.iD)("button",M,"Select Account from the lists"))]),at.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",A," Please select account from the list to view its details ")),et.value?((0,n.wg)(),(0,n.iD)("div",z,[dt.value?((0,n.wg)(),(0,n.iD)("div",{key:0,innerHTML:(0,o.SU)(P)()},null,8,L)):((0,n.wg)(),(0,n.iD)("div",R,[(0,n._)("div",V,[(0,n._)("div",B,[(0,n.Wm)(i,{data:ut.value,columns:tt.value,options:ot.value},{actions:(0,n.w5)((t=>[(0,n._)("div",W,[t.row.proof?((0,n.wg)(),(0,n.iD)("a",{key:0,href:"javascript:;","data-bs-toggle":"modal","data-bs-target":"#attachment",onClick:e=>vt(t.row),title:"View Attachment"},I,8,$)):(0,n.kq)("",!0)])])),_:1},8,["data","columns","options"])])])]))])):(0,n.kq)("",!0),(0,n._)("div",q,[(0,n._)("div",U,[(0,n._)("div",j,[(0,n._)("div",F,[(0,n._)("h1",Y,"PROOF OF PAYMENT ATTACHMENT FOR : "+(0,s.zw)(ht.value?.reference_number),1),Z]),(0,n._)("div",J,[(0,n._)("iframe",{src:ht.value.attachment,class:"w-100 h-100 border-0"},null,8,X)]),G])])])])}}};const Q=K;var tt=Q}}]);
//# sourceMappingURL=4888.e98b1588.js.map