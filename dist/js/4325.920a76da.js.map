{"version":3,"file":"js/4325.920a76da.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/goodReceivedNotes/shortage_statement.vue","webpack://cork-vue3/./src/views/goodReceivedNotes/shortage_statement.vue?b993"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">  \r\n            <ul class=\"navbar-nav flex-row mt-2\">\r\n                <li>\r\n                    <div class=\"page-header\">\r\n                        <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Shortage Statement</span></li>\r\n                            </ol>\r\n                        </nav>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n     \r\n            <h3 class=\"text-center text-uppercase\">Goods Received Notes Shortage Statement</h3>\r\n\r\n\r\n                    <!-- loading spinner starts -->\r\n                 <div v-if=\"loading_spinner\" v-html=\"tableShimmer()\"></div>\r\n        <!-- Loading spinner ends -->\r\n\r\n      \r\n        <div v-else class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel p-0\">\r\n                    <div class=\"custom-table table3\">\r\n                        <v-client-table :data=\"notes\" :columns=\"columns\" :options=\"table_option\">\r\n                            <template #status=\"props\">\r\n                                <span class=\"badge inv-status\" :class=\"'badge-' + props.row.status.color\">{{ props.row.status.name }} </span>\r\n                            </template>\r\n                            <template #actions=\"props\">\r\n                                <a \r\n                                v-if=\"user_permissions.includes('can_edit_shortage_statement')\"\r\n                                href=\"javascript:;\"  class=\"edit me-3\" @click=\"openEditModal(props.row)\" data-bs-toggle=\"modal\" data-bs-target=\"#edit-statement-modal\">\r\n                                            <svg\r\n                                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                                                width=\"24\"\r\n                                                height=\"24\"\r\n                                                viewBox=\"0 0 24 24\"\r\n                                                fill=\"none\"\r\n                                                stroke=\"currentColor\"\r\n                                                stroke-width=\"1.5\"\r\n                                                stroke-linecap=\"round\"\r\n                                                stroke-linejoin=\"round\"\r\n                                                class=\"text-primary\"\r\n                                            >\r\n                                                <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                                                <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                                            </svg>\r\n                                        </a>\r\n                            </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n           <!-- Edit Shortage Statement modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"edit-statement-modal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"editStatementModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"editStatementModalLabel\">Edit Shortage Statement</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"closeEditModal()\"></button>\r\n      </div>\r\n      <form @submit.prevent=\"updateStatement()\">\r\n        <div class=\"modal-body\">\r\n            <div class=\"row mb-3\">\r\n                \r\n                \r\n                <div class=\"col-md-6\">\r\n                    <label for=\"status\">Status</label>\r\n                    <Multiselect\r\n                        v-model=\"status\"\r\n                        :options=\"statuses\"\r\n                        label=\"name\"\r\n                        placeholder=\"Select Status\"\r\n                        :searchable=\"true\"\r\n                        :allow-empty=\"false\"\r\n                    />\r\n                </div>\r\n                <div class=\"col-md-6\">  \r\n                <label for=\"quantity\">Quantity</label>\r\n                <input type=\"number\" v-model=\"quantity\" class=\"form-control\" placeholder=\"Enter Quantity\" step=\"0.01\" >\r\n                </div>\r\n                <div class=\"col-md-12\">  \r\n                <label for=\"briefing\">briefing</label>\r\n                <input type=\"text\" v-model=\"briefing\" class=\"form-control\" placeholder=\"Enter Briefing\" >\r\n                </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"closeEditModal()\" id=\"close_editing\">Close</button>\r\n          <button type=\"submit\" class=\"btn btn-primary\">\r\n            <span v-if=\"loading_spinner\" class=\"spinner-border spinner-border-sm text-white me-2\" role=\"status\"></span>\r\n            Edit\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- Edit Shortage Statement modal ends -->\r\n   \r\n\r\n\r\n   </div>\r\n</template>\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n<script setup>\r\n    import { onMounted, ref,inject,watch } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\nimport Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    useMeta({ title: 'Good Issue Note' });\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n        \r\n         \r\n\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const formatDate = inject('formatDate');\r\n    const formatNumber = inject('formatNumber');\r\n    const tableShimmer = inject('tableShimmer');\r\n    const briefing = ref('')\r\n    const quantity = ref('')\r\n    const status = ref(null)\r\n    \r\n   \r\n\r\n    const loading_spinner = ref(false);\r\n    const columns = ref(['SNo','item', 'description','units','receiver','date','approved','received','shortage','briefing','remark','cost','id', 'status','actions']);\r\n    const notes = ref([]);\r\n    const items = ref([]);\r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 ,100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'name','short_name','status'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const loading = ref(false)\r\n   \r\n    const issue = ref('')\r\n\r\n\r\n    const getIssueNotes = () => {\r\n        loading_spinner.value = true;\r\n        axiosInstance.get('/grn-items').then((response) => {\r\n            \r\n            notes.value = response.data.map((item, index) => {\r\n                return {\r\n                    ...item,\r\n                    SNo: index + 1,\r\n                    id: item.id,\r\n                    receiver : item?.receiver?.name,\r\n                    grn: item.grn_id,\r\n                    remark:item.remark,\r\n                    date: formatDate(item.created_at),\r\n                    item: item.approval_item.requisition_item.remark,\r\n                    description: item.approval_item.requisition_item.description,\r\n                    units: item.approval_item.requisition_item.units,\r\n                    rate: item.approval_item.requisition_item.rate,\r\n                    received: item.quantity,\r\n                    approved: item.approval_item.quantity,\r\n                    shortage: (item.approval_item.quantity - item.quantity).toFixed(2),\r\n                    briefing : item.description,\r\n                    cost: formatNumber(item.approval_item.requisition_item.rate * (item.approval_item.quantity - item.quantity)),\r\n                    rate: item.approval_item.requisition_item.rate,\r\n                };\r\n              \r\n            });\r\n            \r\n            loading_spinner.value = false;\r\n        }).catch(error => {\r\n            showError(error.message || \"Failed to fetch units\");\r\n            loading_spinner.value = false;\r\n        });\r\n    };\r\n\r\n\r\n\r\n     const statuses = ref([])\r\n    const getStatuses = async () =>{\r\n        const response = await axiosInstance.get('statuses')\r\n        statuses.value = response.data\r\n    }\r\n\r\n    const openEditModal = (row) => {\r\n  issue.value = row\r\n  briefing.value = row.briefing || ''\r\n  quantity.value = row.quantity || 0\r\n  status.value = statuses.value.find(s => s.id === row.status_id) || null\r\n}\r\n\r\n  const updateStatement = async () => {\r\n     loading_spinner.value = true\r\n    const row = issue.value;    \r\n    const payload = {\r\n        description: briefing.value,             \r\n        status_id: status.value.id,\r\n        quantity: quantity.value       \r\n    }\r\n\r\n    try {\r\n       \r\n\r\n        const response = await axiosInstance.put(`grn-items/${row.id}`, payload)\r\n        showMessage('Statement updated successfully')\r\n        document.getElementById('close_editing').click()\r\n        getIssueNotes()\r\n    } catch (error) {\r\n        console.error('Error updating GRN item:', error)\r\n        showError(error.response?.data?.message || 'Failed to update statement')\r\n    } finally {\r\n        loading_spinner.value = false\r\n    }\r\n}\r\n\r\n     const closeEditModal = () => {\r\n  briefing.value = ''\r\n  quantity.value = ''\r\n  status.value = null\r\n}\r\n\r\n\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n\r\n     \r\n  \r\n\r\n    onMounted(() => {\r\n        getIssueNotes();\r\n        getStatuses()\r\n    \r\n    });\r\n</script>\r\n\r\n","import script from \"./shortage_statement.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./shortage_statement.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./shortage_statement.vue?vue&type=style&index=0&id=3a85932a&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useMeta","title","axiosInstance","axios","baseURL","process","user_permissions","JSON","parse","localStorage","getItem","permissions","formatDate","inject","formatNumber","tableShimmer","briefing","ref","quantity","status","loading_spinner","columns","notes","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","resizableColumns","issue","getIssueNotes","value","get","then","response","data","map","item","index","SNo","id","receiver","name","grn","grn_id","remark","date","created_at","approval_item","requisition_item","description","units","rate","received","approved","shortage","toFixed","cost","catch","error","showError","message","statuses","getStatuses","async","openEditModal","row","find","s","status_id","updateStatement","payload","put","showMessage","document","getElementById","click","console","closeEditModal","onMounted","__exports__"],"sourceRoot":""}