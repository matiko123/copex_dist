"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[5138],{75138:function(e,a,t){t.r(a),t.d(a,{default:function(){return Se}});t(26699);var l=t(66252),n=t(3577),s=t(2262),o=t(49963),i=t(87066),r=t(56296);const d={class:"layout-px-spacing"},u=(0,l.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">HR</a></li><li class="breadcrumb-item active" aria-current="page"><span>Employees Absence</span></li></ol></nav></div></li></ul>',1),c={class:"navbar-nav flex-row ms-auto"},b={class:"nav-item more-dropdown"},v={class:"dropdown custom-dropdown-icon"},p=(0,l._)("a",{href:"javascript:;",class:"nav-link dropdown-toggle",id:"ddlSettings","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,l._)("span",null,"Select a company"),(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},[(0,l._)("polyline",{points:"6 9 12 15 18 9"})])],-1),m={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"ddlSettings"},g=["onClick"],y={class:"dropdown-item","data-value":"Mail",href:"javascript:void(0);"},h={key:0,class:"text-center"},w={class:"d-flex justify-content-center mb-3 mt-3"},_={key:0,class:"btn-group"},k=["disabled"],f=["disabled"],x=["disabled"],S=["disabled"],C={key:0,class:"mb-2 text-center"},D={key:1,class:"text-start"},z={key:2,class:"input-group"},H=["placeholder"],R=["disabled"],$=["innerHTML"],A={key:1},E={key:1,class:"text-center"},N={class:"d-flex me-4 mt-2"},M={class:"ms-auto"},L={class:"input-group"},j=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,l._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),P=[j],T={class:"row layout-top-spacing"},U={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},q={class:"panel p-0"},O=["innerHTML"],V={key:1,class:"custom-table table3"},I=["onClick"],Y=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,l._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})],-1),B=[Y],F={class:"modal fade mymodal",id:"employee-view-modal","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"employeeViewModalLabel","aria-hidden":"true"},J={class:"modal-dialog modal-xl"},W={class:"modal-content"},G={class:"modal-header"},K={class:"modal-title fs-5",id:"employeeViewModalLabel"},Z={class:"modal-body"},Q={key:0,class:"row mb-3"},X={class:"col-md-12"},ee={class:"panel p-0"},ae={class:"custom-table table3 table-responsive"},te={class:"table table-hover table-striped"},le=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"Employee Name"),(0,l._)("th",null,"Position"),(0,l._)("th",null,"Salary"),(0,l._)("th",null,"Debt"),(0,l._)("th",null,"Absent"),(0,l._)("th",null,"Payable"),(0,l._)("th",null,"Status")])],-1),ne={key:0,colspan:"7"},se={key:1},oe=(0,l._)("h5",{class:"mb-3 text-center"},"Employee Salary Decision",-1),ie=(0,l._)("br",null,null,-1),re={class:"d-flex justify-content-center mb-3"},de={class:"btn-group"},ue=["disabled"],ce=["disabled"],be=["disabled"],ve=["disabled"],pe={key:2,class:"mb-2 text-center"},me={key:3,class:"input-group"},ge=["placeholder"],ye=["disabled"],he=["innerHTML"],we={key:1},_e={class:"modal-footer"},ke=(0,l._)("button",{style:{display:"none"},id:"biometric","data-bs-toggle":"modal","data-bs-target":"#biometric-update-modal"},null,-1);var fe={setup(e){(0,r.j)({title:"Custom Table"});const a=i.Z.create({baseURL:"https://bushman.ink/api/v1/"}),t=JSON.parse(localStorage.getItem("user")).permissions,j=(0,l.f3)("showMessage"),Y=(0,l.f3)("showError"),fe=(0,l.f3)("formatNumber"),xe=((0,l.f3)("formatDate"),(0,l.f3)("loadingSpinner")),Se=((0,l.f3)("printEmployeeList"),(0,s.iH)("")),Ce=new Date,De=Ce.getFullYear(),ze=String(Ce.getMonth()+1).padStart(2,"0");Se.value=`${De}-${ze}`;const He=(0,l.f3)("tableShimmer"),Re=(0,s.iH)(!1),$e=(0,s.iH)(["Sno","name","position","salary","debt","absence","days_absent","balance","status","actions"]),Ae=(0,s.iH)({perPage:50,perPageValues:[50,100,200],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","service_name"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),Ee=(0,s.iH)(""),Ne=(0,s.iH)(""),Me=(0,s.iH)(""),Le=(0,s.iH)([]),je=(0,s.iH)(""),Pe=async()=>{Re.value=!0;try{const e=await a.get(`employee-payrolls?company_id=${Ee.value}&month=${Se.value}`);Le.value=e.data.employees.map(((a,t)=>({...a,Sno:t+1,salary:fe(a.salary),absence:0===a.absent_days?"---":fe(1e3*Math.round(a.salary_deduction/1e3)),employee_salary:a.salary,balance:fe(1e3*Math.round((a.salary-a.salary_deduction-a.debt)/1e3)),name:a.name.toUpperCase(),days_absent:0===a.absent_days?"---":a.absent_days+" days",debt:0===a.debt?"---":fe(a.debt),debt_original:a.debt,salary_original:a.salary,position:a.position,remark:a?.salary_status?.remark??"",status:a?.salary_status?.status??a?.salary_status?.status??(e.data.payroll?e.data.payroll.status:e.data.payroll?{name:"approved",color:"success"}:{name:"Unapproved",color:"secondary"})}))),je.value=e.data.payroll}catch(e){console.log(e),Y(e.message)}finally{Re.value=!1}};(0,l.YP)(Se,(e=>{e&&Pe()}));const Te=()=>{Ne.value="",Me.value=""},Ue=(0,s.iH)(null),qe=async e=>{Ue.value=e},Oe=(0,s.iH)("SELECT A COMPANY"),Ve=(0,s.iH)(!1),Ie=e=>{We.value=e,Ee.value=We.value.id,Pe(),Oe.value=We.value.name+" EMPLOYEES PAYROLL"},Ye=async()=>{Ve.value=!0;const e={remark:Me.value,status_id:Ne.value,employee_id:Ue.value.id,remarker_id:JSON.parse(localStorage.getItem("user")).id,month:Se.value};try{const t=await a.post("employee-salary-statuses",e);j(t.data.message),document.getElementById("employee-status-close").click(),Pe()}catch(t){console.log(t),Y(t.message)}finally{Ve.value=!1}},Be=async()=>{Ve.value=!0;const e={remark:Me.value,company_id:We.value.id,status_id:Ne.value,remarker_id:JSON.parse(localStorage.getItem("user")).id,month:Se.value};try{await a.post("employee-payrolls",e);j("Payroll Updated"),document.getElementById("employee-status-close").click(),Pe()}catch(t){console.log(t),Y(t.message)}finally{Ve.value=!1}},Fe=async e=>{try{const a=e,t=a.reduce(((e,a)=>"approved"===a?.status?.name?e+Number(a.salary_original-a.salary_deduction-a.debt_original||0):e),0),l=document.createElement("iframe");l.style.display="none",document.body.appendChild(l);const n=`\n<!DOCTYPE html>\n<html>\n<head>\n<style>\n  body { font-family: 'Courier New', monospace; margin: 20px; font-size: 8px; }\n  .text-style { font-family: 'Courier New', monospace; }\n  .company-title { text-align: center; font-size: 9px; }\n  .company-title h1 { font-size: 14px; margin: 5px 0; }\n  .title { text-align: center; font-size: 12px; margin: 8px 0; font-weight: bold; }\n  table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 9px; }\n  th, td { border: 1px solid #000; padding: 3px 4px; }\n  th { background-color: #f0f0f0; font-weight: bold; }\n  .text-right { text-align: right; }\n  .text-center { text-align: center; }\n  .badge { padding: 2px 5px; border-radius: 2px; font-size: 8px; display: inline-block; }\n  .badge-success { background-color: #28a745; color: white; }\n  .badge-warning { background-color: #ffc107; color: black; }\n  .badge-danger { background-color: #dc3545; color: white; }\n  .badge-info { background-color: #17a2b8; color: white; }\n  hr { border: 0; border-top: 1px solid #000; margin: 8px 0; }\n  @media print { \n    body { margin: 5mm; } \n    table { page-break-inside: auto; }\n    tr { page-break-inside: avoid; page-break-after: auto; }\n  }\n</style>\n</head>\n<body>\n\n<div class="company-title text-style">\n  <i>\n  <h1>${We.value.name}</h1>\n  <div><b>Address:</b> ${We.value.address}</div>\n  <div><b>Tel:</b> ${We.value.phone}, ${We.value.phone_2??""}</div>\n  <div><b>Email:</b> ${We.value.email}</div>\n  <div><b>TIN:</b> ${We.value.tin_no} &nbsp;&nbsp; <b>VRN:</b> ${We.value.vrn_no}</div>\n  </i>\n</div>\n\n<hr>\n\n<div class="title text-style">\n  ${Oe.value} ON ${Se.value}\n</div>\n\n\n<hr>\n\n<table>\n  <thead>\n    <tr>\n      <th>S/No.</th>\n      <th>Name</th>\n      <th>Position</th>\n      <th>Salary</th>\n      <th>Debt</th>\n      <th>Absence</th>\n      <th>Absence Deduction</th>\n      <th>Balance</th>\n      <th>Signature</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${a.map(((e,a)=>`\n    <tr>\n      <td style="font-weight:bold">${a+1}</td>\n      <td style="font-weight:bold">${e.name||"N/A"}</td>\n      <td style="font-weight:bold">${e.position||"N/A"}</td>\n      <td style="font-weight:bold;text-align:end">${e.salary||"N/A"}</td>\n      <td style="font-weight:bold;text-align:end">${e.debt||"N/A"}</td>\n      <td style="font-weight:bold">${e.days_absent||"N/A"}</td>\n      <td style="font-weight:bold;text-align:end">${fe(e.salary_deduction)||"N/A"}</td>\n      <td style="font-weight:bold ;width:120px;text-align:end${"approved"!==e?.status?.name?";text-decoration:line-through":""}">${e.balance||"N/A"}</td>\n      <td style="font-weight:bold ;width:120px;text-align:center">${"approved"===e?.status?.name?" ":e?.status?.name||"N/A"}</td>\n    </tr>\n    `)).join("")}\n    <tr style="font-weight: bold;">\n      <td colspan="7" class="text-right"><strong>TOTAL COST :</strong></td>\n      <td class="text-right"><strong>${fe(t)}</strong></td>\n    </tr>\n\n  </tbody>\n</table>\n\n\n\n<div style="margin-top: 15px; font-size: 7px;">\n  <p><strong>Report Generated:</strong> ${(new Date).toLocaleString()}</p>\n  <p><strong>Generated By:</strong> ${JSON.parse(localStorage.getItem("user")).name}</p>\n</div>\n\n</body>\n</html>\n`,s=l.contentWindow.document;s.open(),s.write(n),s.close(),l.onload=()=>{l.contentWindow.focus(),l.contentWindow.print(),setTimeout((()=>{document.body.removeChild(l)}),1e3)}}catch(a){Y(`Failed to print report: ${a.message}`)}},Je=(0,s.iH)([]),We=(0,s.iH)(""),Ge=async()=>{const e=await a.get("companies");Je.value=e.data};return(0,l.bv)((async()=>{Ge()})),(e,a)=>{const i=(0,l.up)("v-client-table");return(0,l.wg)(),(0,l.iD)("div",d,[u,((0,l.wg)(),(0,l.j4)(l.lR,{to:"#breadcrumb"},[(0,l._)("ul",c,[(0,l._)("li",b,[(0,l._)("div",v,[p,(0,l._)("ul",m,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Je.value,(e=>((0,l.wg)(),(0,l.iD)("li",{onClick:a=>Ie(e)},[(0,l._)("a",y,(0,n.zw)(e.name),1)],8,g)))),256))])])])])])),We.value?((0,l.wg)(),(0,l.iD)("h4",h,[(0,l.Uk)((0,n.zw)(Oe.value)+" "+(0,n.zw)(Se.value?" FOR "+Se.value:"")+" ",1),(0,l._)("div",w,[!(0,s.SU)(t).includes("can_approve_payroll")||"approved"===je.value?.status?.name&&null!==je.value||Re.value?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",_,["approved"!==Ue.value?.status?.name?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-primary me-2",onClick:a[0]||(a[0]=e=>Ne.value=3),disabled:Ve.value},"Approve ",8,k)):(0,l.kq)("",!0),(0,l._)("button",{class:"btn btn-danger me-2",onClick:a[1]||(a[1]=e=>Ne.value=4),disabled:Ve.value},"Reject",8,f),(0,l._)("button",{class:"btn btn-warning me-2",onClick:a[2]||(a[2]=e=>Ne.value=17),disabled:Ve.value},"Hold ",8,x),(0,l._)("button",{class:"btn btn-info me-2",onClick:a[3]||(a[3]=e=>Ne.value=14),disabled:Ve.value},"Remark",8,S)]))]),Ne.value?((0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("span",{class:(0,n.C_)(["badge rounded-pill",{"bg-danger":4==Ne.value,"bg-success":3==Ne.value,"bg-warning":17==Ne.value,"bg-info":3!=Ne.value&&4!=Ne.value}]),style:{"font-size":"1rem"}},(0,n.zw)(3==Ne.value?"Approve Payroll":17==Ne.value?"Hold Payroll":4==Ne.value?"Reject Payroll":"Fill Remark"),3)])):(0,l.kq)("",!0),je.value&&je.value?.remark?((0,l.wg)(),(0,l.iD)("div",D,(0,n.zw)(je.value.remarker.name)+"'s Remark "+(0,n.zw)(je.value.remark),1)):(0,l.kq)("",!0),Ne.value?((0,l.wg)(),(0,l.iD)("div",z,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:3==Ne.value?"Enter Approval Remark":4==Ne.value?"Enter Rejection Remark":"Enter Remark","onUpdate:modelValue":a[4]||(a[4]=e=>Me.value=e)},null,8,H),[[o.nr,Me.value]]),(0,l._)("button",{class:"btn btn-primary",type:"button",disabled:Ve.value,onClick:a[5]||(a[5]=e=>Be())},[Ve.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(xe)()},null,8,$)):((0,l.wg)(),(0,l.iD)("span",A,"Save"))],8,R)])):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("h4",E,"SELECT A COMPANY")),(0,l._)("div",N,[(0,l._)("div",M,[(0,l._)("div",L,[(0,l.wy)((0,l._)("input",{type:"month",class:"form-control me-2","onUpdate:modelValue":a[6]||(a[6]=e=>Se.value=e)},null,512),[[o.nr,Se.value]]),je.value&&(0,s.SU)(t).includes("can_print_payroll")?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-success",onClick:a[7]||(a[7]=e=>Fe(Le.value))},P)):(0,l.kq)("",!0)])])]),(0,l._)("div",T,[(0,l._)("div",U,[(0,l._)("div",q,[Re.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,s.SU)(He)()},null,8,O)):((0,l.wg)(),(0,l.iD)("div",V,[(0,l.Wm)(i,{data:Le.value,columns:$e.value,options:Ae.value},{status:(0,l.w5)((e=>[(0,l._)("span",{class:(0,n.C_)(["badge inv-status","badge-"+e.row?.status?.color])},(0,n.zw)(e.row?.status?.name),3)])),actions:(0,l.w5)((e=>[(0,l._)("a",{href:"javascript:void(0);",class:"text-primary",onClick:a=>qe(e.row),"data-bs-toggle":"modal","data-bs-target":"#employee-view-modal"},B,8,I)])),_:1},8,["data","columns","options"])]))])])]),(0,l._)("div",F,[(0,l._)("div",J,[(0,l._)("div",W,[(0,l._)("div",G,[(0,l._)("h1",K,"Employee Salary Details For "+(0,n.zw)(Ue.value?.name),1),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:a[8]||(a[8]=e=>Te()),id:"employee-status-close"})]),(0,l._)("div",Z,[Ue.value?((0,l.wg)(),(0,l.iD)("div",Q,[(0,l._)("div",X,[(0,l._)("div",ee,[(0,l._)("div",ae,[(0,l._)("table",te,[le,(0,l._)("tbody",null,[(0,l._)("tr",null,[(0,l._)("td",null,(0,n.zw)(Ue.value.name),1),(0,l._)("td",null,(0,n.zw)(Ue.value.position),1),(0,l._)("td",null,(0,n.zw)(Ue.value.salary),1),(0,l._)("td",null,(0,n.zw)(Ue.value.debt),1),(0,l._)("td",null,(0,n.zw)(Ue.value.absence),1),(0,l._)("td",null,(0,n.zw)(Ue.value.balance),1),(0,l._)("td",null,[(0,l._)("span",{class:(0,n.C_)(["badge inv-status","badge-"+Ue.value?.status?.color])},(0,n.zw)(Ue.value?.status?.name),3)])]),(0,l._)("tr",null,[Ue.value?.remark?((0,l.wg)(),(0,l.iD)("td",ne," Remark : "+(0,n.zw)(Ue.value.remark),1)):(0,l.kq)("",!0)])])])])])])])):(0,l.kq)("",!0),(0,s.SU)(t).includes("can_approve_payroll")&&"paid"!==Ue.value?.status?.name?((0,l.wg)(),(0,l.iD)("div",se,[oe,ie,(0,l._)("div",re,[(0,l._)("div",de,["approved"!==Ue.value?.status?.name?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-primary me-2",onClick:a[9]||(a[9]=e=>Ne.value=3),disabled:Ve.value},"Release ",8,ue)):(0,l.kq)("",!0),(0,l._)("button",{class:"btn btn-danger me-2",onClick:a[10]||(a[10]=e=>Ne.value=4),disabled:Ve.value},"Reject",8,ce),(0,l._)("button",{class:"btn btn-warning me-2",onClick:a[11]||(a[11]=e=>Ne.value=17),disabled:Ve.value},"Hold Salary",8,be),(0,l._)("button",{class:"btn btn-info me-2",onClick:a[12]||(a[12]=e=>Ne.value=14),disabled:Ve.value},"Remark",8,ve)])])])):(0,l.kq)("",!0),Ne.value?((0,l.wg)(),(0,l.iD)("div",pe,[(0,l._)("span",{class:(0,n.C_)(["badge rounded-pill",{"bg-danger":4==Ne.value,"bg-success":3==Ne.value,"bg-warning":17==Ne.value,"bg-info":3!=Ne.value&&4!=Ne.value}]),style:{"font-size":"1rem"}},(0,n.zw)(3==Ne.value?"Release Salary":17==Ne.value?"Hold Salary":4==Ne.value?"Reject Salary":"Fill Remark"),3)])):(0,l.kq)("",!0),Ne.value?((0,l.wg)(),(0,l.iD)("div",me,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:3==Ne.value?"Enter Approval Remark":4==Ne.value?"Enter Rejection Remark":"Enter Remark","onUpdate:modelValue":a[13]||(a[13]=e=>Me.value=e)},null,8,ge),[[o.nr,Me.value]]),(0,l._)("button",{class:"btn btn-primary",type:"button",disabled:Ve.value,onClick:a[14]||(a[14]=e=>Ye())},[Ve.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(xe)()},null,8,he)):((0,l.wg)(),(0,l.iD)("span",we,"Save"))],8,ye)])):(0,l.kq)("",!0)]),(0,l._)("div",_e,[(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:a[15]||(a[15]=e=>Te())},"Close")])])])]),ke])}}};const xe=fe;var Se=xe}}]);
//# sourceMappingURL=5138.c1fb2770.js.map