"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[213],{30213:function(e,t,a){a.r(t),a.d(t,{default:function(){return al}});a(26699);var l=a(66252),n=a(3577),s=a(2262),o=a(49963),d=a(87066),i=a(26212),u=a.n(i),r=a(56296),c=a(42119);const v=e=>((0,l.dD)("data-v-7deb6b42"),e=e(),(0,l.Cn)(),e),m={class:"layout-px-spacing"},b=(0,l.uE)('<ul class="navbar-nav flex-row" data-v-7deb6b42><li data-v-7deb6b42><div class="page-header" data-v-7deb6b42><nav class="breadcrumb-one" aria-label="breadcrumb" data-v-7deb6b42><ol class="breadcrumb" data-v-7deb6b42><li class="breadcrumb-item" data-v-7deb6b42><a href="javascript:;" data-v-7deb6b42>Budgets </a></li></ol></nav></div></li></ul>',1),p={key:0,class:"d-flex justify-content-center my-4"},_={class:"budget-status-card-container mt-3 col-md-6"},g={class:"card-header d-flex justify-content-between align-items-center"},h={class:"card-title mb-0 text-center w-100"},y={class:"card-body"},f={class:"card-text fs-5 text-start"},w={key:0,class:"mt-4"},x=v((()=>(0,l._)("h5",{class:"fs-5 text-dark text-start"},"Remarks:",-1))),k={class:"remarks-text fs-5 text-start"},S={key:1},U={class:"d-flex"},C=(0,l.Uk)("  Budgets "),T={class:"ms-auto"},D=(0,l.Uk)("  Purchase Orders "),H={class:"table table-bordered table-responsive mb-3"},z=v((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{colspan:"8",class:"bg-light text-center text-dark fs-6"},"Budget Details")])],-1))),q=v((()=>(0,l._)("th",null,"Project:",-1))),L=v((()=>(0,l._)("th",null,"Budget Name:",-1))),B=v((()=>(0,l._)("th",null,"Budget Iteme:",-1))),M=v((()=>(0,l._)("th",null,"Description:",-1))),A=v((()=>(0,l._)("th",null,"Allocated Amount:",-1))),E=v((()=>(0,l._)("th",null,"Budget Cost:",-1))),O=v((()=>(0,l._)("th",null,"Used Cost:",-1))),V=v((()=>(0,l._)("th",null,"Balance:",-1))),$={key:0,class:"table table-bordered table-responsive table-striped"},N=v((()=>(0,l._)("tr",null,[(0,l._)("th",{class:"text-dark fw-bold"},"ALLOCATED AMOUNT"),(0,l._)("th",{class:"text-success"},"ALLOCATED BALANCE"),(0,l._)("th",{class:"text-danger"},"UNALLOCATED AMOUNT"),(0,l._)("th",{class:"text-dark"},"BUDGET COST"),(0,l._)("th",{class:"text-dark"},"USED COST"),(0,l._)("th",{class:"text-dark"},"BUDGET STATUS")],-1))),R={key:0},I={class:"d-flex mt-1"},j={class:"ms-auto btn-group"},F=["disabled"],P=["innerHTML"],Q={key:1},W={class:"d-flex flex-wrap gap-2 mb-2 mt-4 justify-content-end align-items-center"},Y={class:"btn-group flex-wrap",style:{gap:"8px"}},G=v((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,l._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1))),J=(0,l.Uk)("  Print "),X=[G,J],K={key:1,class:"table-responsive shadow-lg"},Z={class:"row mt-2 justify-content-center g-2"},ee={class:"col-md-6"},te={class:"input-group"},ae={type:"submit",class:"btn btn-primary"},le=["innerHTML"],ne={key:1},se={class:"table table-bordered table-responsive mt-5"},oe=v((()=>(0,l._)("thead",{class:"thead-light table-reponsive"},[(0,l._)("tr",null,[(0,l._)("th",null,"Sno:"),(0,l._)("th",null,"Item"),(0,l._)("th",null,"Description")])],-1))),de={class:"table table-bordered table-responsive mt-5"},ie={class:"thead-light table-reponsive"},ue=v((()=>(0,l._)("th",null,"Sno:",-1))),re=v((()=>(0,l._)("th",null,"Item",-1))),ce=v((()=>(0,l._)("th",null,"Specification",-1))),ve=v((()=>(0,l._)("th",null,"Units",-1))),me=v((()=>(0,l._)("th",null,"Qty 1",-1))),be=v((()=>(0,l._)("th",null,"Qty 2",-1))),pe=v((()=>(0,l._)("th",null,"Rate",-1))),_e=v((()=>(0,l._)("th",null,"Cost",-1))),ge=["onClick"],he={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-plus-square"},ye=v((()=>(0,l._)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1))),fe=v((()=>(0,l._)("line",{x1:"12",y1:"8",x2:"12",y2:"16"},null,-1))),we=v((()=>(0,l._)("line",{x1:"8",y1:"12",x2:"16",y2:"12"},null,-1))),xe=[ye,fe,we],ke=(0,l.Uk)(" close "),Se=["onClick"],Ue=v((()=>(0,l._)("br",null,null,-1))),Ce=["onClick"],Te=v((()=>(0,l._)("br",null,null,-1))),De=v((()=>(0,l._)("br",null,null,-1))),He=v((()=>(0,l._)("hr",{style:{"border-top":"1px solid red"}},null,-1))),ze=v((()=>(0,l._)("br",null,null,-1))),qe=["onClick"],Le=v((()=>(0,l._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"},null,-1))),Be=v((()=>(0,l._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"},null,-1))),Me=[Le,Be],Ae=["onSubmit"],Ee={class:"row"},Oe={class:"col-md-2"},Ve=v((()=>(0,l._)("label",{class:"form-label"},"Item ",-1))),$e={class:"col-md-2"},Ne=v((()=>(0,l._)("label",{class:"form-label"},"Specification ",-1))),Re={class:"col-md-2"},Ie=v((()=>(0,l._)("label",{class:"form-label"},"Unit",-1))),je={class:"col-md-1"},Fe=v((()=>(0,l._)("label",{class:"form-label"},"Quantity",-1))),Pe={class:"col-md-1"},Qe=v((()=>(0,l._)("label",{class:"form-label"},"quantity_2",-1))),We={class:"col-md-1"},Ye=v((()=>(0,l._)("label",{class:"form-label"},"Rate",-1))),Ge={class:"col-md-1"},Je=v((()=>(0,l._)("label",{class:"form-label"},"Cost",-1))),Xe={class:"form-control"},Ke={class:"col-md-1"},Ze=v((()=>(0,l._)("label",{class:"form-label"},"Save",-1))),et={class:"btn-group",role:"group"},tt=["disabled"],at=["innerHTML"],lt={key:1},nt={class:"row"},st={class:"col-md-2"},ot=v((()=>(0,l._)("label",{class:"form-label"},"Item ",-1))),dt={class:"col-md-2"},it=v((()=>(0,l._)("label",{class:"form-label"},"Specification ",-1))),ut={class:"col-md-2"},rt=v((()=>(0,l._)("label",{class:"form-label"},"Unit",-1))),ct={class:"col-md-1"},vt=v((()=>(0,l._)("label",{class:"form-label"},"Quantity",-1))),mt={class:"col-md-1"},bt=v((()=>(0,l._)("label",{class:"form-label"},"Quantity_2",-1))),pt={class:"col-md-1"},_t=v((()=>(0,l._)("label",{class:"form-label"},"Rate",-1))),gt={class:"col-md-1"},ht=v((()=>(0,l._)("label",{class:"form-label"},"Cost",-1))),yt={class:"form-control"},ft={class:"col-md-1"},wt=v((()=>(0,l._)("label",{class:"form-label"},"Save",-1))),xt={class:"btn-group",role:"group"},kt=["disabled"],St=["innerHTML"],Ut={key:1},Ct=v((()=>(0,l._)("td",{colspan:"2",class:"text-start fw-bold"}," SUMMARY ",-1))),Tt={class:"table table-bordered table-responsive table-striped"},Dt=v((()=>(0,l._)("tr",null,[(0,l._)("th",{class:"text-dark fw-bold"},"ALLOCATED AMOUNT"),(0,l._)("th",{class:"text-success"},"ALLOCATED BALANCE"),(0,l._)("th",{class:"text-danger"},"UNALLOCATED AMOUNT"),(0,l._)("th",{class:"text-dark"},"BUDGET COST"),(0,l._)("th",{class:"text-dark"},"USED COST")],-1))),Ht={class:"modal fade mymodal",id:"consuptions","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},zt={class:"modal-dialog modal-fullscreen modal-dialog-scrollable"},qt={class:"modal-content"},Lt={class:"modal-header"},Bt=v((()=>(0,l._)("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"Budget Consumption Remarks",-1))),Mt={class:"modal-body flex-grow-1 overflow-auto"},At={class:"table table-bordered table-responsive mb-3"},Et=v((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{colspan:"8",class:"bg-light text-center text-dark fs-6"},"Budget Details")])],-1))),Ot=v((()=>(0,l._)("th",null,"Project:",-1))),Vt=v((()=>(0,l._)("th",null,"Budget Name:",-1))),$t=v((()=>(0,l._)("th",null,"Budget Item:",-1))),Nt=v((()=>(0,l._)("th",null,"Description:",-1))),Rt=v((()=>(0,l._)("th",null,"Allocated Amount:",-1))),It=v((()=>(0,l._)("th",null,"Budget Cost:",-1))),jt=v((()=>(0,l._)("th",null,"Used Cost:",-1))),Ft=v((()=>(0,l._)("th",null,"Balance:",-1))),Pt={key:0,class:"d-flex"},Qt=v((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-arrow-left-circle",viewBox:"0 0 16 16"},[(0,l._)("path",{"fill-rule":"evenodd",d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"})],-1))),Wt=(0,l.Uk)("   Back "),Yt={class:"ms-auto"},Gt={class:"row"},Jt={class:"col-md-2"},Xt={class:"col-md-8"},Kt={class:"col-md-2"},Zt={class:"btn-group w-100",role:"group"},ea=["disabled"],ta=["innerHTML"],aa={key:1},la={class:"row layout-top-spacing"},na={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},sa=["innerHTML"],oa={key:1,class:"panel p-0"},da={class:"custom-table table3",style:{"max-height":"95vh","overflow-y":"auto"}},ia=["onClick"],ua=v((()=>(0,l._)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"},null,-1))),ra=v((()=>(0,l._)("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"},null,-1))),ca=[ua,ra],va=v((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-arrow-right",style:{cursor:"pointer"},viewBox:"0 0 16 16"},[(0,l._)("path",{"fill-rule":"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"})],-1))),ma={class:"modal-footer"},ba={class:"modal fade mymodal",id:"edits","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},pa={class:"modal-dialog modal-xl modal-dialog-scrollable"},_a={class:"modal-content"},ga={class:"modal-header"},ha=v((()=>(0,l._)("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"Budget Item Editing Record",-1))),ya={class:"modal-body flex-grow-1 overflow-auto"},fa={class:"row layout-top-spacing"},wa={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},xa=["innerHTML"],ka={key:1,class:"panel p-0"},Sa={class:"custom-table table3"},Ua={class:"modal-footer"},Ca={class:"modal fade mymodal",id:"edit","data-bs-backdrop":"false","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Ta={class:"modal-dialog modal-xl"},Da={class:"modal-content"},Ha={class:"modal-header"},za={class:"modal-title fs-5",id:"staticBackdropLabel"},qa=v((()=>(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"close"},null,-1))),La={class:"modal-body"},Ba={class:"row"},Ma={class:"col-md-12"},Aa=v((()=>(0,l._)("label",{class:"form-label"},"Enter Any Remark ",-1))),Ea={class:"col-md-2"},Oa=v((()=>(0,l._)("label",{class:"form-label"},"Quantity",-1))),Va={class:"col-md-2"},$a=v((()=>(0,l._)("label",{class:"form-label"},"Quantity_2",-1))),Na={class:"col-md-3"},Ra=v((()=>(0,l._)("label",{class:"form-label"},"Rate",-1))),Ia={class:"col-md-3"},ja=v((()=>(0,l._)("label",{class:"form-label"},"Cost",-1))),Fa={class:"form-control"},Pa={class:"col-md-1"},Qa=v((()=>(0,l._)("label",{class:"form-label"},"Save",-1))),Wa={class:"btn-group",role:"group"},Ya=["disabled"],Ga=["innerHTML"],Ja={key:1},Xa=v((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger btn-sm py-2 px-2","data-bs-dismiss":"modal"},"Close")],-1))),Ka=v((()=>(0,l._)("button",{"data-bs-toggle":"modal","data-bs-target":"#edit",style:{display:"none"},id:"edit_button"},null,-1)));var Za={setup(e){const t=(0,c.yj)(),a=JSON.parse(localStorage.getItem("user")).permissions;(0,r.j)({title:"Budgets "});const i=(0,s.iH)(""),v=(0,s.iH)(!1),G=(0,l.f3)("showError"),J=(0,l.f3)("formatNumber"),ye=(0,l.f3)("showMessage"),fe=((0,l.f3)("pillShimmer"),(0,l.f3)("tableShimmer")),we=(0,l.f3)("loadingSpinner"),Le=d.Z.create({baseURL:"https://bushman.ink/api/v1/"}),Be=((0,s.iH)(!0),(0,s.iH)([])),ua=(0,s.iH)(""),ra=(0,s.iH)(!1),Za=(0,s.iH)(!1),el=(0,s.iH)(""),tl=(0,s.iH)(""),al=(0,s.iH)(""),ll=(0,s.iH)([]),nl=(0,l.Fl)((()=>({budget_item_description_id:t.params.budget_item_description_id?parseInt(t.params.budget_item_description_id):null})));(0,l.YP)([nl,Be],(([e,t])=>{if(e.budget_item_description_id&&t&&t.length>0){const a=t.find((t=>t.items?.some((t=>t.descriptions?.some((t=>t.id===e.budget_item_description_id))))));if(a){Yl(a);const t=a.items?.flatMap((e=>e.descriptions||[])).find((t=>t.id===e.budget_item_description_id));if(t){wl(t);const e=document.getElementById("consuptions"),a=new bootstrap.Modal(e);e.addEventListener("hidden.bs.modal",(function(){const e=document.querySelectorAll(".modal-backdrop");e.forEach((e=>{e.remove()})),document.body.classList.remove("modal-open"),document.body.style.overflow="auto",document.body.style.paddingRight=""})),a.show()}}}}),{immediate:!0});const sl=(0,s.iH)([]),ol=["Sno","editor","remark","quantity","quantity_2","rate","cost"],dl=async e=>{Il.value=!0;const t=await Le.get(`budget-edit-logs?description_id=${e}`);sl.value=t.data.map(((e,t)=>({...e,Sno:t+1,editor:e.editor.name,quantity:e.from_quantity+"➡️"+e.to_quantity,quantity_2:e.from_quantity_2+"➡️"+e.to_quantity_2,rate:J(e.from_rate)+" ➡️ "+J(e.to_rate),cost:J(e.from_quantity*e.from_quantity_2*e.from_rate)+" ➡️ "+J(e.to_quantity*e.to_quantity_2*e.to_rate)}))),Il.value=!1},il=async e=>{Il.value=!0,tl.value=al.value;const t={budget_item_description_id:e,from_quantity:kl.value.quantity,to_quantity:Ll.value,from_quantity_2:kl.value.quantity_2,to_quantity_2:Bl.value,from_rate:kl.value.cost,to_rate:Al.value,remark:ml.value,editor_id:JSON.parse(localStorage.getItem("user")).id};try{await Le.post("budget-edit-logs",t);const a=JSON.parse(localStorage.getItem("user")),l=ua.value.items.find((t=>t.descriptions.some((t=>t.id===e))));if(l){const t=l.descriptions.find((t=>t.id===e));t&&(t.last_editor=a.name)}Nl()}catch(a){G(a.message),console.log(a)}finally{Il.value=!1}},ul=(0,s.iH)(!1),rl=(0,s.iH)(""),cl=async()=>{Il.value=!0;const e={funded_amount:ua.value.funded_amount+rl.value};try{await Le.put(`budgets/${ua.value.id}`,e);ye("Fund added successfully"),ua.value.funded_amount=ua.value.funded_amount+rl.value,rl.value=""}catch(t){G(t.message),console.log(t)}finally{Il.value=!1,ul.value=!1}},vl=(0,s.iH)(""),ml=(0,s.iH)(""),bl=(0,s.iH)(""),pl=(0,s.iH)(!1),_l=async()=>{Il.value=!0;try{const e={date:(new Date).toISOString().split("T")[0],remarker_id:JSON.parse(localStorage.getItem("user")).id,approval_id:vl.value,description:ml.value+"This was created from LPO No: "+vl.value,budget_item_description_id:xl.value,cost:bl.value},t=await Le.post("budget-remarks",e),a=t.data;let l=parseFloat(kl.value.quantity*kl.value.quantity_2*kl.value.cost);kl.value.used_cost=(parseFloat(kl.value.used_cost||0)+parseFloat(a.cost)).toFixed(2),ua.value.total_used_cost=ua.value.total_used_cost+a.cost,hl.value=[...hl.value,{sno:hl.value.length+1,id:a.id,approved_by:JSON.parse(localStorage.getItem("user")).name,date:a.date,debit:a.cost>0?Number(a.cost).toLocaleString()+" Tsh":"--",credit:a.cost<0?Number(Math.abs(a.cost)).toLocaleString()+" Tsh":"--",description:a.description,balance:0}],hl.value=hl.value.map(((e,t)=>(l-=parseFloat(e.debit.replace(/[^0-9.-]+/g,""))||0,{...e,sno:t+1,balance:l.toLocaleString()+" Tsh"}))),wl(kl.value),ye("Remark added successfully"),ml.value="",bl.value="",vl.value="",pl.value=""}catch(e){G(e.message)}finally{Il.value=!1}},gl=async(e,t)=>{if(confirm("Are you sure you want to delete "+e.description+" with cost "+e.debit)){Il.value=!0;try{await Le.delete(`budget-remarks/${e.id}`);const a=parseFloat(e.debit.replace(/[^0-9.-]+/g,""))||0;t.used_cost=(parseFloat(t.used_cost)-a).toFixed(2),ua.value.total_used_cost=(parseFloat(ua.value.total_used_cost)-a).toFixed(2),hl.value=hl.value.filter((t=>t.id!==e.id));let l=parseFloat(t.quantity*t.quantity_2*t.cost);hl.value=hl.value.map(((e,t)=>(l-=parseFloat(e.debit.replace(/[^0-9.-]+/g,""))||0,{...e,sno:t+1,balance:l.toLocaleString()+" Tsh"}))),ye("Deleted successfully")}catch(a){G(a.message)}finally{Il.value=!1}}},hl=(0,s.iH)([]),yl=["sno","approved_by","date","description","debit","credit","balance","actions"],fl=(0,s.iH)(0),wl=async e=>{hl.value=[],Il.value=!0,fl.value=parseFloat(e.quantity*e.quantity_2*e.cost);const t=await Le.get(`budget-remarks?budget_item_description_id=${e.id}`);hl.value=t.data.map(((e,t)=>(fl.value-=parseFloat(e.cost),{...e,sno:t+1,id:e.id,approved_by:e.remarker.name,date:e.date,debit:e.cost>0?Number(e.cost).toLocaleString()+" Tsh":"--",credit:e.cost<0?Number(Math.abs(e.cost)).toLocaleString()+" Tsh":"--",description:e.description,balance:fl.value.toLocaleString()+" Tsh"}))),Il.value=!1},xl=(0,s.iH)(""),kl=(0,s.iH)(""),Sl=(0,s.iH)(0),Ul=(0,s.iH)(!1),Cl=(e,t)=>{if(kl.value=e,xl.value=e.id,"closed"===ua.value.status){if(!a.includes("can_open_budget")||0!=Ul.value)return Sl.value+=1,void(Sl.value>3&&(G("Budget Closed"),Sl.value=0));al.value=t,document.getElementById("edit_button").click()}else tl.value=t;zl.value=e.name,ql.value=e.specification||"",Ll.value=e.quantity,Bl.value=e.quantity_2,Al.value=e.cost,Ml.value=Dl.value.find((t=>t.short_name===e.units))},Tl=async e=>{if(ml.value=zl.value,Il.value=!0,!Ml.value&&!al.value)return G("Please fill all items"),void(Il.value=!1);const t={id:e,name:zl.value,specification:ql.value,quantity:Ll.value??0,quantity_2:Bl.value??0,...Ml.value?.short_name&&{units:Ml.value.short_name},cost:Al.value??0};try{await Le.put(`budget-item-descriptions/${e}`,t),ye("Updated Successfully"),"closed"===ua.value.status&&(tl.value=al.value);const a=ll.value.find((e=>e.id===tl.value));if(a&&a.descriptions){const l=a.descriptions.findIndex((t=>t.id===e));-1!==l&&(a.descriptions[l]={...a.descriptions[l],...t})}il(e),Nl()}catch(a){G(a.message),console.log(a)}finally{Il.value=!1}},Dl=(0,s.iH)(""),Hl=async()=>{const e=await Le.get("units");Dl.value=e.data},zl=(0,s.iH)(""),ql=(0,s.iH)(""),Ll=(0,s.iH)(""),Bl=(0,s.iH)(""),Ml=(0,s.iH)(""),Al=(0,s.iH)(""),El=(0,s.iH)(0),Ol=async e=>{if(!Ml.value)return void G("please enter unit");Il.value=!0;const t={budget_item_id:el.value,name:zl.value,specification:ql.value,quantity:Ll.value??0,quantity_2:Bl.value??0,units:Ml.value.short_name,cost:Al.value??0};try{await Le.post("budget-item-descriptions",t);ye("Description added successfully");const e=ll.value.find((e=>e.id===el.value));e&&(e.descriptions=e.descriptions||[],e.descriptions.push(t)),Nl(),tn()}catch(a){G(a.message),console.log(a)}finally{Il.value=!1}},Vl=(0,s.iH)(""),$l=async()=>{Il.value=!0;const e={budget_id:ua.value.id,name:Vl.value};try{const t=await Le.post("budget-items",e);ye("Item Added successfully"),ll.value.push(t.data),tn(),Vl.value="",Za.value=!1}catch(t){G(t.message),console.log(t)}finally{Il.value=!1}},Nl=()=>{Rl.value="",vl.value="",v.value=!1,Vl.value="",Za.value=!1,zl.value="",Ll.value="",Bl.value="",Ml.value="",Al.value="",El.value="",el.value="",xl.value="",tl.value="",bl.value="",ml.value="",pl.value="",al.value="",ml.value="",ql.value="",Ul.value=!1},Rl=(0,s.iH)(""),Il=(0,s.iH)(!1),jl=(0,s.iH)(!1),Fl=(0,s.iH)("danger"),Pl=(0,s.iH)(""),Ql=(0,s.iH)(""),Wl=(0,s.iH)(""),Yl=e=>{if(ua.value&&ua.value.id===e.id)return ua.value="",ll.value=[],void(jl.value=!1);const a=Gl.value.find((e=>e.budget_id===t.params.budget_id));a?"approved"===a.status?.name?(ua.value=e,ll.value=e.items,jl.value=!1,console.log("Budget data loaded successfully")):"Unapproved"===a.status?.name?(jl.value=!0,Fl.value="warning",Pl.value="Budget Unapproved",Ql.value="This budget is pending approval and cannot be accessed yet.",Wl.value=a.remark||"No remarks provided.",ua.value=e,ll.value=[]):"Rejected"===a.status?.name&&(jl.value=!0,Fl.value="danger",Pl.value="Budget Rejected",Ql.value="This budget has been rejected and cannot be accessed.",Wl.value=a.remark||"No rejection remarks provided.",ua.value=e,ll.value=[]):(ua.value=e,ll.value=e.items,jl.value=!1)},Gl=(0,s.iH)([]),Jl=(0,s.iH)(null),Xl=(0,s.iH)(null),Kl=(0,s.iH)(""),Zl=(0,s.iH)(""),en=async()=>{ra.value=!0;try{const e=await Le.get(`budget-item-descriptions/${t.params.budget_item_description_id}`),a=e.data;return Zl.value=e.data,Jl.value=a.budget_item.budget.id,Xl.value=a.budget_item.budget.project_id,i.value=a.budget_item.budget.project,Kl.value=a.budget_item,a}catch(e){return G(e.message),console.log(e),null}finally{ra.value=!1}},tn=async()=>{ra.value=!0;try{Jl.value&&Xl.value||await en();const e=await Le.get(`budgets?project_id=${Xl.value}&budget_id=${Jl.value}`);Be.value=e.data,console.log("Budgets fetched with:",{project_id:Xl.value,budget_id:Jl.value,budgets_count:Be.value.length})}catch(e){G(e.message),console.log(e)}finally{ra.value=!1}};(0,l.YP)(i,(e=>{e&&e.id&&(ua.value="",tn())})),(0,l.YP)(ua,(e=>{e&&(ll.value=e.items)}));const an=()=>{const e=document.querySelector(".modal.show");if(e){const t=bootstrap.Modal.getInstance(e);t?.hide()}document.body.classList.remove("modal-open"),document.body.style.overflow="auto",document.body.style.paddingRight=""};(0,l.bv)((async()=>{try{await en(),await tn(),Hl(),an()}catch(e){console.error("Error in onMounted:",e),G("Failed to load budget data")}})),(0,l.YP)([Jl,Be],(([e,t])=>{if(e&&t&&t.length>0){const a=t.find((t=>t.id===e));!a||ua.value&&ua.value.id===e||(console.log("Auto-selecting budget:",a.name),Yl(a))}}),{immediate:!1});const ln=async()=>{if(!ua.value)return void G("Please select a budget first");const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const t=(new Date).toLocaleDateString(),a=ua.value.funded_amount||0,l=ua.value.total_cost||0,n=ua.value.total_used_cost||0,s=l-n,o=a-l,d=`\n<!DOCTYPE html>\n<html>\n<head>\n<title>Budget Report - ${ua.value.name}</title>\n<style>\n  body { font-family: Arial, sans-serif; margin: 40px; font-size: 14px; }\n  .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }\n  .logo { width: 160px; height: auto; }\n  .report-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 14px; text-align: center; margin-left: auto; border-radius: 5px; }\n  .company-title { text-align: center; margin-top: 10px; flex-grow: 1; }\n  .company-title h2 { margin: 5px 0; font-size: 18px; }\n  .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 12px; line-height: 1.4; font-weight: normal; }\n  .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 15px 0 8px 0; font-size: 16px; }\n  .budget-info table { width: 100%; border-collapse: collapse; margin-bottom: 12px; border: 1px solid #666; }\n  .budget-info th, .budget-info td { padding: 6px; border: 1px solid #666; font-size: 13px; text-align: center; }\n  .budget-info th { background-color: #f5f5f5; }\n  .items-table { width: 100%; border-collapse: collapse; margin-top: 12px; border: 1px solid #666; }\n  .items-table th, .items-table td { border: 1px solid #666; padding: 6px; text-align: left; font-size: 13px; }\n  .items-table th { background-color: #f2f2f2; font-weight: bold; }\n  .summary-row { font-weight: bold; background-color: #e9e9e9; }\n  .text-right { text-align: right; }\n  .description-table { width: 100%; border-collapse: collapse; margin: 4px 0 8px 0; font-size: 12px; border: 1px solid #666; }\n  .description-table th, .description-table td { border: 1px solid #666; padding: 4px; }\n  .description-table th { background-color: #f8f8f8; }\n  .item-header { background-color: #eaeaea; font-weight: bold; padding: 4px; margin-top: 8px; border-bottom: 1px solid #666; font-size: 13px; }\n  @media print { body { margin: 8mm; } .no-print { display: none; } }\n</style>\n</head>\n<body>\n\n<div class="header">\n  <img src="https://bushman.ink/copex.jpg" class="logo" />\n  <div class="report-box">\n     Report Date <br>\n    <span style="color:red;">${t}</span>\n  </div>\n</div>\n\n<div class="reg-info">\n  TIN: 135-489-247<br>\n  VRN: 40-032826C\n</div>\n\n<div class="company-title">\n  <h2>COPEX CONTRACTORS CO.LTD</h2>\n  <div>Msamvu, P.O.BOX 678, Morogoro</div>\n  <div>Mobile, 0713 000 777, 0657 111 555</div>\n</div>\n\n<div class="section-title">BUDGET DETAILS</div>\n\n<div class="budget-info">\n  <table>\n    <thead>\n      <tr>\n        <th>Project</th>\n        <th>Budget Name</th>\n        <th>Allocated Amount</th>\n        <th>Unallocated Amount</th>\n        <th>Budget Cost</th>\n        <th>Used Cost</th>\n        <th>Balance</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>${i.value.short_name}</td>\n        <td>${ua.value.name}</td>\n        <td class="text-right">${J(a)} </td>\n        <td class="text-right">${J(o)} </td>\n        <td class="text-right">${J(l)} </td>\n        <td class="text-right">${J(n)} </td>\n        <td class="text-right">${J(s)} </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n<div class="section-title">BUDGET ITEMS DETAILS</div>\n<table class="items-table">\n  <thead>\n    <tr>\n      <th>#</th>\n      <th>Item</th>\n      <th>Descriptions</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${ll.value.map(((e,t)=>`\n        <tr>\n          <td>${t+1}</td>\n          <td>${e.name}</td>\n          <td>\n            ${e.descriptions.map(((e,t)=>{const a=(e.cost||0)*(e.quantity||0)*(e.quantity_2||1),l=parseFloat(e.used_cost)||0,n=a-l;return`\n                <div class="item-header">ITEM ${t+1}: ${e.name||"-"}</div>\n                <table class="description-table">\n                  <tr>\n                    <th>Specification</th>\n                    <th>Units</th>\n                    <th>Qty 1</th>\n                    <th>Qty 2</th>\n                    <th>Rate</th>\n                    <th>Budgeted</th>\n                    <th>Used</th>\n                    <th>Balance</th>\n                  </tr>\n                  <tr>\n                    <td>${e.specification||"-"}</td>\n                    <td>${e.units||"-"}</td>\n                    <td class="text-right">${e.quantity||0}</td>\n                    <td class="text-right">${e.quantity_2||1}</td>\n                    <td class="text-right">${J(e.cost||0)}</td>\n                    <td class="text-right">${J(a)}</td>\n                    <td class="text-right">${J(l)}</td>\n                    <td class="text-right">${J(n)}</td>\n                  </tr>\n                </table>\n              `})).join("")}\n          </td>\n        </tr>\n      `)).join("")}\n  </tbody>\n  <tfoot>\n    <tr class="summary-row">\n      <td colspan="2" class="text-right"><strong>GRAND TOTAL</strong></td>\n      <td>\n        <table class="description-table">\n          <tr>\n            <th>Total Budgeted</th>\n            <th>Total Used</th>\n            <th>Total Balance</th>\n          </tr>\n          <tr>\n            <td class="text-right">${J(l)} </td>\n            <td class="text-right">${J(n)} </td>\n            <td class="text-right">${J(s)} </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </tfoot>\n</table>\n\n<div style="margin-top: 40px; text-align: center; font-size: 12px; border-top: 1px solid #666; padding-top: 8px;">\n  <p>© ${(new Date).getFullYear()} COPEX CONTRACTORS CO.LTD | TIN: 135-489-247 | VRN: 40-032826C</p>\n  <p>Msamvu, P.O.BOX 678, Morogoro | Mobile: 0713 000 777, 0657 111 555</p>\n</div>\n\n</body>\n</html>\n`,u=e.contentWindow.document;u.open(),u.write(d),u.close(),e.onload=()=>{e.contentWindow.focus(),e.contentWindow.print(),setTimeout((()=>{document.body.removeChild(e)}),1e3)}};return(e,t)=>{const d=(0,l.up)("router-link"),r=(0,l.up)("v-client-table");return(0,l.wg)(),(0,l.iD)("div",m,[b,(0,l._)("div",null,[(0,l._)("div",null,[jl.value?((0,l.wg)(),(0,l.iD)("div",p,[(0,l._)("div",_,[(0,l._)("div",{class:(0,n.C_)(["card shadow border-start-primary h-100 p-4","card-"+Fl.value])},[(0,l._)("div",g,[(0,l._)("h4",h,(0,n.zw)(Pl.value),1)]),(0,l._)("div",y,[(0,l._)("p",f,(0,n.zw)(Ql.value),1),Wl.value?((0,l.wg)(),(0,l.iD)("div",w,[x,(0,l._)("p",k,(0,n.zw)(Wl.value),1)])):(0,l.kq)("",!0)])],2)])])):((0,l.wg)(),(0,l.iD)("div",S,[(0,l._)("div",U,[(0,l.Wm)(d,{to:"/budgets",class:"btn btn-primary mx-2 mt-2 mb-2",title:"Go to budgets"},{default:(0,l.w5)((()=>[C])),_:1}),(0,l._)("div",T,[(0,l.Wm)(d,{to:"/approval-chains/1",class:"btn btn-success mx-2 mt-2 mb-2",title:"Go to budgets"},{default:(0,l.w5)((()=>[D])),_:1})])]),(0,l._)("table",H,[z,(0,l._)("tbody",null,[(0,l._)("tr",null,[q,(0,l._)("td",null,(0,n.zw)(i.value?.short_name),1),L,(0,l._)("td",null,(0,n.zw)(ua.value.name),1),B,(0,l._)("td",null,(0,n.zw)(Kl.value.name),1),M,(0,l._)("td",null,(0,n.zw)(Zl.value.name),1)]),(0,l._)("tr",null,[A,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount))+" Tsh",1),E,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_cost))+" Tsh",1),O,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_used_cost))+" Tsh",1),V,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_used_cost))+" Tsh",1)])])]),ua.value?((0,l.wg)(),(0,l.iD)("table",$,[(0,l._)("thead",null,[N,(0,l._)("tr",null,[ul.value?((0,l.wg)(),(0,l.iD)("td",R,[(0,l._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)((e=>cl()),["prevent"]))},[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Add Funded amount","onUpdate:modelValue":t[0]||(t[0]=e=>rl.value=e),step:"any",min:"1",required:""},null,512),[[o.nr,rl.value]]),(0,l._)("div",I,[(0,l._)("div",j,[(0,l._)("button",{class:"btn btn-danger me-1 btn-sm p-2",onClick:t[1]||(t[1]=e=>(rl.value="",ul.value=!1))},"cancel"),(0,l._)("button",{type:"submit",class:"btn btn-primary btn-sm p-2",disabled:Il.value},[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,P)):((0,l.wg)(),(0,l.iD)("span",Q,"Submit"))],8,F)])])],32)])):((0,l.wg)(),(0,l.iD)("td",{key:1,onClick:t[3]||(t[3]=e=>ul.value=!0)},[(0,l._)("span",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount)),1)])),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_used_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_used_cost)),1),(0,l._)("td",null,(0,n.zw)(ua.value.status),1)])])])):(0,l.kq)("",!0),(0,l._)("div",W,[(0,l._)("div",Y,[ua.value?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn-success mx-2 mt-2",onClick:ln,title:"Print Report"},X)):(0,l.kq)("",!0)])]),ua.value?((0,l.wg)(),(0,l.iD)("div",K,[Za.value?((0,l.wg)(),(0,l.iD)("form",{key:0,onSubmit:t[5]||(t[5]=(0,o.iM)((e=>$l()),["prevent"]))},[(0,l._)("div",Z,[(0,l._)("div",ee,[(0,l._)("div",te,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Add Item","onUpdate:modelValue":t[4]||(t[4]=e=>Vl.value=e),required:""},null,512),[[o.nr,Vl.value]]),(0,l._)("button",ae,[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,le)):((0,l.wg)(),(0,l.iD)("span",ne,"Save"))])])])])],32)):(0,l.kq)("",!0),(0,l._)("table",se,[oe,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ll.value,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",null,[(0,l._)("td",null,(0,n.zw)(a+1),1),(0,l._)("td",null,(0,n.zw)(e.name),1),(0,l._)("td",null,[(0,l._)("table",de,[(0,l._)("thead",ie,[(0,l._)("tr",null,[ue,re,ce,ve,me,be,pe,_e,(0,l._)("th",null,["open"===ua.value.status?((0,l.wg)(),(0,l.iD)("button",{key:0,class:(0,n.C_)(["btn btn-sm p-2",e.id===el.value?"btn-danger":"btn-primary"]),onClick:t=>el.value=e.id===el.value?0:e.id},[e.id!==el.value?((0,l.wg)(),(0,l.iD)("svg",he,xe)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[ke],64))],10,ge)):(0,l.kq)("",!0)])])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.descriptions,((t,a)=>((0,l.wg)(),(0,l.iD)("tr",{onClick:a=>Cl(t,e.id)},[(0,l._)("td",null,(0,n.zw)(a+1),1),(0,l._)("td",null,[(0,l.Uk)((0,n.zw)(t.name)+" ",1),Ue,t.last_editor?((0,l.wg)(),(0,l.iD)("span",{key:0,onClick:e=>(dl(t.id),Ul.value=!0),"data-bs-toggle":"modal","data-bs-target":"#edits",style:{cursor:"pointer"},class:"badge badge-danger",title:"Click to view edit history"},"Edited By "+(0,n.zw)(t.last_editor),9,Ce)):(0,l.kq)("",!0)]),(0,l._)("td",null,(0,n.zw)(t.specification),1),(0,l._)("td",null,(0,n.zw)(t.units),1),(0,l._)("td",null,(0,n.zw)(t.quantity),1),(0,l._)("td",null,(0,n.zw)(t.quantity_2),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(t.cost)),1),(0,l._)("td",null,[(0,l.Uk)(" Budgeted : "+(0,n.zw)((0,s.SU)(J)(t.cost*t.quantity*t.quantity_2))+" ",1),Te,(0,l.Uk)(" Used Cost : "+(0,n.zw)((0,s.SU)(J)(t.used_cost)),1),De,(0,l.Uk)(" Used Qty : "+(0,n.zw)((t.used_cost/t.cost).toFixed(2))+" ",1),He,(0,l.Uk)(" Balance Budget : "+(0,n.zw)((0,s.SU)(J)(t.cost*t.quantity*t.quantity_2-t.used_cost)),1),ze,(0,l.Uk)(" Balance Qty : "+(0,n.zw)(((t.cost*t.quantity*t.quantity_2-t.used_cost)/t.cost).toFixed(2)),1)]),(0,l._)("td",null,[((0,l.wg)(),(0,l.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",fill:"currentColor",class:"bi bi-eye text-secondary",viewBox:"0 0 16 16",onClick:e=>(wl(t),Ul.value=!0),"data-bs-toggle":"modal","data-bs-target":"#consuptions"},Me,8,qe))])],8,Se)))),256))])]),el.value===e.id?((0,l.wg)(),(0,l.iD)("form",{key:0,onSubmit:(0,o.iM)((t=>Ol(e.id)),["prevent"])},[(0,l._)("div",Ee,[(0,l._)("div",Oe,[Ve,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Item","onUpdate:modelValue":t[6]||(t[6]=e=>zl.value=e),required:""},null,512),[[o.nr,zl.value]])]),(0,l._)("div",$e,[Ne,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Specification","onUpdate:modelValue":t[7]||(t[7]=e=>ql.value=e)},null,512),[[o.nr,ql.value]])]),(0,l._)("div",Re,[Ie,(0,l.Wm)((0,s.SU)(u()),{modelValue:Ml.value,"onUpdate:modelValue":t[8]||(t[8]=e=>Ml.value=e),options:Dl.value,label:"short_name","track-by":"id",placeholder:"Select Unit",searchable:!0,"append-to-body":!0},null,8,["modelValue","options"])]),(0,l._)("div",je,[Fe,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 1","onUpdate:modelValue":t[9]||(t[9]=e=>Ll.value=e),step:"any",required:""},null,512),[[o.nr,Ll.value]])]),(0,l._)("div",Pe,[Qe,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 2","onUpdate:modelValue":t[10]||(t[10]=e=>Bl.value=e),step:"any",required:""},null,512),[[o.nr,Bl.value]])]),(0,l._)("div",We,[Ye,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Rate","onUpdate:modelValue":t[11]||(t[11]=e=>Al.value=e),step:"any",required:""},null,512),[[o.nr,Al.value]])]),(0,l._)("div",Ge,[Je,(0,l._)("label",Xe,(0,n.zw)(Number(Ll.value*Bl.value*Al.value).toLocaleString())+"/=",1)]),(0,l._)("div",Ke,[Ze,(0,l._)("div",et,[(0,l._)("button",{type:"submit",class:"btn btn-primary me-1",disabled:Il.value},[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,at)):((0,l.wg)(),(0,l.iD)("span",lt," Submit "))],8,tt),(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[12]||(t[12]=e=>el.value=!1)}," Cancel ")])])])],40,Ae)):(0,l.kq)("",!0),tl.value===e.id&&"open"===ua.value.status?((0,l.wg)(),(0,l.iD)("form",{key:1,onSubmit:t[20]||(t[20]=(0,o.iM)((e=>Tl(xl.value)),["prevent"]))},[(0,l._)("div",nt,[(0,l._)("div",st,[ot,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Item","onUpdate:modelValue":t[13]||(t[13]=e=>zl.value=e)},null,512),[[o.nr,zl.value]])]),(0,l._)("div",dt,[it,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Specification","onUpdate:modelValue":t[14]||(t[14]=e=>ql.value=e)},null,512),[[o.nr,ql.value]])]),(0,l._)("div",ut,[rt,(0,l.Wm)((0,s.SU)(u()),{modelValue:Ml.value,"onUpdate:modelValue":t[15]||(t[15]=e=>Ml.value=e),options:Dl.value,label:"short_name","track-by":"id",placeholder:"Select Unit",searchable:!0,"append-to-body":!0},null,8,["modelValue","options"])]),(0,l._)("div",ct,[vt,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 1","onUpdate:modelValue":t[16]||(t[16]=e=>Ll.value=e),step:"any"},null,512),[[o.nr,Ll.value]])]),(0,l._)("div",mt,[bt,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 2","onUpdate:modelValue":t[17]||(t[17]=e=>Bl.value=e),step:"any"},null,512),[[o.nr,Bl.value]])]),(0,l._)("div",pt,[_t,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Rate","onUpdate:modelValue":t[18]||(t[18]=e=>Al.value=e),step:"any"},null,512),[[o.nr,Al.value]])]),(0,l._)("div",gt,[ht,(0,l._)("label",yt,(0,n.zw)(Number(Ll.value*Bl.value*Al.value).toLocaleString())+"/=",1)]),(0,l._)("div",ft,[wt,(0,l._)("div",xt,[(0,l._)("button",{type:"submit",class:"btn btn-primary me-1",disabled:Il.value},[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,St)):((0,l.wg)(),(0,l.iD)("span",Ut,"Update"))],8,kt),(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[19]||(t[19]=e=>Nl())}," Cancel ")])])])],32)):(0,l.kq)("",!0)])])))),256))]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[Ct,(0,l._)("td",null,[(0,l._)("table",Tt,[(0,l._)("thead",null,[Dt,(0,l._)("tr",null,[(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_used_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_cost)),1),(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_used_cost)),1)])])])])])])])])):(0,l.kq)("",!0)]))])]),(0,l._)("div",Ht,[(0,l._)("div",zt,[(0,l._)("div",qt,[(0,l._)("div",Lt,[Bt,(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[21]||(t[21]=e=>Nl())})]),(0,l._)("div",Mt,[(0,l._)("table",At,[Et,(0,l._)("tbody",null,[(0,l._)("tr",null,[Ot,(0,l._)("td",null,(0,n.zw)(i.value?.short_name),1),Vt,(0,l._)("td",null,(0,n.zw)(ua.value.name),1),$t,(0,l._)("td",null,(0,n.zw)(Kl.value.name),1),Nt,(0,l._)("td",null,(0,n.zw)(Zl.value.name),1)]),(0,l._)("tr",null,[Rt,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount))+" Tsh",1),It,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_cost))+" Tsh",1),jt,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.total_used_cost))+" Tsh",1),Ft,(0,l._)("td",null,(0,n.zw)((0,s.SU)(J)(ua.value.funded_amount-ua.value.total_used_cost))+" Tsh",1)])])]),!pl.value&&(0,s.SU)(a).includes("can_add_budget_consumption")?((0,l.wg)(),(0,l.iD)("div",Pt,[(0,l.Wm)(d,{to:"/approval-chains/1",class:"btn btn-dark btn-sm"},{default:(0,l.w5)((()=>[Qt,Wt])),_:1}),(0,l._)("div",Yt,[(0,l._)("button",{class:"btn btn-primary btn-sm",onClick:t[22]||(t[22]=e=>pl.value=!pl.value)}," Add Remark")])])):(0,l.kq)("",!0),pl.value?((0,l.wg)(),(0,l.iD)("form",{key:1,onSubmit:t[26]||(t[26]=(0,o.iM)((e=>_l()),["prevent"]))},[(0,l._)("div",Gt,[(0,l._)("div",Jt,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[23]||(t[23]=e=>bl.value=e),class:"form-control mb-2",type:"number",placeholder:"Enter cost spent",required:""},null,512),[[o.nr,bl.value]])]),(0,l._)("div",Xt,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[24]||(t[24]=e=>vl.value=e),class:"form-control mb-2",type:"number",placeholder:"Enter LPO number",required:""},null,512),[[o.nr,vl.value]])]),(0,l._)("div",Kt,[(0,l._)("div",Zt,[(0,l._)("button",{type:"button",class:"btn btn-danger me-1",onClick:t[25]||(t[25]=e=>Nl())},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-primary",disabled:Il.value},[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,ta)):((0,l.wg)(),(0,l.iD)("span",aa,"Save"))],8,ea)])])])],32)):(0,l.kq)("",!0),(0,l._)("div",la,[(0,l._)("div",na,[Il.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,s.SU)(fe)()},null,8,sa)):((0,l.wg)(),(0,l.iD)("div",oa,[(0,l._)("div",da,[(0,l.Wm)(r,{data:hl.value,columns:yl},{actions:(0,l.w5)((e=>[(0,s.SU)(a).includes("can_delete_budget_description_remark")?((0,l.wg)(),(0,l.iD)("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-trash text-danger me-2",onClick:t=>gl(e.row,kl.value),viewBox:"0 0 16 16"},ca,8,ia)):(0,l.kq)("",!0),(0,l.Wm)(d,{to:`/approval/${e.row.approval_id}`},{default:(0,l.w5)((()=>[va])),_:2},1032,["to"])])),_:1},8,["data"])])]))])])]),(0,l._)("div",ma,[(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:t[27]||(t[27]=e=>Nl())},"Close")])])])]),(0,l._)("div",ba,[(0,l._)("div",pa,[(0,l._)("div",_a,[(0,l._)("div",ga,[ha,(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[28]||(t[28]=e=>Nl())})]),(0,l._)("div",ya,[(0,l._)("div",fa,[(0,l._)("div",wa,[Il.value?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:(0,s.SU)(fe)()},null,8,xa)):((0,l.wg)(),(0,l.iD)("div",ka,[(0,l._)("div",Sa,[(0,l.Wm)(r,{data:sl.value,columns:ol},null,8,["data"])])]))])])]),(0,l._)("div",Ua,[(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:t[29]||(t[29]=e=>Nl())},"Close")])])])]),(0,l._)("div",Ca,[(0,l._)("div",Ta,[(0,l._)("div",Da,[(0,l._)("div",Ha,[(0,l._)("h1",za,(0,n.zw)(kl.value.name),1),qa]),(0,l._)("div",La,[(0,l._)("form",{onSubmit:t[35]||(t[35]=(0,o.iM)((e=>Tl(xl.value)),["prevent"]))},[(0,l._)("div",Ba,[(0,l._)("div",Ma,[Aa,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"Enter Remark","onUpdate:modelValue":t[30]||(t[30]=e=>ml.value=e)},null,512),[[o.nr,ml.value]])]),(0,l._)("div",Ea,[Oa,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 1","onUpdate:modelValue":t[31]||(t[31]=e=>Ll.value=e),step:"any"},null,512),[[o.nr,Ll.value]])]),(0,l._)("div",Va,[$a,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Qty 2","onUpdate:modelValue":t[32]||(t[32]=e=>Bl.value=e),step:"any"},null,512),[[o.nr,Bl.value]])]),(0,l._)("div",Na,[Ra,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"Rate","onUpdate:modelValue":t[33]||(t[33]=e=>Al.value=e),step:"any"},null,512),[[o.nr,Al.value]])]),(0,l._)("div",Ia,[ja,(0,l._)("label",Fa,(0,n.zw)(Number(Ll.value*Bl.value*Al.value).toLocaleString())+"/=",1)]),(0,l._)("div",Pa,[Qa,(0,l._)("div",Wa,[(0,l._)("button",{type:"submit",class:"btn btn-primary me-1",disabled:Il.value},[Il.value?((0,l.wg)(),(0,l.iD)("span",{key:0,innerHTML:(0,s.SU)(we)()},null,8,Ga)):((0,l.wg)(),(0,l.iD)("span",Ja,"Update"))],8,Ya),(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[34]||(t[34]=e=>Nl())}," Cancel ")])])])],32)]),Xa])])]),Ka])}}},el=a(83744);const tl=(0,el.Z)(Za,[["__scopeId","data-v-7deb6b42"]]);var al=tl}}]);
//# sourceMappingURL=213.cf6a01bf.js.map