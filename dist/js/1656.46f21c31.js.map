{"version":3,"file":"js/1656.46f21c31.js","mappings":"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","sources":["webpack://cork-vue3/./src/components/reusables/globalSearch.js","webpack://cork-vue3/./src/components/reusables/globalSearchField.vue","webpack://cork-vue3/./src/components/reusables/globalSearchField.vue?f760","webpack://cork-vue3/./src/views/stores/binCard.vue","webpack://cork-vue3/./src/views/stores/binCard.vue?2672"],"sourcesContent":["export function globalSearch(data, keyword) {\r\n  const lowerKeyword = keyword.toLowerCase().trim()\r\n  if (!lowerKeyword) return data\r\n\r\n  const containsKeyword = obj => {\r\n    if (obj == null) return false\r\n    if (typeof obj === 'string') return obj.toLowerCase().includes(lowerKeyword)\r\n    if (Array.isArray(obj)) return obj.some(containsKeyword)\r\n    if (typeof obj === 'object')\r\n      return Object.values(obj).some(containsKeyword)\r\n    return false\r\n  }\r\n\r\n  return data.filter(item => containsKeyword(item))\r\n}","<template>\r\n     <form @submit.prevent class=\"input-group container\">\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control border-end-0\"\r\n      placeholder=\"Search a word...\"\r\n      v-model=\"filter\"\r\n    >\r\n    <span class=\"input-group-text bg-white border-start-0\">\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" fill=\"currentColor\" class=\"bi bi-search\" viewBox=\"0 0 16 16\">\r\n        <path d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.442.656a5 5 0 1 1 \r\n        0-10 5 5 0 0 1 0 10z\"/>\r\n      </svg>\r\n    </span>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from 'vue'\r\n\r\n\r\nconst emit = defineEmits(['update:filterValue'])\r\nconst props = defineProps({\r\n  filterValue: String\r\n})\r\nconst filter = ref(props.filterValue || null)\r\n\r\nwatch(filter, val => emit('update:filterValue', val))\r\n</script>\r\n","import script from \"./globalSearchField.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./globalSearchField.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div class=\"layout-px-spacing\">  \r\n        <ul class=\"navbar-nav flex-row mt-2\">\r\n            <li>\r\n                <div class=\"page-header\">\r\n                    <nav class=\"breadcrumb-one\" aria-label=\"breadcrumb\">\r\n                        <ol class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a href=\"javascript:;\">Masters</a></li>\r\n                            <li class=\"breadcrumb-item active\" aria-current=\"page\"><span>Bin Cards</span></li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n\r\n        <div class=\"d-flex\">\r\n          <div class=\"ms-auto w-25\">\r\n           <multiselect \r\n                v-model=\"selectedStore\"\r\n                :options=\"stores\"\r\n                placeholder=\"select store\"\r\n                label=\"name\"\r\n                :searchable=\"true\"        \r\n                :multiple=\"false\"\r\n                :required=\"true\"\r\n                :allow-empty=\"false\"\r\n            ></multiselect>\r\n          </div>\r\n \r\n        </div>\r\n\r\n        <!-- loading spinner starts -->\r\n        <div v-if=\"loading_spinner\" v-html=\"loadingIndicator()\"></div>\r\n        <!-- Loading spinner ends -->\r\n\r\n        \r\n        <div v-else class=\"d-flex align-items-center me-4 mt-2 my-4 position-relative w-100\">\r\n    \r\n            <!-- Centered Header -->\r\n            <div class=\"flex-grow-1 text-center\">\r\n                <h3 class=\"m-0\"> <span v-if=\"selectedStore\">BIN CARDS FOR {{ selectedStore.name }}</span><span v-else> SELECT A STORE TO VIEW BIN CARDS</span></h3>\r\n                <div class=\"d-flex justify-content-center align-items-center mt-2\">\r\n                    <global-search-field\r\n                        v-model:filterValue=\"filter\"\r\n                    />\r\n                </div>\r\n            </div>\r\n \r\n            <!-- Button on the right -->\r\n            <div class=\"ms-auto\" v-if=\"selectedStore && user_permissions.includes('can_create_bin_card')\">\r\n                <button class=\"btn btn-primary\" @click=\"conversion_factor = !conversion_factor\">\r\n                   <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-plus-square\" viewBox=\"0 0 16 16\"> <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\"/> <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4\"/> </svg>\r\n                </button>\r\n            </div>\r\n                 \r\n        </div>\r\n\r\n        <div class=\"my-4\">\r\n            <!-- item registration form starts -->\r\n            <form v-if=\"conversion_factor\" class=\"mt-3 p-3 border rounded bg-white shadow\" @submit.prevent=\"registerBinCard\">\r\n                <h4 class=\"text-center\">REGISTER BIN CARD </h4>\r\n\r\n                <div class=\"row mb-2\">\r\n                    <div class=\"col-md-3\">\r\n                        <label class=\"form-label small\">Item Source</label>\r\n                        <multiselect \r\n                            v-model=\"source\"\r\n                            :options=\"['store','general']\"\r\n                            placeholder=\"select source\"\r\n                            :searchable=\"true\"        \r\n                            :multiple=\"false\"\r\n                            :required=\"true\"\r\n                            :allow-empty=\"true\"\r\n                        ></multiselect>\r\n                    </div>\r\n                    <div v-if=\"source === 'general'\" class=\"col-md-3\">\r\n                        <label class=\"form-label\"> Name</label>\r\n                        <input type=\"text\" class=\"form-control\" placeholder=\"Enter Name\" v-model=\"name\" required>\r\n                    </div>\r\n                    <div v-if=\"source === 'store'\" class=\"col-md-4\">\r\n                        <label class=\"form-label small\">Select Store</label>\r\n                        <multiselect \r\n                            v-model=\"store\"\r\n                            :options=\"stores\"\r\n                            placeholder=\"select store\"\r\n                            label=\"name\"\r\n                            :searchable=\"true\"        \r\n                            :multiple=\"false\"\r\n                            :required=\"true\"\r\n                            :allow-empty=\"false\"\r\n                        ></multiselect>\r\n                    </div>\r\n\r\n                    <div v-if=\"store\" class=\"col-md-5\">\r\n                        <label class=\"form-label small\">Select Item </label>\r\n                        <multiselect \r\n                            v-model=\"storeItem\"\r\n                            :options=\"storeItems\"\r\n                            placeholder=\"select item\"\r\n                            label=\"name\"\r\n                            :searchable=\"true\"        \r\n                            :multiple=\"false\"\r\n                            :required=\"true\"\r\n                            :allow-empty=\"false\"\r\n                        ></multiselect>\r\n                    </div>\r\n\r\n                    <div v-if=\"source === 'general'\" class=\"col-md-2\">\r\n                        <label class=\"form-label small\">Unit</label>\r\n                        <multiselect \r\n                            v-model=\"units\"\r\n                            :options=\"unitList\"\r\n                            placeholder=\"select unit\"\r\n                            label=\"short_name\"\r\n                            :searchable=\"true\"        \r\n                            :multiple=\"false\"\r\n                            :required=\"true\"\r\n                            :allow-empty=\"false\"\r\n                        ></multiselect>\r\n                    </div>\r\n                </div>\r\n                <div class=\"text-center gap-2 justify-content-end\">\r\n                    <button type=\"button\" class=\"btn btn-danger me-3\" @click=\"conversion_factor = false; resetForm();\">Cancel</button>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">Register</button>\r\n                </div>\r\n            </form>\r\n            <!-- item registration form ends-->\r\n        </div>\r\n\r\n         <div v-if=\"!selectedStore\">\r\n           \r\n        </div>\r\n\r\n        <!-- Bin Cards List -->\r\n        <div v-else class=\"accordion accordion-flush\" id=\"accordionFlushExample\">\r\n            <div class=\"accordion-item\" v-for=\"(binCard, index) in filteredBinCardsWithBalance\" :key=\"binCard.id\">\r\n                <h2 class=\"accordion-header\">\r\n                    <button class=\"accordion-button collapsed\" type=\"button\" \r\n                        :data-bs-toggle=\"'collapse'\" \r\n                        :data-bs-target=\"'#flush-collapse-' + binCard.id\" \r\n                        aria-expanded=\"false\" \r\n                        :aria-controls=\"'flush-collapse-' + binCard.id\">\r\n                        {{ index + 1 }} : &nbsp;&nbsp; {{ binCard.name ?? binCard.store_item?.item?.name }} &nbsp;&nbsp;   {{  binCard.store_item.item.description }} &nbsp;&nbsp; {{  binCard.store_item?.item_condition }}  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : &nbsp; {{ binCard.balance }}  &nbsp; {{ binCard.unit_name || binCard.store_item?.item?.unit }}  &nbsp; {{ binCard.description }}\r\n                    </button>\r\n                </h2>\r\n                <div :id=\"'flush-collapse-' + binCard.id\" class=\"accordion-collapse collapse\" :data-bs-parent=\"'#accordionFlushExample'\">\r\n                    <div class=\"accordion-body\">\r\n                        <div class=\"d-flex justify-content-end mb-3\">  \r\n                            <button class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#add-item-modal\" @click=\"openAddItemModal(binCard)\" > \r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-plus-square\" viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\"/>\r\n                                    <path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4\"/>\r\n                                </svg>\r\n                            </button>\r\n                            <button class=\"btn btn-success ms-2\" @click=\"printBinCard(binCard)\">\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1\"/>\r\n                                    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1\"/>\r\n                                </svg>\r\n                            </button>\r\n                        </div> \r\n\r\n                        <div class=\"panel p-0 mt-3\">                            \r\n                            <div class=\"custom-table table3 mt-3\">\r\n                                <v-client-table \r\n                                    :data=\"getTableData(binCard.items)\" \r\n                                    :columns=\"item_columns\" \r\n                                    :options=\"table_option\">\r\n                                    <template #actions=\"props\">\r\n                              \r\n                                <a href=\"javascript:;\" class=\"edit me-3\" @click=\"openEditItemModal(props.row)\" data-bs-toggle=\"modal\" :data-bs-target=\"'#edit-conversion-factor-modal'\" v-if=\"user_permissions.includes('can_edit_bin_card_items')\">\r\n                                    <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"24\"\r\n        height=\"24\"\r\n        viewBox=\"0 0 24 24\"\r\n        fill=\"none\"\r\n        stroke=\"currentColor\"\r\n        stroke-width=\"1.5\"\r\n        stroke-linecap=\"round\"\r\n        stroke-linejoin=\"round\"\r\n        class=\"text-primary\"\r\n        style=\"cursor: pointer;\"\r\n        title=\"Edit Activity\"\r\n      >\r\n        <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n        <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n      </svg>\r\n                                </a>\r\n                                <a href=\"javascript:;\" class=\"cancel\" @click=\"deleteBinCardItem(props.row)\" v-if=\"user_permissions.includes('can_delete_bin_card_items')\">\r\n                                    <span \r\n                                        v-if=\"deletingItemId === props.row.id\"\r\n                                        class=\"spinner-border spinner-border-sm text-danger\" \r\n                                        role=\"status\" \r\n                                        aria-hidden=\"true\"\r\n                                        style=\"width: 24px; height: 24px;\"\r\n                                    ></span>\r\n                                    <svg\r\n                                        v-else\r\n                                        xmlns=\"http://www.w3.org/2000/svg\"\r\n                                        width=\"24\"\r\n                                        height=\"24\"\r\n                                        viewBox=\"0 0 24 24\"\r\n                                        fill=\"none\"\r\n                                        stroke=\"currentColor\"\r\n                                        stroke-width=\"1.5\"\r\n                                        stroke-linecap=\"round\"\r\n                                        stroke-linejoin=\"round\"\r\n                                        class=\"text-danger\"\r\n                                    >\r\n                                        <polyline points=\"3 6 5 6 21 6\"></polyline>\r\n                                        <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\r\n                                    </svg>\r\n                                </a>\r\n                            </template>\r\n                                </v-client-table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n    <div v-if=\"filteredBinCardsWithBalance.length === 0\" class=\"alert alert-light text-center\">\r\n                No bin cards found for the selected store\r\n            </div>\r\n          \r\n        </div>\r\n    </div>\r\n\r\n    <!-- add binCard item starts -->\r\n    <div class=\"modal fade mymodal\" id=\"add-item-modal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"itemModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-xl\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h1 class=\"modal-title fs-5\" id=\"itemModalLabel\">Add Bin Card Entry For {{ binCard.name ?? binCard.store_item?.item?.name }}</h1>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"closebinCardModal()\" id=\"close_item\"></button>\r\n                </div>\r\n                <form @submit.prevent=\"AddBinCardItem()\">\r\n                    <div class=\"modal-body\">\r\n                        <div class=\"row mb-3\">\r\n                            <div class=\"col-md-4\">\r\n                                <label for=\"quantity\"> Ref No</label>\r\n                                <input type=\"number\" v-model=\"ref_no\" class=\"form-control\" placeholder=\"Enter Ref No\" step=\"any\" required >\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <label for=\"quantity\"> Received Quantity</label>\r\n                                <input type=\"number\" v-model=\"received\" class=\"form-control\" placeholder=\"Enter Received Quantity\" step=\"any\" >\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <label for=\"quantity\"> Isused Quantity</label>\r\n                                <input type=\"number\" v-model=\"issued\" class=\"form-control\" placeholder=\"Enter Issued Quantity\" step=\"any\" >\r\n                            </div>\r\n                            <div class=\"col-md-12\">\r\n                                <label for=\"remark\"> Remark</label>\r\n                                <input type=\"text\" v-model=\"remark\" class=\"form-control\" placeholder=\"Enter Remark\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-danger\" data-bs-dismiss=\"modal\" @click=\"closebinCardModal()\" id=\"close_item\">Close</button>\r\n                        <button class=\"btn btn-primary me-2 mt-1\" :disabled=\"isSending\">\r\n                            <span v-if=\"isSending\" v-html=\"loadingSpinner()\"></span>\r\n                            <span>Save</span>\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!-- add binCard item ends -->\r\n\r\n             <!-- Edit bin card item  modal starts -->\r\n<div class=\"modal fade mymodal\" id=\"edit-conversion-factor-modal\" data-bs-backdrop=\"false\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"editConversionFactorModalLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-xl\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h1 class=\"modal-title fs-5\" id=\"editConversionFactorModalLabel\">Edit Conversion Factor</h1>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"closeEditModal()\"></button>\r\n      </div>\r\n      <form @submit.prevent=\"updateBinCardItem(bin_card_item_id)\">\r\n        <div class=\"modal-body\">\r\n            <div class=\"row mb-3\">\r\n                <div class=\"col-md-4\">\r\n                                <label for=\"quantity\"> Ref No</label>\r\n                                <input type=\"number\" v-model=\"ref_no\" class=\"form-control\" placeholder=\"Enter Ref No\" step=\"any\">\r\n                 </div>\r\n                <div class=\"col-md-4\">\r\n                <label for=\"quantity\"> Received Quantity</label>\r\n              <input type=\"number\" v-model=\"received\" class=\"form-control\" placeholder=\"Enter Quantity\" step=\"any\">\r\n            </div>\r\n            <div class=\"col-md-4\">\r\n                <label for=\"quantity\"> Issued Quantity</label>\r\n              <input type=\"number\" v-model=\"issued\" class=\"form-control\" placeholder=\"Enter Quantity\" step=\"any\">\r\n            </div>\r\n            <div class=\"col-md-12\">\r\n                                <label for=\"remark\"> Remark</label>\r\n                                <input type=\"text\" v-model=\"remark\" class=\"form-control\" placeholder=\"Enter Remark\">\r\n                            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" @click=\"closeEditModal()\" id=\"close_editing\">Close</button>\r\n          <button type=\"submit\" class=\"btn btn-primary\">\r\n            <span v-if=\"loading_spinner\" class=\"spinner-border spinner-border-sm text-white me-2\" role=\"status\"></span>\r\n            Edit\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- Edit bin card item modal ends -->\r\n</template>\r\n\r\n<script setup>\r\n    import { onMounted, ref, inject, watch, computed } from 'vue';\r\n    import axios from 'axios';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    import Multiselect from '@suadelabs/vue3-multiselect';\r\n    import '@suadelabs/vue3-multiselect/dist/vue3-multiselect.css';\r\n    import globalSearchField from '@/components/reusables/globalSearchField.vue';\r\n    import { globalSearch } from '@/components/reusables/globalSearch';\r\n    \r\n    useMeta({ title: 'Bin Cards' });  \r\n    const loadingIndicator = inject('loadingIndicator');\r\n    const showMessage = inject('showMessage');\r\n    const conversion_factor = ref(false);\r\n    const showError = inject('showError');\r\n    const user_permissions = JSON.parse(localStorage.getItem(\"user\")).permissions;\r\n    const formatDate = inject('formatDate');\r\n    const tableShimmer = inject('tableShimmer');\r\n    const loadingSpinner = inject('loadingSpinner'); \r\n    const filter = ref('')\r\n    \r\n    const loading_spinner = ref(false);\r\n    const item_columns = ref(['SNo','date','ref_no','received_Qty','issued_Qty','balance_Qty','remark','authorized_by','actions']);    \r\n    const name = ref('');\r\n    const remark = ref('');\r\n    const description = ref('');\r\n    const units = ref('');\r\n    const source = ref('')\r\n    const stores = ref([])\r\n    const selectedStore = ref(null) // Changed from store to selectedStore for clarity\r\n    \r\n    const table_option = ref({\r\n        perPage: 20,\r\n        perPageValues: [20, 50 ,100],\r\n        skin: 'table table-hover table-striped',\r\n        columnsClasses: { actions: 'actions text-center' },\r\n        sortable: ['SNo', 'ref_no','received_Qty','issued_Qty','balance_Qty'],\r\n        sortIcon: {\r\n            base: 'sort-icon-none',\r\n            up: 'sort-icon-asc',\r\n            down: 'sort-icon-desc',\r\n        },\r\n        pagination: { nav: 'scroll', chunk: 5 },\r\n        texts: {\r\n            count: 'Showing {from} to {to} of {count}',\r\n            filter: '',\r\n            filterPlaceholder: 'Search...',\r\n            limit: 'Results:',\r\n        },\r\n        resizableColumns: false,\r\n    });\r\n\r\n    const axiosInstance = axios.create({\r\n        baseURL: process.env.VUE_APP_API_BASE_URL\r\n    });\r\n\r\n    const unitList = ref([]);\r\n    const getUnits = async () => {\r\n        try {\r\n            const response = await axiosInstance.get('/units');\r\n            unitList.value = response.data;\r\n        } catch (error) {\r\n            showError(error.message);\r\n        }\r\n    };\r\n\r\n    const binCards = ref([]);\r\n    \r\n    // Function to calculate balance for table data\r\n    const getTableData = (items) => {\r\n        if (!items) return [];\r\n        \r\n        let runningBalance = 0;\r\n        return items.map((item, index) => {\r\n            const received = parseFloat(item.received) || 0;\r\n            const issued = parseFloat(item.issued) || 0;\r\n            runningBalance += received - issued;\r\n            \r\n            return {\r\n                id: item.id,\r\n                SNo: index + 1,\r\n                ref_no: item.ref_no,\r\n                received_Qty: item.received,\r\n                issued_Qty: item.issued,\r\n                balance_Qty: runningBalance.toFixed(2),\r\n                remark: item.remark,\r\n                date: formatDate(item.created_at),\r\n                authorized_by: item.issuer?.name || 'N/A',\r\n            };\r\n        });\r\n    };\r\n\r\n    // Filter bin cards based on selected store\r\n    const filteredBinCards = computed(() => {\r\n        if (!selectedStore.value) {\r\n            return [];\r\n        }\r\n        \r\n        const searchFiltered = globalSearch(binCards.value, filter.value);\r\n        \r\n        // Filter by store_id\r\n        return searchFiltered.filter(binCard => {\r\n            // Check if bin card has store_item and if store_item has store_id that matches selected store\r\n            return binCard.store_item && binCard.store_item.store_id === selectedStore.value.id;\r\n        });\r\n    });\r\n\r\n    // Add this computed property to calculate balance for each bin card\r\n    const filteredBinCardsWithBalance = computed(() => {\r\n        return filteredBinCards.value.map(binCard => {\r\n            if (!binCard.items || binCard.items.length === 0) {\r\n                return {\r\n                    ...binCard,\r\n                    balance: 0\r\n                };\r\n            }\r\n\r\n            // Calculate total balance from all items\r\n            const totalBalance = binCard.items.reduce((balance, item) => {\r\n                const received = parseFloat(item.received) || 0;\r\n                const issued = parseFloat(item.issued) || 0;\r\n                return balance + (received - issued);\r\n            }, 0);\r\n\r\n            return {\r\n                ...binCard,\r\n                balance: totalBalance.toFixed(2)\r\n            };\r\n        });\r\n    });\r\n\r\n    const getBinCards = async () => {\r\n        loading_spinner.value = true;\r\n        try {\r\n            const response = await axiosInstance.get('bin-cards');\r\n            binCards.value = response.data.map((item, index) => ({\r\n                ...item,\r\n                SNo: index + 1,\r\n                id: item.id,\r\n                name: item.name,\r\n                unit: item.unit,\r\n                unit_name: item.unit,\r\n                description: item.description,\r\n                remark: item.remark,\r\n                items: item.items,\r\n            }));\r\n        } catch (error) {\r\n            showError(error.message);\r\n        } finally {\r\n            loading_spinner.value = false;\r\n        }\r\n    };\r\n    \r\n    const registerBinCard = async () => {\r\n        const existingBinCard = binCards.value.find(card => {\r\n            \r\n            if (source.value === 'general' && card.name === name.value) {\r\n                return true;\r\n            }\r\n            // Check by store_item_id if source is store\r\n            if (source.value === 'store' && storeItem.value && card.store_item_id === storeItem.value.id) {\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        if (existingBinCard) {\r\n            showError('A bin card already exists!');\r\n            return;\r\n        }\r\n        conversion_factor.value = false;\r\n        const itemData = {\r\n            name: name.value ??  storeItem.value.name ,\r\n            unit: units.value.short_name,\r\n            description: description.value,\r\n            remark: remark.value,\r\n            store_item_id : storeItem.value.id ?? '' ,\r\n            issuer_id : JSON.parse(localStorage.getItem('user')).id\r\n        };\r\n    \r\n        try {\r\n            const response = await axiosInstance.post('/bin-cards', itemData);\r\n            getBinCards();\r\n            showMessage('Bin Card registered!');\r\n            resetForm();\r\n        } catch (error) {\r\n            showError(error.message);\r\n            console.log(error)\r\n        }\r\n    };    \r\n\r\n    const resetForm = () => {\r\n        name.value = '';\r\n        units.value = '';\r\n        description.value = '';\r\n        storeItem.value = ''\r\n        storeItems.value = []\r\n        store.value = ''\r\n        source.value = ''\r\n    };\r\n\r\n    const openAddItemModal = (row) => {\r\n        bin_card_id.value = row.id; \r\n        binCard.value = row;\r\n    };\r\n\r\n    const isSending = ref(false);\r\n    const received = ref('');\r\n    const issued = ref('');\r\n    const bin_card_id = ref('');\r\n    const ref_no = ref('');\r\n    const item = ref('');\r\n    const binCard = ref('');\r\n    const store = ref(''); // This is for the form, keep as is\r\n\r\n    const AddBinCardItem = async () => {\r\n        isSending.value = true;\r\n        const itemData = {\r\n            bin_card_id: bin_card_id.value, \r\n            ref_no: ref_no.value,    \r\n            received: received.value,\r\n            issued: issued.value,\r\n            issuer_id: JSON.parse(localStorage.getItem(\"user\")).id,\r\n            remark: remark.value,\r\n        };\r\n        try {  \r\n            const response = await axiosInstance.post(`bin-card-items`, itemData)\r\n            await getBinCards() \r\n            document.getElementById('close_item').click();\r\n            showMessage('Bin Card Item added')\r\n        } catch(error) {\r\n            console.log(error)\r\n            showError(error.message)\r\n        } finally {\r\n            isSending.value = false;    \r\n        }\r\n    };\r\n\r\n    const closebinCardModal = () => {\r\n        ref_no.value = '';\r\n        received.value = '';\r\n        issued.value = '';\r\n        remark.value = '';\r\n    };\r\n\r\n    const printBinCard = (binCard) => {\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.position = 'absolute';\r\n        iframe.style.width = '0';\r\n        iframe.style.height = '0';\r\n        iframe.style.border = 'none';\r\n        document.body.appendChild(iframe);\r\n\r\n        const tableData = getTableData(binCard.items);\r\n        const tableRows = tableData.map(row => `\r\n            <tr>\r\n                <td>${row.SNo}</td>\r\n                <td>${row.ref_no}</td>\r\n                <td>${row.received_Qty}</td>\r\n                <td>${row.issued_Qty}</td>\r\n                <td>${row.balance_Qty}</td>\r\n                <td>${row.remark}</td>\r\n                <td>${row.authorized_by}</td>\r\n                <td>${row.date}</td>      \r\n            </tr>\r\n        `).join('');\r\n\r\n        const currentDate = new Date().toLocaleDateString('en-GB', {\r\n            day: '2-digit',\r\n            month: '2-digit',\r\n            year: 'numeric'\r\n        });\r\n\r\n        const printContent = `\r\n            <!DOCTYPE html>\r\n            <html>\r\n            <head>\r\n            <title>Bin Card - ${binCard.name ?? binCard.store_item?.item?.name}</title>\r\n            <style>\r\n                .header { display: flex; justify-content: space-between; align-items: flex-start; }\r\n                body { font-family: Arial, sans-serif; margin: 40px; font-size: 14px; }\r\n                .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }\r\n                .logo { width: 160px; height: auto; }\r\n                .section-title { text-align: center; font-weight: bold; text-decoration: underline; margin: 20px 0 10px 0; }\r\n                .report-box { border: 1px solid #000; padding: 5px 10px; font-weight: normal; font-size: 14px; text-align: center; border-radius: 5px; }\r\n                .company-title { text-align: center; margin-top: 10px; }\r\n                .company-title h2 { margin: 5px 0; font-size: 18px; }\r\n                .reg-info { position: absolute; top: 120px; right: 40px; text-align: right; font-size: 12px; line-height: 1.4; font-weight: normal; }\r\n                .summary-title { margin-top: 30px; margin-bottom: 2px; font-size: 16px; font-weight: bold;  }\r\n                .info { margin: 20px 0; }\r\n                .info p { margin: 5px 0; }\r\n                table { width: 100%; border-collapse: collapse; margin-top: 20px; border: 1px solid #666; }\r\n                th, td { border: 1px solid #666; padding: 6px; font-size: 13px; text-align: left; }\r\n                th { background-color: #f2f2f2; font-weight: bold; }\r\n                .text-right { text-align: right; }\r\n                .text-center { text-align: center; }\r\n                .total-row { background-color: #f0f0f0; font-weight: bold; }\r\n                @media print { body { margin: 8mm; } .no-print { display: none; } }\r\n            </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"header\">\r\n                    <img src=\"https://bushman.ink/copex.jpg\" class=\"logo\" />\r\n                    <div class=\"report-box\">\r\n                        Bin Card No. <br>\r\n                        <span style=\"color:red;\"> 00${binCard.id}/${currentDate.split('/').slice(0, 2).join('/')}</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"reg-info\">\r\n                    TIN: 135-489-247<br>\r\n                    VRN: 40-032826-C\r\n                </div>\r\n\r\n                <div class=\"company-title\">\r\n                    <h2>COPEX CONTRACTORS CO.LTD</h2>\r\n                    <div>Msamvu, P.O.BOX 678, Morogoro</div>\r\n                    <div>Mobile, 0713 000 777, 0657 111 555</div>\r\n                </div>\r\n                \r\n                <h2 style=\"text-align: center;\">BIN CARD</h2>\r\n                \r\n                <h3 class=\"header\">Bin Card Details</h3>\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Item</th>\r\n                            <th>Unit</th>\r\n                            <th>Condition</th>\r\n                            <th>Current Balance</th>\r\n                            <th>Description</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td class=\"text-center\">${binCard.name ?? binCard.store_item?.item?.name}</td>\r\n                            <td class=\"text-center\">${binCard.unit_name || binCard.store_item?.item?.unit}</td>\r\n                            <td class=\"text-center\">${binCard.store_item?.item_condition || 'N/A'}</td>\r\n                            <td class=\"text-center\">${binCard.balance}</td>\r\n                            <td class=\"text-center\"> ${binCard.description || 'N/A'}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n                \r\n                <h3 class=\"header\">Bin Card Items</h3>\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>S.No</th>\r\n                            <th>Ref No</th>\r\n                            <th>Received</th>\r\n                            <th>Issued </th>\r\n                            <th>Balance</th>\r\n                            <th>Remark</th>\r\n                            <th>Authorized By</th> \r\n                            <th>Date</th>       \r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        ${tableRows}\r\n                    </tbody>\r\n                </table>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        const iframeDoc = iframe.contentWindow.document;\r\n        iframeDoc.open();\r\n        iframeDoc.write(printContent);\r\n        iframeDoc.close();\r\n\r\n        iframe.onload = () => {\r\n            iframe.contentWindow.focus();\r\n            iframe.contentWindow.print();\r\n            setTimeout(() => {\r\n                document.body.removeChild(iframe);\r\n            }, 1000);\r\n        };\r\n    };\r\n\r\n    const getStoresList = () => {\r\n        axiosInstance.get('/get-stores').then((response) => {\r\n            stores.value = response.data\r\n        });\r\n    };\r\n\r\n    const storeItems = ref([])\r\n    const storeItem = ref('')\r\n    const getStoreItems = (id) => {\r\n        axiosInstance.get(`/get-store-items?store_id=${id}`).then((response) => {\r\n            storeItems.value = response.data\r\n            .map((store,index) => ({\r\n                ...store,\r\n                SNo: index + 1,\r\n                name: store?.name + ' ' + (store?.condition ?? ''),\r\n                category : store?.category_name,\r\n                used: store?.used_quantity || 0,\r\n                balance : store?.balance_quantity || 0,\r\n                stock: store?.total_quantity || 0,\r\n                checked : false\r\n            }));\r\n            loading_spinner.value = false;\r\n        });\r\n    };\r\n\r\n    watch(store, (newVal) => {\r\n        storeItem.value = ''\r\n        storeItems.value = ['']\r\n        getStoreItems(newVal.id)\r\n    });\r\n\r\n    const deletingItemId = ref(null);\r\n\r\n    const deleteBinCardItem = async (item) => {\r\n      deletingItemId.value = item.id;\r\n      try {\r\n        await axiosInstance.delete(`/bin-card-items/${item.id}`);\r\n        await getBinCardReactive();\r\n        showMessage('Bin Card Item deleted successfully');\r\n      } catch (error) {\r\n        console.error(error);\r\n        showError(error.message);\r\n      } finally {\r\n        deletingItemId.value = null;\r\n      }\r\n    };\r\n\r\n    const getBinCardReactive = async () => {\r\n        const response = await axiosInstance.get('bin-cards');\r\n            binCards.value = response.data.map((item, index) => ({\r\n                ...item,\r\n                SNo: index + 1,\r\n                id: item.id,\r\n                name: item.name,\r\n                unit: item.unit,\r\n                unit_name: item.unit,\r\n                description: item.description,\r\n                remark: item.remark,\r\n                items: item.items,\r\n            }));\r\n    };\r\n\r\n    const bin_card_item_id = ref('');\r\n    const closeEditModal = () => {\r\n        ref_no.value = '';\r\n        received.value = '';\r\n        issued.value = '';\r\n        remark.value = '';\r\n    };\r\n    const openEditItemModal = (row) => {\r\n    console.log('Editing item:', row);\r\n        bin_card_item_id.value = row.id;\r\n        ref_no.value = row.ref_no;\r\n        received.value = row.received_Qty; // Changed from row.received\r\n        issued.value = row.issued_Qty;     // Changed from row.issued\r\n        remark.value = row.remark;\r\n    };\r\n\r\n    const updateBinCardItem = async () => {\r\n        loading_spinner.value = true;\r\n        const payload = {\r\n            ref_no: ref_no.value,\r\n                received: received.value,\r\n                issued: issued.value,\r\n                remark: remark.value,\r\n        };\r\n        try {  \r\n            const response = await axiosInstance.put(`bin-card-items/${bin_card_item_id.value}`, payload);\r\n            getBinCardReactive(); \r\n            showMessage('Bin Card Item updated')\r\n            document.getElementById('close_editing').click();\r\n            closeEditModal();\r\n        } catch(error) {\r\n            console.log(error)\r\n            showError(error.message)\r\n        } finally {\r\n            loading_spinner.value = false;    \r\n        }\r\n    };\r\n\r\n    onMounted(() => {\r\n        getBinCards();\r\n        getUnits();\r\n        getStoresList()\r\n    });\r\n</script>\r\n\r\n<style>\r\n    .table3 .actions svg {\r\n        padding: 2px;\r\n    }\r\n</style>\r\n","import script from \"./binCard.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./binCard.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./binCard.vue?vue&type=style&index=0&id=4df9f3e9&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["globalSearch","data","keyword","lowerKeyword","toLowerCase","trim","containsKeyword","obj","includes","Array","isArray","some","Object","values","filter","item","ref","props","filterValue","watch","val","emit","__exports__","useMeta","title","loadingIndicator","inject","showMessage","conversion_factor","showError","user_permissions","JSON","parse","localStorage","getItem","permissions","formatDate","loadingSpinner","loading_spinner","item_columns","name","remark","description","units","source","stores","selectedStore","table_option","perPage","perPageValues","skin","columnsClasses","actions","sortable","sortIcon","base","up","down","pagination","nav","chunk","texts","count","filterPlaceholder","limit","resizableColumns","axiosInstance","axios","baseURL","process","unitList","getUnits","async","response","get","value","error","message","binCards","getTableData","items","runningBalance","map","index","received","parseFloat","issued","id","SNo","ref_no","received_Qty","issued_Qty","balance_Qty","toFixed","date","created_at","authorized_by","issuer","filteredBinCards","computed","searchFiltered","binCard","store_item","store_id","filteredBinCardsWithBalance","length","balance","totalBalance","reduce","getBinCards","unit","unit_name","registerBinCard","existingBinCard","find","card","storeItem","store_item_id","itemData","short_name","issuer_id","post","resetForm","console","log","storeItems","store","openAddItemModal","row","bin_card_id","isSending","AddBinCardItem","document","getElementById","click","closebinCardModal","printBinCard","iframe","createElement","style","position","width","height","border","body","appendChild","tableData","tableRows","join","currentDate","Date","toLocaleDateString","day","month","year","printContent","split","slice","item_condition","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","getStoresList","then","getStoreItems","condition","category","category_name","used","used_quantity","balance_quantity","stock","total_quantity","checked","newVal","deletingItemId","deleteBinCardItem","delete","getBinCardReactive","bin_card_item_id","closeEditModal","openEditItemModal","updateBinCardItem","payload","put","onMounted"],"sourceRoot":""}