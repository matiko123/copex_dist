"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[7954],{97954:function(t,a,e){e.r(a),e.d(a,{default:function(){return $}});var n=e(66252),l=e(3577),s=e(49963),o=e(2262),r=e(87066),i=e(56296),d=e(26212),c=e.n(d);const p={class:"layout-px-spacing"},u=(0,n.uE)('<ul class="navbar-nav flex-row mt-2"><li><div class="page-header"><nav class="breadcrumb-one" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="javascript:;">Masters</a></li><li class="breadcrumb-item active" aria-current="page"><span>Services</span></li></ol></nav></div></li></ul>',1),m={class:"text-center"},v={class:"d-flex me-4 mt-2"},b={class:"ms-auto btn-group"},h=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",fill:"currentColor",class:"bi bi-printer",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,n._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1),g=[h],_={class:"row layout-top-spacing"},y={class:"col-xl-12 col-lg-12 col-sm-12 layout-spacing"},w={class:"panel p-0"},f={class:"custom-table table3"},x=["innerHTML"],S=(0,n._)("a",{href:"javascript:void(0)",class:"text-success",title:"Approve"},[(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-check2-square",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z"}),(0,n._)("path",{d:"m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0"})])],-1),C=(0,n._)("a",{href:"javascript:void(0);",class:"text-primary"},[(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-eye",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),(0,n._)("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"})])],-1),T={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},A={class:"modal-dialog",role:"document"},O={class:"modal-content"},k=(0,n._)("div",{class:"modal-header"},[(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Service Registration"),(0,n._)("button",{type:"button","data-dismiss":"modal","data-bs-dismiss":"modal","aria-label":"Close",class:"btn-close"})],-1),M={class:"modal-body"},N=(0,n._)("div",{class:"modal-footer"},[(0,n._)("button",{type:"button",class:"btn","data-dismiss":"modal","data-bs-dismiss":"modal"},[(0,n._)("i",{class:"flaticon-cancel-12"}),(0,n.Uk)(" Discard")]),(0,n._)("button",{type:"button",class:"btn btn-primary"},"Save")],-1);var H={setup(t){(0,i.j)({title:"Labour Attendance"});const a=r.Z.create({baseURL:"https://bushman.ink/api/v1/"}),e=((0,n.f3)("showMessage"),(0,n.f3)("showError")),d=((0,n.f3)("waitIndicator"),(0,n.f3)("printEmployees"),(0,n.f3)("formatNumber")),h=(0,n.f3)("formatDate"),H=(0,n.f3)("tableShimmer"),z=(0,o.iH)(""),$=(0,o.iH)(!1),E=(0,o.iH)(["Sno","full_name","type","rate","project","supervisor","task","status","date"]),L=(0,o.iH)({perPage:20,perPageValues:[20,50,100],skin:"table table-hover table-striped",columnsClasses:{actions:"actions text-center"},sortable:["id","service_name"],sortIcon:{base:"sort-icon-none",up:"sort-icon-asc",down:"sort-icon-desc"},pagination:{nav:"scroll",chunk:5},texts:{count:"Showing {from} to {to} of {count}",filter:"",filterPlaceholder:"Search...",limit:"Results:"},resizableColumns:!1}),D=(0,o.iH)([]),R=((0,o.iH)((new Date).toISOString().slice(0,10)),(0,o.iH)((new Date).toISOString().slice(0,10))),V=(0,o.iH)((new Date).toISOString().slice(0,10)),j=async()=>{$.value=!0;try{const t={start_date:R.value,end_date:V.value};I.value?.short_name&&(t.project_id=I.value.id);const e=await a.get("labour-attendants",{params:t});D.value=e.data.map(((t,a)=>({...t,Sno:a+1,full_name:t.labour_name,type:t.labour_type.name,rate:d(t.labour_type.rate),rate_original:t.labour_type.rate,project:t.project.short_name,supervisor:t.registrar.name,date:h(t.created_at)})))}catch(t){e(t.message)}finally{$.value=!1}},U=(0,o.iH)([""]),I=(0,o.iH)(),P=async()=>{try{const t=await a.get("projects");U.value=t.data}catch(t){e(t.message),console.log(t)}},B=async t=>{try{const a=t||[],e=a.reduce(((t,a)=>t+Number(a?.labour_type?.rate||0)),0),n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n);const l=`\n<!DOCTYPE html>\n<html>\n<head>\n<style>\n  body { font-family: 'Courier New', monospace; margin: 20px; font-size: 8px; }\n  .company-title { text-align: center; font-size: 9px; }\n  .company-title h1 { font-size: 14px; margin: 5px 0; }\n  .title { text-align: center; font-size: 12px; margin: 8px 0; font-weight: bold; }\n  table { width: 100%; border-collapse: collapse; margin-top: 8px; font-size: 9px; }\n  th, td { border: 1px solid #000; padding: 3px 4px; }\n  th { background-color: #f0f0f0; font-weight: bold; }\n  .text-right { text-align: right; }\n  hr { border: 0; border-top: 1px solid #000; margin: 8px 0; }\n</style>\n</head>\n<body>\n\n<div class="company-title">\n  <h1>COPEX CONTRACTORS CO.LTD</h1>\n  <div><b>Address:</b> Msamvu, P.O.BOX 678, Morogoro</div>\n  <div><b>Tel:</b> 0713 000 777, 0657 111 555</div>\n  <div><b>Email:</b> info@copexcontractors.co.tz</div>\n  <div><b>TIN:</b> 135-489-247 &nbsp;&nbsp; <b>VRN:</b> 40-032826C</div>\n</div>\n\n<hr>\n\n<div class="title">${I.value.short_name??"ALL"} SITE LABOUR ATTENDANCE REPORT </div>\n<div class="title">FROM ${R.value} TO ${V.value} </div>\n\n<hr>\n\n<table>\n<thead>\n<tr>\n  <th>S/No.</th>\n  <th>Labour</th>\n  <th>Type</th>\n  <th>Task</th>\n  <th>Time Reported</th>\n  <th>Date</th>\n  <th>Status</th>\n  <th>Cost Per Day</th>\n</tr>\n</thead>\n<tbody>\n${a.map(((t,a)=>`\n<tr>\n  <td>${a+1}</td>\n  <td>${t.labour_name||"N/A"}</td>\n  <td>${t?.labour_type?.name||"N/A"}</td>\n  <td>${t.task||"N/A"}</td>\n  <td>${t.reporting_time||"N/A"}</td>\n  <td>${h(t.created_at)||"N/A"}</td>\n  <td>${t?.status?.name||"N/A"}</td>\n  <td class="text-right">${d(t?.labour_type?.rate||0)}</td>\n</tr>\n`)).join("")}\n<tr style="font-weight:bold;">\n  <td colspan="7" class="text-right">TOTAL COST :</td>\n  <td class="text-right">${d(e)}</td>\n</tr>\n</tbody>\n</table>\n\n<div style="margin-top: 15px; font-size: 7px;">\n  <p><strong>Report Generated:</strong> ${(new Date).toLocaleString()}</p>\n  <p><strong>Generated By:</strong> ${JSON.parse(localStorage.getItem("user"))?.name}</p>\n</div>\n\n</body>\n</html>\n`,s=n.contentWindow.document;s.open(),s.write(l),s.close(),n.onload=()=>{n.contentWindow.focus(),n.contentWindow.print(),setTimeout((()=>document.body.removeChild(n)),1e3)}}catch(a){e(`Failed to print report: ${a.message}`)}};return(0,n.bv)((()=>{j(),P()})),(t,a)=>{const e=(0,n.up)("v-client-table");return(0,n.wg)(),(0,n.iD)("div",p,[u,(0,n._)("h3",m,"SITE LABOUR ATTENDANCE FROM "+(0,l.zw)(R.value)+" TO "+(0,l.zw)(V.value),1),(0,n._)("div",v,[(0,n._)("div",b,[(0,n._)("button",{class:"btn btn-success me-2",onClick:a[0]||(a[0]=t=>B(D.value))},g),(0,n.wy)((0,n._)("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=t=>R.value=t),class:"form-control me-2"},null,512),[[s.nr,R.value]]),(0,n.wy)((0,n._)("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=t=>V.value=t),class:"form-control me-2"},null,512),[[s.nr,V.value]]),(0,n.Wm)((0,o.SU)(c()),{modelValue:I.value,"onUpdate:modelValue":a[3]||(a[3]=t=>I.value=t),options:U.value,label:"short_name",placeholder:"Select Project",searchable:!0,"allow-empty":!1,style:{"min-width":"300px"}},null,8,["modelValue","options"]),(0,n._)("button",{class:"btn btn-primary",onClick:a[4]||(a[4]=t=>j())},"Search")])]),(0,n._)("div",_,[(0,n._)("div",y,[(0,n._)("div",w,[(0,n._)("div",f,[$.value?((0,n.wg)(),(0,n.iD)("div",{key:0,innerHTML:(0,o.SU)(H)()},null,8,x)):((0,n.wg)(),(0,n.j4)(e,{key:1,data:D.value,columns:E.value,options:L.value},{status:(0,n.w5)((t=>[(0,n._)("span",{class:(0,l.C_)(["badge inv-status","badge-"+t.row.status.color])},(0,l.zw)(t.row.status.name),3)])),actions:(0,n.w5)((t=>[S,C,(0,n._)("div",T,[(0,n._)("div",A,[(0,n._)("div",O,[k,(0,n._)("div",M,[(0,n.wy)((0,n._)("input",{type:"text",class:"form-control",placeholder:"Enter Service Name","onUpdate:modelValue":a[5]||(a[5]=t=>z.value=t)},null,512),[[s.nr,z.value]])]),N])])])])),_:1},8,["data","columns","options"]))])])])])])}}};const z=H;var $=z}}]);
//# sourceMappingURL=7954.30417fda.js.map