{"version":3,"file":"js/7255.fb99879b.js","mappings":"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","sources":["webpack://cork-vue3/./src/views/masters/logs.vue","webpack://cork-vue3/./src/views/masters/logs.vue?2338"],"sourcesContent":["<template>\r\n    <div class=\"layout-px-spacing\">\r\n  \r\n        <div class=\"seperator-header layout-top-spacing\">\r\n            <div class=\"d-flex justify-content-between mt-3\">\r\n              <button class=\"btn btn-dark me-2 px-3\" @click=\"$router.go(-1)\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-arrow-left\" viewBox=\"0 0 16 16\">\r\n  <path fill-rule=\"evenodd\" d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8\"/>\r\n  </svg>\r\n                </button>\r\n                \r\n                <div class=\"d-flex align-items-center\">\r\n                    <!-- Type filter dropdown -->\r\n                    <div class=\"dropdown me-3\">\r\n                        <select class=\"form-select\" v-model=\"selectedType\" @change=\"filterByType\">\r\n                            <option value=\"all\">All Types</option>\r\n                            <option v-for=\"type in uniqueTypes\" :key=\"type\" :value=\"type\">{{ type }}</option>\r\n                        </select>\r\n                    </div>\r\n                    \r\n                    <!-- Print button -->\r\n                    <button class=\"btn btn-primary px-3\" @click=\"printTable\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-printer me-1\">\r\n                            <polyline points=\"6 9 6 2 18 2 18 9\"></polyline>\r\n                            <path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\"></path>\r\n                            <rect x=\"6\" y=\"14\" width=\"12\" height=\"8\"></rect>\r\n                        </svg>\r\n                        Print\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n  \r\n        <div class=\"mt-3 mx-2\">     \r\n          <div class=\"text-center text-primary mt-2 mb-2\">\r\n                <!-- loading spinner starts -->\r\n                 <div v-if=\"loading_spinner\" v-html=\"loadingIndicator()\"></div>\r\n        <!-- Loading spinner ends -->\r\n          </div>\r\n        </div>   \r\n  \r\n        <div class=\"row layout-top-spacing\">\r\n            <div class=\"col-xl-12 col-lg-12 col-sm-12 layout-spacing\">\r\n                <div class=\"panel br-6 p-0\">\r\n                    <div class=\"custom-table\">\r\n                        <v-client-table :data=\"Logs\" :columns=\"columns\" :options=\"table_option\">\r\n                            <!-- Simple display of quantity from endpoint -->\r\n                            <template #quantity=\"props\">\r\n                                {{ (props.row.quantity || 0 ).toLocaleString()}}/=\r\n                            </template>\r\n                        </v-client-table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n  \r\n<script setup>\r\n    import { onMounted, ref, computed, inject } from 'vue';\r\n    import { useMeta } from '@/composables/use-meta';\r\n    useMeta({ title: 'Activity Logs' });\r\n    import axios from 'axios';\r\n    \r\n    const loadingIndicator = inject('loadingIndicator');\r\n    const showMessage = inject('showMessage');\r\n    const showError = inject('showError');\r\n    const loading_spinner = ref(false);\r\n    // Add quantity to columns\r\n    const columns = ref(['SNo', 'user_name', 'action', 'type', 'date', 'time', 'quantity']);\r\n    const Logs = ref([]);\r\n    const selectedType = ref('all');\r\n    const allLogs = ref([]); // Store all logs for filtering\r\n\r\n    const table_option = ref({\r\n      perPage: 10,\r\n      perPageValues: [5, 10, 20, 50],\r\n      skin: 'table table-hover',\r\n      pagination: { nav: 'scroll', chunk: 5 },\r\n      texts: {\r\n        count: 'Showing {from} to {to} of {count}',\r\n        filter: '',\r\n        filterPlaceholder: 'Search...',\r\n        limit: 'Results:',\r\n      },\r\n      sortable: ['SNo', 'user_name', 'action', 'type', 'date', 'time', 'quantity'],\r\n      sortIcon: {\r\n        base: 'sort-icon-none',\r\n        up: 'sort-icon-asc',\r\n        down: 'sort-icon-desc',\r\n      },\r\n      resizableColumns: false,\r\n    });\r\n\r\n    // Computed property to get unique types for dropdown\r\n    const uniqueTypes = computed(() => {\r\n        const types = allLogs.value.map(item => item.type);\r\n        return [...new Set(types)].filter(type => type); // Remove empty values\r\n    });\r\n\r\n    // Filter function for types\r\n    const filterByType = () => {\r\n        if (selectedType.value === 'all') {\r\n            // Show all data\r\n            Logs.value = [...allLogs.value];\r\n        } else {\r\n            // Filter data by selected type\r\n            Logs.value = allLogs.value.filter(item => item.type === selectedType.value);\r\n        }\r\n        \r\n        // Update SNo after filtering\r\n        Logs.value = Logs.value.map((item, index) => ({\r\n            ...item,\r\n            SNo: index + 1\r\n        }));\r\n    };\r\n\r\n   const getLogs = async () => {\r\n    loading_spinner.value = true;\r\n    try {\r\n        const response = await axios.get(`https://construction.trustdigital.space/api/v1/activity-logs`);\r\n        if (response.data && response.data.data) {\r\n            // Store all logs for filtering\r\n            allLogs.value = response.data.data.map((item, index) => ({\r\n                ...item,\r\n                SNo: index + 1\r\n            }));\r\n            \r\n            // Initialize the displayed logs with all logs\r\n            Logs.value = [...allLogs.value];\r\n            \r\n            console.log(\"Unique types:\", uniqueTypes.value); // Debug log\r\n        }\r\n        loading_spinner.value = false;\r\n    } catch (error) {\r\n        showError(error.message);\r\n        console.log(error);\r\n        loading_spinner.value = false;\r\n    }\r\n}\r\n \r\n\r\n    \r\n    // Function to print the table directly - now uses filtered data\r\n    const printTable = () => {\r\n      // Create a hidden iframe for printing\r\n      const iframe = document.createElement('iframe');\r\n      iframe.style.display = 'none';\r\n      document.body.appendChild(iframe);\r\n      \r\n      // Get all columns\r\n      const printColumns = columns.value;\r\n      \r\n      // Get the type filter text for the title\r\n      const typeFilterText = selectedType.value === 'all' ? 'All Types' : `Type: ${selectedType.value}`;\r\n      \r\n      // Helper function to format date as YYYY.MM.DD\r\n      const formatDate = (dateString) => {\r\n        if (!dateString) return '';\r\n        const date = new Date(dateString);\r\n        if (isNaN(date.getTime())) return dateString; // Return original if invalid date\r\n        \r\n        const year = date.getFullYear();\r\n        const month = String(date.getMonth() + 1).padStart(2, '0');\r\n        const day = String(date.getDate()).padStart(2, '0');\r\n        return `${year}.${month}.${day}`;\r\n      };\r\n      \r\n      // Helper function to format quantity with commas and /= suffix\r\n      const formatQuantity = (value) => {\r\n        if (value === null || value === undefined) return '0/=';\r\n        return `${Number(value).toLocaleString()}/=`;\r\n      };\r\n      \r\n      // Create HTML content for printing\r\n      let printContent = `\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>Activity Logs - ${typeFilterText}</title>\r\n          <style>\r\n            body {\r\n              font-family: Arial, sans-serif;\r\n              margin: 20px;\r\n            }\r\n            h1 {\r\n              text-align: center;\r\n              margin-bottom: 10px;\r\n            }\r\n            h2 {\r\n              text-align: center;\r\n              margin-bottom: 20px;\r\n              font-size: 16px;\r\n              color: #666;\r\n            }\r\n            table {\r\n              width: 100%;\r\n              border-collapse: collapse;\r\n              margin-bottom: 20px;\r\n            }\r\n            th, td {\r\n              border: 1px solid #ddd;\r\n              padding: 8px;\r\n              text-align: left;\r\n            }\r\n            th {\r\n              background-color: #f2f2f2;\r\n              font-weight: bold;\r\n            }\r\n            tr:nth-child(even) {\r\n              background-color: #f9f9f9;\r\n            }\r\n            .print-date {\r\n              text-align: right;\r\n              margin-bottom: 20px;\r\n              font-size: 12px;\r\n            }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <h1>Activity Logs Report</h1>\r\n          <h2>${typeFilterText}</h2>\r\n          <div class=\"print-date\">Printed on: ${new Date().toLocaleString()}</div>\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                ${printColumns.map(col => `<th>${capitalize(col)}</th>`).join('')}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n      `;\r\n      \r\n      // Add filtered rows to the print content\r\n      Logs.value.forEach(row => {\r\n        printContent += '<tr>';\r\n        printColumns.forEach(col => {\r\n          // Format date column\r\n          if (col === 'date') {\r\n            printContent += `<td>${formatDate(row[col])}</td>`;\r\n          }\r\n          // Format quantity column\r\n          else if (col === 'quantity') {\r\n            printContent += `<td>${formatQuantity(row[col])}</td>`;\r\n          }\r\n          // Default formatting for other columns\r\n          else {\r\n            printContent += `<td>${row[col] || ''}</td>`;\r\n          }\r\n        });\r\n        printContent += '</tr>';\r\n      });\r\n      \r\n      // Close the HTML structure\r\n      printContent += `\r\n            </tbody>\r\n          </table>\r\n        </body>\r\n        </html>\r\n      `;\r\n      \r\n      // Write to the iframe and print it\r\n      const iframeDoc = iframe.contentWindow.document;\r\n      iframeDoc.open();\r\n      iframeDoc.write(printContent);\r\n      iframeDoc.close();\r\n      \r\n      // Wait for content to load before printing\r\n      iframe.onload = () => {\r\n        iframe.contentWindow.focus();\r\n        iframe.contentWindow.print();\r\n        \r\n        // Remove the iframe after printing (or after a timeout)\r\n        setTimeout(() => {\r\n          document.body.removeChild(iframe);\r\n        }, 1000);\r\n      };\r\n    };\r\n    \r\n    // Helper function to capitalize column names for display\r\n    const capitalize = (text) => {\r\n      return text\r\n        .replace(/_/g, ' ') // Replace all underscores with spaces\r\n        .replace(/-/g, ' ') // Replace all hyphens with spaces\r\n        .toLowerCase()\r\n        .split(' ')\r\n        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n        .join(' ');\r\n    };\r\n    \r\n   \r\n    \r\n    onMounted(() => {\r\n      getLogs();\r\n    });\r\n</script>\r\n  \r\n<style scoped>\r\n   .mymodal{\r\n    background-color: rgba(122, 122, 122, 0.653);\r\n   }\r\n   \r\n   @media print {\r\n     .layout-px-spacing {\r\n       margin: 0 !important;\r\n       padding: 0 !important;\r\n     }\r\n     \r\n     .seperator-header,\r\n     .panel-heading,\r\n     .custom-table .VueTables__search,\r\n     .custom-table .VueTables__limit,\r\n     .custom-table .VueTables__pagination {\r\n       display: none !important;\r\n     }\r\n     \r\n     .panel {\r\n       box-shadow: none !important;\r\n       border: none !important;\r\n     }\r\n   }\r\n</style> \r\n\r\n\r\n","import script from \"./logs.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./logs.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./logs.vue?vue&type=style&index=0&id=bfbe2202&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\copexErp\\\\frontEnd\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bfbe2202\"]])\n\nexport default __exports__"],"names":["useMeta","title","loadingIndicator","inject","showError","loading_spinner","ref","columns","Logs","selectedType","allLogs","table_option","perPage","perPageValues","skin","pagination","nav","chunk","texts","count","filter","filterPlaceholder","limit","sortable","sortIcon","base","up","down","resizableColumns","uniqueTypes","computed","types","value","map","item","type","Set","filterByType","index","SNo","getLogs","async","response","axios","data","console","log","error","message","printTable","iframe","document","createElement","style","display","body","appendChild","printColumns","typeFilterText","formatDate","dateString","date","Date","isNaN","getTime","year","getFullYear","month","String","getMonth","padStart","day","getDate","formatQuantity","undefined","Number","toLocaleString","printContent","col","capitalize","join","forEach","row","iframeDoc","contentWindow","open","write","close","onload","focus","print","setTimeout","removeChild","text","replace","toLowerCase","split","word","charAt","toUpperCase","slice","onMounted","__exports__"],"sourceRoot":""}