"use strict";(self["webpackChunkcork_vue3"]=self["webpackChunkcork_vue3"]||[]).push([[9320],{19320:function(e,a,t){t.r(a),t.d(a,{default:function(){return Nt}});t(26699);var l=t(66252),r=t(3577),s=t(49963),o=t(2262),n=t(87066),d=t(56296),i=t(26212),c=t.n(i);const u=e=>((0,l.dD)("data-v-167b195c"),e=e(),(0,l.Cn)(),e),v={class:"layout-px-spacing horizontal-scroll-container"},m={class:"d-flex justify-content-between align-items-center horizontal-scroll-content"},_={class:"flex-grow-1 text-center"},p={class:"container mt-5"},g={key:0,class:"mb-5 d-flex"},b={class:"ms-auto"},w={class:"dropdown nav-item notification-dropdown btn-group"},y={href:"javascript:;",id:"ddlnotify","data-bs-toggle":"dropdown","aria-expanded":"false",class:"btn dropdown-toggle nav-link position-relative p-0 shadow"},h=u((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-bell text-danger",style:{transform:"scale(2)"}},[(0,l._)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,l._)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})],-1))),k={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},f={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"ddlnotify"},x={class:"dropdown-item"},D={class:"media"},S=(0,l.uE)('<div class="media-aside align-self-start" data-v-167b195c><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-server" data-v-167b195c><rect x="2" y="2" width="20" height="8" rx="2" ry="2" data-v-167b195c></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2" data-v-167b195c></rect><line x1="6" y1="6" x2="6" y2="6" data-v-167b195c></line><line x1="6" y1="18" x2="6" y2="18" data-v-167b195c></line></svg></div>',1),H={class:"media-body"},A={class:"data-info"},U={class:"mb-0"},z={class:"mb-0"},C=["onClick"],E={class:"mt-5"},M={class:"text-center"},$={class:"d-flex align-items-center"},T={class:"mx-auto"},L=(0,l.Uk)(" Search Date "),N={class:"mx-auto"},W=(0,l.Uk)(" Labour type "),q=u((()=>(0,l._)("option",{value:""},"All Labours",-1))),V=["value"],R={class:"mx-auto"},j=(0,l.Uk)(" Project "),F=u((()=>(0,l._)("option",{value:"0"},"All Projects",-1))),O=["value"],Y={class:"ms-auto"},I=u((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"me-2 bi bi-printer",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),(0,l._)("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"})],-1))),K=(0,l.Uk)(" Print "),Z=[I,K],P=u((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",style:{cursor:"pointer"}},[(0,l._)("path",{d:"M4 4h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H7l-4 4v-16a2 2 0 0 1 2-2z",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linejoin":"round"})],-1))),B=(0,l.Uk)(" Add Remark "),J=[P,B],G={key:0,class:"mt-3 p-3 border rounded bg-light mb-2"},Q=u((()=>(0,l._)("h5",{class:"mb-3"},"Add Labour",-1))),X={class:"form-group mb-3 d-flex align-items-center col-12"},ee=["onSubmit"],ae={class:"col-md-3 col-10"},te={class:"col-md-3 col-10"},le={class:"col-md-3 col-10"},re={class:"col-md-3 col-10"},se=u((()=>(0,l._)("option",{value:"0"},"Select Project",-1))),oe=["value"],ne=u((()=>(0,l._)("div",{class:"d-flex mt-2"},[(0,l._)("div",{class:"ms-auto"},[(0,l._)("button",{type:"submit",class:"btn btn-primary w-100"},"Submit")])],-1))),de={key:1,class:"d-flex justify-content-center align-items-center",style:{"block-size":"100px"}},ie=u((()=>(0,l._)("span",{class:"text-primary spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},[(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",class:"bi bi-arrow-repeat",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M11.534 7h-4.07a.5.5 0 0 0 0 1h4.07a.5.5 0 0 0 0-1z"}),(0,l._)("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 1 0-.832-.554A4 4 0 1 1 8 4a.5.5 0 0 0 0-1z"}),(0,l._)("path",{d:"M8 1a7 7 0 1 1-6.546 4.914.5.5 0 1 0-.832-.554A8 8 0 1 0 8 0a.5.5 0 0 0 0 1z"})]),(0,l.Uk)(" Loading... ")],-1))),ce=[ie],ue={class:"allowance-table-container"},ve={class:"table table-bordered mt-4"},me=u((()=>(0,l._)("thead",{class:"thead-light"},[(0,l._)("tr",null,[(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"SN"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Name"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Designation"),(0,l._)("th",{colspan:"7",class:"text-center text-dark"},"Days (Tuesday - Monday)"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Days"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Advance"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Rate"),(0,l._)("th",{rowspan:"2",class:"align-middle text-dark"},"Total")]),(0,l._)("tr",null,[(0,l._)("th",{class:"text-dark text-center"},"Tuesday"),(0,l._)("th",{class:"text-dark text-center"},"Wednesday"),(0,l._)("th",{class:"text-dark text-center"},"Thursday"),(0,l._)("th",{class:"text-dark text-center"},"Friday"),(0,l._)("th",{class:"text-dark text-center"},"Saturday"),(0,l._)("th",{class:"text-dark text-center"},"Sunday"),(0,l._)("th",{class:"text-dark text-center"},"Monday")])],-1))),_e=u((()=>(0,l._)("td",null,null,-1))),pe=u((()=>(0,l._)("td",null,null,-1))),ge=u((()=>(0,l._)("td",null,null,-1))),be=u((()=>(0,l._)("td",null,null,-1))),we=u((()=>(0,l._)("td",null,null,-1))),ye=u((()=>(0,l._)("td",null,null,-1))),he={class:"text-start"},ke={class:"text-start"},fe={class:"text-start"},xe=["onClick"],De={style:{cursor:"pointer"}},Se={key:0},He={key:1},Ae={class:"text-center"},Ue={class:"text-end"},ze={class:"text-end"},Ce={class:"text-end"},Ee=["id"],Me={class:"modal-dialog modal-xl"},$e={class:"modal-content"},Te=u((()=>(0,l._)("div",{class:"modal-header"},[(0,l._)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Daily Work Allowance"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Le={class:"modal-body"},Ne={key:0,class:"d-flex justify-content-center align-items-center",style:{"block-size":"100px"}},We=u((()=>(0,l._)("span",{class:"text-primary spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},[(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",class:"bi bi-arrow-repeat",viewBox:"0 0 16 16"},[(0,l._)("path",{d:"M11.534 7h-4.07a.5.5 0 0 0 0 1h4.07a.5.5 0 0 0 0-1z"}),(0,l._)("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 1 0-.832-.554A4 4 0 1 1 8 4a.5.5 0 0 0 0-1z"}),(0,l._)("path",{d:"M8 1a7 7 0 1 1-6.546 4.914.5.5 0 1 0-.832-.554A8 8 0 1 0 8 0a.5.5 0 0 0 0 1z"})]),(0,l.Uk)(" Loading... ")],-1))),qe=[We],Ve={key:1},Re={class:"mb-4"},je={class:"row g-2 align-items-center"},Fe={class:"col-md-3 col-6"},Oe=u((()=>(0,l._)("div",{class:"fw-bold text-secondary small"},"Date",-1))),Ye={class:"fs-6"},Ie={class:"col-md-3 col-6"},Ke=u((()=>(0,l._)("div",{class:"fw-bold text-secondary small"},"Labourer Name",-1))),Ze={class:"fs-6 text-start"},Pe={class:"col-md-3 col-6"},Be=u((()=>(0,l._)("div",{class:"fw-bold text-secondary small"},"Designation",-1))),Je={class:"fs-6"},Ge={class:"col-md-3 col-6"},Qe=u((()=>(0,l._)("div",{class:"fw-bold text-secondary small"},"Daily Wages",-1))),Xe={class:"fs-6"},ea=u((()=>(0,l._)("hr",null,null,-1))),aa={class:"row g-3"},ta={class:"col-md-2"},la=u((()=>(0,l._)("label",{class:"form-label"},"Start Hour ",-1))),ra={class:"col-md-2"},sa=u((()=>(0,l._)("label",{class:"form-label"},"End Hour",-1))),oa={class:"col-md-2"},na=u((()=>(0,l._)("label",{class:"form-label"},"Advance",-1))),da={class:"col-md-6"},ia=u((()=>(0,l._)("label",{class:"form-label"},"Activity",-1))),ca={key:0,class:"col-md-6"},ua=u((()=>(0,l._)("label",{class:"form-label"},"Select Machine",-1))),va={key:1,class:"col-md-6"},ma=u((()=>(0,l._)("label",{class:"form-label"},"Fuel Used ",-1))),_a={class:"col-md-10"},pa=u((()=>(0,l._)("label",{class:"form-label"},"Target",-1))),ga={class:"col-md-2"},ba=u((()=>(0,l._)("label",{class:"form-label"},"Status",-1))),wa=u((()=>(0,l._)("option",{value:"Achieved"},"Achieved",-1))),ya=u((()=>(0,l._)("option",{value:"Not achieved"},"Not achieved",-1))),ha=[wa,ya],ka={class:"col-md-12"},fa=u((()=>(0,l._)("label",{class:"form-label"},"Remark",-1))),xa=u((()=>(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close"),(0,l._)("button",{type:"submit",class:"btn btn-secondary"},"Save changes")],-1))),Da={key:1},Sa={class:"d-flex"},Ha={class:"ms-auto"},Aa=u((()=>(0,l._)("h5",{class:"mb-3"},"Work Log Details",-1))),Ua={class:"row g-3"},za={class:"col-md-6"},Ca={class:"card p-3 h-100 text-start"},Ea={class:"mb-2"},Ma=u((()=>(0,l._)("strong",null,"Date:",-1))),$a={class:"mb-2"},Ta=u((()=>(0,l._)("strong",null,"Labourer Name:",-1))),La={class:"mb-2"},Na=u((()=>(0,l._)("strong",null,"Designation:",-1))),Wa={class:"mb-2"},qa=u((()=>(0,l._)("strong",null,"Daily Wages:",-1))),Va={class:"mb-2"},Ra=u((()=>(0,l._)("strong",null,"Advance:",-1))),ja={class:"col-md-6"},Fa={class:"card p-3 h-100 text-start"},Oa={class:"mb-2"},Ya=u((()=>(0,l._)("strong",null,"Start Hour:",-1))),Ia={class:"mb-2"},Ka=u((()=>(0,l._)("strong",null,"End Hour:",-1))),Za={key:0,class:"mb-2"},Pa=u((()=>(0,l._)("strong",null,"Machine:",-1))),Ba={key:1,class:"mb-2"},Ja=u((()=>(0,l._)("strong",null,"Fuel Used :",-1))),Ga={class:"mb-2"},Qa=u((()=>(0,l._)("strong",null,"Target:",-1))),Xa={class:"mb-2"},et=u((()=>(0,l._)("strong",null,"Status:",-1))),at={class:"col-12"},tt={class:"card p-3 text-start"},lt={class:"mb-2 text-start"},rt=u((()=>(0,l._)("strong",null,"Activity:",-1))),st=(0,l.Uk)(),ot={class:"text-muted"},nt={class:"mb-2 text-start"},dt=u((()=>(0,l._)("strong",null,"Remark:",-1))),it=(0,l.Uk)(),ct={class:"text-muted"},ut={key:0,class:"mb-2 text-start"},vt=u((()=>(0,l._)("strong",null,"MD's Remark:",-1))),mt=(0,l.Uk)(),_t={class:"text-muted"},pt={key:0,class:"row mt-2"},gt={class:"col-md-0"},bt=u((()=>(0,l._)("label",{class:"form-label me-2"},"MD's Remark",-1))),wt=u((()=>(0,l._)("div",{class:"text-center"},[(0,l._)("button",{type:"submit",class:"mt-2 text-center btn btn-primary"},"Send")],-1))),yt=u((()=>(0,l._)("div",{class:"modal-footer mt-3"},[(0,l._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Close")],-1))),ht={key:0,style:{"background-color":"yellow","padding-top":"1px"}},kt={class:"mt-4 mb-1"},ft=(0,l.Uk)("MD ANATAKA WATU WAKUTANE CONFERENCE ROOM KWA AJILI YA MKUTANO .ASANTENI"),xt={key:0,class:"remark-modal-overlay"},Dt={class:"remark-modal-container"},St=u((()=>(0,l._)("h5",{class:"remark-modal-title"},"Remark(s) On Weekly Allowance",-1))),Ht={class:"remark-modal-body"},At={class:"remark-sender"},Ut={class:"remark-text"},zt={class:"remark-modal-footer"},Ct={class:"remark-modal-buttons"},Et=["disabled"],Mt={key:1,class:"modal-backdrop fade show"};var $t={setup(e){(0,d.j)({title:"Weekly Allowance"});const a=(0,o.iH)(!1),t=(0,o.iH)(!1),i="https://construction.trustdigital.space/api/v1/",u=(0,l.f3)("showMessage"),I=(0,l.f3)("showError"),K=(0,o.iH)(!1),P=(0,o.iH)(0),B=()=>{P.value+=1,P.value>=3?(K.value=!0,P.value=1):P.value<3&&(K.value=!1)},ie=e=>{if(!e?.weekly_work)return 0;let a=0;return["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].forEach((t=>{const l=e.weekly_work[t];l&&"---"!==l&&("Achieved"===l.target?a+=1:"Not achieved"===l.target&&(a+=.5))})),parseFloat(a.toFixed(1))},We=(0,o.iH)([]),wa=(0,o.iH)(""),ya=async()=>{n.Z.get("https://bcftrack.trustdigital.space/api/v1/machines").then((e=>{Array.isArray(e.data)?We.value=e.data.map((e=>({id:e.id,name:e.name}))):(error_message.value="Error fetching machine data: "+error.message,console.error(error_message.value))})).catch((e=>{console.error("Error fetching machine data:",e.message)})).finally((()=>{}))},$t=(0,o.iH)(""),Tt=(0,o.iH)(""),Lt=(0,o.iH)(""),Nt=(0,o.iH)(""),Wt=(0,o.iH)(0),qt=(0,o.iH)((new Date).toISOString().split("T")[0]),Vt=(0,o.iH)(0),Rt=(0,o.iH)(""),jt=(0,o.iH)(""),Ft=(0,o.iH)("Not achieved"),Ot=(0,o.iH)(""),Yt=(0,o.iH)(""),It=(0,o.iH)(""),Kt=(0,o.iH)(""),Zt=(0,o.iH)(),Pt=(0,o.iH)(0),Bt=e=>{const a=new Date(e);return a.toISOString().split("T")[0]},Jt=(0,o.iH)(""),Gt=(0,o.iH)(null),Qt=async e=>{confirm("Are you sure you want to delete this record ?")&&(t.value=!0,n.Z["delete"](`${i}daily-work-logs/${e}`).then((e=>{vl(),Lt.value="",ol(),t.value=!1,200===e.status?u("Record Deleted Successfully"):(I("Fail to Delete Record"),console.error("Error delete record:",e.data.message))})).catch((e=>{I(e.message),console.error("Error deletion Record:",e)})))},Xt=async()=>{t.value=!0,a.value=!1;const e={labour_id:jt.value,work_date:Bt(Rt.value),start_hour:It.value,end_hour:Kt.value,machine:wa.value.name,fuel_used:Zt.value,activity:Ot.value,target:Ft.value,remark:Yt.value,target_description:Jt.value,advance:Gt.value||0};try{const a=await n.Z.post(`${i}daily-work-logs`,e);201==a.status?(vl(),ol(),Yt.value="",u("Work log added Successfully"),wa.value="",Zt.value=0,t.value=!1):(I("Failed to Add Work Log"),t.value=!1,console.error(a))}catch(error){t.value=!1,console.error("Error fetching work Log:",error),I(error.message)}},el=async e=>{const a={md_remark:Yt.value};hl.value="For "+e.labour.designation+" "+e.labour.name+" on "+e.work_date+" , "+Yt.value;try{const t=await n.Z.patch(`${i}daily-work-logs/${e.id}`,a);200==t.status?(Yt.value="",$l(),u("Remark added Succesfully"),vl()):(Yt.value="",I("Failed to add Remark"),console.error(error))}catch(error){Yt.value="",console.error("Error Adding Remark:",error),I(error.message)}},al=(e,a,t)=>{Vt.value=a,jt.value=e.id,$t.value=e.name,Tt.value=e.designation,Nt.value=e.rate,Lt.value=e.labour_type,Rt.value=t,vl(),setTimeout((()=>{const e=document.getElementById("modal-"+a);if(e){const a=window.bootstrap?new window.bootstrap.Modal(e):null;a&&a.show()}}),100)},tl=()=>{const e=qt.value?new Date(qt.value):new Date,a=e.getDay(),t=new Date(e);t.setDate(e.getDate()-(a-2+7)%7);const l=[];for(let r=0;r<7;r++){const e=new Date(t);e.setDate(t.getDate()+r),l.push(e.toISOString().split("T")[0])}return l},ll=async()=>{a.value=!1;const e={name:$t.value,labour_type:Lt.value.name,type_id:Lt.value.id,designation:Tt.value,rate:0,project_id:Pt.value.id,project_name:Pt.value.short_name};console.log(e);try{const a=await n.Z.post(`${i}labours`,e);Lt.value="",ol(),201==a.status?u("Labour added Succesfully"):(I("Failed to Add Labour"),console.error(error))}catch(error){console.error("Error fetching labours:",error),I(error.message)}},rl=(0,o.iH)([]),sl=(0,o.iH)([]),ol=async()=>{t.value=!0;try{const e=await n.Z.get(`${i}labours?date=${qt.value}`);sl.value=e.data,Array.isArray(e.data)?rl.value=Lt.value?e.data.filter((e=>e.labour_type===Lt.value)):e.data:rl.value=[],t.value=!1}catch(error){t.value=!1,console.error("Error fetching labours:",error)}},nl=()=>{0===Pt.value.id?rl.value=sl.value:(rl.value=sl.value,rl.value=rl.value.filter((e=>e.project_id===Pt.value.id)))},dl=(0,o.iH)([]),il=async()=>{t.value=!0;try{const e=await n.Z.get(`${i}labour-types`);dl.value=e.data.filter((e=>"approved"===e.status)),t.value=!1}catch(error){t.value=!1,console.error("Error fetching labour types:",error)}},cl=(0,o.iH)(""),ul=(0,o.iH)(!1),vl=async()=>{t.value=!0;try{const e=await n.Z.get(`${i}day-work-log?labour_id=${jt.value}&work_date=${Rt.value}`);cl.value=e.data,Wt.value=cl.value.advance??0,ul.value=!e.data||0===Object.keys(e.data).length,t.value=!1}catch(error){console.error("Error fetching work log:",error),t.value=!1}},ml=(0,o.iH)([]),_l=async()=>{t.value=!0;try{const e=await n.Z.get("https://bcftrack.trustdigital.space/api/v1/projects");ml.value=e.data,t.value=!1}catch(error){console.error("Error fetching projects:",error),t.value=!1}},pl=()=>{const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const a=tl(),t=e=>{const a=new Date(e),t=String(a.getDate()).padStart(2,"0"),l=String(a.getMonth()+1).padStart(2,"0"),r=String(a.getFullYear()).slice(-2);return`${t}.${l}.${r}`},l=rl.value.filter((e=>ie(e)*Number(e.rate)-e.total_advance>0)),r=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>Weekly Wages Report</title>\n            <style>\n                body { font-family: Arial, sans-serif; margin: 20px; }\n                table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n                th, td { border: 1px solid #000; padding: 8px; text-align: center; }\n                th { background-color: ; font-weight: bold; }\n                .text-start { text-align: left; }\n                .text-end { text-align: right; }\n                .text-center { text-align: center; }\n                .total-row { font-weight: bold; background-color: #e9ecef; }\n                .signature-section { margin-top: 50px; display: flex; justify-content: space-between; }\n                .signature-line { border-top: 1px solid #000; width: 200px; margin-top: 60px; text-align: center; padding-top: 5px; }\n            </style>\n        </head>\n        <body>\n            <center>\n                <h1>Weekly Wages Report</h1>\n                <h2>Week : ${t(a[0])} to ${t(new Date(new Date(a[5]).getTime()+864e5))}</h2>\n                <h3>Project : ${Pt.value.short_name??"All Projects "}</h3>\n            </center>\n            <table>\n                <thead>\n                    <tr >\n                        <th>SN</th>\n                        <th>Name</th>\n                        <th>Designation</th>\n                        ${["Tue","Wed","Thur","Friday","Sat","Sun","Mon"].map((e=>`<th>${e}</th>`)).join("")}\n                        <th>Days</th>\n                        <th>Advance</th>\n                        <th>Rate</th>\n                        <th>Total</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ${l.map(((e,a)=>`\n                        <tr>\n                            <td class="text-start">${a+1}</td>\n                            <td class="text-start">${e.name}</td>\n                            <td class="text-start">${e.designation}</td>\n                            ${["Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday"].map((a=>`\n                                <td class="text-center">\n                                    ${e.weekly_work?.[a]?.target||"-"}\n                                </td>\n                            `)).join("")}\n                            <td class="text-center">${ie(e)}</td>\n                            <td class="text-end">${Number(e.total_advance).toLocaleString()}/=</td>\n                            <td class="text-end">${Number(e.rate).toLocaleString()}/=</td>\n                            <td class="text-end">\n                                ${(ie(e)*Number(e.rate)-e.total_advance).toLocaleString()}/=\n                            </td>\n                        </tr>\n                    `)).join("")}\n                    <tr class="total-row">\n                        <td></td>\n                        <td></td>\n                        <td></td>\n                        <td colspan="10" class="text-end">Grand Total:</td>\n                        <td class="text-end">\n                            ${l.reduce(((e,a)=>e+(ie(a)*Number(a.rate)-a.total_advance)),0).toLocaleString()}/=\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n\n            <div class="signature-section">\n                <div class="signature-line">Prepared by</div>\n                <div class="signature-line">Checked by</div>\n                <div class="signature-line">Approved by</div>\n            </div>\n        </body>\n        </html>\n    `,s=e.contentWindow.document;s.open(),s.write(r),s.close(),e.onload=()=>{e.contentWindow.focus(),e.contentWindow.print(),setTimeout((()=>{document.body.removeChild(e)}),1e3)}},gl=(0,o.iH)(null),bl=(0,o.iH)([]);(0,l.bv)((()=>{const e=localStorage.getItem("user");gl.value=JSON.parse(e),bl.value=gl.value.permissions,_l(),ol(),ya(),il(),Ml()}));const wl=(0,o.iH)(!1),yl=(0,o.iH)([]),hl=(0,o.iH)(""),kl=(0,o.iH)(!1),fl=(0,o.iH)(!1),xl=JSON.parse(localStorage.getItem("user")).id,Dl="https://bcftrack.trustdigital.space/api/v1/remark",Sl=()=>{wl.value=!0,Al(),document.body.style.overflow="hidden"},Hl=()=>{wl.value=!1,hl.value="",document.body.style.overflow=""},Al=async()=>{fl.value=!0;try{const e=await n.Z.get(`${Dl}?remark_type=allowance&week_date=${qt.value}`);e.data&&Array.isArray(e.data.data)?yl.value=e.data.data:e.data&&Array.isArray(e.data)?yl.value=e.data:yl.value=[],setTimeout((()=>{const e=document.querySelector(".remark-modal-body");e&&(e.scrollTop=e.scrollHeight)}),100)}catch(error){console.error("Error fetching remarks:",error),I("Failed to load remarks")}finally{fl.value=!1}},Ul=async e=>{const a={status:"checked by "+JSON.parse(localStorage.getItem("user")).name};try{await zl.put(`/remark/${e}`,a);u("checked"),Ml()}catch(error){console.error("Error:",error)}},zl=n.Z.create({baseURL:"https://bushman.ink/api/v1/"}),Cl=(0,o.iH)(0),El=(0,o.iH)([""]),Ml=async()=>{try{const e=await zl.get("remark?remark_type=allowance");El.value=e.data.data.filter((e=>"unchecked"===e.status)),Cl.value=e.data.unchecked_count}catch(error){console.error("Error fetching allowance remark :",error),I("Failed to load allowance remark "+(error.response?.data?.message||error.message))}finally{fl.value=!1}},$l=async()=>{if(hl.value.trim()){kl.value=!0;try{const e={remarker_id:xl,description:hl.value,remark_type:"allowance",type_id:0,week_date:qt.value,remarker:JSON.parse(localStorage.getItem("user")).name,created_at:(new Date).toISOString()},a=await n.Z.post(Dl,e);201!==a.status&&200!==a.status||(a.data?(Ml(),yl.value.push(a.data)):yl.value.push(e),hl.value="",setTimeout((()=>{const e=document.querySelector(".remark-modal-body");e&&(e.scrollTop=e.scrollHeight)}),100))}catch(error){console.error("Error saving remark:",error),I("Failed to save remark")}finally{kl.value=!1}}else I("Remark cannot be empty")};return(0,l.YP)(qt,(()=>{wl.value&&Al()})),(e,n)=>{const d=(0,l.up)("marquee");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",v,[(0,l._)("div",m,[(0,l._)("div",_,[(0,l._)("div",p,[0!=Cl.value?((0,l.wg)(),(0,l.iD)("div",g,[(0,l._)("div",b,[(0,l._)("div",w,[(0,l._)("a",y,[h,(0,l._)("span",k,(0,r.zw)(Cl.value),1)]),(0,l._)("ul",f,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(El.value,(e=>((0,l.wg)(),(0,l.iD)("li",x,[(0,l._)("div",D,[S,(0,l._)("div",H,[(0,l._)("div",A,[(0,l._)("h6",U,"From : "+(0,r.zw)(e.sender_name),1),(0,l._)("p",z,[(0,l.Uk)((0,r.zw)(e.description)+" ",1),(0,l._)("button",{class:"btn btn-success p-1 btn-sm me-1",style:{cursor:"pointer"},onClick:a=>Ul(e.id)},"✔",8,C)])])])])])))),256))])])])])):(0,l.kq)("",!0)]),(0,l._)("div",E,[(0,l._)("div",M,[(0,l._)("h4",{class:"budgets-title",onClick:n[0]||(n[0]=e=>B())},"WEEKLY ALLOWANCE")]),(0,l._)("div",$,[(0,l._)("div",T,[L,(0,l.wy)((0,l._)("input",{type:"date",class:"text-center form-control form-control-sm w-auto","onUpdate:modelValue":n[1]||(n[1]=e=>qt.value=e),onChange:ol},null,544),[[s.nr,qt.value]])]),(0,l._)("div",N,[W,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":n[2]||(n[2]=e=>Lt.value=e),class:"form-control",onChange:ol},[q,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(dl.value,(e=>((0,l.wg)(),(0,l.iD)("option",{value:e.name},(0,r.zw)(e.name),9,V)))),256))],544),[[s.bM,Lt.value]])]),(0,l._)("div",R,[j,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":n[3]||(n[3]=e=>Pt.value=e),class:"form-control",onChange:n[4]||(n[4]=e=>nl())},[F,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ml.value,(e=>((0,l.wg)(),(0,l.iD)("option",{value:e},(0,r.zw)(e.short_name),9,O)))),256))],544),[[s.bM,Pt.value]])]),(0,l._)("div",Y,[(0,l._)("button",{class:"btn btn-success me-2",onClick:pl},Z),(0,l._)("button",{class:"btn btn-info me-2",onClick:Sl,title:"Add Remark"},J),(0,l._)("button",{onClick:n[5]||(n[5]=e=>a.value=!a.value),class:"btn btn-primary"},"Add Labour")])]),a.value?((0,l.wg)(),(0,l.iD)("div",G,[Q,(0,l._)("div",X,[(0,l._)("form",{onSubmit:(0,s.iM)(ll,["prevent"]),class:"row d-flex align-items-center col-12"},[(0,l._)("div",ae,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":n[6]||(n[6]=e=>$t.value=e),placeholder:"Enter Labour name",required:""},null,512),[[s.nr,$t.value]])]),(0,l._)("div",te,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":n[7]||(n[7]=e=>Tt.value=e),placeholder:"Enter Designation",required:""},null,512),[[s.nr,Tt.value]])]),(0,l._)("div",le,[(0,l.Wm)((0,o.SU)(c()),{modelValue:Lt.value,"onUpdate:modelValue":n[8]||(n[8]=e=>Lt.value=e),searchable:!0,options:dl.value,multiple:!1,required:"","track-by":"id",label:"name"},null,8,["modelValue","options"])]),(0,l._)("div",re,[(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":n[9]||(n[9]=e=>Pt.value=e),class:"form-control",required:""},[se,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ml.value,(e=>((0,l.wg)(),(0,l.iD)("option",{value:e},(0,r.zw)(e.short_name),9,oe)))),256))],512),[[s.bM,Pt.value]])]),ne],40,ee)])])):(0,l.kq)("",!0),t.value?((0,l.wg)(),(0,l.iD)("div",de,ce)):(0,l.kq)("",!0),(0,l._)("div",ue,[(0,l._)("table",ve,[me,(0,l._)("tbody",null,[(0,l._)("tr",null,[_e,pe,ge,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(tl(),((e,a)=>((0,l.wg)(),(0,l.iD)("td",{key:"date-"+a,class:"text-center text-muted small"},(0,r.zw)(e),1)))),128)),be,we,ye]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(rl.value,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",he,(0,r.zw)(a+1),1),(0,l._)("td",ke,(0,r.zw)(e.name),1),(0,l._)("td",fe,(0,r.zw)(e.designation),1),((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(["Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday"],((a,t)=>(0,l._)("td",{key:a,class:"text-center",onClick:a=>al(e,e.id,tl()[t])},[(0,l._)("span",De,[e.weekly_work&&e.weekly_work[a]&&"---"!==e.weekly_work[a].hours?((0,l.wg)(),(0,l.iD)("span",Se,[(0,l._)("span",{class:(0,r.C_)(["badge px-2","Achieved"===e.weekly_work[a].target?"bg-success":"bg-danger"])},(0,r.zw)(e.weekly_work[a].target),3)])):((0,l.wg)(),(0,l.iD)("span",He))])],8,xe))),64)),(0,l._)("td",Ae,(0,r.zw)(ie(e)),1),(0,l._)("td",Ue,(0,r.zw)(Number(e.total_advance).toLocaleString())+"/=",1),(0,l._)("td",ze,(0,r.zw)(Number(e.rate).toLocaleString())+"/=",1),(0,l._)("td",Ce,(0,r.zw)((Number(e.rate)*ie(e)-e.total_advance).toLocaleString())+"/= ",1)])))),128))])])])])])]),(0,l._)("div",null,[(0,l._)("div",{class:"modal fade custom-backdrop mymodal","data-bs-backdrop":"false",id:"modal-"+Vt.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,l._)("div",Me,[(0,l._)("div",$e,[Te,(0,l._)("div",Le,[t.value?((0,l.wg)(),(0,l.iD)("div",Ne,qe)):((0,l.wg)(),(0,l.iD)("div",Ve,[(0,l._)("div",Re,[(0,l._)("div",je,[(0,l._)("div",Fe,[Oe,(0,l._)("div",Ye,(0,r.zw)(Rt.value),1)]),(0,l._)("div",Ie,[Ke,(0,l._)("div",Ze,(0,r.zw)($t.value),1)]),(0,l._)("div",Pe,[Be,(0,l._)("div",Je,(0,r.zw)(Tt.value),1)]),(0,l._)("div",Ge,[Qe,(0,l._)("div",Xe,(0,r.zw)(Nt.value.toLocaleString())+"/=",1)])]),ea]),ul.value?((0,l.wg)(),(0,l.iD)("form",{key:0,onSubmit:n[19]||(n[19]=(0,s.iM)((e=>Xt()),["prevent"]))},[(0,l._)("div",aa,[(0,l._)("div",ta,[la,(0,l.wy)((0,l._)("input",{type:"time",class:"form-control","onUpdate:modelValue":n[10]||(n[10]=e=>It.value=e),required:""},null,512),[[s.nr,It.value]])]),(0,l._)("div",ra,[sa,(0,l.wy)((0,l._)("input",{type:"time",class:"form-control","onUpdate:modelValue":n[11]||(n[11]=e=>Kt.value=e),required:""},null,512),[[s.nr,Kt.value]])]),(0,l._)("div",oa,[na,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control","onUpdate:modelValue":n[12]||(n[12]=e=>Gt.value=e),placeholder:"Advance"},null,512),[[s.nr,Gt.value]])]),(0,l._)("div",da,[ia,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":n[13]||(n[13]=e=>Ot.value=e),required:"",placeholder:"Enter activity"},null,512),[[s.nr,Ot.value]])]),"driver"==Lt.value?((0,l.wg)(),(0,l.iD)("div",ca,[ua,(0,l.Wm)((0,o.SU)(c()),{modelValue:wa.value,"onUpdate:modelValue":n[14]||(n[14]=e=>wa.value=e),searchable:!0,options:We.value,multiple:!1,required:"","track-by":"id",label:"name"},null,8,["modelValue","options"])])):(0,l.kq)("",!0),"driver"==Lt.value?((0,l.wg)(),(0,l.iD)("div",va,[ma,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"enter fuel used","onUpdate:modelValue":n[15]||(n[15]=e=>Zt.value=e),required:"",step:"any"},null,512),[[s.nr,Zt.value]])])):(0,l.kq)("",!0),(0,l._)("div",_a,[pa,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control","onUpdate:modelValue":n[16]||(n[16]=e=>Jt.value=e),required:"",placeholder:"Enter Target"},null,512),[[s.nr,Jt.value]])]),(0,l._)("div",ga,[ba,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":n[17]||(n[17]=e=>Ft.value=e),class:"form-control",required:""},ha,512),[[s.bM,Ft.value]])]),(0,l._)("div",ka,[fa,(0,l.wy)((0,l._)("textarea",{placeholder:"Enter Remark",class:"form-control","onUpdate:modelValue":n[18]||(n[18]=e=>Yt.value=e),required:""},null,512),[[s.nr,Yt.value]])])]),xa],32)):((0,l.wg)(),(0,l.iD)("div",Da,[(0,l._)("div",Sa,[(0,l._)("div",Ha,[(0,l._)("button",{class:"btn btn-danger",onClick:n[20]||(n[20]=e=>Qt(cl.value.id))},"Clear Record")])]),Aa,(0,l._)("div",Ua,[(0,l._)("div",za,[(0,l._)("div",Ca,[(0,l._)("div",Ea,[Ma,(0,l.Uk)(" "+(0,r.zw)(cl.value.work_date),1)]),(0,l._)("div",$a,[Ta,(0,l.Uk)(" "+(0,r.zw)($t.value),1)]),(0,l._)("div",La,[Na,(0,l.Uk)(" "+(0,r.zw)(Tt.value),1)]),(0,l._)("div",Wa,[qa,(0,l.Uk)(" "+(0,r.zw)(Nt.value.toLocaleString())+"/=",1)]),(0,l._)("div",Va,[Ra,(0,l.Uk)(" "+(0,r.zw)(Wt.value.toLocaleString())+"/=",1)])])]),(0,l._)("div",ja,[(0,l._)("div",Fa,[(0,l._)("div",Oa,[Ya,(0,l.Uk)(" "+(0,r.zw)(cl.value.start_hour),1)]),(0,l._)("div",Ia,[Ka,(0,l.Uk)(" "+(0,r.zw)(cl.value.end_hour),1)]),null!==cl.value.machine?((0,l.wg)(),(0,l.iD)("div",Za,[Pa,(0,l.Uk)(" "+(0,r.zw)(cl.value.machine),1)])):(0,l.kq)("",!0),0!=cl.value.fuel_used?((0,l.wg)(),(0,l.iD)("div",Ba,[Ja,(0,l.Uk)(" "+(0,r.zw)(cl.value.fuel_used)+" Litres",1)])):(0,l.kq)("",!0),(0,l._)("div",Ga,[Qa,(0,l.Uk)(" "+(0,r.zw)(cl.value.target_description),1)]),(0,l._)("div",Xa,[et,(0,l.Uk)(" "+(0,r.zw)(cl.value.target),1)])])]),(0,l._)("div",at,[(0,l._)("div",tt,[(0,l._)("div",lt,[rt,st,(0,l._)("span",ot,(0,r.zw)(cl.value.activity),1)]),(0,l._)("div",nt,[dt,it,(0,l._)("span",ct,(0,r.zw)(cl.value.remark),1)]),null!==cl.value.md_remark?((0,l.wg)(),(0,l.iD)("div",ut,[vt,mt,(0,l._)("span",_t,(0,r.zw)(cl.value.md_remark),1)])):(0,l.kq)("",!0)])])]),null===cl.value.md_remark&&bl.value.includes("is_md")?((0,l.wg)(),(0,l.iD)("div",pt,[(0,l._)("div",gt,[(0,l._)("form",{onSubmit:n[22]||(n[22]=(0,s.iM)((e=>el(cl.value)),["prevent"]))},[bt,(0,l.wy)((0,l._)("textarea",{placeholder:"Enter Remark",class:"form-control","onUpdate:modelValue":n[21]||(n[21]=e=>Yt.value=e),required:""},null,512),[[s.nr,Yt.value]]),wt],32)])])):(0,l.kq)("",!0),yt]))]))])])])],8,Ee),K.value?((0,l.wg)(),(0,l.iD)("div",ht,[(0,l._)("h4",kt,[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[ft])),_:1})])])):(0,l.kq)("",!0)])]),wl.value?((0,l.wg)(),(0,l.iD)("div",xt,[(0,l._)("div",Dt,[(0,l._)("div",{class:"remark-modal-header"},[St,(0,l._)("button",{type:"button",class:"remark-modal-close",onClick:Hl},"×")]),(0,l._)("div",Ht,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(yl.value,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"remark-message-container"},[(0,l._)("div",{class:(0,r.C_)(["remark-message",e.remarker_id==(0,o.SU)(xl)?"remark-message-own":"remark-message-other"])},[(0,l._)("div",At,(0,r.zw)(e.remarker_id==(0,o.SU)(xl)?"You":e.remarker||e.sender_name),1),(0,l._)("div",Ut,(0,r.zw)(e.description),1)],2)])))),128))]),(0,l._)("div",zt,[(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":n[23]||(n[23]=e=>hl.value=e),class:"remark-input",placeholder:"Enter your remark"},null,512),[[s.nr,hl.value]]),(0,l._)("div",Ct,[(0,l._)("button",{class:"remark-btn remark-btn-close",onClick:Hl},"Close"),(0,l._)("button",{class:"remark-btn remark-btn-save",onClick:$l,disabled:kl.value||!hl.value.trim()}," Save ",8,Et)])])])])):(0,l.kq)("",!0),wl.value?((0,l.wg)(),(0,l.iD)("div",Mt)):(0,l.kq)("",!0)],64)}}},Tt=t(83744);const Lt=(0,Tt.Z)($t,[["__scopeId","data-v-167b195c"]]);var Nt=Lt}}]);
//# sourceMappingURL=9320.c4b9070e.js.map